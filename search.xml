<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>局域网文件多播，局域网拷贝文件，大文件批量传输</title>
      <link href="/page/3832108924/"/>
      <url>/page/3832108924/</url>
      
        <content type="html"><![CDATA[<h1 id="功能简介"><a href="#功能简介" class="headerlink" title="功能简介"></a>功能简介</h1><p>　　HOU文件多播 是用于局域网文件“一对多”批量传输的软件。它是基于UDP的可靠传输，<br>能有效提高传输速度，并减轻服务器负载。</p><p>　　多播(组播)的优点：可以真正同时的进行文件传送，客户机越多，总体速度就越快。<br>因为 总体速度 = 传送速度 X 客户机数目 。特别适合大文件的批量传输！</p><h1 id="使用功能说明"><a href="#使用功能说明" class="headerlink" title="使用功能说明"></a>使用功能说明</h1><p>选项:<br>　　1.“循环启动”，和“自动开始”配合使用可实现无人值守。<br>　　2.“自动开始”，根据设置的条件自动开始传输，<br>如:当有3个接收端连接时 或 当有一个接收端连接且达到“最大等待”时间。<br>　　3.“传输速率”，这个对在高负载网络上传输时较实用，可限制传输的带宽占用，减轻网络负载。<br>如果接收端性能较差可以适当限制传输速率，以提高整体速度。<br>　　4.“传输接口”，一般最好选择固定接口，特别是在发送端上存在ADSL拨号时需要选择接口,<br>软件会自动添加组播路由，以正常传输。<br>　　5.“开启流模式”，强制以组播方式传输，就算只有一个接收端（正常情况下只有一个接收端时会使用点对点传输）。<br>此功能开启后允许接收端加入一个正在传输的会话进行接收（但之前已经传输的数据将无法收到，所以一般不要中途加入）。</p><p>高级选项：<br>　　6.“初始片块数”，相当于TCP中的窗口大小，就是一次连续发送的块(UDP包)数。0为默认，一般不要修改。<br>　　7.“动态调整片块数”，根据重传情况自动调整连续发送的块数，以适应波动较大的网络(如无线)。<br>　　8.“超时重试次”，在发送完一片后请求接收端确认时，重试次数，以确定是否要放弃无响应的接收端。<br>如果经常出现接收端被断开，可适当加大重试次数。</p><h1 id="文件说明"><a href="#文件说明" class="headerlink" title="文件说明:"></a>文件说明:</h1><p>　　“DMCSender.exe” 发送端</p><p>　　“DMCReceiver.exe” 接收端<br>　　使用：<br>　　　　开始 -&gt; 运行 -&gt; DMCReceiver.exe D:\</p><h1 id="图文使用说明"><a href="#图文使用说明" class="headerlink" title="图文使用说明"></a>图文使用说明</h1><ol><li>接收端<br>首先接收端加接收目录参数，运行，如下图<br><img src="/images/20210923095321.png" alt="局域网传输文件接收端"></li><li>发送端</li></ol><ul><li>选择文件或文件夹</li><li>点击开始 会自动发现同局域网所有运行了接收端的客户机</li><li>点击传输 会同时向运行了接收端的机器传输文件或文件夹<br><img src="/images/20210923095841.png" alt="局域网接收文件发送端"><h1 id="应用案例"><a href="#应用案例" class="headerlink" title="应用案例"></a>应用案例</h1>局域网中，比如网吧，从客户端拷文件（游戏）到服务器，因为使用共享，服务器就不安全，如果安装ftp，一是麻烦，二是容易有利用漏洞。所以一般的操作就是U盘从客户机拷贝后再插到服务端拷贝，这样服务器容易中毒。使用此局域网拷贝软件，大大方便了操作！</li></ul><h1 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h1><p><a href="https://share.weiyun.com/ea2izq81">局域网传输文件工具</a> 密码：z2djzf</p><h1 id="使用感受"><a href="#使用感受" class="headerlink" title="使用感受"></a>使用感受</h1><p>  此软件使用delphi编写,对特殊文件名或目录，识别转换偶尔存在问题，即编码问题!如果你的文件或文件夹包括乱码，则可能传输会中断!<br>  如果使用此软件传输文件夹内容不成功,可以使用<a href="/page/1934957637/">croc</a>进行传输!</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 局域网 </tag>
            
            <tag> 精品软件 </tag>
            
            <tag> 文件传输 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>系统无法启动-电脑蓝屏等怎么办？使用Win10系统内置的万能工具解决此类问题!</title>
      <link href="/page/3944557397/"/>
      <url>/page/3944557397/</url>
      
        <content type="html"><![CDATA[<p>Windows无法正常工作，一般情况下很多人的做法就是重装系统，但对于电脑小白来说，重装系统就像是一个难题。并且系统中的数据最为重要，重装不是最好的选择。如果系统出现了问题，大家可利用该工具修复系统问题，实在没辙了再重装也为时未晚!</p><p><img src="/images/2021092201.jpg" alt="win re界面"></p><iframe frameborder="0"  width="100%" height="600px" src="https://v.douyin.com/df7xUFn/" allowFullScreen="true"></iframe> <p>由于磁盘损坏、系统文件损坏或缺少 或安装更新时挂起的操作，系统可能无法启动，依次执行</p><ol><li>BCDEdit (查看系统盘符)</li><li>CHKDSK /f 系统盘符: (修复磁盘错误)</li><li>SFC /scannow /offbootdir=系统盘符:\ /offwindir=系统盘符:\windows (检查修复系统文件)</li></ol><p>这是微软官方给出的解决windows常见启动问题的方法!蓝屏或启动不了系统，可以试试这样操作，不能保证百分百成功，至少离恢复正常工作环境又近了一步!注册表造成的蓝屏可以使用上个蓝屏视频试试!</p><p>执行sfc的相关提供信息如下：</p><p><img src="/images/fc1f4134970a304e444acafffb9c6b80c9175c21.jpeg"></p><p><a href="https://www.douyin.com/user/MS4wLjABAAAAQwn54Jes0qMk4oDljDNC_4zWQCZrhpoMQIe7aPmU4ueHtUmGvSuqmXY6BJRncREG">欢迎关注百脑问抖音：杰叔说电脑 抖音号：jscomp</a></p><p><a href="https://www.douyin.com/user/MS4wLjABAAAAMa9WqR28kXFhmkObqEzCq0HvOphSyHJaVMKrPHEia54">欢迎关注百脑问抖音：表情包零动画 抖音号：bqbao</a></p><p><a href="https://www.xiaohongshu.com/user/profile/5e495bbe0000000001005d53">欢迎关注百脑问小红书：电脑百科知识</a></p>]]></content>
      
      
      <categories>
          
          <category> 抖音 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 电脑蓝屏 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决在hexo上github推送连接失败的问题</title>
      <link href="/page/1758950243/"/>
      <url>/page/1758950243/</url>
      
        <content type="html"><![CDATA[<p>在国内，有时候使用 git clone 的速度实在太慢而让人难以承受，或者 git pull/git push 一点反应都没有，这里整理了一下解决方法，亲测有效。<br>总的来说，这是因为 github.global.ssl.fastly.net 域名被限制了。只要找到这个域名对应的 ip 地址，然后在 hosts 文件中加上 ip–&gt;域名 的映射，刷新 DNS 缓存便可。<br><img src="/images/12b1a07f8ae753b1d1ee27e14e19f97.png"><br>1.查找域名对应的 ip 地址</p><ul><li><p>在网站 <a href="https://www.ipaddress.com/">https://www.ipaddress.com/</a> 分别搜索 github.global.ssl.fastly.net 和 github.com</p></li><li><p>或者在本地的终端中如下键入：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ nslookup github.global.ssl.fastly.<span class="built_in">Net</span></span><br><span class="line"><span class="function">Server:  127.0.0.53</span></span><br><span class="line"><span class="function"><span class="title">Address</span>: 127.0.0.53#53</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Non</span>-<span class="title">authoritative</span> <span class="title">answer</span>:</span></span><br><span class="line"><span class="function"><span class="title">Name</span>: <span class="title">github.global.ssl.fastly.Net</span></span></span><br><span class="line"><span class="function"><span class="title">Address</span>: 151.101.229.194</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">$ <span class="title">nslookup</span> <span class="title">github.com</span></span></span><br><span class="line"><span class="function"><span class="title">Server</span>:  127.0.0.53</span></span><br><span class="line"><span class="function"><span class="title">Address</span>: 127.0.0.53#53</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Non</span>-<span class="title">authoritative</span> <span class="title">answer</span>:</span></span><br><span class="line"><span class="function"><span class="title">Name</span>: <span class="title">github.com</span></span></span><br><span class="line"><span class="function"><span class="title">Address</span>: 13.229.188.59</span></span><br></pre></td></tr></table></figure></li></ul><ol start="2"><li>修改 hosts 文件</li></ol><ul><li>Windows 上的 hosts 文件路径在: C:\Windows\System32\drivers\etc\hosts<br>在 hosts 文件末尾添加两行<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># Copyright (c) <span class="number">1993</span>-<span class="number">2009</span> Microsoft Corp.</span><br><span class="line">#</span><br><span class="line"># This is a sample HOSTS file used by Microsoft TCP/IP <span class="keyword">for</span> Windows.</span><br><span class="line">#</span><br><span class="line"># This file contains the mappings of IP addresses to host names. Each</span><br><span class="line"># entry should be kept on an individual line. The IP address should</span><br><span class="line"># be placed <span class="keyword">in</span> the first column followed by the corresponding host name.</span><br><span class="line"># The IP address and the host name should be separated by <span class="built_in">at</span> least one</span><br><span class="line"># space.</span><br><span class="line">#</span><br><span class="line"># Additionally, comments (such as these) may be inserted on individual</span><br><span class="line"># lines or following the machine name denoted by a &#x27;#&#x27; symbol.</span><br><span class="line">#</span><br><span class="line"># <span class="keyword">For</span> example:</span><br><span class="line">#</span><br><span class="line">#      <span class="number">102</span>.<span class="number">54</span>.<span class="number">94</span>.<span class="number">97</span>     rhino.acme.com          # source server</span><br><span class="line">#       <span class="number">38</span>.<span class="number">25</span>.<span class="number">63</span>.<span class="number">10</span>     x.acme.com              # x client host</span><br><span class="line"></span><br><span class="line"># localhost name resolution is handled within DNS itself.</span><br><span class="line">#<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>       localhost</span><br><span class="line">#::<span class="number">1</span>             localhost</span><br><span class="line"></span><br><span class="line"><span class="number">199</span>.<span class="number">232</span>.<span class="number">69</span>.<span class="number">194</span> github.global.ssl.fastly.<span class="built_in">net</span></span><br></pre></td></tr></table></figure></li><li>Linux 的 hosts 文件路径在 /etc/hosts 中:<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/hosts</span><br></pre></td></tr></table></figure></li></ul><ol start="3"><li>刷新 DNS 缓存</li></ol><ul><li>windows<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ipconfig</span> /flushdns</span><br></pre></td></tr></table></figure></li><li>linux<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo /etc/init.d/networking restart</span><br></pre></td></tr></table></figure></li></ul><ol start="4"><li>参考文献<br><a href="https://blog.csdn.net/xiaolong_4_2/article/details/105389128">解决linux上git clone速度慢的问题</a><br><a href="https://www.jianshu.com/p/3f6477049ece">git clone速度太慢的解决办法</a></li><li>本文转载自<br><a href="https://iphysresearch.github.io/blog/post/programing/linux_shell/hosts/">解决 GitHub 的 host 域名被限制的问题</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 开源项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>看完世界上最诡异的图片，你还会相信你的眼睛吗？</title>
      <link href="/page/3381448577/"/>
      <url>/page/3381448577/</url>
      
        <content type="html"><![CDATA[<p>如果你看见这个舞女是顺时针转，说明你用的是右脑；­<br>如果是逆时针转，说明你用的左脑。­<br>据说，14%的美国人可以两个方向都能看见。­<br>可以和别人一起看，测试下，一般不同人同时看这张图的感觉都会不太一样的，真的很神奇。<br><img src="/images/2021092001.gif"><br>照片的本身由34张图片组成的gif图，在photoshop中，一张一张的看，是从左向右转动，如果你看到的图片一会左转，一会儿右转，并不是图片本身是多方向变动的，这一点你可以下载图片自己用photoshop查看! <img src="/images/20210920100945.png"></p><p>下面这张图片:柱子到底是圆的还是方的,别着急慢慢看<br><img src="/images/2021092002.jpg"></p><p>看着黑点身体前后移动</p><p><img src="/images/2021092003.jpg"></p><p>这些图片到底是静的还是动的（看则静，不看则动）</p><p><img src="/images/2021092004.jpg"><br><img src="/images/2021092005.jpg"><br><img src="/images/2021092006.jpg"><br><img src="/images/2021092007.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> 素材 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图片 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编程实现关闭显示器等的python源代码-等同于按显示器的电源键</title>
      <link href="/page/93934963/"/>
      <url>/page/93934963/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/1440056844.jpg"></p><h1 id="可实现功能"><a href="#可实现功能" class="headerlink" title="可实现功能"></a>可实现功能</h1><p>通过显示器的 DDC/CI 来直接操作显示器，拯救可怜的显示器按键。</p><p>支持的操作：</p><ul><li><p>调整亮度</p></li><li><p>调整对比度</p></li><li><p>设置色温 / 颜色预设</p></li><li><p>设置RGB颜色的比例</p></li><li><p>OSD语言</p></li><li><p>开关机</p></li><li><p>切换输入源</p></li><li><p>自动调整图像 (VGA输入需要)</p></li><li><p>恢复出厂设置</p><h1 id="系统需求"><a href="#系统需求" class="headerlink" title="系统需求"></a>系统需求</h1><p>Windows Vista +<br>Python3 (建议安装时选上Python Launcher)<br>支持DDC/CI的外接显示器，不支持笔记本内置显示器<br><img src="/images/2021091901.jpg"></p><h1 id="使用参考"><a href="#使用参考" class="headerlink" title="使用参考"></a>使用参考</h1><p>GUI 模式<br>不附加参数启动 monitor_ctrl.py 即可启动GUI，直接拖动滑条设置显示器的参数。</p></li></ul><p>由于显示器应用VCP指令可能需要一定时间，为避免出错，GUI模式将忽略命令行指定的操作。</p><p>GUI中显示的配置不会自动刷新，要查看新的配置目前需要重启应用程序。</p><p>将文件后缀修改为 .pyw, 直接双击打开，可以避免显示conhost黑窗口</p><p>命令行模式<br>当指定 -c 选项或者 tkinter import失败就会使用CLI模式。</p><p>py monitor_ctrl.py [-h] [-m Model_string] [-s Settings_string] [-r] [-t] [-c] [-l] [-v]<br>  -h          显示帮助<br>  -m          指定要应用到的Monitor Model，不指定则应用到所有可操作的显示器<br>  -s          property1=value1:property2=”value 2” 应用多项设置<br>  -r          将显示器恢复出厂设置<br>  -t          对输入执行自动调整（仅VGA输入需要）<br>  -c          不启用GUI<br>  -l          显示可操作的显示器model<br>  -v          Verbose logging</p><p>example：</p><p>列出可操作的显示器<br>monitor_ctrl.py -c -l</p><p>降低显示器的亮度和蓝色亮度：<br>monitor_ctrl.py -c -s brightness=10:rgb_gain=”(100, 100, 80)”</p><p>设置显示器颜色预设为 sRGB ：<br>monitor_ctrl.py -c -s color_preset=sRGB</p><p>恢复出厂设置：<br>monitor_ctrl.py -c -r</p><p>VGA输入自动调整<br>monitor_ctrl.py -c -t</p><p>仅设置某个特定型号的显示器：<br>monitor_ctrl.py -c -m p2401 -s power_mode=on</p><p>-s 接受的属性<br>参见后面 PhyMonitor() 类的常用属性。</p><p>python实现的主代码如下:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding = utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> wintypes</span><br><span class="line"><span class="keyword">import</span> vcp_code</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Tuple</span></span><br><span class="line"></span><br><span class="line">_LOGGER = logging.getLogger(__name__)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Reference</span></span><br><span class="line"><span class="string">[High-Level Monitor API](https://msdn.microsoft.com/en-us/library/vs/alm/dd692964(v=vs.85).aspx)</span></span><br><span class="line"><span class="string">[Low-Level Monitor Configuration](https://msdn.microsoft.com/en-us/library/windows/desktop/dd692982(v=vs.85).aspx)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Monitor Control Command Set](https://en.wikipedia.org/wiki/Monitor_Control_Command_Set)</span></span><br><span class="line"><span class="string">https://milek7.pl/ddcbacklight/mccs.pdf</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># #################################### Use Windows API to enumerate monitors</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_physical_monitors_from_hmonitor</span>(<span class="params">hmonitor: wintypes.HMONITOR</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Retrieves the physical monitors associated with an HMONITOR monitor handle</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    https://msdn.microsoft.com/en-us/library/vs/alm/dd692950(v=vs.85).aspx</span></span><br><span class="line"><span class="string">    BOOL GetPhysicalMonitorsFromHMONITOR(</span></span><br><span class="line"><span class="string">        _In_   HMONITOR hMonitor,</span></span><br><span class="line"><span class="string">        _In_   DWORD dwPhysicalMonitorArraySize,</span></span><br><span class="line"><span class="string">        _Out_  LPPHYSICAL_MONITOR pPhysicalMonitorArray</span></span><br><span class="line"><span class="string">    );</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Retrieves the number of physical monitors associated with an HMONITOR monitor handle.</span></span><br><span class="line"><span class="string">    Call this function before calling GetPhysicalMonitorsFromHMONITOR.</span></span><br><span class="line"><span class="string">    https://msdn.microsoft.com/en-us/library/dd692948(v=vs.85).aspx</span></span><br><span class="line"><span class="string">    BOOL GetNumberOfPhysicalMonitorsFromHMONITOR(</span></span><br><span class="line"><span class="string">        _In_   HMONITOR hMonitor,</span></span><br><span class="line"><span class="string">        _Out_  LPDWORD pdwNumberOfPhysicalMonitors</span></span><br><span class="line"><span class="string">    );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :param hmonitor:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">_PhysicalMonitorStructure</span>(<span class="params">ctypes.Structure</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        PHYSICAL_MONITOR Structure.</span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/vs/alm/dd692967(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        typedef struct _PHYSICAL_MONITOR &#123;</span></span><br><span class="line"><span class="string">            HANDLE hPhysicalMonitor;</span></span><br><span class="line"><span class="string">            WCHAR  szPhysicalMonitorDescription[PHYSICAL_MONITOR_DESCRIPTION_SIZE];</span></span><br><span class="line"><span class="string">        &#125; PHYSICAL_MONITOR, *LPPHYSICAL_MONITOR;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        PHYSICAL_MONITOR_DESCRIPTION_SIZE = 128</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        _fields_ = [</span><br><span class="line">            (<span class="string">&quot;hPhysicalMonitor&quot;</span>, wintypes.HANDLE),</span><br><span class="line">            (<span class="string">&quot;szPhysicalMonitorDescription&quot;</span>, wintypes.WCHAR * <span class="number">128</span>)</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Retrieves the number of physical monitors</span></span><br><span class="line">    phy_monitor_number = wintypes.DWORD()</span><br><span class="line">    api_call_get_number = ctypes.windll.Dxva2.GetNumberOfPhysicalMonitorsFromHMONITOR</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> api_call_get_number(hmonitor, ctypes.byref(phy_monitor_number)):</span><br><span class="line">        _LOGGER.error(ctypes.WinError())</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Retrieves the physical monitors</span></span><br><span class="line">    api_call_get_monitor = ctypes.windll.Dxva2.GetPhysicalMonitorsFromHMONITOR</span><br><span class="line">    <span class="comment"># create array</span></span><br><span class="line">    phy_monitor_array = (_PhysicalMonitorStructure * phy_monitor_number.value)()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> api_call_get_monitor(hmonitor, phy_monitor_number, phy_monitor_array):</span><br><span class="line">        _LOGGER.error(ctypes.WinError())</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(phy_monitor_array)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enumerate_monitors</span>() -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    enumerate all physical monitor.</span></span><br><span class="line"><span class="string">    ** 请注意防止返回的 Handle 对象被GC!</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    https://msdn.microsoft.com/en-us/library/dd162610(v=vs.85).aspx</span></span><br><span class="line"><span class="string">    BOOL EnumDisplayMonitors(</span></span><br><span class="line"><span class="string">        _In_ HDC             hdc,</span></span><br><span class="line"><span class="string">        _In_ LPCRECT         lprcClip,</span></span><br><span class="line"><span class="string">        _In_ MONITORENUMPROC lpfnEnum,</span></span><br><span class="line"><span class="string">        _In_ LPARAM          dwData</span></span><br><span class="line"><span class="string">    );</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    :return: list contains physical monitor handles</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    all_hmonitor = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Factory function of EnumDisplayMonitors callback.</span></span><br><span class="line">    <span class="comment"># 保持引用以防止被GC !</span></span><br><span class="line">    <span class="comment"># https://msdn.microsoft.com/en-us/library/dd145061(v=vs.85).aspx</span></span><br><span class="line">    _MONITOR_ENUM_PROC = ctypes.WINFUNCTYPE(wintypes.BOOL,</span><br><span class="line">                                            wintypes.HMONITOR,</span><br><span class="line">                                            wintypes.HDC,</span><br><span class="line">                                            ctypes.POINTER(wintypes.LPRECT),</span><br><span class="line">                                            wintypes.LPARAM)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__monitor_enum_proc_callback</span>(<span class="params">hmonitor_: wintypes.HMONITOR, hdc, lprect, lparam</span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        EnumDisplayMonitors callback, append HMONITOR to all_hmonitor list.</span></span><br><span class="line"><span class="string">        :param hmonitor_:</span></span><br><span class="line"><span class="string">        :param hdc:</span></span><br><span class="line"><span class="string">        :param lprect:</span></span><br><span class="line"><span class="string">        :param lparam:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        all_hmonitor.append(hmonitor_)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ctypes.windll.user32.EnumDisplayMonitors(<span class="literal">None</span>, <span class="literal">None</span>,</span><br><span class="line">                                                    _MONITOR_ENUM_PROC(__monitor_enum_proc_callback), <span class="literal">None</span>):</span><br><span class="line">            <span class="keyword">raise</span> ctypes.WinError()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># get physical monitor handle</span></span><br><span class="line">    handles = []</span><br><span class="line">    <span class="keyword">for</span> hmonitor <span class="keyword">in</span> all_hmonitor:</span><br><span class="line">        handles.extend(_get_physical_monitors_from_hmonitor(hmonitor))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> handles</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PhyMonitor</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    一个物理显示器的VCP控制class，封装常用操作.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, phy_monitor</span>):</span></span><br><span class="line">        self._phy_monitor = phy_monitor</span><br><span class="line">        self._phy_monitor_handle = self._phy_monitor.hPhysicalMonitor</span><br><span class="line">        <span class="comment"># VCP Capabilities String</span></span><br><span class="line">        self._caps_string = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># Monitor model name</span></span><br><span class="line">        self.model = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        self.info_display_type = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        </span><br><span class="line">        self._get_monitor_caps()</span><br><span class="line">        <span class="keyword">if</span> self._caps_string != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            self._get_model_info()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_monitor_caps</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/windows/desktop/dd692938(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        BOOL GetCapabilitiesStringLength(</span></span><br><span class="line"><span class="string">            _In_   HANDLE hMonitor,</span></span><br><span class="line"><span class="string">            _Out_  LPDWORD pdwCapabilitiesStringLengthInCharacters</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/windows/desktop/dd692934(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        BOOL CapabilitiesRequestAndCapabilitiesReply(</span></span><br><span class="line"><span class="string">            _In_   HANDLE hMonitor,</span></span><br><span class="line"><span class="string">            _Out_  LPSTR pszASCIICapabilitiesString,</span></span><br><span class="line"><span class="string">            _In_   DWORD dwCapabilitiesStringLengthInCharacters</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        caps_string_length = wintypes.DWORD()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ctypes.windll.Dxva2.GetCapabilitiesStringLength(self._phy_monitor_handle,</span><br><span class="line">                                                               ctypes.byref(caps_string_length)):</span><br><span class="line">            _LOGGER.error(ctypes.WinError())</span><br><span class="line">            <span class="keyword">raise</span> ctypes.WinError()</span><br><span class="line">        </span><br><span class="line">        caps_string = (ctypes.c_char * caps_string_length.value)()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ctypes.windll.Dxva2.CapabilitiesRequestAndCapabilitiesReply(</span><br><span class="line">                self._phy_monitor_handle, caps_string, caps_string_length):</span><br><span class="line">                _LOGGER.error(ctypes.WinError())</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        self._caps_string = caps_string.value.decode(<span class="string">&#x27;ASCII&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_model_info</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        analyze caps string</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">find_</span>(<span class="params">src: <span class="built_in">str</span>, start_: <span class="built_in">str</span>, end_: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            查找 start_ 和 end_ 之间包围的内容</span></span><br><span class="line"><span class="string">            :param src: 待寻找的支付串</span></span><br><span class="line"><span class="string">            :param start_:</span></span><br><span class="line"><span class="string">            :param end_:</span></span><br><span class="line"><span class="string">            :return:</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">            start_index = src.find(start_)</span><br><span class="line">            <span class="keyword">if</span> start_index == -<span class="number">1</span>:</span><br><span class="line">                <span class="comment"># not found</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">            start_index = start_index + <span class="built_in">len</span>(start_)</span><br><span class="line">            </span><br><span class="line">            end_index = src.find(end_, start_index)</span><br><span class="line">            <span class="keyword">if</span> end_index == -<span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> src[start_index:end_index]</span><br><span class="line">        </span><br><span class="line">        model = find_(self._caps_string, <span class="string">&#x27;model(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> model == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;unable to find model info in vcp caps string: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(self._caps_string))</span><br><span class="line">        self.model = model</span><br><span class="line"></span><br><span class="line">        info_display_type = find_(self._caps_string, <span class="string">&#x27;type(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> info_display_type == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;unable to find display type info in vcp caps string: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(self._caps_string))</span><br><span class="line">        self.info_display_type = info_display_type</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Close WinAPI Handle.</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/windows/desktop/dd692936(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        BOOL DestroyPhysicalMonitor(</span></span><br><span class="line"><span class="string">            _In_  HANDLE hMonitor</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">import</span> ctypes</span><br><span class="line">        api_call = ctypes.windll.Dxva2.DestroyPhysicalMonitor</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> api_call(self._phy_monitor_handle):</span><br><span class="line">            _LOGGER.error(ctypes.WinError())</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ########################## 发送/读取 VCP 设置的函数</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send_vcp_code</span>(<span class="params">self, code: <span class="built_in">int</span>, value: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        send vcp code to monitor.</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/dd692979(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        BOOL SetVCPFeature(</span></span><br><span class="line"><span class="string">            _In_  HANDLE hMonitor,</span></span><br><span class="line"><span class="string">            _In_  BYTE bVCPCode,</span></span><br><span class="line"><span class="string">            _In_  DWORD dwNewValue</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        :param code: VCP Code</span></span><br><span class="line"><span class="string">        :param value: Data</span></span><br><span class="line"><span class="string">        :return: Win32 API return</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> code <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            _LOGGER.error(<span class="string">&#x27;vcp code to send is None. ignored.&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        api_call = ctypes.windll.Dxva2.SetVCPFeature</span><br><span class="line">        code = wintypes.BYTE(code)</span><br><span class="line">        new_value = wintypes.DWORD(value)</span><br><span class="line">        api_call.restype = ctypes.c_bool</span><br><span class="line">        ret_ = api_call(self._phy_monitor_handle, code, new_value)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ret_:</span><br><span class="line">            _LOGGER.error(<span class="string">&#x27;send vcp command failed: &#x27;</span> + <span class="built_in">hex</span>(code))</span><br><span class="line">            _LOGGER.error(ctypes.WinError())</span><br><span class="line">        <span class="keyword">return</span> ret_</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_vcp_code</span>(<span class="params">self, code: <span class="built_in">int</span></span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        send vcp code to monitor, get current value and max value.</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/dd692953(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        BOOL GetVCPFeatureAndVCPFeatureReply(</span></span><br><span class="line"><span class="string">            _In_   HANDLE hMonitor,</span></span><br><span class="line"><span class="string">            _In_   BYTE bVCPCode,</span></span><br><span class="line"><span class="string">            _Out_  LPMC_VCP_CODE_TYPE pvct,</span></span><br><span class="line"><span class="string">            _Out_  LPDWORD pdwCurrentValue,</span></span><br><span class="line"><span class="string">            _Out_  LPDWORD pdwMaximumValue</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        :param code: VCP Code</span></span><br><span class="line"><span class="string">        :return: current_value, max_value</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> code <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            _LOGGER.error(<span class="string">&#x27;vcp code to send is None. ignored.&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        api_call = ctypes.windll.Dxva2.GetVCPFeatureAndVCPFeatureReply</span><br><span class="line">        api_in_vcp_code = wintypes.BYTE(code)</span><br><span class="line">        api_out_current_value = wintypes.DWORD()</span><br><span class="line">        api_out_max_value = wintypes.DWORD()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> api_call(self._phy_monitor_handle, api_in_vcp_code, <span class="literal">None</span>,</span><br><span class="line">                        ctypes.byref(api_out_current_value), ctypes.byref(api_out_max_value)):</span><br><span class="line">            _LOGGER.error(<span class="string">&#x27;get vcp command failed: &#x27;</span> + <span class="built_in">hex</span>(code))</span><br><span class="line">            _LOGGER.error(ctypes.WinError())</span><br><span class="line">        <span class="keyword">return</span> api_out_current_value.value, api_out_max_value.value</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_vcp_value_by_name</span>(<span class="params">self, vcp_code_key: <span class="built_in">str</span>, value: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        根据功能名称发送vcp code和数据</span></span><br><span class="line"><span class="string">        :param vcp_code_key: key name of vcp_code.VCP_CODE dict</span></span><br><span class="line"><span class="string">        :param value: new value</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.send_vcp_code(vcp_code.VCP_CODE.get(vcp_code_key), value)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_vcp_value_by_name</span>(<span class="params">self, vcp_code_key: <span class="built_in">str</span></span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        根据功能名称读取vcp code的值和最大值</span></span><br><span class="line"><span class="string">        :param vcp_code_key: key name of vcp_code.VCP_CODE dict</span></span><br><span class="line"><span class="string">        :return: current_value, max_value</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.read_vcp_code(vcp_code.VCP_CODE.get(vcp_code_key))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ########################### 经过包装后方便调用的属性/方法</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reset_factory</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Reset monitor to factory defaults</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Restore Factory Defaults&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">color_temperature</span>(<span class="params">self</span>):</span></span><br><span class="line">        increment = self.get_vcp_value_by_name(<span class="string">&#x27;User Color Temperature Increment&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        current = self.get_vcp_value_by_name(<span class="string">&#x27;User Color Temperature&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3000</span> + current * increment</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @color_temperature.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">color_temperature</span>(<span class="params">self, value: <span class="built_in">int</span></span>):</span></span><br><span class="line">        increment = self.get_vcp_value_by_name(<span class="string">&#x27;User Color Temperature Increment&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        new_value = (value - <span class="number">3000</span>) // increment</span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;User Color Temperature&#x27;</span>, new_value)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">brightness_max</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Luminance&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">brightness</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Luminance&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @brightness.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">brightness</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        设置亮度</span></span><br><span class="line"><span class="string">        :param value:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        brightness_max = self.brightness_max</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; brightness_max:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid brightness level: &#123;&#125;, allowed: 0-&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                value, brightness_max))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Luminance&#x27;</span>, value)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">contrast_max</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Contrast&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">contrast</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Contrast&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @contrast.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">contrast</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        contrast_max = self.contrast_max</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; contrast_max:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid contrast level: &#123;&#125;, allowed: 0-&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                value, contrast_max))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Contrast&#x27;</span>, value)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">color_preset_list</span>(<span class="params">self</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        可用的color preset, 显示器不一定全部支持</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(vcp_code.COLOR_PRESET_CODE.keys())</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">color_preset</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        当前的color preset</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        preset = self.get_vcp_value_by_name(<span class="string">&#x27;Select Color Preset&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(vcp_code.COLOR_PRESET_CODE.keys()):</span><br><span class="line">            <span class="keyword">if</span> vcp_code.COLOR_PRESET_CODE[i] == preset:</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @color_preset.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">color_preset</span>(<span class="params">self, preset: <span class="built_in">str</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> preset <span class="keyword">not</span> <span class="keyword">in</span> self.color_preset_list:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid color preset: &#123;&#125;, available:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                preset, self.color_preset_list))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Select Color Preset&#x27;</span>, vcp_code.COLOR_PRESET_CODE.get(preset))</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rgb_gain_max</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        最大允许设置的RGB值</span></span><br><span class="line"><span class="string">        ! 只取红色的RGB最大值作为3个颜色的参考</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Video Gain Red&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rgb_gain</span>(<span class="params">self</span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>]:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        :return:  Red, Green, Blue</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        rg = self.get_vcp_value_by_name(<span class="string">&#x27;Video Gain Red&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        gg = self.get_vcp_value_by_name(<span class="string">&#x27;Video Gain Green&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        bg = self.get_vcp_value_by_name(<span class="string">&#x27;Video Gain Blue&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> rg, gg, bg</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @rgb_gain.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rgb_gain</span>(<span class="params">self, value_pack</span>):</span></span><br><span class="line">        max_ = self.rgb_gain_max</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 检查传入参数</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">check_input</span>(<span class="params">value</span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            检查传入的RGB gain</span></span><br><span class="line"><span class="string">            :param value:</span></span><br><span class="line"><span class="string">            :return:</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">            <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; max_:</span><br><span class="line">                _LOGGER.warning(<span class="string">&#x27;invalid RGB value: &#123;&#125;, allowed: 0-&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                    value, max_))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            rg = value_pack[<span class="number">0</span>]</span><br><span class="line">            gg = value_pack[<span class="number">1</span>]</span><br><span class="line">            bg = value_pack[<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">            _LOGGER.error(err)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (check_input(rg) <span class="keyword">and</span> check_input(gg) <span class="keyword">and</span> check_input(bg)):</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="comment"># 设置 RGB Gain</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Video Gain Red&#x27;</span>, rg)</span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Video Gain Green&#x27;</span>, gg)</span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Video Gain Blue&#x27;</span>, bg)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">auto_setup_perform</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        执行自动调整</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Auto Setup&#x27;</span>, vcp_code.AUTO_SETUP_CODE.get(<span class="string">&#x27;Manual Perform&#x27;</span>))</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">info_poweron_hours</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        返回显示器的开机时间 (Hours)</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Display Usage Time&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">osd_languages_list</span>(<span class="params">self</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        VCP 中指定的语言列表</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(vcp_code.OSD_LANG_CODE.keys())</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">osd_language</span>(<span class="params">self</span>):</span></span><br><span class="line">        language = self.get_vcp_value_by_name(<span class="string">&#x27;OSD Language&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(vcp_code.OSD_LANG_CODE.keys()):</span><br><span class="line">            <span class="keyword">if</span> vcp_code.OSD_LANG_CODE[i] == language:</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @osd_language.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">osd_language</span>(<span class="params">self, language: <span class="built_in">str</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> language <span class="keyword">not</span> <span class="keyword">in</span> self.osd_languages_list:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid OSD Language: &#123;&#125;, available:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                language, self.osd_languages_list))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;OSD Language&#x27;</span>, vcp_code.OSD_LANG_CODE.get(language))</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">power_mode_list</span>(<span class="params">self</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        VCP 中指定的电源状态</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(vcp_code.POWER_MODE_CODE.keys())</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">power_mode</span>(<span class="params">self</span>):</span></span><br><span class="line">        power_ = self.get_vcp_value_by_name(<span class="string">&#x27;Power Mode&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(vcp_code.POWER_MODE_CODE.keys()):</span><br><span class="line">            <span class="keyword">if</span> vcp_code.POWER_MODE_CODE[i] == power_:</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">        <span class="comment"># return &#x27;off&#x27; to fix quirky, example: when power-off, it return 0x02</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;off&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @power_mode.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">power_mode</span>(<span class="params">self, mode: <span class="built_in">str</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> mode <span class="keyword">not</span> <span class="keyword">in</span> self.power_mode_list:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid power mode: &#123;&#125;, available:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                mode, self.power_mode_list))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Power Mode&#x27;</span>, vcp_code.POWER_MODE_CODE.get(mode))</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">input_src_list</span>(<span class="params">self</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        VCP 中指定的输入源</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(vcp_code.INPUT_SRC_CODE.keys())</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">input_src</span>(<span class="params">self</span>):</span></span><br><span class="line">        input_ = self.get_vcp_value_by_name(<span class="string">&#x27;Input Source&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(vcp_code.INPUT_SRC_CODE.keys()):</span><br><span class="line">            <span class="keyword">if</span> vcp_code.INPUT_SRC_CODE[i] == input_:</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @input_src.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">input_src</span>(<span class="params">self, src: <span class="built_in">str</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> src <span class="keyword">not</span> <span class="keyword">in</span> self.input_src_list:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid input source: &#123;&#125;, available:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                src, self.input_src_list))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Input Source&#x27;</span>, vcp_code.INPUT_SRC_CODE.get(src))</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">info_pannel_type</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">        pannel_type = self.get_vcp_value_by_name(<span class="string">&#x27;Flat Panel Sub-Pixel Layout&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> vcp_code.FLAT_PANEL_SUB_PIXEL_LAYOUT_CODE.get(pannel_type, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># test code</span></span><br><span class="line">    </span><br><span class="line">    logging.basicConfig(level=logging.INFO)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 检查是否在支持的平台上工作</span></span><br><span class="line">    <span class="comment"># os.popen(&#x27;ver.exe&#x27;).read()</span></span><br><span class="line">    <span class="keyword">if</span> sys.platform != <span class="string">&#x27;win32&#x27;</span> <span class="keyword">or</span> sys.version_info.major != <span class="number">3</span>:</span><br><span class="line">        _LOGGER.error(<span class="string">&#x27;不支持的平台，需要 Windows Vista+, Python 3&#x27;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        monitors = enumerate_monitors()</span><br><span class="line">    <span class="keyword">except</span> OSError:</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    phy_monitors = []</span><br><span class="line">    <span class="keyword">for</span> h_monitor <span class="keyword">in</span> monitors:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            monitor = PhyMonitor(h_monitor)</span><br><span class="line">        <span class="keyword">except</span> OSError <span class="keyword">as</span> os_err:</span><br><span class="line">            _LOGGER.error(os_err)</span><br><span class="line">            <span class="comment"># 忽略这个显示器并继续</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        _LOGGER.info(<span class="string">&#x27;found &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(monitor.model))</span><br><span class="line">        phy_monitors.append(monitor)</span><br><span class="line"></span><br><span class="line">    test_monitor = phy_monitors[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h1 id="python完整源码"><a href="#python完整源码" class="headerlink" title="python完整源码"></a>python完整源码</h1><p><a href="https://github.com/cillthrive/monitor_ctrl">github开源地址</a></p><p><a href="/page/365528154/">同功能autoit 3实现</a></p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python源码 </tag>
            
            <tag> dxva2 </tag>
            
            <tag> 显示器设置 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实现GiteePages自动部署的aardio源码</title>
      <link href="/page/1586529761/"/>
      <url>/page/1586529761/</url>
      
        <content type="html"><![CDATA[<h1 id="问题的由来"><a href="#问题的由来" class="headerlink" title="问题的由来"></a>问题的由来</h1><p>github提供开源项目管理，同时提供静态网站github page，但国内访问速度很慢，经常打不开，gitee码云在国内，提供和github一样的功能，但gitee page每次推送文件后，不会自动刷新（免费版），必须手动刷新!网上已有提供python自动刷新Gitee Pages的源码!</p><h1 id="python自动部署Gitee-Pages源码"><a href="#python自动部署Gitee-Pages源码" class="headerlink" title="python自动部署Gitee Pages源码"></a>python自动部署Gitee Pages源码</h1><ol><li>python环境要求<br>python3 + selenium + chromedrive.exe。</li></ol><ul><li>先安装好python3(最好设置好国内镜像源，不然安装库，因墙的缘故可能失败)</li><li>再安装好selenium库<br>pip install selenium<br>pip install Alert</li><li>下载chrome对应的chromedriver</li></ul><p>2.python源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.alert <span class="keyword">import</span> Alert</span><br><span class="line">option = webdriver.ChromeOptions()</span><br><span class="line"><span class="comment">#指定chrome浏览器</span></span><br><span class="line">option.binary_location=<span class="string">r&#x27;D:\Program Files\CentBrowser64\chrome.exe&#x27;</span></span><br><span class="line"><span class="comment">#指定chromedriver和chrome版本要匹配</span></span><br><span class="line">driver = webdriver.Chrome(<span class="string">r&#x27;D:\Program Files\CentBrowser64\chromedriver.exe&#x27;</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;https://gitee.com/login&#x27;</span>)</span><br><span class="line">driver.maximize_window()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">user_login = driver.find_element_by_id(<span class="string">&#x27;user_login&#x27;</span>)</span><br><span class="line">user_login.send_keys(<span class="string">&quot;gitee的用户名&quot;</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;user_password&#x27;</span>).send_keys(<span class="string">&quot;gitee的登录密码&quot;</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;/html/body/div[2]/div[2]/div/div[1]/div[2]/div[1]/form[1]/div/div/div/div[4]/input&#x27;</span>).click()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;https://gitee.com/此处改为you_gitee_id/此处改为you_gitee_id/pages&#x27;</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;/html/body/div[3]/div[2]/div/div[2]/div/form/div[6]&#x27;</span>).click()</span><br><span class="line">Alert(driver).accept()</span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;成功&quot;</span>)</span><br><span class="line">driver.quit()</span><br><span class="line">fp = <span class="built_in">open</span>(<span class="string">&quot;D:\log.txt&quot;</span>, <span class="string">&quot;a+&quot;</span>)</span><br><span class="line">now_time = time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, time.localtime())</span><br><span class="line">fp.write(<span class="string">&quot;部署时间:&#123;0&#125;\n&quot;</span>.<span class="built_in">format</span>(now_time))</span><br><span class="line">fp.close()</span><br></pre></td></tr></table></figure><p><img src="/images/2021092202.png" alt="gitee page python自动部署"><br>提供此代码的开源项目地址：<a href="https://github.com/witmy/my-giteepages">https://github.com/witmy/my-giteepages</a><br>上面的代码修改了一下，指定了chrome浏览器地址和chromedriver的地址，这样就不会运行不了!特别适合小白!</p><h1 id="aardio自动部署Gitee-Pages的源码"><a href="#aardio自动部署Gitee-Pages的源码" class="headerlink" title="aardio自动部署Gitee Pages的源码"></a>aardio自动部署Gitee Pages的源码</h1><p>python的代码，如果是新手，安装python，然后直接运行上面的源码，成功的机率很小，因为Chrome driver是需要浏览器和driver版本匹配的!上面的python源码，如果你不熟悉python，基本上调试不会成功!<br>不过不要紧，下面我讲的，小白也会的aardio教程，一步一步复杂粘贴就能实现，你不需要会python，不需要会aardio，一样可以编译一个自动更新gitee pages的执行文件!</p><ol><li>查看chrome内核的浏览器版本<br>只要是使用chrome为内核的浏览器，都可以，比如qq浏览器，360极速浏览器，搜狗浏览器或chrome谷歌浏览器!第一步打开浏览器，第二步，在地址栏输入  chrome://version 查看版本号，正常应该显示为这样<br><img src="/images/20210918090344.png"><br>查看版本号，上图版本号为86.0.4240.112，并且知道浏览器的路径为 D:\Program Files (x86)\360Chrome\Chrome\Application\360chrome.exe</li><li>打开chromedriver的镜像网站<a href="https://npm.taobao.org/mirrors/chromedriver">https://npm.taobao.org/mirrors/chromedriver</a> 下载相应的chromedriver<br><img src="/images/20210918090709.png"><br>对应上面的chrome，应该下载86.0.4240.22，最后的版本号112，选择最接近的就行！<br>进入86.0.4240.22目录，<img src="/images/20210918091136.png">下载 chromedriver_win32.zip，并解压到本地目录，如d:\temp\</li><li>aardio部署gitee pages的源码<figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> chrome.driver;</span><br><span class="line">var driver = chrome.driver(<span class="string">&quot;D:\Program Files\CentBrowser64\chrome.exe&quot;</span>,<span class="string">&quot;d:\temp\chromedriver.exe&quot;</span>);</span><br><span class="line"><span class="comment">//driver.addArguments(&quot;--headless&quot;,&quot;--disable-gpu&quot;,&quot;--remote-debugging-port=9222&quot;); //无头模式</span></span><br><span class="line">var browser = driver.startBrowser( &#123;</span><br><span class="line">    loggingPrefs  = &#123; browser = <span class="string">&#x27;ALL&#x27;</span>, performance = <span class="string">&#x27;ALL&#x27;</span>, &#125;;</span><br><span class="line">perfLoggingPrefs = &#123;</span><br><span class="line">    enableNetwork = <span class="literal">true</span>,</span><br><span class="line">    enablePage= <span class="literal">false</span>,</span><br><span class="line">    enableTimeline = <span class="literal">false</span></span><br><span class="line">&#125; </span><br><span class="line">&#125;);</span><br><span class="line">browser.go(<span class="string">&quot;https://gitee.com/login&quot;</span>)</span><br><span class="line">var ele = browser.querySelector(<span class="string">&quot;body&quot;</span>).querySelector(<span class="string">&quot;#user_login&quot;</span>); </span><br><span class="line">ele.setValue( <span class="string">&quot;gitee的用户名&quot;</span> );<span class="comment">//改为你的gitee用户名</span></span><br><span class="line">ele = browser.querySelector(<span class="string">&quot;body&quot;</span>).querySelector(<span class="string">&quot;#user_password&quot;</span>);</span><br><span class="line">ele.setValue( <span class="string">&quot;gitee的登录密码&quot;</span> ); <span class="comment">//改为你的gitee密码</span></span><br><span class="line">var searchButton = browser.doScript(<span class="string">` </span></span><br><span class="line"><span class="string">return arguments[0].querySelector(&quot;#new_user &gt; div &gt; div &gt; div &gt; div:nth-child(4) &gt; input&quot;);</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line">,browser.querySelector(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">)</span><br><span class="line"><span class="comment">//也可以直接使用query查询，以及使用xpath取值，如 searchButton = browser.query([&quot;xpath&quot;] = &#x27;/html/body/div[1]/div[1]/div[5]/div[2]/div/form/span[2]/input&#x27;);</span></span><br><span class="line">searchButton.click();</span><br><span class="line">win.delay(<span class="number">2000</span>)</span><br><span class="line">browser.go(<span class="string">&quot;https://gitee.com/此处改为you_gitee_id/此处改为you_gitee_id/pages&quot;</span>); <span class="comment">//改为你的gitee项目地址</span></span><br><span class="line">var gxButton=browser.doScript(<span class="string">`</span></span><br><span class="line"><span class="string">   return arguments[0].querySelector(&quot;#pages-branch &gt; div.button.orange.redeploy-button.ui.update_deploy&quot;);</span></span><br><span class="line"><span class="string">`</span>,browser.querySelector(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">)</span><br><span class="line">win.delay(<span class="number">5000</span>)</span><br><span class="line">gxButton.click();</span><br><span class="line">browser.alert.accept();</span><br><span class="line">win.delay(<span class="number">2000</span>)</span><br><span class="line">browser.closeAll();</span><br></pre></td></tr></table></figure>其中，代码的第二行的参数，第一个改为你的浏览器路径（其中第一步上面已查看到），第二个参数改为你下载的chromedriver的路径<br>，然后在<a href="http://www.aardio.com/">http://www.aardio.com</a> 下载aardio，新建文件，复制上面代码，直接编译就可运行(如果没有chrome.divver库，aardio会自动下载)</li></ol><h1 id="后期可能失效说明"><a href="#后期可能失效说明" class="headerlink" title="后期可能失效说明"></a>后期可能失效说明</h1><p>登录按钮的css selector，现在为 #new_user &gt; div &gt; div &gt; div &gt; div:nth-child(4) &gt; input<br>更新按钮的css selector, 现在为 #pages-branch &gt; div.button.orange.redeploy-button.ui.update_deploy<br>如何查看这两个按钮的css selector<br>比如更新按钮的css selector<br>手动打开gitee pages更新页面，对着更新按钮，右键审查元素，<img src="/images/20210918092106.png"><br>在弹出的devtool的Elements界面，自动选中的地方右键，点击选择copy selector，<img src="/images/20210918092554.png">把上面的代码中修改即可!</p><p>其实就是一个模拟手动按键的过程!不过无头模式，似乎有点问题，有时不点击更新，也可能是延时问题，但非无头模式是正常的，不点击就加大延时!</p><h1 id="题外话-Headless-Chrome"><a href="#题外话-Headless-Chrome" class="headerlink" title="题外话:-Headless Chrome"></a>题外话:-Headless Chrome</h1><p>Headless Chrome 是 Chrome 浏览器的无界面形态，可以在不打开浏览器的前提下，使用所有 Chrome 支持的特性运行你的程序。相比于现代浏览器，Headless Chrome 更加方便测试 web 应用，获得网站的截图，做爬虫抓取信息等。相比于出道较早的 PhantomJS，SlimerJS 等，Headless Chrome 则更加贴近浏览器环境。<br>启动无头模式</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome.exe --headless --disable-gpu --remote-debugging-port=<span class="number">9222</span>  https://github.com</span><br></pre></td></tr></table></figure><p>获取屏幕截图</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome.exe --headless --disable-gpu --screenshot --window-size=<span class="number">1280</span>,<span class="number">1696</span> https://github.com</span><br></pre></td></tr></table></figure><p>获取页面为PDF</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome.exe --headless --disable-gpu --<span class="built_in">print</span>-to-pdf https://github.com</span><br></pre></td></tr></table></figure><p>打印页面DOM</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome.exe --headless --disable-gpu --dump-dom https://github.com/</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> aardio源码 </tag>
            
            <tag> python源码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>发现网卡变百兆自动发送邮件通知的AutoIt源码</title>
      <link href="/page/4125339080/"/>
      <url>/page/4125339080/</url>
      
        <content type="html"><![CDATA[<h1 id="问题的出现"><a href="#问题的出现" class="headerlink" title="问题的出现"></a>问题的出现</h1><p>网吧维护中，由于交换机或水晶机或工艺上的问题，有些机器网卡正常的千兆会变成百兆，在无盘系统中启动机器或启动游戏变得很慢，用户体验相当不好!出现这个问题时，网管或维护却很难第一时间发现1000M变成100M的问题机器。<br>以下是使用autoit3写的，发现任意网卡是100M，就会按mail.ini配置文件中指定的邮件发送邮件通知，让你第一时间发现这种网卡变100M的问题机器，及时进行处理！</p><p>把以下代码保存为au3脚本或编译为可执行文件后，需要在同目录下建一个mail.ini文件，内容如下<br>[setup]<br>FromAddress=发件人@qq.com<br>toaddress=收件人@qq.com<br>username=qq号<br>password=QQ的smtp服务器提供的邮件授权码<br>body=邮件正文内容</p><p>其中password内容，应该进入你的QQ邮箱开通smtp和取得授权码<br><img src="/images/EWOCA8IZXGRZQCPD.png" alt="qq邮箱授权码"></p><h1 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h1><p>设置好mainl.ini中的qq的smtp服务器的用户名及授权码等一切信息后，开机执行一次此代码就行，检测完成自动退出程序</p><h1 id="autoit源码如下"><a href="#autoit源码如下" class="headerlink" title="autoit源码如下"></a>autoit源码如下</h1><p>以下为autoit3实现发现任意一网卡是100M，自动根据设置的邮件发送邮件通知!</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ButtonConstants.au3&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GUIConstantsEx.au3&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ListViewConstants.au3&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WindowsConstants.au3&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GuiListView.au3&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">Include</span><span class="meta-string">&lt;file.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">NoTrayIcon</span></span></span><br><span class="line">$badlan=<span class="literal">false</span></span><br><span class="line">$a = _GetAdaptersInfo() </span><br><span class="line"><span class="keyword">For</span> $i = <span class="number">1</span> <span class="keyword">To</span> $a[0][0] </span><br><span class="line">$lSpeed=GetIfEntry($a[$i][3])</span><br><span class="line"><span class="keyword">if</span> $lSpeed=<span class="number">100</span> <span class="keyword">then</span></span><br><span class="line">  $badlan=<span class="literal">true</span></span><br><span class="line">  <span class="keyword">ExitLoop</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> $badlan=<span class="literal">true</span> <span class="keyword">then</span>    </span><br><span class="line">$SmtpServer = <span class="string">&quot;smtp.qq.com&quot;</span>              <span class="comment">; address for the smtp-server to use - REQUIRED</span></span><br><span class="line">$FromName = <span class="string">&quot;发送人&quot;</span>                      <span class="comment">; name from who the email was sent</span></span><br><span class="line">$FromAddress = <span class="built_in">IniRead</span>(<span class="symbol">@WorkingDir</span>&amp;<span class="string">&quot;\mail.ini&quot;</span>,<span class="string">&quot;setup&quot;</span>,<span class="string">&quot;FromAddress&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">$ToAddress = <span class="built_in">IniRead</span>(<span class="symbol">@WorkingDir</span>&amp;<span class="string">&quot;\mail.ini&quot;</span>,<span class="string">&quot;setup&quot;</span>,<span class="string">&quot;toaddress&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">$Subject = <span class="symbol">@ComputerName</span>&amp;<span class="string">&quot;号机器网卡为100M，请检查!&quot;</span>                    <span class="comment">; subject from the email - can be anything you want it to be</span></span><br><span class="line"><span class="comment">;$Body = &quot;邮件正文&quot;                                ; the messagebody from the mail - can be left blank but then you get a blank mail</span></span><br><span class="line">$Body = <span class="built_in">IniRead</span>(<span class="symbol">@WorkingDir</span>&amp;<span class="string">&quot;\mail.ini&quot;</span>,<span class="string">&quot;setup&quot;</span>,<span class="string">&quot;body&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">$AttachFiles = <span class="string">&quot;&quot;</span>                        <span class="comment">; the file you want to attach- leave blank if not needed</span></span><br><span class="line">$CcAddress = <span class="string">&quot;&quot;</span>        <span class="comment">; address for cc - leave blank if not needed</span></span><br><span class="line">$BccAddress = <span class="string">&quot;&quot;</span>      <span class="comment">; address for bcc - leave blank if not needed</span></span><br><span class="line">$Importance = <span class="string">&quot;Normal&quot;</span>                  <span class="comment">; Send message priority: &quot;High&quot;, &quot;Normal&quot;, &quot;Low&quot;</span></span><br><span class="line">$Username = <span class="built_in">IniRead</span>(<span class="symbol">@WorkingDir</span>&amp;<span class="string">&quot;\mail.ini&quot;</span>,<span class="string">&quot;setup&quot;</span>,<span class="string">&quot;Username&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">$Password = <span class="built_in">IniRead</span>(<span class="symbol">@WorkingDir</span>&amp;<span class="string">&quot;\mail.ini&quot;</span>,<span class="string">&quot;setup&quot;</span>,<span class="string">&quot;Password&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">$IPPort = <span class="number">465</span>                            <span class="comment">; port used for sending the mail</span></span><br><span class="line">$ssl = <span class="number">1</span>    </span><br><span class="line">$rc = _INetSmtpMailCom ( $SmtpServer, $FromName, $FromAddress, $ToAddress, $Subject, $Body, $AttachFiles, $CcAddress, $BccAddress, $Importance, $Username, $Password, $IPPort, $ssl )</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="comment">;msgbox(0,&quot;&quot;,$ToAddress)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">SetListView</span><span class="params">()</span> </span></span><br><span class="line">$a = _GetAdaptersInfo() </span><br><span class="line">$index = ($a[1][3]) </span><br><span class="line"><span class="keyword">For</span> $i = <span class="number">1</span> <span class="keyword">To</span> $a[0][0] </span><br><span class="line"><span class="built_in">GUICtrlCreateListViewItem</span>($a[$i][1] &amp; <span class="string">&#x27;|&#x27;</span> &amp; _ </span><br><span class="line"><span class="built_in">StringLeft</span>(<span class="built_in">Hex</span>($a[$i][2]), <span class="number">12</span>) &amp; <span class="string">&#x27;|&#x27;</span> &amp; _ </span><br><span class="line">$a[$i][6] &amp; <span class="string">&#x27;|&#x27;</span> &amp; _ </span><br><span class="line">GetIfEntry($a[$i][3]) &amp; <span class="string">&#x27; MB&#x27;</span>, $ListView1) </span><br><span class="line"><span class="keyword">Next</span> </span><br><span class="line"><span class="keyword">EndFunc</span> <span class="comment">;==&gt;SetListView </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">GetIfEntry</span><span class="params">($ifIndex)</span> </span></span><br><span class="line"><span class="keyword">Local</span> $tagBuffer, $tBuffer, $pBuffer, $iResult, $iSpeed, $sDescr </span><br><span class="line"></span><br><span class="line">$tagBuffer = <span class="string">&quot;wchar[256];dword[5];byte[8];dword[16];char[256]&quot;</span> </span><br><span class="line">$tBuffer = <span class="built_in">DllStructCreate</span>($tagBuffer) </span><br><span class="line">$pBuffer = <span class="built_in">DllStructGetPtr</span>($tBuffer) </span><br><span class="line"><span class="built_in">DllStructSetData</span>($tBuffer, <span class="number">2</span>, $ifIndex, <span class="number">1</span>) </span><br><span class="line"></span><br><span class="line">$iResult = <span class="built_in">DllCall</span>(<span class="string">&quot;iphlpapi.dll&quot;</span>, <span class="string">&quot;long&quot;</span>, <span class="string">&quot;GetIfEntry&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $pBuffer) </span><br><span class="line">$iSpeed = <span class="built_in">DllStructGetData</span>($tBuffer, <span class="number">2</span>, <span class="number">4</span>) / <span class="number">1000</span> / <span class="number">1000</span> </span><br><span class="line">$sDescr = <span class="built_in">DllStructGetData</span>($tBuffer, <span class="number">5</span>) </span><br><span class="line">$tBuffer = <span class="number">0</span> </span><br><span class="line"><span class="keyword">Return</span> <span class="built_in">SetError</span>($iResult[0], $iSpeed, $iSpeed) </span><br><span class="line"><span class="keyword">EndFunc</span> <span class="comment">;==&gt;GetIfEntry </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_GetAdaptersInfo</span><span class="params">()</span> </span></span><br><span class="line"><span class="keyword">Local</span> $iResult, $tBuffer, $pBuffer, $aResult[1][9], $tagADPTINFO, $tAdpt </span><br><span class="line"></span><br><span class="line"><span class="comment">; 第一次调用传递空值，pOutBufLen ( $iResult[2] ) 设为结构所需大小，单位byte。 </span></span><br><span class="line">$iResult = <span class="built_in">DllCall</span>(<span class="string">&quot;iphlpapi.dll&quot;</span>, <span class="string">&quot;dword&quot;</span>, <span class="string">&quot;GetAdaptersInfo&quot;</span>, <span class="string">&quot;ptr&quot;</span>, <span class="number">0</span>, <span class="string">&quot;ulong*&quot;</span>, <span class="number">0</span>) </span><br><span class="line">$tBuffer = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;byte[&quot;</span> &amp; $iResult[2] &amp; <span class="string">&quot;]&quot;</span>) <span class="comment">; 定义$iResult[2] 字节的缓存区域 (分配内存空间)。 </span></span><br><span class="line">$pBuffer = <span class="built_in">DllStructGetPtr</span>($tBuffer) <span class="comment">; 获取内存指针。 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">; 第二次调用，GetAdaptersInfo把网卡信息复制到指定的内存空间 ($tBuffer) 中。 </span></span><br><span class="line">$iResult = <span class="built_in">DllCall</span>(<span class="string">&quot;iphlpapi.dll&quot;</span>, <span class="string">&quot;dword&quot;</span>, <span class="string">&quot;GetAdaptersInfo&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $pBuffer, <span class="string">&quot;ulong*&quot;</span>, $iResult[2]) </span><br><span class="line"><span class="comment">; $iResult[0]值为0则调用成功，否则为系统错误号。 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">; 数据转换， byte --&gt; IP_ADAPTER_INFO </span></span><br><span class="line">$tagADPTINFO = <span class="string">&quot;ptr NextAdpt; dword ComboIndex; char AdptName[260]; char AdptDescr[132];uint AddrLength;byte MacAddr[8];dword Index;uint Type; uint DhcpEnabled;ptr CurrentIpAddr;ptr NextIpAddr; char IpAddr[16];char IpAddrMask[16]; dword IpAddrCxt; ptr NextGateway; char GatewayAddr[16]; char GatewayAddrMask[16];dword GatewayCxt; ptr NextDhcp; char DhcpAddr[16]; char DhcpAddrMask[16];dword DhcpCxt; int HaveWins; ptr NextPriWinsServer; char PriWinsServerAddr[16]; char PriWinsServerAddrMask[16]; dword PriWinsServerCxt; ptr NextSecWinsServer; char SecWinsServerAddr[16]; char SecWinsServerAddrMask[16]; dword LeaseObtained; dword LeaseExpires&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">While</span> $pBuffer </span><br><span class="line">$tAdpt = <span class="built_in">DllStructCreate</span>($tagADPTINFO, $pBuffer) </span><br><span class="line">$aResult[0][0] += <span class="number">1</span> </span><br><span class="line"><span class="keyword">ReDim</span> $aResult[$aResult[0][0] + <span class="number">1</span>][<span class="number">9</span>] </span><br><span class="line">$aResult[$aResult[0][0]][0] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;AdptName&quot;</span>) <span class="comment">; 网卡名称 </span></span><br><span class="line">$aResult[$aResult[0][0]][1] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;AdptDescr&quot;</span>) <span class="comment">; 网卡描述 </span></span><br><span class="line">$aResult[$aResult[0][0]][2] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;MacAddr&quot;</span>) <span class="comment">; 网卡MAC </span></span><br><span class="line">$aResult[$aResult[0][0]][3] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;Index&quot;</span>) <span class="comment">; 网卡索引号 </span></span><br><span class="line">$aResult[$aResult[0][0]][4] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;Type&quot;</span>) <span class="comment">; 类型 </span></span><br><span class="line">$aResult[$aResult[0][0]][5] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;DhcpEnabled&quot;</span>) <span class="comment">; DHCP是否启用 true = 启用， false = 禁用 </span></span><br><span class="line">$aResult[$aResult[0][0]][6] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;IpAddr&quot;</span>) <span class="comment">; IP 地址 </span></span><br><span class="line">$aResult[$aResult[0][0]][7] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;GatewayAddr&quot;</span>) <span class="comment">; 网关地址 </span></span><br><span class="line">$aResult[$aResult[0][0]][8] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;DhcpAddr&quot;</span>) <span class="comment">; DHCP地址, 只有DhcpEnabled为true时，此值才有效。 </span></span><br><span class="line">$pBuffer = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;NextAdpt&quot;</span>) <span class="comment">; [下一张网卡信息的内存地址。] </span></span><br><span class="line">$tAdpt = <span class="number">0</span> </span><br><span class="line"><span class="keyword">WEnd</span> </span><br><span class="line">$tBuffer = <span class="number">0</span> </span><br><span class="line"><span class="keyword">Return</span> <span class="built_in">SetError</span>($iResult[0], <span class="number">0</span>, $aResult) </span><br><span class="line"><span class="keyword">EndFunc</span> <span class="comment">;==&gt;_GetAdaptersInfo</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; The UDF</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_INetSmtpMailCom</span> <span class="params">( $s_SmtpServer, $s_FromName, $s_FromAddress, $s_ToAddress, $s_Subject = <span class="string">&quot;&quot;</span>, $as_Body = <span class="string">&quot;&quot;</span>, $s_AttachFiles = <span class="string">&quot;&quot;</span>, $s_CcAddress = <span class="string">&quot;&quot;</span>, $s_BccAddress = <span class="string">&quot;&quot;</span>, $s_Importance= <span class="string">&quot;Normal&quot;</span>, $s_Username = <span class="string">&quot;&quot;</span>, $s_Password = <span class="string">&quot;&quot;</span>, $IPPort = <span class="number">25</span>, $ssl = <span class="number">0</span> )</span></span></span><br><span class="line">    <span class="keyword">Local</span> $objEmail = <span class="built_in">ObjCreate</span> ( <span class="string">&quot;CDO.Message&quot;</span> )</span><br><span class="line">    $objEmail.From = <span class="string">&#x27;&quot;&#x27;</span> &amp; $s_FromName &amp; <span class="string">&#x27;&quot; &lt;&#x27;</span> &amp; $s_FromAddress &amp; <span class="string">&#x27;&gt;&#x27;</span></span><br><span class="line">    $objEmail.<span class="keyword">To</span> = $s_ToAddress</span><br><span class="line">    <span class="keyword">Local</span> $i_Error = <span class="number">0</span></span><br><span class="line">    <span class="keyword">Local</span> $i_Error_desciption = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">If</span> $s_CcAddress &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> $objEmail.Cc = $s_CcAddress</span><br><span class="line">    <span class="keyword">If</span> $s_BccAddress &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> $objEmail.Bcc = $s_BccAddress</span><br><span class="line">    $objEmail.Subject = $s_Subject</span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">StringInStr</span> ( $as_Body, <span class="string">&quot;&lt;&quot;</span> ) <span class="literal">And</span> <span class="built_in">StringInStr</span> ( $as_Body, <span class="string">&quot;&gt;&quot;</span> ) <span class="keyword">Then</span></span><br><span class="line">        $objEmail.HTMLBody = $as_Body</span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        $objEmail.Textbody = $as_Body &amp; <span class="symbol">@CRLF</span></span><br><span class="line">    <span class="keyword">EndIf</span></span><br><span class="line">    <span class="keyword">If</span> $s_AttachFiles &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">        <span class="keyword">Local</span> $S_Files2Attach = <span class="built_in">StringSplit</span> ( $s_AttachFiles, <span class="string">&quot;;&quot;</span> )</span><br><span class="line">        <span class="keyword">For</span> $x = <span class="number">1</span> <span class="keyword">To</span> $S_Files2Attach [ <span class="number">0</span> ]</span><br><span class="line">            $S_Files2Attach [ $x ] = _PathFull ( $S_Files2Attach [ $x ] )</span><br><span class="line">            <span class="built_in">ConsoleWrite</span> ( <span class="string">&#x27;@@ Debug(62) : $S_Files2Attach = &#x27;</span> &amp; $S_Files2Attach &amp; <span class="symbol">@LF</span> &amp; <span class="string">&#x27;&gt;Error code: &#x27;</span> &amp; <span class="symbol">@error</span> &amp; <span class="symbol">@LF</span> ) <span class="comment">;### Debug Console</span></span><br><span class="line">            <span class="keyword">If</span> <span class="built_in">FileExists</span> ( $S_Files2Attach [ $x ] ) <span class="keyword">Then</span></span><br><span class="line">                $objEmail.AddAttachment ( $S_Files2Attach [ $x ] )</span><br><span class="line">            <span class="keyword">Else</span></span><br><span class="line">                <span class="built_in">ConsoleWrite</span> ( <span class="string">&#x27;!&gt; File not found to attach: &#x27;</span> &amp; $S_Files2Attach [ $x ] &amp; <span class="symbol">@LF</span> )</span><br><span class="line">                <span class="built_in">SetError</span> ( <span class="number">1</span> )</span><br><span class="line">                <span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line">            <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">    <span class="keyword">EndIf</span></span><br><span class="line">    $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/sendusing&quot;</span> ) = <span class="number">2</span></span><br><span class="line">    $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpserver&quot;</span> ) = $s_SmtpServer</span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Number</span> ( $IPPort ) = <span class="number">0</span> <span class="keyword">then</span> $IPPort = <span class="number">25</span></span><br><span class="line">    $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpserverport&quot;</span> ) = $IPPort</span><br><span class="line">    <span class="comment">;Authenticated SMTP</span></span><br><span class="line">    <span class="keyword">If</span> $s_Username &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">        $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpauthenticate&quot;</span> ) = <span class="number">1</span></span><br><span class="line">        $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/sendusername&quot;</span> ) = $s_Username</span><br><span class="line">        $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/sendpassword&quot;</span> ) = $s_Password</span><br><span class="line">    <span class="keyword">EndIf</span></span><br><span class="line">    <span class="keyword">If</span> $ssl <span class="keyword">Then</span></span><br><span class="line">        $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpusessl&quot;</span> ) = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">EndIf</span></span><br><span class="line">    <span class="comment">;Update settings</span></span><br><span class="line">    $objEmail.Configuration.Fields.Update</span><br><span class="line">    <span class="comment">; Set Email Importance</span></span><br><span class="line">    <span class="keyword">Switch</span> $s_Importance</span><br><span class="line">        <span class="keyword">Case</span> <span class="string">&quot;High&quot;</span></span><br><span class="line">            $objEmail.Fields.Item ( <span class="string">&quot;urn:schemas:mailheader:Importance&quot;</span> ) = <span class="string">&quot;High&quot;</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="string">&quot;Normal&quot;</span></span><br><span class="line">            $objEmail.Fields.Item ( <span class="string">&quot;urn:schemas:mailheader:Importance&quot;</span> ) = <span class="string">&quot;Normal&quot;</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="string">&quot;Low&quot;</span></span><br><span class="line">            $objEmail.Fields.Item ( <span class="string">&quot;urn:schemas:mailheader:Importance&quot;</span> ) = <span class="string">&quot;Low&quot;</span></span><br><span class="line">    <span class="keyword">EndSwitch</span></span><br><span class="line">    $objEmail.Fields.Update</span><br><span class="line">    <span class="comment">; Sent the Message</span></span><br><span class="line">    $objEmail.<span class="built_in">Send</span></span><br><span class="line">    <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">SetError</span> ( <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">Return</span> $oMyRet [ <span class="number">1</span> ]</span><br><span class="line">    <span class="keyword">EndIf</span></span><br><span class="line">    $objEmail= <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">EndFunc</span>    <span class="comment">;==&gt;_INetSmtpMailCom</span></span><br><span class="line"><span class="comment">;</span></span><br></pre></td></tr></table></figure><h1 id="成品下载地址"><a href="#成品下载地址" class="headerlink" title="成品下载地址"></a>成品下载地址</h1><p>已编译为可执行文件下载</p><p><a href="https://share.weiyun.com/NGw8l6mT">下载地址</a> 密码：3xw7di</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> autoit源码 </tag>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用croc两网吧之间同步互传文件</title>
      <link href="/page/1934957637/"/>
      <url>/page/1934957637/</url>
      
        <content type="html"><![CDATA[<img src="/images/46709024-9b23ad00-cbf6-11e8-9fb2-ca8b20b7dbec.jpg" alt=""><h1 id="故事背景"><a href="#故事背景" class="headerlink" title="故事背景"></a>故事背景</h1><p>网吧A和网吧B之间经常有这样的事情发生:网吧A更新游戏，如pubg，更新量很大，比如40G，网吧A速度很快，已经更新完成，但网吧B速度慢，到游戏开服也只更新了20G。如果把网吧A的游戏同步更新到网吧B呢？一般的做法是用U盘从网吧A拷到网吧B<br>但网吧使用无盘服务器，需要在服务器上插U盘，风险较高！并且比较麻烦，从网吧A拷了游戏还要跑网吧B操作。如果在网吧A开通ftp，再从网吧B下载，速度不敢保证，并且还得映射端口，各种复杂的操作!普通小白做不到！<br>其中直接同步，可以采用syncthing实现两网吧P2P文件同步，syncthing需要双方安装，总之操作不够简单！<br>croc是使用golang 编写的工具，允许任何两台计算机简单和安全地传输文件和文件夹。据我所知，croc 是唯一的 CLI 文件传输工具。<br>对，你没听错，只需要一个文件croc.exe，分别拷到网吧A和网吧B的游戏目录，同时运行就可以互传文件或文件夹!<br>如果网吧A和网吧B的带宽均不高，网吧间互传文件很慢，那么你也可以从网吧A用U盘拷游戏到网吧B，从客户机使用croc和网吧B的服务器同步文件，局域网传文件相当快，比在服务器插U盘相比，中毒风险直接排除！</p><h1 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h1><p>　　croc 的特性：允许任意两台计算机传输数据（使用一个中继）<br>　　提供端到端加密（使用 PAKE）<br>　　支持方便的跨平台传输，支持 Windows、Linux、Mac<br>　　允许多文件传输<br>　　允许恢复被中断的传输<br>　　不需要本地服务器或端口转发<br>　　通过压缩和多路复用比虫洞、rsync、scp 更快（加速 1.5x 到 4x）<br>　　支持IPv6和IPv4；<br>　　支持使用Tor之类的代理；</p><h1 id="简单使用方法"><a href="#简单使用方法" class="headerlink" title="简单使用方法"></a>简单使用方法</h1><img src="/images/16f5fa106ffe738b_600_0.gif" alt="">如需发送文件，可以直接运行下列命令：<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ croc send [file(s)-or-folder]</span><br><span class="line">Sending &#x27;file-or-folder&#x27; (X MB)</span><br><span class="line">Code is: code-phrase</span><br></pre></td></tr></table></figure>接下来，在另一台电脑上使用下列命令来进行文件或目录接收：<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ croc code-phrase</span><br></pre></td></tr></table></figure>这里的code-phrase即密码短语，用于建立密码认证密钥协议（PAKE），该协议将生成一个密钥供发送方和接收方用于端到端加密。<p>自定义密码短语<br>我们可以使用下列方式来配置自己的密码短语，必须是4个字符以上：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ croc send --code [code-phrase] [file(s)-or-folder]</span><br></pre></td></tr></table></figure><p>使用管道-stdin和stdout<br>我们可以通过管道来向Croc传递文件：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat [filename] | croc send</span><br></pre></td></tr></table></figure><p>此时，Croc将会自动使用stdin数据，并发送和分配一个类似“croc-stdin-123456789”的文件名。如需接收stdout，可以直接使用–yes选项来自动接收文件：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ croc --yes [code-phrase] &gt; out</span><br></pre></td></tr></table></figure><p>发送文字消息<br>有些时候，我们可能只需要发送URL地址或简短的文字消息，此时可以通过下列命令实现发送：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ croc send --text &quot;hello world&quot;</span><br></pre></td></tr></table></figure><p>使用代理<br>我们还可以使用代理链接来进行传输中继，比如说，我们可以使用下列命令来将Tor作为代理中继：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ croc --socks5 &quot;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">9050</span>&quot; send SOMEFILE</span><br></pre></td></tr></table></figure><h1 id="网吧同步文件的使用"><a href="#网吧同步文件的使用" class="headerlink" title="网吧同步文件的使用"></a>网吧同步文件的使用</h1><ol><li>网吧A与网吧B直接传文件，如要拷贝的目录为pubg，则先把croc.exe拷到pubg同级目录（不是拷在pubg目录，如pubg完整目录为g:\steam\pubg,那croc.exe应拷到g:\steam目录，同步完就可以把croc.exe删除）然后执行<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">croc send --code mysendname pubg</span><br></pre></td></tr></table></figure>在网吧B也把croc.exe拷到pubg同级目录，执行<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">croc mysendname</span><br></pre></td></tr></table></figure>即实现了把网吧A的pubg文件夹完全拷到网吧B的pubg</li><li>网吧客户机拷到网吧服务器。比如用U盘从网吧A拷了游戏，在网吧B任意一台机器拷到网吧B的服务器，同样在要拷贝的同级分别拷贝croc.exe<br>在客户机执行<br>发送端执行<br>先建服务(中转服务器直接在客户机，拷贝速度就看你内网的速度，下面的192.168.10.8的IP就是执行此命令的机器的IP)<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">croc replay</span><br></pre></td></tr></table></figure>再传文件夹(IP换成你当前中转服务机器的IP，一般就在当前机器)<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">croc --relay <span class="number">192</span>.<span class="number">168</span>.<span class="number">10</span>.<span class="number">8</span>:<span class="number">9009</span> send --code mysendtask pubg</span><br></pre></td></tr></table></figure>接收端执行(IP换成你当前中转服务机器的IP)<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">croc --relay <span class="number">192</span>.<span class="number">168</span>.<span class="number">10</span>.<span class="number">8</span>:<span class="number">9009</span> mysendtask</span><br></pre></td></tr></table></figure></li></ol><h1 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h1><p><a href="https://github.com/schollz/croc/releases">github下载地址</a><br><a href="https://github.com/schollz/croc">github开源</a><br>如果github的下载速度太慢，你也可以尝试搜索国内的下载地址</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 局域网 </tag>
            
            <tag> 精品软件 </tag>
            
            <tag> 文件传输 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Delphi实现类似Android锁屏的密码锁控件</title>
      <link href="/page/2745266982/"/>
      <url>/page/2745266982/</url>
      
        <content type="html"><![CDATA[<p>手机锁屏之后，开屏的时候，要求咱们输入密码的那个滑动效果输入的控件。<br>  Android的那个锁屏的效果，用过的人应该都知道是个什么效果，也就是横竖各3行，排列成九宫格的效果，然后由用户在上面滑动以此来达到密码输入进而进行解锁和加密的效果。那么首先，俺们可以分析一下，他的具体形成思路，实际上是很简单的，就是一个排列，然后根据滑动产生的内容形成密码来达到解密的目的，那么最主要的就是这个密码和他本身的密码是如何对应解密的，实际上很简单，咱们给他排列的九宫格，都固定好位置</p><p>1 2 3<br>4 5 6<br>7 8 9 </p><p>就像这样，排列的给他的位置固定好，然后每一个格子表示一个字符或者说字符串，进而用户滑动的时候，将对应的位置序列进入到一个列表中去保存，然后鼠标放开的时候，那么入队的选择位置进行组合，那么就是对应的密码了，比如<img src="/images/2012072314370919.png" alt=""></p><p>这样的输入就是表示123，如此顺序记录，就可以形成密码了，然后用户进行滑屏录入之后和以前的进行比较就可以知道密码是否正确了，当然我这个组合是相当简单的，如果想要整的复杂，可以给每个顺序位置给定复杂的字符串，这样形成的密码就足够的复杂了！给一般人去看，也是看不明白的。</p><p>那么分析清楚了，思路也就简单了，鼠标按下的时候，开始可以滑动形成密码，鼠标按下的第一个点，作为队列的第一个，然后再滑过的就顺序的一一的记录到队列中，鼠标放开的时候，从队列中获取各个顺序位置，组合形成密码然后和原密码比对，判断密码是否正确！源码如下：</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  Delphi实现的类似Android鼠标锁屏效果的控件</span></span><br><span class="line"><span class="comment">  作者：不得闲</span></span><br><span class="line"><span class="comment">  2012-7-23</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="keyword">unit</span> AndroidLockControl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span></span><br><span class="line"><span class="keyword">uses</span> Windows,Classes,SysUtils,Graphics,Controls;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span></span><br><span class="line">  TDxLockItem = <span class="keyword">class</span></span><br><span class="line">  <span class="keyword">private</span></span><br><span class="line">    r: TRect;</span><br><span class="line">    IsEnter: Boolean;</span><br><span class="line">    IsChecked: Boolean;</span><br><span class="line">    Value: AnsiChar;</span><br><span class="line">    FRadio: TPoint;</span><br><span class="line">  <span class="keyword">public</span></span><br><span class="line">    <span class="function"><span class="keyword">constructor</span> <span class="title">Create</span>;</span></span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">  TInPutPwdEvent = <span class="function"><span class="keyword">procedure</span><span class="params">(Sender: TObject;InputPwd: <span class="keyword">string</span>)</span> <span class="title">of</span> <span class="title">object</span>;</span></span><br><span class="line">  <span class="title">TDxAndroidLock</span> = <span class="keyword">class</span>(TGraphicControl)</span><br><span class="line">  <span class="keyword">private</span></span><br><span class="line">    FItemSpace: Integer;</span><br><span class="line">    FRowCount: Integer;</span><br><span class="line">    FColCount: Integer;</span><br><span class="line">    FItemRaidio: Integer;</span><br><span class="line">    Items: TList;</span><br><span class="line">    FUseNum: Boolean;</span><br><span class="line">    FPassword: <span class="keyword">string</span>;</span><br><span class="line">    IsDown: Boolean;</span><br><span class="line">    LastInItem: TDxLockItem;</span><br><span class="line">    PwdItems: TList;</span><br><span class="line">    FOnInputPwd: TInPutPwdEvent;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">SetItemSpace</span><span class="params">(<span class="keyword">const</span> Value: Integer)</span>;</span></span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">SetItemRaidio</span><span class="params">(<span class="keyword">const</span> Value: Integer)</span>;</span></span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">SetUseNum</span><span class="params">(<span class="keyword">const</span> Value: Boolean)</span>;</span></span><br><span class="line">  <span class="keyword">protected</span></span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">paint</span>;</span><span class="keyword">override</span>;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">MouseDown</span><span class="params">(Button: TMouseButton; Shift: TShiftState;</span></span></span><br><span class="line"><span class="params"><span class="function">      X, Y: Integer)</span>;</span> <span class="keyword">override</span>;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">MouseMove</span><span class="params">(Shift: TShiftState; X, Y: Integer)</span>;</span> <span class="keyword">override</span>;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">MouseUp</span><span class="params">(Button: TMouseButton; Shift: TShiftState;</span></span></span><br><span class="line"><span class="params"><span class="function">      X, Y: Integer)</span>;</span> <span class="keyword">override</span>;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">CalcItemRects</span>;</span></span><br><span class="line">  <span class="keyword">public</span></span><br><span class="line">    <span class="function"><span class="keyword">constructor</span> <span class="title">Create</span><span class="params">(AOwner: TComponent)</span>;</span><span class="keyword">override</span>;</span><br><span class="line">    <span class="function"><span class="keyword">destructor</span> <span class="title">Destroy</span>;</span><span class="keyword">override</span>;</span><br><span class="line">    <span class="keyword">property</span> Password: <span class="keyword">string</span> <span class="keyword">read</span> FPassword <span class="keyword">write</span> FPassWord;</span><br><span class="line">  <span class="keyword">published</span></span><br><span class="line">    <span class="keyword">property</span> ItemSpace: Integer <span class="keyword">read</span> FItemSpace <span class="keyword">write</span> SetItemSpace <span class="keyword">default</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">property</span> OnInputPwd: TInPutPwdEvent <span class="keyword">read</span> FOnInputPwd <span class="keyword">write</span> FOnInputPwd;</span><br><span class="line">    <span class="keyword">property</span> ItemRaidio: Integer <span class="keyword">read</span> FItemRaidio <span class="keyword">write</span> SetItemRaidio <span class="keyword">default</span> <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">property</span> UseNum: Boolean <span class="keyword">read</span> FUseNum <span class="keyword">write</span> SetUseNum;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">implementation</span></span><br><span class="line"><span class="keyword">uses</span> pngimage;</span><br><span class="line"><span class="meta">&#123;$R LockRc.RES&#125;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  PngIn,PngOut: TPngImage;</span><br><span class="line"><span class="comment">&#123; TDxAndroidLock &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">CalcItemRects</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i,j: Integer;</span><br><span class="line">  p: TPoint;</span><br><span class="line">  r: TRect;</span><br><span class="line">  item: TDxLockItem;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  p.Y := FItemRaidio;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">1</span> <span class="keyword">to</span> <span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    p.X := FItemRaidio;</span><br><span class="line">    r.Left := p.X - FItemRaidio;r.Top := p.Y - FItemRaidio;</span><br><span class="line">    r.Right := p.x + FItemRaidio;r.Bottom := p.Y + FItemRaidio;</span><br><span class="line">    <span class="keyword">for</span> j := <span class="number">1</span> <span class="keyword">to</span> <span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      item := Items[<span class="number">3</span>*(i-<span class="number">1</span>)+j - <span class="number">1</span>];</span><br><span class="line">      item.Value := AnsiChar(<span class="number">3</span>*(i-<span class="number">1</span>)+j+<span class="number">48</span>);</span><br><span class="line">      item.FRadio := p;</span><br><span class="line">      item.r := r;</span><br><span class="line">      p.X := p.X + FItemRaidio * <span class="number">2</span> + FItemSpace;</span><br><span class="line">      r.Left := p.X - FItemRaidio;r.Right := p.X + FItemRaidio;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">    p.Y := p.Y + FItemRaidio * <span class="number">2</span> + FItemSpace;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">constructor</span> <span class="title">TDxAndroidLock</span>.<span class="title">create</span><span class="params">(AOwner: TComponent)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i: Integer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">inherited</span>;</span><br><span class="line">  LastInItem := <span class="keyword">nil</span>;</span><br><span class="line">  PwdItems := TList.Create;</span><br><span class="line">  FPassWord := <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  Items := TList.Create;</span><br><span class="line">  FItemSpace := <span class="number">10</span>;</span><br><span class="line">  FRowCount := <span class="number">3</span>;</span><br><span class="line">  FColCount := <span class="number">3</span>;</span><br><span class="line">  FItemRaidio := <span class="number">20</span>;</span><br><span class="line">  Width := FItemRaidio * <span class="number">2</span> * <span class="number">3</span> + FItemSpace * <span class="number">2</span>;</span><br><span class="line">  Height := FItemRaidio * <span class="number">2</span> * <span class="number">3</span> + FItemSpace * <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> <span class="number">8</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    Items.Add(TDxLockItem.Create);</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  CalcItemRects;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">destructor</span> <span class="title">TDxAndroidLock</span>.<span class="title">Destroy</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">while</span> Items.Count &gt; <span class="number">0</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    TDxLockItem(Items[Items.Count - <span class="number">1</span>]).Free;</span><br><span class="line">    Items.Delete(Items.Count - <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  PwdItems.Free;</span><br><span class="line">  <span class="keyword">inherited</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">MouseDown</span><span class="params">(Button: TMouseButton; Shift: TShiftState; X,</span></span></span><br><span class="line"><span class="params"><span class="function">  Y: Integer)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  IsDown := Button = mbLeft;</span><br><span class="line">  <span class="keyword">if</span> IsDown <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> LastInItem &lt;&gt; <span class="keyword">nil</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      LastInItem.IsChecked := IsDown;</span><br><span class="line">      PwdItems.Add(LastInItem);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">    Invalidate;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">MouseMove</span><span class="params">(Shift: TShiftState; X, Y: Integer)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i: Integer;</span><br><span class="line">  p: TPoint;</span><br><span class="line">  OldInItem,Item: TDxLockItem;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  OldInItem := LastInItem;</span><br><span class="line">  p := Point(x,y);</span><br><span class="line">  LastInItem := <span class="keyword">nil</span>;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> items.Count - <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    item := Items[i];</span><br><span class="line">    <span class="keyword">if</span> PtInRect(Item.r,p) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      LastInItem := Item;</span><br><span class="line">      LastInItem.IsEnter := True;</span><br><span class="line">      LastInItem.IsChecked := IsDown;</span><br><span class="line">      <span class="keyword">Break</span>;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">if</span> LastInItem &lt;&gt; OldInItem <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> OldInItem &lt;&gt; <span class="keyword">nil</span> <span class="keyword">then</span></span><br><span class="line">      OldInItem.IsEnter := False;</span><br><span class="line">    <span class="keyword">if</span> IsDown <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      <span class="keyword">if</span> LastInItem &lt;&gt; <span class="keyword">nil</span> <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        PwdItems.Add(LastInItem);</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line">      Invalidate;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">MouseUp</span><span class="params">(Button: TMouseButton; Shift: TShiftState; X,</span></span></span><br><span class="line"><span class="params"><span class="function">  Y: Integer)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i: Integer;</span><br><span class="line">  item: TDxLockItem;</span><br><span class="line">  Np: <span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  IsDown := False;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> items.Count - <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    item := Items[i];</span><br><span class="line">    item.IsChecked := False;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> PwdItems.Count - <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">    Np := Np + TDxLockItem(PwdItems[i]).Value;</span><br><span class="line">  PwdItems.Clear;</span><br><span class="line">  Invalidate;</span><br><span class="line">  <span class="keyword">if</span> Assigned(FOnInputPwd) <span class="keyword">then</span></span><br><span class="line">    FOnInputPwd(self,Np);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">DrawLineArrow</span><span class="params">(canvas: TCanvas; p1, p2: TPoint)</span>;</span></span><br><span class="line"><span class="keyword">const</span></span><br><span class="line">  l = <span class="number">6</span>; <span class="comment">//箭头长度</span></span><br><span class="line">  w = <span class="number">4</span>; <span class="comment">//箭头宽度</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  slope, angle: Double;</span><br><span class="line">  points: <span class="keyword">array</span>[<span class="number">0</span>..<span class="number">2</span>] <span class="keyword">of</span> TPoint;</span><br><span class="line">  Xl,b: Single;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  canvas.Brush.Color := canvas.Pen.Color;</span><br><span class="line">  canvas.Brush.Style := bsSolid;</span><br><span class="line">  canvas.MoveTo(p1.X,p1.Y);</span><br><span class="line">  canvas.LineTo(p2.X,p2.Y);</span><br><span class="line">  <span class="keyword">if</span> (p2.Y &lt;&gt; p1.Y) <span class="keyword">and</span> (P2.X &lt;&gt; p1.X) <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    xl := (P2.Y - p1.Y) / (P2.X - p1.X);</span><br><span class="line">    b := p2.Y - xl * p2.X;</span><br><span class="line">    p2.X := (p2.X - p1.X) <span class="keyword">div</span> <span class="number">2</span> + p1.X;</span><br><span class="line">    p2.Y := Trunc(p2.X * xl + b);</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> p2.Y = p1.Y <span class="keyword">then</span></span><br><span class="line">    p2.X := (p2.X - p1.X) <span class="keyword">div</span> <span class="number">2</span> + p1.X</span><br><span class="line">  <span class="keyword">else</span> P2.Y := (p2.Y - p1.Y) <span class="keyword">div</span> <span class="number">2</span> + p1.Y;</span><br><span class="line"><span class="comment">//画箭头</span></span><br><span class="line">  points[<span class="number">0</span>] := Point(p2.x, p2.y);<span class="comment">//箭头顶点</span></span><br><span class="line">  <span class="keyword">if</span> (p2.x - p1.x = <span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span> <span class="comment">//垂直</span></span><br><span class="line">    <span class="keyword">if</span> (p2.y - p1.y &gt; <span class="number">0</span>) <span class="keyword">then</span> slope := -<span class="number">1</span> <span class="keyword">else</span> slope := <span class="number">1</span>;</span><br><span class="line">    points[<span class="number">1</span>] := Point(p2.x - w, p2.y + Trunc(l * slope));</span><br><span class="line">    points[<span class="number">2</span>] := Point(p2.x + w, p2.y + Trunc(l * slope));</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">else</span></span><br><span class="line">  <span class="keyword">begin</span> <span class="comment">//倾斜</span></span><br><span class="line">    slope := (p2.y - p1.y) / (p2.x - p1.x);</span><br><span class="line">    angle := ArcTan(slope);</span><br><span class="line">    <span class="keyword">if</span> (p2.x - p1.x &gt; <span class="number">0</span>) <span class="keyword">then</span> angle := angle - PI;</span><br><span class="line">    points[<span class="number">1</span>] := Point(p2.x + trunc(l * cos(angle) - w * sin(angle)),</span><br><span class="line">      p2.y + trunc(l * sin(angle) + w * cos(angle)));</span><br><span class="line">    points[<span class="number">2</span>] := Point(p2.x + Trunc(l * cos(angle) + w * sin(angle)),</span><br><span class="line">      p2.y + Trunc(l * sin(angle) - w * cos(angle)));</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  canvas.Polygon(points);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">paint</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i: Integer;</span><br><span class="line">  item,item1: TDxLockItem;</span><br><span class="line">  r: TRect;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> IsDown <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> Items.Count - <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      item := items[i];</span><br><span class="line">      r.Left := item.FRadio.X - <span class="number">5</span>;r.Right := item.FRadio.X + <span class="number">5</span>;</span><br><span class="line">      r.Top := item.FRadio.Y - <span class="number">5</span>;r.Bottom := item.FRadio.Y + <span class="number">5</span>;</span><br><span class="line">      Canvas.Draw(r.Left,r.Top,pngIn);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    <span class="comment">//绘制指向线条</span></span><br><span class="line">    Canvas.Pen.Width := <span class="number">2</span>;</span><br><span class="line">    Canvas.Pen.Color := clGreen;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> PwdItems.Count - <span class="number">2</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      item := PwdItems[i];</span><br><span class="line">      item1 := PwdItems[i + <span class="number">1</span>];</span><br><span class="line">      Canvas.MoveTo(item.FRadio.X,item.FRadio.Y);</span><br><span class="line">      Canvas.LineTo(item1.FRadio.X,item1.FRadio.Y);</span><br><span class="line">      DrawLineArrow(Canvas,item.FRadio,item1.FRadio);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> Items.Count - <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      item := items[i];</span><br><span class="line">      <span class="keyword">if</span> item.IsChecked <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        Canvas.Draw(item.r.Left,item.r.Top,pngOut);</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line">      r.Left := item.FRadio.X - <span class="number">5</span>;r.Right := item.FRadio.X + <span class="number">5</span>;</span><br><span class="line">      r.Top := item.FRadio.Y - <span class="number">5</span>;r.Bottom := item.FRadio.Y + <span class="number">5</span>;</span><br><span class="line">      Canvas.Draw(r.Left,r.Top,pngIn);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">SetItemRaidio</span><span class="params">(<span class="keyword">const</span> Value: Integer)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  FItemRaidio := Value;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">SetItemSpace</span><span class="params">(<span class="keyword">const</span> Value: Integer)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  FItemSpace := Value;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">SetUseNum</span><span class="params">(<span class="keyword">const</span> Value: Boolean)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  FUseNum := Value;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">&#123; TDxLockItem &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">constructor</span> <span class="title">TDxLockItem</span>.<span class="title">Create</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  r := Rect(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">  IsEnter := False;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">initialization</span></span><br><span class="line"> PngIn := TPngImage.Create;</span><br><span class="line"> PngIn.LoadFromResourceName(Hinstance,<span class="string">&#x27;InnerGra&#x27;</span>);</span><br><span class="line"> PngOut := TPngImage.Create;</span><br><span class="line"> PngOut.LoadFromResourceName(Hinstance,<span class="string">&#x27;Outer&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">finalization</span></span><br><span class="line">  PngIn.Free;</span><br><span class="line">  PngOut.Free;</span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure><p>运行之后的效果就是<br><img src="/images/2012072314434974.jpg" alt=""><br>转载自: <a href="https://www.cnblogs.com/DxSoft/archive/2012/07/23/2604941.html">https://www.cnblogs.com/DxSoft/archive/2012/07/23/2604941.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> 密码锁 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多个局域网如何组建成一个局域网互相访问_softether的安装及使用</title>
      <link href="/page/1999908472/"/>
      <url>/page/1999908472/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="e5a1177b3224f03e969aa19e75f6908786c986162e3fd067f5a682ea594de56e">1af2aaa64b94522a0556bd1ec5c327926c3e53ccd8a5cce18e30a1a06212345c39a0594ac69cb5f1cd1efdccf8f8c467cb00d5665bf4b7596eee3bea313b472f73605f819af6268411d9122ba6b7631c6c3dc2b3288d760da6593fc3ab568204a1c2a685d9c713821606443c4ec7fe09e5a0afca762525fd133d75ebfc1cec126cb3355c673cfa1a780e5f0d79ffbe7845ac5b634edbea8b3255789a2228f6ea620d97584378534e4299ad0a04028479cee9636724a1f0113c8c4cc72eaa794aa31ca5c2b77e3078b297045e2910b55be686d71cf8566edf5abeeda8b26c5c0347bf6c0ecd90d18f311ed2edd963bc0d7fb79adc1da87bd419ca2b7abc12c25db43d1b59860cb53cec064e6eb60931e72f4f14ed8a0a765ca25d8229d2284074bc9556b3fd53a98926df74eee856b77f23c0e3ee43bccde4390666e5441263e5724eae7d3b4b7f140184c12e89fe18190ce2b752abe43c2469a35e5ad8506e7a99f1d2a69fb4b55a24b98391c12261e6c7406deb92827bb78a68346541f90d73efda46e6270535c935fcbd2c76f1c40b554b64f04565f78cb8a55c9f69dc291465a637971e4f95656a6c0a3181ee0316d04d315f76281fc79c7723865fd60eb70bf5184f182af89f09f42c2a4e6a3da4ee7e16b483798559e3c4a8d609038f5b1cc57b17b02f718e6e935878cbf3ec488982e5b2797a8087364539789754217147399a2aae33dac303c263b870118197d583fa1bfa944ed19ff5c66dd758a232d5da51af3c8c19420617d130680793f4988a580f14365b26b680b2d40c78dbfb6e32814ee2d8b4224a9cd773e7281dd89cfec49e33cecf0b547b34cea9135f4f09c3e66549c42f5766a1af954e32673e3f1a123efa57dc909e65e5ded61069d07f2275b5cb9222d8bd560163f40788f558c5b619c1d303c5725bfc5cf3a229932ce353d0b1f4ffce92491e291173a9929d47471260e7eae3ce64be6a645fca513c8a7d5873620fdd3ab74f9529602749ffa068ff7a1302947964d04f13e7a66fdd0e17dda486ef9bde17f0f34a05f26a2918de2b2b847c716fc4aa365ea75b67f836775e442ad03335dc011c46304d480b4f7d66afecf21b947539e6dbbaef8f5995a196dda323c1c2bfa45d2c802683dcbe1e4d1fffb7876241f9b67feca9014c1b3a8183b13dc5ed776b67c2c97d260e6c34155097692f23adecc0cde13ba9f3017c12ace5519cfb9d200f1182e8e6417b6f9f23030aee6f719f72929c6f0aad7f556cad29ef9986fc43b03376137255b7c660cd840609d435e8da6c8ca8e3192c5910b051a08bb04500be85180234b010030d59b1c9d718a571da10647bd6ca327f10df82a1fddfbdf1a485237db8d1d0d7b67b5563eb051fdc6e2ad655165fbd67a075722633d0e4d41458b5ce489cec91dab3b2ed3ba2acd0d9085241fdd9d81268afbc5b2b88e81e6b980081dc108b1759d393bc3742cfa9a6e09c1367e84c4d572b89265de8136a3daf9a8c55967466d74add7f0f39a362f98913c8afd7074da07a6934b98b5d689ab62167aa8f518fdc262dc661a0b49c0d8e7075533af52774b4cbba149008d01ff968ad5817b6499c38f6e726ae9fbbe3655ef9ae25fbc0a0eaa1df45995196275c1a69b657a9e028f5224919e67ed43ba86f77e40b1e94513b1fd31d0059915fe382d06c9fc4836cc69bcb0ec81ee634b757bd2de56d69b386448edfc8ad4b1b2675b31dd3896f5bbdd4df5baf7ac93b2adbead6a7b2e9f99d6f9c496501cafc2cafc5323ed50628e32b9ff2e7adad5c30de93e229e80e8f8fab425d0e76d333e9b0cf6d692ed3db10b79ade834bbe05b9f15e1a75d2bcd8e911a0e484ee5ba8fae2df5a4c4da537c51fbbcf4d767cbfc9b28d7ec0c27b8bc7dffd4e0486a3de69816bda7e08d4c16f5707defc7d67f7ee8f60967be3d282995a1dc9ac80c2167d648344bd4fef7191a3b7396d3be96e8bfa33b79e3149d29e3f2eb7c8288e92257204c198ca0541e578e08c5b61c5123c6d07fd6ba221972a1065c09996d90400cf1a76279e8dbdc9d7a6411ebd303371e714777ba8d7716dda16ee9148a3cc807929585dec72f5a4327f72467214fb637fd82e9877c8c100e106ba731a0937a05a6b7dd3fc431605e1bceff2d00592fa82e912680779a46b583a71b5e50fcc5c856c258e7ba8f45eb9c9cedbd45db959c1dcdc2760bdde45b5c0c7acafaafb30a0d6c624de80b4258d4eb0d9a3eeeebbbe966dbe23e9d23c1ae7499ee4e1f6676961f2e5816a1eaa1fefeef98aaee77b6592fe9d2e4eef0de3019d82bb22abededff90da990749ee279876195991dd5c2132ac6fcd943d95650a72014ba49ff554b67d15885652569162e0278254809de8f14e7e84b55d80f09b351abb454e3d71509f697929ecda17bce4df04874de1316a1a142f07fa0183e7c873577fb985a278e40b7e65fc0d3d6dc20860d50d17a69c56b34b20cfb6e48f214df582c4b4470ecc96e37fc005b138c793012d1a3d4bffce75ada3bfd0d0972d2faa7592405c92bcd5df3477c4b3612cb150d0b88e4fcece0792bdea716f848cd6d0bb587c32267f2eaba9f60172274457c6da177e8e946cc9e873f4dd6a281b4a82e2a90a301fb6bc4d7ac7f618c845b0c705203bd0766681e618c2e39d5bcf344f6d0656bc1e56572fadb50a4aceb9feb9cdba91b2d53a29a93d9a976343bfd9da9a46e768bc12c859207388ce439d98b5dbe488e0104e25844c1a61176d6c1d3d85715fdcf7815fa32097b73d728b1db818de8d14c64128367ce53f4172c4a006e6e335f7d70c1103414843d6c8c157b202b827dd9bd96d86025a95173405816ffac516614ac78399688f172a9dfad10bdf65c929805e7d67f54fb53f416b26bec9baee37798e7966140c6167e8968a0d6dd8d414f99567f9ebf33a7f2daa2cef091d389d97a11113fad0b3ad8dc0aa074a0a6f79f06b33af3638a09c8449544565f83dd733452c3258c1c3668b2b89d0328c740a570f1332db01b85d41bb1452ef947bbe85d0962e3341e9c3771d6205b446628198630092f09daf1c7a44d52c167af42e601070604d92d52c073284c21008d853559a244977fec4ab5e1fb613812a98f1491622bda05726a32ff915a4de22074fb0fbf22a0b324e16a78984eed987ab94cd9ca7493b9873b05152f47058bfc71d9839e58296e3f3fd0cdd456e32eeee26906850654d50b654cfbd1d3d8846099771dc65d8ff0e7cd804a6b55687d15a0195fc79768760b84ffacd89bd95baa4e1e218f10f19acbe27050637cf01f2d8cb635b9a4403260edbacc437af32c387a67a2a2cd772c5e7567d878ec194b1984d559854aed8b133c0bf435f2f906c3f30c9cfa84412f1c8f97ae3b770f2011b6b28662d0c4282d088dffde036a9ad2dae174727a33d21caa06e5caca1ab0346ba4ae336ca7c18b637f2ecb2236d83ebeb1b8e134d112a3da1ed51a42da9032b9805652e6db679acc56b665868378beda2f17766c7a13165283c093ec81fb9cc2f1647940a4850c466fd347f370c43c6c97bbd31483172dfa9998e76124943584603ffcb1c63d151e260a1a36f64e57bb0b5061c0762c3e360b01bd02668d37b793cfdf0413e3148533c6ee3e0120ed4d09596f57b7d94f9a2f2d0e958f7f6348898a47648e36fbacd81844a3c37581d97fec904adee4b79ad20670cad59da21fa60c7dc5cfd9215567761f3984db39bf62814db8649f5574e5b4fbc124892c86cafed6e833ee520a762629fec745d03d838b41f56d97c19da09d5594e278141015e1844b2eef4d4b1c5e2f62b241aa68e391391ebb7d91e82b3a52ec2e421734d029efc368133f4a10a2201198743276ee03a19229be581970683a9d4817f028a72c64bbd7176e9bc389303341ddb352f8fffa277077bd9e47cd818e27128fac0a57be928343490eccd0051a08797e0b57b97443dfaf466c08ef6bccc6db980a4b5926cac219ec6b30d7175f6f21cb97c1827028c10934f1dfcf2b4e2098870b30b1226d178f3e246e0d23ff5a91e294ddce262326cc55ec2b33fb0e9d22ff03f034e60fb6f771a7732ad59e8a63907af1a55492c8b55aa96892fd3c7ff7a67b4030945fdfcf2e3ad13ba0aac112272d1bab54327dee1b158e14f5d2a8195055021a2e3ed64716ca624ca4fd7c17289815c6512f421746ccc760b1f06886120c3d3d601b425b9f3aa97306e7927d73f1cbd41491813a98d0f29691997d72906a94a558d9f05acb0b4ef1b65cb002330826659536b5262a61b4bb920eeaff82d4464705a8682e92964f4782718030034de61829ad8736e2907b4376f2e33ece18dcd9e75fdedb5868afa64b840ca90f74f384335557d87a93421a6cf0fd65c755fa8195e7ec38eae344fc5ce33d6a1eeabe3d30a8969de3c3859ebfe23bf7d749eda08a028c49f6817cc7c9093c430b1c5f41bb66147fceca9dbbd93567ebd30d4eef4dbaab170ffcf942db181b496d8f0a1d0e00c658b6328e99046d503ef65caf2815a40bfd116fe8eb218febe2d6aa9f9d8be8498267325f02913d7d236667ca80b09a2ccd78bed8c061d9d4ef6d3e8610774bf403535728eaa1904570beb963788ee3f8c21fac3835b39a6a7dc6b66137d003f1b2538c0aeb74d8587676e53d125de75db5de1064c35afb1e468a480d418691435f2ad452d735101b6f93c5790a4ac98302e6727548414bdbc36cbb4a737fd5f435f26eed05779419939e4882fdbcfb2ae20f3d70247bfc32847eae5dd71cbddd0198aadecf21e5f7a72a47cd09cc289b8ab70475476af38261920f7085b3ebb4ca3ea40d71809215d5c7096f462db7de4be9fd384a5c4b6612a31c5364263ca6060840e54e3ca29a3438e8d6beef8cf5f44d9b4327a9b57f020cdc480a211d7127731ee128f11d6231758c56aa44c12fb793dead5bd0f9912908b9c0d9dcbb01d1392edb486cec36b6d2a24f2eb1a7cbe7805e0e29081071da7611ee163476c446bf1d79ef16cbbcdba2add10421ecf8bce71e5e0f43e443a4a3b0f2e7d187856fea53eb64292b990fa0d21f8cea79812071b19fd1ff70419a25037e3b63a86edf7e8e39b557842863fa31954d8d8d92a26a21b62e5247a941a9f635781638cf3bdcc2b5f6b3557471d2279dfe96c19a230de7d0eeb6dd7085ebd59d4904b20310c06103106bcfa0ba8c44ebe4fe79ffe3bd8807b556195bfdf63ebb25722ff99e47e7686d2ba82e27997b4f31cf0bbb760e8c97fd6bd8712c829fe44b5a772c4e737a73ef1bfa1446a87351a1e62259226c03b2387b66ac77a59ebbb2ce676a720b23978bc1629700d50f06687fa60d36e9da6d22d1ef3ff10d463e13eb9ee296a11450eceba00da5b31d7c871cb5a98ced52dab57fd7bb1b4eda8142b9593a37d77200df52f9e786dbb3b4cbe87f3c4ba3ee516892c3c92a23d076d02f65e2f171ea0d8b7557358533a84f03478f1eccf91163a8322f6ab9b495eebc23804e95e1027f7758eb68f9cd34b6c1be795d0b4b7d5c1a36a0f8e304af40f740c8820a41a1f9063dce2d02def17b9a68308bd1b9f281e28a06b34e1eecac7acf5a7c50caf39bcd44c3af5e242630e761ece89dc6892ee17802ad56e161f06aafeb08e3fec5030212357d2b5e5ef2ebc36efa9801f5eb19036dbf7a8b5fb911ada0391e41e65c22218eeaf27bd4b783c935d4d2b1699df5ba0bf5ff2a4d792b57b0f0980a37bb37ca0d1fd37c3c7dab30d2ca1994943b2c7a2820adad706693e4791ac0cd500ddf55235c47dd21d6bb60eb557fc21e82fd0b5f635fbda00dc11dd430af293f124452a5f6f1f394e0b6c9c50c935bff6c91da6d3df8d15ac044f71c560a363da8157b1f06b2c26240cd65b1cff50b3a6545fbd59b37d8268c0777534705c29215cf262ddf4a37bad2ccd5fe715be78f34c6126b1e2468827fc2c1a74b113a751f96cd8107f143d514aeb81aa7f54a72ceba9a328afe2f054b2c7100813dbd7865e538cf5074bc3db2f530b5d0d97af080ee1c43186359ef78757f5bea7a5201357a5da09f3aba6cb8330fa6ad4cb6838530ae5aa3df4595c7fa1d0e5d425edf69153815f93a1ab4ad3ddc558c2139cb47585c4824ca4fd5e4f4b396eb4597dce2a5d80bfffef89b7a6524c120d9a433424400d4fa8990f4b4a1a3f09934adb80567b9cf181e83b2080f86c67907e335324d43f51d97e02955e92488f93086edbbb9ef98254fddb9830bbb4f099aa39de590d7c9a9372a4df7989963a38164ff920703f2ba5d142dea9a9041fd066e86a7e65405bc0c7345b3e22edb2854e3c31e4622e2d60baa1bdf19ff072ac279804240458977aa076cb1348c87e2406c12e18da65c12e74dc9396c289c341197181f986c3c089920ee767f6e3638c4c680cbca71c5af1947a7eb385120dccf568cb7bf7a984cf63aa4defd4ac3e850241598ce2b1dad30495d296b7db732cf88b4e2a59be02e36385a97fcbdb6d422b97cd55f82c7a9c285b2212b617939e49ccb5f39d7fe1e220ce4213c7a3a4ade4387e44e6b076ba14e3fcb9ac0cab36c34e99bd97fdd5e5d5659ce056f91f71eb7436d6aa5ec0779d1691f53a61d977da835209b699836f61669eeb33788dda4af3592b406e5b885c178c2769c45d9dc87cfa34e277b659952c1da75dad3a0ff6d912d7dc074a66ef9b9b3161c4cca0c5971e0be41d800c7b314e3c363a293fc71eced3f8f9d43b18b6d6ad7588368fd79f88a1ff77ae619b4ce37f051ecd22637f9557edf5f10bdf2ad33f3c1712a20715b2bb5be04195cc6a7311ad888b975809d20fe98aca88a23cd38be4aea88ae04d912ed426da83c90941862523ea7ab565cc61627f648b57964c56d162a8ef32bee955198ea8476d25273a6a9b3ccf67b088c006e007b8a896629a3a81097f0521a0feef2e22c04372e22bd9c86490b073c6cc5a49c7215828aa480aacd2c0ca07a459eabc8514dcebfe05c5c2a6e8dc7e21e540cef55c3800a217f2faf12caa615f96fc24949e70f41702f90122f91a8a7da3a0f1d4bff7dadaff9f9c66f9ba3d1b970212c214099dd00647cf4539759d540c9a15a534c39c6d1b55c147eac41e5b6962ec866815f36e60749e1fb4197d15a39bf3b1a676863bffebd06a5a31a91fa71a90c86c3a26b4892edfdf5952fb344677e30f2b3f26994dde5b819a5a52e4df435df37a2858394452c19230a3ae6577a76c5aa00904bf78d8c427935050234d8ea1208d0dcdb59b676e982c6a8919cdac76dcaadb5d5de54b4e3f0519786974816ea25c48e256f9d9713a60079fbcfaf8367528d209c8dc73a076af693b2476c02acb2bfdfa563132b97e9dbf72b6d87da445d20007ad8f112d57cc4b13447ba9baf41a4cda397fa167a1788ec103b4ef014e555b4e7fc008a212fccaf24f6c54a6a5b211b8a40d2fc87bb08adc9eefff1e87bb240864e99e685cdf10393ae01cb3ea34cce58cb2fb3f04a742b9aac854c08879212c55c2f9e3041725f921c1e5016ba32c493cfdb0914dc6e2427c9331953178dc03c9b4ec16ab9bffdddd436bdc0fb65c8f9f391ad33a4381cd4b379a10c85eaf49fd1b5d38427273971a1749cd6976eaa00c50c4db83761089b8d30deb8a97375f39cc9f739eeca7380ae41adac7046c3fc3d53d8461c609c4e8dbc53c0df90ba0366b72ba2fa0f4030d7710c6d242f6012e4d6f6bcfce43aa2fe2064f928b27ba2b0875fa924b98b5f6261867d2ffc06b1a58508183a1e4f0fb56d45baaa4fd65bdca6bade63a692a9c1ed39b4ecbfcf31027da5ac7afcdd4461ac4084c81ab72f4edd150c6a3b33932590c7321f3926a5aac81e73f76d1bddc550082626e114d79ce768b37b0c4eafd6b8e20c51508d43212d1aed1ae8d28168b499d51d364e550000575a756bf8650136f8b07bda5bb040d78b60bd7e7e823fad0b0b0cff5fcaa2520b0334f48bd0b6e9d62b0f90b8bc68795fbfb99a97ccaabc51f36bf2b90c513b4a55d883bef12ba44bfc17431e9abde52afd2cf30e9a4f098d39d85d5632592b690324f8e257f59e880b687cb7782bc7aabd3fa038becdc6af066f56985f427d87ba539696e558ad99aecad76bfbf35df4271e9c4ef01bdab8fbdc0200ff9523795627310c89898e80af964d3c47acfa033a3579b4b550170eed3605fc13c3229d3aa04fedf360bf5e60456adc5b2af1043a65615a7ad4268d9342de95762017b7341da38f8983abe731332a737917893d3290fb362b1f5634d2fa4725281ad06341a3a93fa8c5e736e66a5fed01454301a96c335fac3e648a9d8b1e58a750e4191c83dfe4f0972f43564493620143f088d72c1abc6434ee26bf8ec8ed1c0234627047dccb399bcf2e4a378a831067689f2436778512f3c10bda7be51c3d4a486efda20e2554589e3054822ccf8fc141ff1d10df36cd390287963424c47daa5fc7971b257cbce3b0a781ba1d5c91dd89c3ce926ec01f23131f91af0a4e2ab7ef4f461b501ea128565b7867ce7d1909f67c9fcc95dd690ffcbc1fb99546285f2d9249498203fe14d52a0f4c57af41194e98ec60d02cfe8dea508da0741b5f0441880a6d51191a23ae2357874721781c592b2957434bcee304d125dc241c90d9ef25410c782a686a83f2d3a7d8d303f30ac08e265098678846ee6faa2c74c2e9cafbcf850eda106d2648e7690d06f0d5c406f725f1df8cfa5d43bfe2b3a3fe5f2f8d9aa37555af66a09e81847e5c564b2ae07a15a229bd68522c31e15e178cb47469e7f7e0ed8fe1ff24dbcfb1977f12a618fdee7a1c1db4f868e5508f4ec0bd91a246c2bbb3a0de596da98d348d02abea4e98e23c15cad8602872370c3548d7fbe1362af6b874f3a392622b87d7d192513135ffa6fa521034a093ddb7d1ea94bbfa6d09798b49a7abd6751afdf29443d019fb65cb963547a6d231a58f67bf9b45834c24c54eb94313dc803fbcfe27c746e0f6d26e5753cb1dd8352ea211f3008e8244f326cad6411a69df58bef7f5d63cbcf51595da6434a55bd06bd919c4b053b8172cdb80a310e0f8a4f1d7a2b2f1af8f37407152198e6e822b4fe2d963c32d7f2ed6c505fb2d7270842a54fe2491638f2049a06224fd79184e084e9b07fe8a2677328c50f625d2375a29d21d67f98c125e5776109b40a71d0849352f6569c48c159459d0b428ee66f403185b5c9dbdfff77f269cb99401a0323c697628fc8afe808a9fd5010b8646af89b8c0f210965923b94706fded156a2aabd2b359378b96754fbfb44cf5eef66ddc5afe34c848fc35d97ee1cafb19c96a1d405b6917b4f878ad0375e9a675ddd4367dc5dd8e14e7378186ca244e02a3635e2cc58b0bcdd4758796b3e628d77dbef68b701056040321214682251255bc9593672ff2e7d56b2193a771373aa74f32161fa07e78a63a97d827449a8a7ca468e8180f2faa937aa554c49d468a8afef660a094a0d27d8d8f7b63278889ff04d6f011d0983c5c2fc638d5824025e85fcfd585618e616e83cbd5e06298ea7a4186e14ce9b0526dd3958e250bb9cb1d3c158541f7c11e77de71f780496d51dd2c80e7cd9ff607b4db4434c77cff79d7498787816f98831ab480447320f3b51d7064b8d04e5be8e7ff438c512c347b4096b7fe6f8201d61ba224867fc9cea3454b6a9d2bb3db796fa6379d27d3292e09bbf10019c5d224dc3d9910261e477e371ef85cdf27cb5dcdefd516426ab7f3aab281aca444b98e194</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-wave">      <input class="hbe hbe-input-field hbe-input-field-wave" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-wave" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-wave">输入密码查看内容</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-wave" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> softether使用方法 </tag>
            
            <tag> 局域网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实现进程被结束就蓝屏的函数</title>
      <link href="/page/2848625591/"/>
      <url>/page/2848625591/</url>
      
        <content type="html"><![CDATA[<h1 id="1-保护进程，结束就蓝屏"><a href="#1-保护进程，结束就蓝屏" class="headerlink" title="1. 保护进程，结束就蓝屏"></a>1. 保护进程，结束就蓝屏</h1><p>RtlSetProcessIsCritical函数可以启用或关闭开启之后变得和系统进程一样被杀系统直接蓝屏系统进程也是此函数实现的上图可以用于进程保护<br>设置自己为保护进程，这样结束掉就会蓝屏，蓝屏信息翻译就是 重点保护进程。</p><p>设置为保护进程：RtlSetProcessIsCritical(True,Null(或Nothing),False)</p><p>取消（关闭时记得加上去。）：RtlSetProcessIsCritical(False,Null,False)<br>把进程做crss中止就蓝屏，防止进程被杀<br><img src="/images/182944wc66ia5wz61ce6ap.jpg" alt="保护进程"><br><img src="/images/202842lhbqbh192doloq1z.png" alt="smss中的保护方式"><br>这是最不占用CPU的方式了</p><p>以下为C代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> (NTAPI*Rtl)(ULONG,BOOL,BOOL,PBOOL);</span><br><span class="line"><span class="keyword">typedef</span> (NTAPI*PT1)(BOOL, PBOOLEAN, BOOL);</span><br><span class="line"><span class="keyword">typedef</span> (NTAPI*PT2)(BOOL,PBOOLEAN,BOOL);</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Protect</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">BOOL B;</span><br><span class="line">ULONG SE_DEBUG_PRIVILEGE = <span class="number">20</span>;</span><br><span class="line">Rtl RtlAdjustPrivilege=(Rtl)GetProcAddress(GetModuleHandleW(<span class="string">L&quot;ntdll&quot;</span>),<span class="string">&quot;RtlAdjustPrivilege&quot;</span>);</span><br><span class="line">PT1 RtlSetProcessIsCritical=(PT1)GetProcAddress(GetModuleHandleW(<span class="string">L&quot;ntdll&quot;</span>), <span class="string">&quot;RtlSetProcessIsCritical&quot;</span>);</span><br><span class="line">PT2 RtlSetThreadIsCritical=(PT2)GetProcAddress(GetModuleHandleW(<span class="string">L&quot;ntdll&quot;</span>), <span class="string">&quot;RtlSetThreadIsCritical&quot;</span>);</span><br><span class="line">RtlAdjustPrivilege(SE_DEBUG_PRIVILEGE,TRUE,FALSE,&amp;B);</span><br><span class="line">RtlSetProcessIsCritical(TRUE,<span class="literal">NULL</span>,FALSE);</span><br><span class="line">RtlSetThreadIsCritical(TRUE, <span class="literal">NULL</span>, FALSE);</span><br><span class="line"><span class="comment">//BY 1361784102</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Protect();</span><br><span class="line">getchar();</span><br><span class="line"><span class="comment">//BY 1361784102</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>vb代码如下：</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Public</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> RtlAdjustPrivilege <span class="keyword">Lib</span> <span class="string">&quot;ntdll.dll&quot;</span> (<span class="keyword">ByVal</span> Privilege <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByVal</span> Enable <span class="keyword">As</span> <span class="type">Boolean</span>, <span class="keyword">ByVal</span> Client <span class="keyword">As</span> <span class="type">Boolean</span>, WasEnabled <span class="keyword">As</span> <span class="type">Long</span>) <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Public</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> RtlSetProcessIsCritical <span class="keyword">Lib</span> <span class="string">&quot;ntdll&quot;</span> (<span class="keyword">Optional</span> <span class="keyword">ByVal</span> NewValue <span class="keyword">As</span> <span class="type">Boolean</span>, <span class="keyword">Optional</span> <span class="keyword">ByVal</span> Value <span class="keyword">As</span> <span class="type">Boolean</span>, <span class="keyword">Optional</span> <span class="keyword">ByVal</span> WinLogon <span class="keyword">As</span> <span class="type">Boolean</span> = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Main()</span><br><span class="line">    RtlAdjustPrivilege <span class="number">20</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="number">0</span></span><br><span class="line">    RtlSetProcessIsCritical <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span></span><br><span class="line">    <span class="keyword">End</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><h1 id="2-RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏"><a href="#2-RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏" class="headerlink" title="2. RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏"></a>2. RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏</h1><p>VB代码如下：</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Public</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> NtRaiseHardError <span class="keyword">Lib</span> <span class="string">&quot;ntdll.dll&quot;</span> (<span class="keyword">ByVal</span> ErrorStatus <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByVal</span> NumberOfParameters <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByVal</span> UnicodeStringParameterMask <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByRef</span> Parameters <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> ValidResponseOptions <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByRef</span> Response <span class="keyword">As</span> <span class="type">Long</span>) <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Public</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> RtlAdjustPrivilege <span class="keyword">Lib</span> <span class="string">&quot;ntdll.dll&quot;</span> (<span class="keyword">ByVal</span> Privilege <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByVal</span> Enable <span class="keyword">As</span> <span class="type">Boolean</span>, <span class="keyword">ByVal</span> Client <span class="keyword">As</span> <span class="type">Boolean</span>, WasEnabled <span class="keyword">As</span> <span class="type">Long</span>) <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Public</span> <span class="keyword">Declare</span> <span class="keyword">Sub</span> RtlInitUnicodeString <span class="keyword">Lib</span> <span class="string">&quot;ntdll.dll&quot;</span> (DestinationString <span class="keyword">As</span> UNICODE_STRING, <span class="keyword">ByVal</span> SourceString <span class="keyword">As</span> <span class="type">Long</span>)</span><br><span class="line"><span class="keyword">Public</span> Type UNICODE_STRING</span><br><span class="line">    Length                <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">    MaximumLength         <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">    Buffer                <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">End</span> Type</span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Main()</span><br><span class="line">    <span class="keyword">Dim</span> u <span class="keyword">As</span> UNICODE_STRING, p(<span class="number">3</span>) <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">    RtlAdjustPrivilege <span class="number">19</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="number">0</span></span><br><span class="line">    RtlInitUnicodeString u, StrPtr(<span class="string">&quot;Session Manager&quot;</span>)</span><br><span class="line">    p(<span class="number">0</span>) = VarPtr(u)</span><br><span class="line">    p(<span class="number">1</span>) = u.Length</span><br><span class="line">    p(<span class="number">2</span>) = VarPtr(u)</span><br><span class="line">    p(<span class="number">3</span>) = VarPtr(u)</span><br><span class="line">    NtRaiseHardError <span class="number">&amp;HC000021A</span>, <span class="number">4</span>, <span class="number">1</span>, p(<span class="number">0</span>), <span class="number">6</span>, <span class="number">0</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><p>vc代码</p><blockquote><p>函数原型<br>NTSTATUS RtlAdjustPrivilege<br>(<br>    ULONG    Privilege,<br>    BOOLEAN Enable,<br>    BOOLEAN CurrentThread,<br>    PBOOLEAN Enabled<br>);<br>NTSYSAPI NTSTATUS NTAPI NtRaiseHardError<br>(<br>  IN NTSTATUS             ErrorStatus,<br>  IN ULONG                NumberOfParameters,<br>  IN PUNICODE_STRING      UnicodeStringParameterMask OPTIONAL,<br>  IN PVOID                *Parameters,<br>  IN HARDERROR_RESPONSE_OPTION ResponseOption,<br>  OUT PHARDERROR_RESPONSE Response<br>);</p></blockquote><p>NTHeaders.h（声明相关结构与变量）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">//======================================================================</span><br><span class="line">//By TiKEY!</span><br><span class="line">//E-mail:tyk5555@hotmail.com</span><br><span class="line">//QQ:574436201</span><br><span class="line">//======================================================================</span><br><span class="line">#ifndef _NT_HDRS_</span><br><span class="line">#define _NT_HDRS_</span><br><span class="line">#include &lt;windows.h&gt;</span><br><span class="line"></span><br><span class="line">typedef /*__success(return &gt;= 0)*/ LONG NTSTATUS; </span><br><span class="line">typedef NTSTATUS *PNTSTATUS; </span><br><span class="line"></span><br><span class="line">#define STATUS_SUCCESS  ((NTSTATUS)0x00000000L)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">typedef struct _LSA_UNICODE_STRING &#123;</span><br><span class="line">  USHORT Length;</span><br><span class="line">  USHORT MaximumLength;</span><br><span class="line">  PWSTR  Buffer;</span><br><span class="line">&#125; LSA_UNICODE_STRING, *PLSA_UNICODE_STRING, UNICODE_STRING, *PUNICODE_STRING;</span><br><span class="line"></span><br><span class="line">typedef enum _HARDERROR_RESPONSE_OPTION &#123;</span><br><span class="line">    OptionAbortRetryIgnore,</span><br><span class="line">    OptionOk,</span><br><span class="line">    OptionOkCancel,</span><br><span class="line">    OptionRetryCancel,</span><br><span class="line">    OptionYesNo,</span><br><span class="line">    OptionYesNoCancel,</span><br><span class="line">    OptionShutdownSystem</span><br><span class="line">&#125; HARDERROR_RESPONSE_OPTION, *PHARDERROR_RESPONSE_OPTION;</span><br><span class="line"></span><br><span class="line">typedef enum _HARDERROR_RESPONSE &#123;</span><br><span class="line">    ResponseReturnToCaller,</span><br><span class="line">    ResponseNotHandled,</span><br><span class="line">    ResponseAbort,</span><br><span class="line">    ResponseCancel,</span><br><span class="line">    ResponseIgnore,</span><br><span class="line">    ResponseNo,</span><br><span class="line">    ResponseOk,</span><br><span class="line">    ResponseRetry,</span><br><span class="line">    ResponseYes</span><br><span class="line">&#125; HARDERROR_RESPONSE, *PHARDERROR_RESPONSE;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p>BlueScreen.cpp:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">//======================================================================</span><br><span class="line">//By TiKEY!</span><br><span class="line">//E-mail:tyk5555@hotmail.com</span><br><span class="line">//QQ:574436201</span><br><span class="line">//======================================================================</span><br><span class="line">#include &lt;Windows.h&gt;</span><br><span class="line">#include &quot;NTHeaders.h&quot;</span><br><span class="line"></span><br><span class="line">HINSTANCE hInst;// 当前实例</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">typedef UINT (CALLBACK* NTRAISEHARDERROR)(NTSTATUS, ULONG, PUNICODE_STRING, PVOID,HARDERROR_RESPONSE_OPTION, PHARDERROR_RESPONSE);</span><br><span class="line">typedef UINT (CALLBACK* RTLADJUSTPRIVILEGE)(ULONG, BOOL, BOOL, PINT);</span><br><span class="line"></span><br><span class="line">int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)</span><br><span class="line">&#123;</span><br><span class="line">HINSTANCE hDLL = LoadLibrary(TEXT(&quot;ntdll.dll&quot;));</span><br><span class="line">NTRAISEHARDERROR NtRaiseHardError;</span><br><span class="line">RTLADJUSTPRIVILEGE RtlAdjustPrivilege;</span><br><span class="line">int nEn = 0;</span><br><span class="line">HARDERROR_RESPONSE reResponse;</span><br><span class="line">if (hDLL != NULL)</span><br><span class="line">&#123;</span><br><span class="line">NtRaiseHardError = (NTRAISEHARDERROR)GetProcAddress(hDLL, &quot;NtRaiseHardError&quot;);</span><br><span class="line">RtlAdjustPrivilege = (RTLADJUSTPRIVILEGE)GetProcAddress(hDLL, &quot;RtlAdjustPrivilege&quot;);</span><br><span class="line">if (!NtRaiseHardError)</span><br><span class="line">&#123;</span><br><span class="line">// handle the error</span><br><span class="line">FreeLibrary(hDLL);</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br><span class="line">if (!RtlAdjustPrivilege)</span><br><span class="line">&#123;</span><br><span class="line">// handle the error</span><br><span class="line">FreeLibrary(hDLL);</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br><span class="line">RtlAdjustPrivilege(0x13, TRUE, FALSE, &amp;nEn);//0x13 = SeShutdownPrivilege</span><br><span class="line">NtRaiseHardError(0xC000021A,0,0,0,OptionShutdownSystem,&amp;reResponse);</span><br><span class="line">&#125;</span><br><span class="line">return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>vc代码在VS2010 SP1编译通过， Win7 SP1测试有效。</p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 电脑蓝屏 </tag>
            
            <tag> c++源码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>可实现维护通道的vbs脚本类</title>
      <link href="/page/2434381964/"/>
      <url>/page/2434381964/</url>
      
        <content type="html"><![CDATA[<img src="/images/2354883490,3989130937.jpg" alt=""><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>闲来无事，为了方便，用vbs写了一个类！ 别瞧不上vbs脚本语言，其实当你学习的语言越多，发现所有编程语言都是那么一回事，最终的目的都是完成某项功能，vbs的 好处就是可以使用系统的计事本直接编辑，不需要任何语言安装环境，python开源库是多，但却必须安装python的语言环境， c++等语言生成的程序功能是可以足够强大，但要立即增加修改功能却很麻烦(因为需要安装编程环境)！ vbs特别适合拿来即用，代码不对随时可以修改！就好比批处理虽然功能不强，windows却一直保留到现在！也许windows的激活 slmgr.vbs和office的激活ospp.vbs一直保留到现在的原因可能就是说明vbs还是有存在的道理的!如果你仔细看了这个vbs自定义 类，你就会发现vbs也可以实现很多功能！比如这个vbs类中的中止线程函数，所有语言实现，都是取得线程ID，然后发送中止线 程的消息，其实此自定义类就用了三句代码，这就是其他软件中的根据窗口关闭网吧广告的功能，也可以中止那些在任务管理器 中无法结束的进程！</p><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>vbs常用函数代码，包括一些特色函数，杀毒软件可能会报毒，使用notepad++等软件可直接查看源代码，未进行任何加密 最大的特色，可以让vbs使用windows api函数，api能办到的功能，vbs也能做到! 自定义vbs类的函数，见demo\demo.vbs文件</p><h2 id="软件架构"><a href="#软件架构" class="headerlink" title="软件架构"></a>软件架构</h2><p>lib目录的MyVbsClass.vbs和dynwrapx.dll为核心文件，即vbs自定义类</p><p>demo为示例代码， 维护通道是使用vbs自定义类写的网吧开机维护通道</p><p>虽然是明文方式写的vbs脚本，一样能实现如深蓝维护通道等类软件中的绝大部份功能，一样可以关闭网吧的广告及广告窗口!</p><h2 id="安装教程"><a href="#安装教程" class="headerlink" title="安装教程"></a>安装教程</h2><p>把lib目录复制一份<br>新建一目录，引用lib中的MyVbsClass.vbs即可使用其全部函数，引用方法见demo\demo.vbs<br>仅适用于64位系统</p><h2 id="当前实现功能"><a href="#当前实现功能" class="headerlink" title="当前实现功能"></a>当前实现功能</h2><p>‘call myfun.MakeLink(“罗技鼠标设置”,”G:\常用软件\罗技鼠标游戏驱动\Rungame.exe”,””,”G:\常用软件\罗技鼠标游戏驱动\48731.ico”) ‘创建桌面快捷方式<br>‘call myfun.MakeUrl(“<a href="http://www.bnwin.com&quot;,&quot;百脑问&quot;,true/">http://www.bnwin.com&quot;,&quot;百脑问&quot;,true</a>) ‘收藏夹栏添加网址<br>‘call myfun.SetHomepage(“<a href="https://www.baidu.com&quot;/">https://www.baidu.com&quot;</a>) ‘设置ie主页<br>‘msgbox myfun.GetExePath(“C:\Program Files\Internet Explorer\iexplore.exe”) ‘根据路径取目录<br>‘msgbox myfun.IsExitFile(“c:\abc.txt”) ‘判断文件是否存在<br>‘msgbox myfun.IsExitDir(“c:\abc”,true) ‘判断目录是否存在<br>‘call myfun.MyCreateFolder(“c:\abc\1233\dd”)  ‘创建目录可多级<br>‘call myfun.XCopy(“D:\dump”,”d:\456”,true) ‘拷目录 多级<br>‘call myfun.CopyFile(“C:\Windows\win.ini”,”d:\323\aaa.txt”,true)  ‘拷贝文件<br>‘call myfun.DelFile(“c:\abd\123.txt”)  ‘删除文件<br>‘call myfun.DelDir(“c:\abd&quot;)  ‘删除目录<br>‘Call myfun.Run(“””C:\Program Files (x86)\Internet Explorer\iexplore.exe””  <a href="http://www.bnwin.com&quot;,false/">http://www.bnwin.com&quot;,false</a>)  ‘路径带有空格，要用引号把空格路径括起，会检测文件是否存在，不能用于执行dos命令<br>‘msgbox myfun.ping(“192.168.0.1”)  ‘ping是否在线<br>‘MsgBox myfun.GetMac   ‘取得网卡mac地址<br>‘MsgBox myfun.GetIP   ‘取得本机ip地址<br>‘MsgBox myfun.GetComputerName   ‘取得机器名<br>‘MsgBox myfun.GetOS  ‘取得操作系统是win7还是win10<br>‘MsgBox myfun.X86orX64  ‘系统是64位还是32位<br>‘call myfun.ReadBinary(“c:\windows\notepad.exe”,”d:\123.txt”) ‘把文件生成16进制字符串文本文件<br>‘call myfun.WriteBinary(“d:\123.exe”,”d:\123.txt”,true)  ‘把16进制文本文件还原为可执行文件<br>‘call myfun.Sleep(5)  ‘延时5秒<br>‘call myfun.ImportReg(“.\reg.reg”)  ‘导入注册表<br>‘call myfun.RunBat(“.\test.bat”)  ‘运行批处理文件<br>‘myfun.Runcmd “dir c:\ &gt;c:\1.txt” ‘运行dos命令<br>‘call myfun.import(“d:\abc.vbs”)  ‘导入vbs文件<br>‘call myfun.CloseProcess(“SunloginRemote.exe”)  ‘关闭指定进程<br>‘call myfun.IsProcess(“qq.exe”)     ‘检查指定进程是否存在<br>‘call myfun.IsProcessEx(“qq.exe|notepad.exe”)  ‘指定指定列表进程是否存在<br>‘call myfun.CloseProcessEx(“qq.exe|wechat.exe”)  ‘结束进程列表<br>‘call myfun.RegExpTest(“sdf|456”,”123456789”)  ‘正则判断是否存在指定内容<br>‘call myfun.KillWindow(“”,”计算机”)  ‘关闭指定类名或标题的窗口<br>‘call myfun.WriteReg(“HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\MAIN\Start Page”,”<a href="https://www.baidu.com&quot;,&quot;&quot;/">https://www.baidu.com&quot;,&quot;&quot;</a>)  ‘写注册表值<br>‘MsgBox myfun.ReadReg(“HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\MAIN\Start Page”) ‘读注册表值<br>‘call myfun.HideWindow(“Notepad”,””) ‘按类名或标题隐藏窗口 未关闭<br>‘call myfun.KillThread(“Notepad”,””)  ‘按类名或标题中止显示此窗口的线程 如果是单线程，程序则会退出 可用于关闭广告窗口<br>‘call myfun.DownFile(“<a href="http://gh.api.99988866.xyz/github.com/Chuyu-Team/Dism-Multi-language/releases/download/v10.1.1001.10/Dism++10.1.1001.10_d4ba4eb035254b3326d6adc6638bc9c8daea7018.zip&quot;,&quot;d:/dism.zip&quot;">http://gh.api.99988866.xyz/github.com/Chuyu-Team/Dism-Multi-language/releases/download/v10.1.1001.10/Dism++10.1.1001.10_d4ba4eb035254b3326d6adc6638bc9c8daea7018.zip&quot;,&quot;d:\dism.zip&quot;</a>)  ‘下载远程文件<br>‘call myfun.SyncTime  ‘同步时间<br>‘MsgBox myfun.GetSysRunTime() ‘取得系统开机时间 关机时间 返回时间较长，可用于学习查询系统日志<br>‘call myfun.log(“测试”)   ‘写日志文件 日志文件在当前脚本下，以日期命名<br>‘MsgBox myfun.IsSuperAdmin() ‘判断无盘是否有超级用户<br>‘MsgBox myfun.FromUnixTime(“1630211522”,8) ‘unix时间转北京时间<br>‘msgbox myfun.ToUnixTime(now, 8)  ‘把当前时间转成unix时间<br>‘myfun.WriteIni “节点”,”键名”,”值”,”d:\123.ini”   ‘写INI文件<br>‘msgbox myfun.ReadIni(“节点”,”键名”,”默认值”,”d:\123.ini”) ‘读ini文件<br>‘call myfun.CreatLink(“d:\pg”,”C:\Program Files (x86)”)  ‘’把C盘程序目录映射到D盘pg目录,访问D:\pg相当于访问C:\Program Files (x86)内容<br>‘msgbox “系统运行了：”&amp;myfun.GetOsRunTime&amp;”分钟”<br>‘call myfun.SysVolme  ‘把系统音量调到最大<br>‘call myfun.Depolicy(“禁止常用端口”)  ‘创建本机安全策略禁止135 137 139 445 3389端口<br>‘call myfun.CloseMonitor(2) ‘2关闭显示 -1打开显示器<br>‘call myfun.RunAu3(“E:\软件工程\vbs\demo\monitor.au3”,false) ‘恢复显示器所有设置<br>‘call myfun.RestMonitor() ‘恢复显示器所有设置</p><h2 id="开源地址：https-gitee-com-goodhelp-vbs-code"><a href="#开源地址：https-gitee-com-goodhelp-vbs-code" class="headerlink" title="开源地址：https://gitee.com/goodhelp/vbs-code"></a>开源地址：<a href="https://gitee.com/goodhelp/vbs-code">https://gitee.com/goodhelp/vbs-code</a></h2>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 开源项目 </tag>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>让电源键关机变重启</title>
      <link href="/page/1082310208/"/>
      <url>/page/1082310208/</url>
      
        <content type="html"><![CDATA[<h2 id="让电源键关机变重启-使用说明"><a href="#让电源键关机变重启-使用说明" class="headerlink" title="让电源键关机变重启　使用说明"></a>让电源键关机变重启　使用说明</h2><img src="/images/1621350706-111.jpg" /><p>注意：需要关闭无盘的闪电关机，开启闪电关机，本软件无效！</p><p>功能：运行本工具，按电源键，或系统中点关机，会执行重启！总之就是不关机，关机就是重启，关机直接重启，关机会重启，说三遍!</p><p>适用范围：息屏挖矿，按电源键会关机，本软件作用就显现了!机器正在挖矿，显示器黑屏，总有顾客以为机器是关了的，去按电源键开机，这时机器就会关机。顾客就会以为这台机器有问题，明明按了开关键，结果机器没开起，有些会立马换一台机器，重复上面的操作。使用了本软件，按了电源键不会关机，直接变成重启，顾客不会置疑了，呼叫网管的次数少了!</p><p><a href="https://item.taobao.com/item.htm?spm=a1z10.1-c.w4023-488448694.4.62d67cacz2wvxZ&id=655303638168">下载地址</a></p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 原创软件 </tag>
            
            <tag> 关机重启 </tag>
            
            <tag> 电源键 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>八圈9.5版关闭侧边栏工具-怎样关闭8圈侧边栏</title>
      <link href="/page/3043345977/"/>
      <url>/page/3043345977/</url>
      
        <content type="html"><![CDATA[<img src="/images/8qu-img2.png" alt="">如果说8圈智能场所管理平台等，提高了网吧运营管理的效率，让整个管理流程更加便捷；那么8圈机器人，就是让整个运营管理更加智能化，降低人为因素造成的失误，在原有的基础上提高运营管理的准确性、安全性。<p>据李金平介绍，8圈机器人能够轻松解决困扰网吧业主的收银员不负责，收银员成本高，招聘难，员工不稳定，财务统计困难，身份证冒用现象频发等系列问题。</p><p>不仅如此，8圈机器人优势明显：</p><p>设置简单、操作方便，无需专人指导一点就会；全天候24小时工作，节省人工成本开支提高竞争力；在财务管理上，自助收银，机器人收入按班次自动汇总，当班收入掌上8圈随时可查，更安全；AI人脸识别，杜绝人证不一致。</p><p>9.5版去侧边栏下载地址:</p><p><a href="https://item.taobao.com/item.htm?ft=t&id=655108849725">点击开始下载</a></p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 八圈 </tag>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>显示器亮度，对比度，色温缩放调节，笔记本亮度调节AUTOIT源码</title>
      <link href="/page/365528154/"/>
      <url>/page/365528154/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/c9ae1552366758.png" alt="显示器调节"><br>通过调用dxva2.dll文件，修改显示器的设置，和按显示器上的物理按钮效果一样，有效的解决显示器上按钮不好设置，按钮功能不明的问题，有些显示器不支持，如果你使用的无效果，说明你显示器不支持此调节功能!下载地址：<a href="https://www.jianyiit.com/content/uploadfile/201903/adf51552366758.zip">源码</a></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WinAPI.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WinAPIFiles.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WinAPIGdi.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GUIConstantsEx.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GuiSlider.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Array.au3&gt;</span></span></span><br><span class="line">Opt(<span class="string">&quot;GUIOnEventMode&quot;</span>, <span class="number">1</span>)</span><br><span class="line">$g_szVersion = <span class="string">&quot;RU1Y2-D59U9&quot;</span></span><br><span class="line"><span class="keyword">If</span> <span class="built_in">WinExists</span>($g_szVersion) <span class="keyword">Then</span> <span class="keyword">Exit</span></span><br><span class="line"><span class="built_in">AutoItWinSetTitle</span>($g_szVersion)</span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $Dxva2 = <span class="built_in">DllOpen</span>(<span class="string">&quot;Dxva2.dll&quot;</span>)</span><br><span class="line"><span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $tagSTRUCT = <span class="string">&quot;HANDLE hPhysicalMonitor;WCHAR szPhysicalMonitorDescription[128];&quot;</span></span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $tag_MC_TIMING_REPORT = <span class="string">&quot;BYTE bTimingStatusByte; DWORD dwHorizontalFrequencyInHZ; DWORD dwVerticalFrequencyInHZ&quot;</span></span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $tag_DISPLAY_BRIGHTNESS = <span class="string">&quot;byte ucDisplayPolicy; byte ucACBrightness; byte ucDCBrightness&quot;</span></span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $IOCTL_VIDEO_QUERY_SUPPORTED_BRIGHTNESS = _WinAPI_IOCTL($FILE_DEVICE_VIDEO, <span class="number">0x125</span>, $METHOD_BUFFERED, $FILE_ANY_ACCESS)</span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $IOCTL_VIDEO_QUERY_DISPLAY_BRIGHTNESS = _WinAPI_IOCTL($FILE_DEVICE_VIDEO, <span class="number">0x126</span>, $METHOD_BUFFERED, $FILE_ANY_ACCESS)</span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $IOCTL_VIDEO_SET_DISPLAY_BRIGHTNESS = _WinAPI_IOCTL($FILE_DEVICE_VIDEO, <span class="number">0x127</span>, $METHOD_BUFFERED, $FILE_ANY_ACCESS)</span><br><span class="line"><span class="keyword">Global</span> $idSlider1, $idSlider2, $idButton1, $idButton2, $idLabel1, $idLabel2</span><br><span class="line"><span class="keyword">Global</span> $hMonitor, $brightness, $contrast, $switch1, $switch2, $VCPReply</span><br><span class="line"><span class="keyword">Global</span> $idLabel3, $idSlider3, $hDevice, $BRIGHTNESS_LCD_Array</span><br><span class="line">$hDevice = LCD()</span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> <span class="symbol">@error</span> <span class="keyword">Then</span></span><br><span class="line">        LCD_Set($hDevice)</span><br><span class="line">        <span class="keyword">If</span> $hDevice <span class="keyword">Then</span> _WinAPI_CloseHandle($hDevice)</span><br><span class="line">        <span class="built_in">DllClose</span>($Dxva2)</span><br><span class="line">        <span class="keyword">Exit</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line">$hMonitor = _WinAPI_MonitorFromWindow(_WinAPI_GetDesktopWindow(), $MONITOR_DEFAULTTOPRIMARY) <span class="comment">;返回主显示器句柄</span></span><br><span class="line">$hMonitor = _GetPhysicalMonitorsFromHMONITOR($hMonitor) <span class="comment">;获取物理显示器句柄</span></span><br><span class="line">$StringLength = CapabilitiesRequestAndCapabilitiesReply($hMonitor)</span><br><span class="line">$Gui = <span class="built_in">GUICreate</span>(<span class="string">&quot;显示器设置&quot;</span>, <span class="number">262</span>, <span class="number">220</span>, <span class="number">-1</span>, <span class="number">-1</span>)</span><br><span class="line"><span class="built_in">GUISetOnEvent</span>($GUI_EVENT_CLOSE, <span class="string">&quot;_exit&quot;</span>)</span><br><span class="line">$idSlider1 = <span class="built_in">GUICtrlCreateSlider</span>(<span class="number">10</span>, <span class="number">30</span>, <span class="number">240</span>, <span class="number">20</span>, <span class="built_in">BitOR</span>($TBS_TOOLTIPS, $TBS_AUTOTICKS))</span><br><span class="line"><span class="built_in">GUICtrlSetOnEvent</span>($idSlider1, <span class="string">&quot;Brightness&quot;</span>)</span><br><span class="line"><span class="built_in">GUICtrlSetLimit</span>($idSlider1, <span class="number">100</span>)</span><br><span class="line">$idSlider2 = <span class="built_in">GUICtrlCreateSlider</span>(<span class="number">10</span>, <span class="number">82</span>, <span class="number">240</span>, <span class="number">20</span>, <span class="built_in">BitOR</span>($TBS_TOOLTIPS, $TBS_AUTOTICKS))</span><br><span class="line"><span class="built_in">GUICtrlSetOnEvent</span>($idSlider2, <span class="string">&quot;Contrast&quot;</span>)</span><br><span class="line"><span class="built_in">GUICtrlSetLimit</span>($idSlider2, <span class="number">100</span>)</span><br><span class="line">$idButton1 = <span class="built_in">GUICtrlCreateButton</span>(<span class="string">&quot;宽屏切换&quot;</span>, <span class="number">16</span>, <span class="number">160</span>, <span class="number">85</span>, <span class="number">25</span>)</span><br><span class="line"><span class="built_in">GUICtrlSetOnEvent</span>($idButton1, <span class="string">&quot;Button1&quot;</span>)</span><br><span class="line">$idButton2 = <span class="built_in">GUICtrlCreateButton</span>(<span class="string">&quot;恢复默认&quot;</span>, <span class="number">158</span>, <span class="number">160</span>, <span class="number">85</span>, <span class="number">25</span>)</span><br><span class="line"><span class="built_in">GUICtrlSetOnEvent</span>($idButton2, <span class="string">&quot;Button2&quot;</span>)</span><br><span class="line">$idLabel1 = <span class="built_in">GUICtrlCreateLabel</span>(<span class="string">&quot;  亮度调节:不可用&quot;</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">140</span>, <span class="number">20</span>)</span><br><span class="line">$idLabel2 = <span class="built_in">GUICtrlCreateLabel</span>(<span class="string">&quot;对比度调节:不可用&quot;</span>, <span class="number">10</span>, <span class="number">60</span>, <span class="number">140</span>, <span class="number">20</span>)</span><br><span class="line">$Combo1 = <span class="built_in">GUICtrlCreateCombo</span>(<span class="string">&quot;&quot;</span>, <span class="number">102</span>, <span class="number">120</span>, <span class="number">100</span>, <span class="number">25</span>, <span class="number">0x0003</span>)</span><br><span class="line"><span class="built_in">GUICtrlSetOnEvent</span>($Combo1, <span class="string">&quot;Color&quot;</span>)</span><br><span class="line"><span class="built_in">GUICtrlCreateLabel</span>(<span class="string">&quot;色温调节&quot;</span>, <span class="number">32</span>, <span class="number">124</span>, <span class="number">48</span>, <span class="number">20</span>)</span><br><span class="line">_GUICtrlSlider_SetTipSide($idSlider1, $TBTS_TOP)</span><br><span class="line">_GUICtrlSlider_SetTipSide($idSlider2, $TBTS_TOP)</span><br><span class="line"><span class="keyword">If</span> $StringLength &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">        $VCP_Array = Manage_vcp($StringLength)</span><br><span class="line">        $VCPReply = _GetVCPFeatureAndVCPFeatureReply($hMonitor, <span class="number">0x86</span>)</span><br><span class="line">        <span class="keyword">If</span> $VCPReply[0] = <span class="number">0</span> <span class="keyword">Then</span> <span class="built_in">GUICtrlSetState</span>($idButton1, $GUI_DISABLE)</span><br><span class="line">        $brightness = _GetMonitorBrightness($hMonitor) <span class="comment">;获取监视器亮度</span></span><br><span class="line">        <span class="built_in">ConsoleWrite</span>($brightness[1] &amp; <span class="symbol">@CRLF</span>)</span><br><span class="line">        $contrast = _GetMonitorContrast($hMonitor) <span class="comment">;获取监视器对比度</span></span><br><span class="line">        <span class="keyword">If</span> $brightness[2] &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span> $switch1 = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">If</span> $contrast[2] &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span> $switch2 = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">If</span> $switch1 <span class="keyword">Then</span></span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($idSlider1, $brightness[1])</span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($idLabel1, <span class="string">&quot;设置亮度:&quot;</span> &amp; $brightness[1])</span><br><span class="line">        <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">If</span> $switch2 <span class="keyword">Then</span></span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($idSlider2, $contrast[1])</span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($idLabel2, <span class="string">&quot;设置对比度:&quot;</span> &amp; $contrast[1])</span><br><span class="line">        <span class="keyword">EndIf</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">For</span> $i = <span class="number">0</span> <span class="keyword">To</span> <span class="built_in">UBound</span>($VCP_Array) - <span class="number">1</span></span><br><span class="line">                <span class="keyword">If</span> $VCP_Array[$i][0] = <span class="string">&quot;14&quot;</span> <span class="keyword">Then</span></span><br><span class="line">                        <span class="keyword">If</span> $VCP_Array[$i][1] &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">                                $Color_Array = <span class="built_in">StringSplit</span>($VCP_Array[$i][1], <span class="string">&quot; &quot;</span>, <span class="number">2</span>)</span><br><span class="line">                                $Color_String = <span class="string">&quot;&quot;</span></span><br><span class="line">                                <span class="keyword">For</span> $S = <span class="number">0</span> <span class="keyword">To</span> <span class="built_in">UBound</span>($Color_Array) - <span class="number">1</span></span><br><span class="line">                                        $temp = Select_Color($Color_Array[$S])</span><br><span class="line">                                        <span class="keyword">If</span> $temp &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> $Color_String &amp;= $temp &amp; <span class="string">&quot;|&quot;</span></span><br><span class="line">                                <span class="keyword">Next</span></span><br><span class="line">                        <span class="keyword">EndIf</span></span><br><span class="line">                        <span class="keyword">ExitLoop</span></span><br><span class="line">                <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">If</span> $Color_String &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">                $VCPCode = _GetVCPFeatureAndVCPFeatureReply($hMonitor, <span class="number">0x14</span>)</span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($Combo1, $Color_String, Select_Color($VCPCode[1] - <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($Combo1, <span class="string">&quot;不支持&quot;</span>, <span class="string">&quot;不支持&quot;</span>)</span><br><span class="line">                <span class="built_in">GUICtrlSetState</span>($Combo1, $GUI_DISABLE)</span><br><span class="line">        <span class="keyword">EndIf</span></span><br><span class="line">        <span class="built_in">GUISetState</span>(<span class="symbol">@SW_SHOW</span>, $Gui)</span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">        <span class="built_in">WinSetTitle</span>($Gui, <span class="string">&quot;&quot;</span>, <span class="string">&quot;未发现DDC/CI&quot;</span>)</span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($Combo1, <span class="string">&quot;不支持&quot;</span>, <span class="string">&quot;不支持&quot;</span>)</span><br><span class="line">        <span class="built_in">GUICtrlSetState</span>($idSlider1, $GUI_DISABLE)</span><br><span class="line">        <span class="built_in">GUICtrlSetState</span>($idSlider2, $GUI_DISABLE)</span><br><span class="line">        <span class="built_in">GUICtrlSetState</span>($idButton1, $GUI_DISABLE)</span><br><span class="line">        <span class="built_in">GUICtrlSetState</span>($Combo1, $GUI_DISABLE)</span><br><span class="line">        <span class="built_in">GUISetState</span>(<span class="symbol">@SW_SHOW</span>, $Gui)</span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">While</span> <span class="number">1</span></span><br><span class="line">        <span class="built_in">Sleep</span>(<span class="number">50</span>)</span><br><span class="line"><span class="keyword">WEnd</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">LCD</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">Local</span> $iDevice</span><br><span class="line">        $iDevice = _WinAPI_CreateFileEx(<span class="string">&quot;\\.\LCD&quot;</span>, $OPEN_EXISTING, $GENERIC_READ + $GENERIC_WRITE, $FILE_ANY_ACCESS, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span>) ? (<span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)) : ($iDevice)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;LCD</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">LCD_Set</span><span class="params">($iDevice)</span></span></span><br><span class="line">        <span class="keyword">Local</span> $brightness = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;BYTE[256]&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> $DISPLAY_BRIGHTNESS = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;BYTE[3]&quot;</span>)</span><br><span class="line">        $success = _WinAPI_DeviceIoControl($iDevice, $IOCTL_VIDEO_QUERY_SUPPORTED_BRIGHTNESS, <span class="literal">Null</span>, <span class="number">0</span>, <span class="built_in">DllStructGetPtr</span>($brightness), <span class="number">0xff</span>)</span><br><span class="line">        <span class="keyword">If</span> $success = <span class="literal">False</span> <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        $BRIGHTNESS_LCD_Array = Brightness_lcd(<span class="built_in">DllStructGetData</span>($brightness, <span class="number">1</span>))</span><br><span class="line">        $success = _WinAPI_DeviceIoControl($iDevice, $IOCTL_VIDEO_QUERY_DISPLAY_BRIGHTNESS, <span class="literal">Null</span>, <span class="number">0</span>, <span class="built_in">DllStructGetPtr</span>($DISPLAY_BRIGHTNESS), <span class="number">0x03</span>)</span><br><span class="line">        <span class="keyword">If</span> $success = <span class="literal">False</span> <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        $DISPLAY_BRIGHTNESS_READ = <span class="built_in">Int</span>(<span class="built_in">BinaryMid</span>(<span class="built_in">DllStructGetData</span>($DISPLAY_BRIGHTNESS, <span class="number">1</span>), <span class="number">3</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">        $Gui = <span class="built_in">GUICreate</span>(<span class="string">&quot;内置LCD显示器&quot;</span>, <span class="number">262</span>, <span class="number">80</span>, <span class="number">-1</span>, <span class="number">-1</span>)</span><br><span class="line">        <span class="built_in">GUISetOnEvent</span>($GUI_EVENT_CLOSE, <span class="string">&quot;_exit&quot;</span>)</span><br><span class="line">        $idSlider3 = <span class="built_in">GUICtrlCreateSlider</span>(<span class="number">10</span>, <span class="number">30</span>, <span class="number">240</span>, <span class="number">20</span>, <span class="built_in">BitOR</span>($TBS_TOOLTIPS, $TBS_AUTOTICKS))</span><br><span class="line">        <span class="built_in">GUICtrlSetLimit</span>($idSlider3, <span class="number">100</span>)</span><br><span class="line">        $idLabel3 = <span class="built_in">GUICtrlCreateLabel</span>(<span class="string">&quot;  亮度调节:&quot;</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">140</span>, <span class="number">20</span>)</span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idSlider3, $DISPLAY_BRIGHTNESS_READ)</span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idLabel3, <span class="string">&quot;设置亮度:&quot;</span> &amp; $DISPLAY_BRIGHTNESS_READ)</span><br><span class="line">        <span class="built_in">GUICtrlSetOnEvent</span>($idSlider3, <span class="string">&quot;Brightness_set_lcd&quot;</span>)</span><br><span class="line">        <span class="built_in">GUISetState</span>(<span class="symbol">@SW_SHOW</span>, $Gui)</span><br><span class="line">        <span class="built_in">WinSetTitle</span>($Gui, <span class="string">&quot;&quot;</span>, <span class="string">&quot;内置LCD显示器&quot;</span>)</span><br><span class="line">        <span class="keyword">While</span> <span class="number">1</span></span><br><span class="line">                <span class="built_in">Sleep</span>(<span class="number">50</span>)</span><br><span class="line">        <span class="keyword">WEnd</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;LCD_Set</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Brightness_set_lcd</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">Local</span> $lcd_BRIGHTNESS, $DISPLAY_BRIGHTNESS, $success</span><br><span class="line">        $lcd_BRIGHTNESS = <span class="built_in">GUICtrlRead</span>($idSlider3)</span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idLabel3, <span class="string">&quot;设置亮度:&quot;</span> &amp; $lcd_BRIGHTNESS)</span><br><span class="line">        <span class="keyword">For</span> $i = <span class="number">0</span> <span class="keyword">To</span> <span class="built_in">UBound</span>($BRIGHTNESS_LCD_Array)</span><br><span class="line">                <span class="keyword">If</span> $lcd_BRIGHTNESS &lt;= $BRIGHTNESS_LCD_Array[$i] <span class="keyword">Then</span></span><br><span class="line">                        $DISPLAY_BRIGHTNESS = <span class="built_in">DllStructCreate</span>($tag_DISPLAY_BRIGHTNESS)</span><br><span class="line">                        <span class="built_in">DllStructSetData</span>($DISPLAY_BRIGHTNESS, <span class="string">&quot;ucDisplayPolicy&quot;</span>, <span class="number">3</span>)</span><br><span class="line">                        <span class="built_in">DllStructSetData</span>($DISPLAY_BRIGHTNESS, <span class="string">&quot;ucACBrightness&quot;</span>, $BRIGHTNESS_LCD_Array[$i])</span><br><span class="line">                        <span class="built_in">DllStructSetData</span>($DISPLAY_BRIGHTNESS, <span class="string">&quot;ucDCBrightness&quot;</span>, $BRIGHTNESS_LCD_Array[$i])</span><br><span class="line">                        $success = _WinAPI_DeviceIoControl($hDevice, $IOCTL_VIDEO_SET_DISPLAY_BRIGHTNESS, <span class="built_in">DllStructGetPtr</span>($DISPLAY_BRIGHTNESS), <span class="built_in">DllStructGetSize</span>($DISPLAY_BRIGHTNESS), <span class="literal">Null</span>, <span class="number">0</span>)</span><br><span class="line">                        <span class="keyword">If</span> $success = <span class="literal">False</span> <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">                        <span class="keyword">ExitLoop</span></span><br><span class="line">                <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Brightness_set_lcd</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Select_Color</span><span class="params">($iValue)</span></span></span><br><span class="line">        <span class="keyword">Local</span> $String</span><br><span class="line">        <span class="keyword">If</span> <span class="built_in">StringIsXDigit</span>($iValue) <span class="keyword">Then</span> $iValue = <span class="built_in">Dec</span>($iValue)</span><br><span class="line">        <span class="keyword">Switch</span> $iValue</span><br><span class="line">                <span class="keyword">Case</span> <span class="number">1</span></span><br><span class="line">                        $String = <span class="string">&quot;sRGB&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">2</span></span><br><span class="line">                        $String = <span class="string">&quot;原生显示&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">3</span></span><br><span class="line">                        $String = <span class="string">&quot;4000K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">4</span></span><br><span class="line">                        $String = <span class="string">&quot;5000K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">5</span></span><br><span class="line">                        $String = <span class="string">&quot;6500K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">6</span></span><br><span class="line">                        $String = <span class="string">&quot;7500K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">7</span></span><br><span class="line">                        $String = <span class="string">&quot;8200K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">8</span></span><br><span class="line">                        $String = <span class="string">&quot;9300K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">9</span></span><br><span class="line">                        $String = <span class="string">&quot;10000K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">10</span></span><br><span class="line">                        $String = <span class="string">&quot;11500K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">11</span></span><br><span class="line">                        $String = <span class="string">&quot;User1&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">12</span></span><br><span class="line">                        $String = <span class="string">&quot;User2&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">13</span></span><br><span class="line">                        $String = <span class="string">&quot;User3&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="keyword">Else</span></span><br><span class="line">        <span class="keyword">EndSwitch</span></span><br><span class="line">        <span class="keyword">Return</span> $String</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Select_Color</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Color</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">Local</span> $iValue = <span class="built_in">GUICtrlRead</span>($Combo1)</span><br><span class="line">        <span class="keyword">Select</span></span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;sRGB&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x01</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;原生显示&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x02</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;4000K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x03</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;5000K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x04</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;6500K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x05</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;7500K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x06</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;8200K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x07</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;9300K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x08</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;10000K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x09</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;11500K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x0a</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;User1&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x0b</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;User2&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x0c</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;User3&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x0d</span>)</span><br><span class="line">                <span class="keyword">Case</span> <span class="keyword">Else</span></span><br><span class="line">        <span class="keyword">EndSelect</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Color</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Button1</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">Local</span> $VCPCode</span><br><span class="line">        <span class="keyword">If</span> $switch1 <span class="literal">And</span> $switch2 <span class="keyword">Then</span></span><br><span class="line">                $VCPCode = _GetVCPFeatureAndVCPFeatureReply($hMonitor, <span class="number">0x86</span>)</span><br><span class="line">                <span class="built_in">ConsoleWrite</span>($VCPCode[1] &amp; <span class="symbol">@CRLF</span>)</span><br><span class="line">                <span class="keyword">If</span> $VCPCode[1] = <span class="number">8</span> <span class="keyword">Then</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x86</span>, <span class="number">0x02</span>)</span><br><span class="line">                        <span class="built_in">GUICtrlSetData</span>($idButton1, <span class="string">&quot;窄屏&quot;</span>)</span><br><span class="line">                <span class="keyword">Else</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x86</span>, <span class="number">0x08</span>)</span><br><span class="line">                        <span class="built_in">GUICtrlSetData</span>($idButton1, <span class="string">&quot;宽屏&quot;</span>)</span><br><span class="line">                <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Button1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Button2</span><span class="params">()</span></span></span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idButton2, <span class="string">&quot;Reset..&quot;</span>)</span><br><span class="line">        <span class="built_in">Sleep</span>(<span class="number">250</span>)</span><br><span class="line">        <span class="built_in">GUISetState</span>(<span class="symbol">@SW_HIDE</span>)</span><br><span class="line">        <span class="keyword">If</span> $switch1 <span class="literal">Or</span> $switch2 <span class="keyword">Then</span></span><br><span class="line">                _RestoreMonitorFactoryDefaults($hMonitor)</span><br><span class="line">                <span class="built_in">Sleep</span>(<span class="number">1000</span>)</span><br><span class="line">        <span class="keyword">EndIf</span></span><br><span class="line">        _DestroyPhysicalMonitor($hMonitor) <span class="comment">;关闭监视器句柄</span></span><br><span class="line">        <span class="built_in">DllClose</span>($Dxva2)</span><br><span class="line">        <span class="keyword">Exit</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Button2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Brightness</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">If</span> <span class="literal">Not</span> $switch1 <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idLabel1, <span class="string">&quot;设置亮度:&quot;</span> &amp; <span class="built_in">GUICtrlRead</span>($idSlider1))</span><br><span class="line">        _SetMonitorBrightness($hMonitor, <span class="built_in">GUICtrlRead</span>($idSlider1))</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Brightness</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Contrast</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">If</span> <span class="literal">Not</span> $switch2 <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idLabel2, <span class="string">&quot;设置对比度:&quot;</span> &amp; <span class="built_in">GUICtrlRead</span>($idSlider2))</span><br><span class="line">        _SetMonitorContrast($hMonitor, <span class="built_in">GUICtrlRead</span>($idSlider2))</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Contrast</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_GetMonitorBrightness</span><span class="params">(Const $h_monitor)</span></span></span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $MinimumBrightness = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $CurrentBrightness = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $MaximumBrightness = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetMonitorBrightness&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $h_monitor, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MinimumBrightness), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($CurrentBrightness), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MaximumBrightness))</span><br><span class="line">        <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $brightness[3] = [<span class="built_in">DllStructGetData</span>($MinimumBrightness, <span class="number">1</span>), _</span><br><span class="line">                        <span class="built_in">DllStructGetData</span>($CurrentBrightness, <span class="number">1</span>), _</span><br><span class="line">                        <span class="built_in">DllStructGetData</span>($MaximumBrightness, <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">Return</span> $brightness</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_GetMonitorBrightness</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_GetMonitorContrast</span><span class="params">(Const $h_monitor)</span></span></span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $MinimumContrast = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $CurrentContrast = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $MaximumContrast = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetMonitorContrast&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $h_monitor, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MinimumContrast), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($CurrentContrast), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MaximumContrast))</span><br><span class="line">        <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $contrast[3] = [<span class="built_in">DllStructGetData</span>($MinimumContrast, <span class="number">1</span>), _</span><br><span class="line">                        <span class="built_in">DllStructGetData</span>($CurrentContrast, <span class="number">1</span>), _</span><br><span class="line">                        <span class="built_in">DllStructGetData</span>($MaximumContrast, <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">Return</span> $contrast</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_GetMonitorContrast</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_SetMonitorBrightness</span><span class="params">(Const $h_monitor, Const $NewBrightness)</span></span></span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;SetMonitorBrightness&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $h_monitor, <span class="string">&quot;dword&quot;</span>, $NewBrightness)</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span> ? <span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>) : <span class="literal">True</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_SetMonitorBrightness</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_SetMonitorContrast</span><span class="params">(Const $h_monitor, Const $contrast)</span></span></span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;SetMonitorContrast&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $h_monitor, <span class="string">&quot;dword&quot;</span>, $contrast)</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span> ? <span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>) : <span class="literal">True</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_SetMonitorContrast</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_GetPhysicalMonitorsFromHMONITOR</span><span class="params">(Const $pMonitor)</span></span></span><br><span class="line">        <span class="keyword">Local</span> $Number = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;DWORD&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> $i, $tagPhysical, $M = <span class="number">1</span></span><br><span class="line">        $Ret = <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetNumberOfPhysicalMonitorsFromHMONITOR&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $pMonitor, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($Number))</span><br><span class="line">        $NumberOfMonitors = <span class="built_in">DllStructGetData</span>($Number, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">For</span> $i = <span class="number">1</span> <span class="keyword">To</span> $NumberOfMonitors</span><br><span class="line">                $tagPhysical &amp;= $tagSTRUCT</span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">        $MonitorArray = <span class="built_in">DllStructCreate</span>($tagSTRUCT)</span><br><span class="line">        $Ret = <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetPhysicalMonitorsFromHMONITOR&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $pMonitor, _</span><br><span class="line">                        <span class="string">&quot;DWORD&quot;</span>, $NumberOfMonitors, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MonitorArray))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">Return</span> <span class="built_in">DllStructGetData</span>($MonitorArray, <span class="number">1</span>) <span class="comment">;返回第一个显示器句柄</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_GetPhysicalMonitorsFromHMONITOR</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">CapabilitiesRequestAndCapabilitiesReply</span><span class="params">(Const $h_monitor)</span></span></span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $tagStringLength = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetCapabilitiesStringLength&quot;</span>, <span class="string">&quot;handle&quot;</span>, $h_monitor, <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($tagStringLength))</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $CapabilitiesStringLength = <span class="built_in">DllStructGetData</span>($tagStringLength, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $CapabilitiesString = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;char[&quot;</span> &amp; $CapabilitiesStringLength &amp; <span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;CapabilitiesRequestAndCapabilitiesReply&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $h_monitor, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($CapabilitiesString), _</span><br><span class="line">                        <span class="string">&quot;dword&quot;</span>, <span class="built_in">DllStructGetSize</span>($CapabilitiesString))</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span>) ? (<span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)) : (<span class="built_in">DllStructGetData</span>($CapabilitiesString, <span class="number">1</span>))</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;CapabilitiesRequestAndCapabilitiesReply</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_RestoreMonitorFactoryDefaults</span><span class="params">(Const $h_monitor)</span></span></span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;RestoreMonitorFactoryDefaults&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $h_monitor)</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span>) ? (<span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)) : (<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_RestoreMonitorFactoryDefaults</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_SetVCPFeature</span><span class="params">(Const $h_monitor, Const $VCPCode, Const $NewValue)</span></span></span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;SetVCPFeature&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $h_monitor, _</span><br><span class="line">                        <span class="string">&quot;byte&quot;</span>, $VCPCode, _</span><br><span class="line">                        <span class="string">&quot;dword&quot;</span>, $NewValue)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span>) ? (<span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)) : (<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_SetVCPFeature</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_GetVCPFeatureAndVCPFeatureReply</span><span class="params">(Const $h_monitor, Const $VCPCode)</span></span></span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $CurrentValue = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $MaximumValue = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $VCPCodeType = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetVCPFeatureAndVCPFeatureReply&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $h_monitor, _</span><br><span class="line">                        <span class="string">&quot;byte&quot;</span>, $VCPCode, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($VCPCodeType), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($CurrentValue), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MaximumValue))</span><br><span class="line">        <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $VCPFeatureReply[3] = [<span class="built_in">DllStructGetData</span>($VCPCodeType, <span class="number">1</span>), <span class="built_in">DllStructGetData</span>($CurrentValue, <span class="number">1</span>), <span class="built_in">DllStructGetData</span>($MaximumValue, <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">Return</span> $VCPFeatureReply</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_GetVCPFeatureAndVCPFeatureReply</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Manage_vcp</span><span class="params">(Const $String)</span></span></span><br><span class="line">        <span class="keyword">Local</span> $Exp, $i, $tmp, $OUT_String</span><br><span class="line">        $Exp = <span class="built_in">StringRegExp</span>($String, <span class="string">&quot;(?&lt;=vcp\()([A-Za-z0-9]&#123;2&#125;[\)\(]?\s?)*(?=\))&quot;</span>, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        $Exp = <span class="built_in">StringRegExp</span>($Exp[0], <span class="string">&quot;([0-9A-Fa-f]&#123;2&#125;)(\(.+?\))?&quot;</span>, <span class="number">4</span>)</span><br><span class="line">        <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        <span class="keyword">Local</span> $Array[UBound($Exp)][<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">For</span> $i = <span class="number">0</span> <span class="keyword">To</span> <span class="built_in">UBound</span>($Exp) - <span class="number">1</span></span><br><span class="line">                $tmp = $Exp[$i]</span><br><span class="line">                $Array[$i][0] = <span class="built_in">StringStripWS</span>(<span class="built_in">StringLeft</span>($tmp[0], <span class="number">2</span>), <span class="number">8</span>)</span><br><span class="line">                $OUT_String = <span class="built_in">StringStripWS</span>(<span class="built_in">StringTrimLeft</span>($tmp[0], <span class="number">2</span>), <span class="number">3</span>)</span><br><span class="line">                <span class="keyword">If</span> $OUT_String &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">                        $OUT_String = <span class="built_in">StringTrimLeft</span>(<span class="built_in">StringTrimRight</span>($OUT_String, <span class="number">1</span>), <span class="number">1</span>)</span><br><span class="line">                        $Array[$i][1] = $OUT_String</span><br><span class="line">                <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">        <span class="keyword">Return</span> $Array</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Manage_vcp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_DestroyPhysicalMonitor</span><span class="params">(Const $h_monitor)</span></span></span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;DestroyPhysicalMonitor&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $h_monitor)</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span>) ? (<span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)) : (<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_DestroyPhysicalMonitor</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Brightness_lcd</span><span class="params">(Const $BRIGHTNESS_Lcd)</span></span></span><br><span class="line">        <span class="keyword">Local</span> $BRIGHTNESS_String, $tmp, $i</span><br><span class="line">        <span class="keyword">For</span> $i = <span class="number">1</span> <span class="keyword">To</span> <span class="built_in">BinaryLen</span>($BRIGHTNESS_Lcd)</span><br><span class="line">                $tmp = <span class="built_in">Int</span>(<span class="built_in">BinaryMid</span>($BRIGHTNESS_Lcd, $i, <span class="number">1</span>))</span><br><span class="line">                <span class="keyword">If</span> $i = <span class="number">1</span> <span class="keyword">Then</span></span><br><span class="line">                        $BRIGHTNESS_String &amp;= $tmp &amp; <span class="string">&quot;;&quot;</span></span><br><span class="line">                <span class="keyword">Else</span></span><br><span class="line">                        <span class="keyword">If</span> $tmp = <span class="number">0</span> <span class="keyword">Then</span> <span class="keyword">ExitLoop</span></span><br><span class="line">                        $BRIGHTNESS_String &amp;= $tmp &amp; <span class="string">&quot;;&quot;</span></span><br><span class="line">                <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">        <span class="keyword">Return</span> <span class="built_in">StringSplit</span>(<span class="built_in">StringTrimRight</span>($BRIGHTNESS_String, <span class="number">1</span>), <span class="string">&quot;;&quot;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Brightness_lcd</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_exit</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">If</span> $hDevice <span class="keyword">Then</span> _WinAPI_CloseHandle($hDevice)</span><br><span class="line">        _DestroyPhysicalMonitor($hMonitor) <span class="comment">;关闭监视器句柄</span></span><br><span class="line">        <span class="built_in">DllClose</span>($Dxva2)</span><br><span class="line">        <span class="keyword">Exit</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_exit</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> autoit源码 </tag>
            
            <tag> dxva2 </tag>
            
            <tag> 显示器设置 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网吧耳麦助手－设置主音量_麦克风音量_麦克风加强级别</title>
      <link href="/page/2203111529/"/>
      <url>/page/2203111529/</url>
      
        <content type="html"><![CDATA[<p>网吧耳麦助手是一款自动设置系统主音量，自动设置麦克风音量，自动设置麦克风加强级别，波形显示麦克风音量的软件！</p><p>可使用命令行运行，命令行无界面，运行后自动退出<br>参数一 为 允许/禁止所有声音效果 0为允许 1为禁止<br>参数二 为 设置主音量 取值范围为0-100<br>参数三 为 设置麦克风音量 取值范围为0-100<br>参数四 为 设置麦克风加强 取值范围为 0 10 20 30 40<br>例如 autosound.exe 1 100 100 30表示禁止所有声音效果，<br>主音量设置为100 麦克风音量为100 麦克风加强为30</p><p>运行本软件，看下面的麦克风检测的动态条，就可知麦克风是否正常!</p><p>本软件支持win7 win10 不支持winxp<br><img src="/images/wblmzs.gif" alt="网吧耳麦助手演示动画"></p><p>下载地址</p><p>链接: <a href="https://pan.baidu.com/s/1b5KCsTAPffjVh40SyUUuVw">https://pan.baidu.com/s/1b5KCsTAPffjVh40SyUUuVw</a> 提取码: sek6 复制这段内容后打开百度网盘手机App，操作更方便哦 解压密码 bnwin.com</p><p>加强版自动检测上报麦克风是否损坏，方便及时更换麦克风损坏的耳机，不用一台一台的试耳麦是否完好!</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>8圈计费系统9.5独立挂机_充值_换机_下机等功能工具-八圈挂机锁</title>
      <link href="/page/1816476569/"/>
      <url>/page/1816476569/</url>
      
        <content type="html"><![CDATA[<p>8圈计费系统独立挂机\充值\换机\下机等功能工具<br>适用于8圈 9.5版</p><p>2019-03-24 新增参数二支持</p><p>参数二为1，按8圈计费原生方式显示，为空或其他值，则直接显示功能界面!</p><p>如 8圈挂机.exe 1 1 表示按8圈计费原生方式显示下机!而 8圈挂机.exe 1 则直接显示下机界面，不会有8圈的主界面! 如 8圈挂机.exe 0 1 则按8圈计费原生方式显示挂机</p><p>参数 1 下机<br>参数 2 换机<br>参数 3 呼叫<br>参数 4 充值<br>参数 5 去上网<br>参数 6 商城<br>参数 7 聊天<br>参数 8 修改密码<br>参数 9 包时<br>不加参数或其他值 挂机<br><img src="/images/lock9.5.gif" alt=""></p><h2 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址:"></a>下载地址:</h2><p><a href="https://item.taobao.com/item.htm?ft=t&id=655874499629">点我开始下载</a></p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 八圈 </tag>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>单机游戏死亡阴影aardio内存修改器源码</title>
      <link href="/page/2891878490/"/>
      <url>/page/2891878490/</url>
      
        <content type="html"><![CDATA[<img src="/images/2012-2_2012216161145996090.jpg" alt="">aardio是专用于桌面软件快速开发的新一代混合型编程语言 – 具有动态语言轻便、灵活的特性，而且又可以同时支持静态类型开发，象静态语言那样使用。aardio可以直接支持原生DLL，即使是外部EXE进程中的函数，也可以使用一句代码声明为普通的aardio函数对象( 原生call支持 )，aardio支持非常多的标准调用约定，例如 stdcall，cdecl，thiscall，fastcall，regparm(n) 等调用约定都可以支持。aardio虽然小，但支持的接口很丰富、可以支持com静态动态双接口，象VBS一样原生支持com对象。<p>以下是使用aardio写的修改单机游戏死亡阴影3的游戏数据源码，仅供学习aardio使用!新建一个aardio代码文件，把下面代码复制到代码文件中，就可直接运行!</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> win.ui;</span><br><span class="line"><span class="keyword">import</span> process;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//声明变量hero3,jz</span></span><br><span class="line">var hero3,jz;</span><br><span class="line">hero3=process.find(<span class="string">&quot;Heroes3.exe&quot;</span>)</span><br><span class="line"><span class="keyword">if</span>(hero3)&#123;</span><br><span class="line">    <span class="comment">//把基址赋值给jz变量</span></span><br><span class="line">    jz=hero3.readNumber(<span class="number">0</span>x82B0BC)        </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    win.msgbox(<span class="string">&quot;请您先运行游戏&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*DSG&#123;&#123;*/</span></span><br><span class="line">var winform = win.form(text=<span class="string">&quot;死亡阴影修改器&quot;</span>;left=<span class="number">300</span>;right=<span class="number">440</span>;bottom=<span class="number">247</span>;max=<span class="literal">false</span>;parent=...)</span><br><span class="line">winform.add(</span><br><span class="line">button=&#123;cls=<span class="string">&quot;button&quot;</span>;text=<span class="string">&quot;修改&quot;</span>;left=<span class="number">33</span>;top=<span class="number">202</span>;right=<span class="number">105</span>;bottom=<span class="number">237</span>;z=<span class="number">1</span>&#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">/*&#125;&#125;*/</span></span><br><span class="line"> </span><br><span class="line">bqm = &#123; <span class="string">&quot;水晶：&quot;</span>;<span class="string">&quot;水银：&quot;</span>;<span class="string">&quot;石头：&quot;</span>;<span class="string">&quot;金钱：&quot;</span>;<span class="string">&quot;木材：&quot;</span>;<span class="string">&quot;宝石：&quot;</span>;<span class="string">&quot;硫磺：&quot;</span> &#125;</span><br><span class="line">py  = &#123; sj=Oxac;sy=Oxa0;st=Oxa4;jq=<span class="number">0</span>xb4;mc=Ox9c;bs=<span class="number">0</span>xb0;lh=Oxa8 &#125;</span><br><span class="line">bjk = &#123; <span class="string">&quot;sj&quot;</span>;<span class="string">&quot;sy&quot;</span>;<span class="string">&quot;st&quot;</span>;<span class="string">&quot;jq&quot;</span>;<span class="string">&quot;mc&quot;</span>;<span class="string">&quot;bs&quot;</span>;<span class="string">&quot;lh&quot;</span> &#125;</span><br><span class="line">tab = &#123; &#125;</span><br><span class="line"> </span><br><span class="line">winform.button.oncommand = <span class="built_in">function</span>(id,event)&#123; </span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;#bjk;<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(winform[<span class="string">&quot;edit_&quot;</span>+bjk[ i ]].text != <span class="number">0</span>&amp;&amp;winform[<span class="string">&quot;edit_&quot;</span>+bjk[ i ]].text !=<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">            table.push(tab,bjk[ i ])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;#tab;<span class="number">1</span>)&#123; </span><br><span class="line">        <span class="comment">//win.msgbox(winform[&quot;edit_&quot;+tab[ i ]].text,&quot;死亡阴影修改器&quot;)</span></span><br><span class="line">        hero3.writeNumber(jz+py[tab[ i ]],winform[<span class="string">&quot;edit_&quot;</span>+tab[ i ]].text)</span><br><span class="line">    &#125;</span><br><span class="line">    tab=&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">var topp = <span class="number">5</span></span><br><span class="line">var bott = <span class="number">25</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;#bqm;<span class="number">1</span>)&#123;</span><br><span class="line">    winform.add( [<span class="string">&quot;edit_&quot;</span>+bjk[ i ]]=&#123;num=<span class="number">1</span>;bottom=bott;text=<span class="string">&quot;999&quot;</span>;left=<span class="number">50</span>;top=topp;z=<span class="number">3</span>;right=<span class="number">114</span>;edge=<span class="number">1</span>;cls=<span class="string">&quot;edit&quot;</span> &#125;)</span><br><span class="line">    winform.add( [<span class="string">&quot;static&quot;</span>+i]=&#123; bottom=bott;right=<span class="number">52</span>;left=<span class="number">16</span>;text=bqm[ i ];top=topp;z=<span class="number">1</span>;transparent=<span class="number">1</span>;cls=<span class="string">&quot;static&quot;</span>&#125;)</span><br><span class="line">    topp+=<span class="number">24</span></span><br><span class="line">    bott+=<span class="number">24</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">winform.show() </span><br><span class="line">win.loopMessage();</span><br></pre></td></tr></table></figure><p>其中的基址0x82B0BC，及偏移量为什么是这个数据，就需要你使用ce自己分析了! 对aardio不熟悉可以查看在线手机 aardio使用手册</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基址查找方法 </tag>
            
            <tag> aardio源码 </tag>
            
            <tag> 内存修改方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>aardio的listview自绘源代码</title>
      <link href="/page/1712950360/"/>
      <url>/page/1712950360/</url>
      
        <content type="html"><![CDATA[<img src="/images/aardio.jpg" alt="">aardio的listview自绘源代码，在aardio新建一代码文件，复制下面的代码到代码文件中，直接运行就可以看到效果!<figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> win.ui;</span><br><span class="line"><span class="comment">/*DSG&#123;&#123;*/</span></span><br><span class="line">var winform = win.form(text=<span class="string">&quot;listview中添加进度条演示&quot;</span>;right=<span class="number">945</span>;bottom=<span class="number">474</span>)</span><br><span class="line">winform.add(</span><br><span class="line">button=&#123;cls=<span class="string">&quot;button&quot;</span>;text=<span class="string">&quot;(点击这里随机更新一次第二行的进度值)&quot;</span>;left=<span class="number">0</span>;top=<span class="number">392</span>;right=<span class="number">944</span>;bottom=<span class="number">472</span>;font=LOGFONT(h=-<span class="number">21</span>);z=<span class="number">2</span>&#125;;</span><br><span class="line">流程编辑框=&#123;cls=<span class="string">&quot;listview&quot;</span>;left=<span class="number">0</span>;top=<span class="number">0</span>;right=<span class="number">946</span>;bottom=<span class="number">384</span>;edge=<span class="number">1</span>;font=LOGFONT(h=-<span class="number">19</span>;name=<span class="string">&#x27;FontAwesome&#x27;</span>);fullRow=<span class="number">1</span>;vscroll=<span class="number">1</span>;z=<span class="number">1</span>&#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">/*&#125;&#125;*/</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> win.fontAwesome;</span><br><span class="line"><span class="keyword">import</span> win.graphics;</span><br><span class="line"><span class="keyword">import</span> win.imageList;</span><br><span class="line">var imagelist = win.imageList(<span class="number">5</span>,<span class="number">34</span>);</span><br><span class="line">winform.流程编辑框.setImageList( imagelist,<span class="number">1</span><span class="comment">/*_LVSIL_SMALL*/</span> );</span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;&quot;</span>,<span class="number">30</span>,,<span class="number">0</span>x2<span class="comment">/*_LVCFMT_CENTER*/</span>) </span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;中断&quot;</span>,<span class="number">80</span>,,<span class="number">0</span>x2<span class="comment">/*_LVCFMT_CENTER*/</span>) </span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;备注&quot;</span>,<span class="number">300</span>,,<span class="number">0</span>x0<span class="comment">/*_LVCFMT_LEFT*/</span>) </span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;功能&quot;</span>,<span class="number">100</span>,,<span class="number">0</span>x0<span class="comment">/*_LVCFMT_LEFT*/</span>)</span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;参数&quot;</span>,<span class="number">300</span>,,<span class="number">0</span>x0<span class="comment">/*_LVCFMT_LEFT*/</span>)</span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;&quot;</span>,<span class="number">30</span>,,<span class="number">0</span>x2<span class="comment">/*_LVCFMT_CENTER*/</span>)</span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;&quot;</span>,<span class="number">1</span>,,<span class="number">0</span>x2<span class="comment">/*_LVCFMT_CENTER*/</span>)</span><br><span class="line"><span class="comment">//自适应列宽度 </span></span><br><span class="line">winform.流程编辑框.adjust = <span class="built_in">function</span>(cx,cy)&#123;</span><br><span class="line">    winform.流程编辑框.fillParent(<span class="number">5</span><span class="comment">/*列序号*/</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">30</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=1000;[&quot;模式&quot;]=&quot;相对运动&quot;;[&quot;距离&quot;]=&quot;2380&quot;;[&quot;是否等待&quot;]=&quot;否&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00d&#x27;</span>;<span class="string">&#x27;\uF05e&#x27;</span>;<span class="number">100</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=300;[&quot;模式&quot;]=&quot;连续运动&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">200</span>;<span class="string">&quot;调用子程序&quot;</span>;<span class="string">&#x27;&#123;[&quot;调用子程序&quot;]=&quot;连续读传感器&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">50</span>;<span class="string">&quot;调用子程序&quot;</span>;<span class="string">&#x27;&#123;[&quot;调用子程序&quot;]=&quot;回字形对准算法&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">150</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=1000;[&quot;模式&quot;]=&quot;相对运动&quot;;[&quot;距离&quot;]=&quot;2380&quot;;[&quot;是否等待&quot;]=&quot;否&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">120</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=1000;[&quot;模式&quot;]=&quot;相对运动&quot;;[&quot;距离&quot;]=&quot;2380&quot;;[&quot;是否等待&quot;]=&quot;否&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00d&#x27;</span>;<span class="string">&#x27;\uF05e&#x27;</span>;<span class="number">10</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=300;[&quot;模式&quot;]=&quot;连续运动&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">70</span>;<span class="string">&quot;调用子程序&quot;</span>;<span class="string">&#x27;&#123;[&quot;调用子程序&quot;]=&quot;连续读传感器&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">260</span>;<span class="string">&quot;调用子程序&quot;</span>;<span class="string">&#x27;&#123;[&quot;调用子程序&quot;]=&quot;回字形对准算法&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">130</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=1000;[&quot;模式&quot;]=&quot;相对运动&quot;;[&quot;距离&quot;]=&quot;2380&quot;;[&quot;是否等待&quot;]=&quot;否&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line"> </span><br><span class="line"><span class="comment">//自绘</span></span><br><span class="line">winform.流程编辑框.onnotify = <span class="built_in">function</span>(id,code,ptr)&#123; </span><br><span class="line">        <span class="keyword">if</span>( code == <span class="number">0</span>xFFFFFFF4<span class="comment">/*_NM_CUSTOMDRAW*/</span> )&#123;</span><br><span class="line">                var lvcd = winform.流程编辑框.getNotifyCustomDraw(code,ptr);</span><br><span class="line">                <span class="keyword">if</span>( lvcd.nmcd.dwDrawStage == <span class="number">0</span>x10001<span class="comment">/*_CDDS_ITEMPREPAINT*/</span>)</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>x20<span class="comment">/*_CDRF_NOTIFYSUBITEMDRAW*/</span></span><br><span class="line">                elseif( lvcd.nmcd.dwDrawStage == <span class="number">1</span><span class="comment">/*_CDDS_PREPAINT*/</span> )&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>x20<span class="comment">/*_CDRF_NOTIFYITEMDRAW*/</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                elseif( lvcd.nmcd.dwDrawStage == ( <span class="number">0</span>x10001<span class="comment">/*_CDDS_ITEMPREPAINT*/</span> | <span class="number">0</span>x20000<span class="comment">/*_CDDS_SUBITEM*/</span>) )&#123; </span><br><span class="line">                        <span class="comment">//注意这里 iSubItem 的索引自0开始( 其他函数通常自1开始 )</span></span><br><span class="line">                        </span><br><span class="line">                        var cvs = win.graphics.canvas(); <span class="comment">// 创建一个画布</span></span><br><span class="line">                    cvs.fromHDC(lvcd.nmcd.hdc); <span class="comment">// 传入 hDC</span></span><br><span class="line">                    var nItem = lvcd.nmcd.dwItemSpec+<span class="number">1</span>;</span><br><span class="line">                    var nSubItem = lvcd.iSubItem;</span><br><span class="line">                    var rc = owner.getItemRect(nItem,nSubItem);</span><br><span class="line">                    <span class="keyword">if</span>(nSubItem == <span class="number">3</span>)&#123;</span><br><span class="line">                            </span><br><span class="line">                            var RetRc = ::RECT(rc.left+<span class="number">1</span>,rc.top+<span class="number">6</span>,rc.right-tonumber(owner.getItemText(nItem,<span class="number">3</span>)),rc.bottom-<span class="number">6</span>);</span><br><span class="line">                            cvs.brush.color = <span class="number">0</span>x00ff00;</span><br><span class="line">                            cvs.fillRect(RetRc)</span><br><span class="line">                                    </span><br><span class="line">                    &#125;</span><br><span class="line">                    cvs.pen.color = <span class="number">0</span>xebebeb; <span class="comment">// 定义画笔的颜色</span></span><br><span class="line">                    cvs.drawEdge(rc);</span><br><span class="line">                        </span><br><span class="line">                    lvcd.update()</span><br><span class="line">                    cvs.destroy();</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span><span class="comment">/*_CDRF_DODEFAULT*/</span></span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//演示更新进度</span></span><br><span class="line">winform.button.oncommand = <span class="built_in">function</span>(id,event)&#123;</span><br><span class="line">        winform.流程编辑框.setItemText(tostring(math.random(<span class="number">10</span>,<span class="number">280</span>)),<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">winform.show() </span><br><span class="line">win.loopMessage();</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> aardio源码 </tag>
            
            <tag> listview使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ApacheBench(ab)服务器负载压力测试软件</title>
      <link href="/page/2797625853/"/>
      <url>/page/2797625853/</url>
      
        <content type="html"><![CDATA[<p>ApacheBench(ab)使用简介<br>服务器负载太大而影响程序效率也是很常见的，Apache服务器自带有一个叫AB(ApacheBench)的工具，在bin目录下。使用这个轻巧的工具我们可以对服务器进行负载测试，</p><p>基本用法:</p><p>ab -n 全部请求数 -c 并发数 测试url<br>例；ab -n 100 -c 50 <a href="http://192.168.22.150:8088/gfmis/login">http://192.168.22.150:8088/gfmis/login</a></p><p><a href="http://19.104.10.79:8080/gfmis/login">http://19.104.10.79:8080/gfmis/login</a><br>例:ab -n 1000 -c 50 <a href="http://www.abc.com/a.php">http://www.abc.com/a.php</a></p><p>得到结果类似于(后面颜色字为中文翻译):</p><p>Server Software: Apache/2.0.55<br>Server Hostname: localhost<br>Server Port: 80</p><p>Document Path: /1.php<br>Document Length: 82522 bytes #请求文档大小</p><p>Concurrency Level: 50 #并发数<br>Time taken for tests: 92.76140 seconds #全部请求完成耗时<br>Complete requests: 10000 #全部请求数<br>Failed requests: 1974 #失败的请求<br>(Connect: 0, Length: 1974, Exceptions: 0)<br>Write errors: 0<br>Total transferred: 827019400 bytes #总传输大小<br>HTML transferred: 825219400 bytes<br>Requests per second: 108.61 [#/sec] (mean) #每秒请求数(平均)<br>Time per request: 460.381 [ms] (mean) #每次并发请求时间(所有并发)<br>Time per request: 9.208 [ms] (mean, across all concurrent requests) #每一请求时间(并发平均)<br>Transfer rate: 8771.39 [Kbytes/sec] received #传输速率</p><p>Connection Times (ms) #连接时间<br>min mean [+/-sd] median max<br>Connect(#连接): 0 0 2.1 0 46<br>Processing(#处理): 31 458 94.7 438 1078<br>Waiting(#等待): 15 437 87.5 422 938<br>Total: 31 458 94.7 438 1078</p><p>其它参数:</p><p>-n requests 全部请求数<br>-c concurrency 并发数<br>-t timelimit 最长等待回应时间<br>-p postfile POST数据文件<br>-T content-type POST Content-type<br>-v verbosity How much troubleshooting info to print<br>-w Print out results in HTML tables<br>-i Use HEAD instead of GET<br>-x attributes String to insert as table attributes<br>-y attributes String to insert as tr attributes<br>-z attributes String to insert as td or th attributes<br>-C attribute 加入cookie, eg. ‘Apache=1234. (repeatable)<br>-H attribute 加入http头, eg. ‘Accept-Encoding: gzip’<br>Inserted after all normal header lines. (repeatable)<br>-A attribute http验证,分隔传递用户名及密码<br>-P attribute Add Basic Proxy Authentication, the attributes<br>are a colon separated username and password.<br>-X proxy:port 代理服务器<br>-V 查看ab版本<br>-k Use HTTP KeepAlive feature<br>-d Do not show percentiles served table.<br>-S Do not show confidence estimators and warnings.<br>-g filename Output collected data to gnuplot format file.<br>-e filename Output CSV file with percentages served<br>-h Display usage information (this message)</p><p>看实际使用效果图<br><img src="/images/abtest.png" alt=""><br>下载地址：</p><p>链接: <a href="https://pan.baidu.com/s/1NjFciN9BRjwNGsVaiySrJg">https://pan.baidu.com/s/1NjFciN9BRjwNGsVaiySrJg</a> 提取码: 22be</p><p>解压密码 bnwin.com</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 精品软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TeamViewer_resetclientID重置PC端id源码</title>
      <link href="/page/2135361570/"/>
      <url>/page/2135361570/</url>
      
        <content type="html"><![CDATA[<p>如何重置TeamViewer的ID？我们先来了解一下什么是WMI,<br>WMI有一组API。我们不管使用VBScript、PowerShell脚本还是利用C#的来访问WMI的类库，都是因为WMI向外暴露的一组API。这些API是在系统安装WMI模块的时候安装的，通过他们我们能够能拿到我们想要的类。WMI有一个存储库。尽管WMI的多数实例数据都不存储在WMI中，但是WMI确实有一个存储库，用来存放提供程序提供的类信息，或者称为类的蓝图或者Schema。WMI有一个Service。WMI总是能够响应用户的访问，那是因为它有一个一直运行的Windows服务，名字叫Winmgmt。停止这个服务，所有对WMI的操作都将没有反应。WMI是可扩展的。人人都知道WMI能干很多事情，读取本机硬盘信息、读取远程计算机的用户信息、读取域用户信息等等。基本上，你能想到的获取或者更改资源的操作，它都能干。可谓吃得少，干得多。它为什么这么能干呢？这基于WMI的可扩展性。WMI对资源的操作，不是它自己实现了什么方法，而完全取决于向它注册的提供程序。</p><p>如何重置TeamViewer的ID？重置TeamViewer的ID的原理是什么，请看下面的源码<br>Autoit3源代码</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; </span></span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">; </span></span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">RequireAdmin</span></span></span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">; </span></span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_ProcessGetName</span><span class="params">($i_PID)</span></span></span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> <span class="built_in">ProcessExists</span>($i_PID) <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Local</span> $a_Processes = <span class="built_in">ProcessList</span>()</span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> <span class="symbol">@error</span> <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">For</span> $i = <span class="number">1</span> <span class="keyword">To</span> $a_Processes[0][0]</span><br><span class="line"><span class="keyword">If</span> $a_Processes[$i][1] = $i_PID <span class="keyword">Then</span> <span class="keyword">Return</span> $a_Processes[$i][0]</span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_ProcessGetPriority</span><span class="params">($vProcess)</span></span></span><br><span class="line"><span class="keyword">Local</span> $i_PID = <span class="built_in">ProcessExists</span>($vProcess)</span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> $i_PID <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Local</span> $hDLL = <span class="built_in">DllOpen</span>(<span class="string">&#x27;kernel32.dll&#x27;</span>)</span><br><span class="line"><span class="keyword">Local</span> $aProcessHandle = <span class="built_in">DllCall</span>($hDLL, <span class="string">&#x27;int&#x27;</span>, <span class="string">&#x27;OpenProcess&#x27;</span>, <span class="string">&#x27;int&#x27;</span>, <span class="number">0x0400</span>, <span class="string">&#x27;int&#x27;</span>, <span class="literal">False</span>, <span class="string">&#x27;int&#x27;</span>, $i_PID)</span><br><span class="line"><span class="keyword">Local</span> $aPriority = <span class="built_in">DllCall</span>($hDLL, <span class="string">&#x27;int&#x27;</span>, <span class="string">&#x27;GetPriorityClass&#x27;</span>, <span class="string">&#x27;int&#x27;</span>, $aProcessHandle[0])</span><br><span class="line"><span class="built_in">DllCall</span>($hDLL, <span class="string">&#x27;int&#x27;</span>, <span class="string">&#x27;CloseHandle&#x27;</span>, <span class="string">&#x27;int&#x27;</span>, $aProcessHandle[0])</span><br><span class="line"><span class="built_in">DllClose</span>($hDLL)</span><br><span class="line"><span class="keyword">Switch</span> $aPriority[0]</span><br><span class="line"><span class="keyword">Case</span> <span class="number">0x00000040</span></span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">Case</span> <span class="number">0x00004000</span></span><br><span class="line"><span class="keyword">Return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">Case</span> <span class="number">0x00000020</span></span><br><span class="line"><span class="keyword">Return</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">Case</span> <span class="number">0x00008000</span></span><br><span class="line"><span class="keyword">Return</span> <span class="number">3</span></span><br><span class="line"><span class="keyword">Case</span> <span class="number">0x00000080</span></span><br><span class="line"><span class="keyword">Return</span> <span class="number">4</span></span><br><span class="line"><span class="keyword">Case</span> <span class="number">0x00000100</span></span><br><span class="line"><span class="keyword">Return</span> <span class="number">5</span></span><br><span class="line"><span class="keyword">Case</span> <span class="keyword">Else</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">EndSwitch</span></span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_RunDOS</span><span class="params">($sCommand)</span></span></span><br><span class="line"><span class="keyword">Return</span> <span class="built_in">RunWait</span>(<span class="symbol">@ComSpec</span> &amp; <span class="string">&quot; /C &quot;</span> &amp; $sCommand, <span class="string">&quot;&quot;</span>, <span class="symbol">@SW_HIDE</span>)</span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">; </span></span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">; </span></span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_FileCountLines</span><span class="params">($sFilePath)</span></span></span><br><span class="line"><span class="keyword">Local</span> $N = <span class="built_in">FileGetSize</span>($sFilePath) - <span class="number">1</span></span><br><span class="line"><span class="keyword">If</span> <span class="symbol">@error</span> <span class="literal">Or</span> $N = <span class="number">-1</span> <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">Return</span> <span class="built_in">StringLen</span>(<span class="built_in">StringAddCR</span>(<span class="built_in">FileRead</span>($sFilePath, $N))) - $N + <span class="number">1</span></span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_FileCreate</span><span class="params">($sFilePath)</span></span></span><br><span class="line"><span class="keyword">Local</span> $hOpenFile</span><br><span class="line"><span class="keyword">Local</span> $hWriteFile</span><br><span class="line">$hOpenFile = <span class="built_in">FileOpen</span>($sFilePath, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">If</span> $hOpenFile = <span class="number">-1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line">$hWriteFile = <span class="built_in">FileWrite</span>($hOpenFile, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">If</span> $hWriteFile = <span class="number">-1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="built_in">FileClose</span>($hOpenFile)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_FileListToArray</span><span class="params">($sPath, $sFilter = <span class="string">&quot;*&quot;</span>, $iFlag = <span class="number">0</span>)</span></span></span><br><span class="line"><span class="keyword">Local</span> $hSearch, $sFile, $asFileList[1]</span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> <span class="built_in">FileExists</span>($sPath) <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="built_in">SetError</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">If</span> (<span class="built_in">StringInStr</span>($sFilter, <span class="string">&quot;\&quot;</span>)) <span class="literal">Or</span> (<span class="built_in">StringInStr</span>($sFilter, <span class="string">&quot;/&quot;</span>)) <span class="literal">Or</span> (<span class="built_in">StringInStr</span>($sFilter, <span class="string">&quot;:&quot;</span>)) <span class="literal">Or</span> (<span class="built_in">StringInStr</span>($sFilter, <span class="string">&quot;&gt;&quot;</span>)) <span class="literal">Or</span> (<span class="built_in">StringInStr</span>($sFilter, <span class="string">&quot;&lt;&quot;</span>)) <span class="literal">Or</span> (<span class="built_in">StringInStr</span>($sFilter, <span class="string">&quot;|&quot;</span>)) <span class="literal">Or</span> (<span class="built_in">StringStripWS</span>($sFilter, <span class="number">8</span>) = <span class="string">&quot;&quot;</span>) <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="built_in">SetError</span>(<span class="number">2</span>, <span class="number">2</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> ($iFlag = <span class="number">0</span> <span class="literal">Or</span> $iFlag = <span class="number">1</span> <span class="literal">Or</span> $iFlag = <span class="number">2</span>) <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="built_in">SetError</span>(<span class="number">3</span>, <span class="number">3</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">$hSearch = <span class="built_in">FileFindFirstFile</span>($sPath &amp; <span class="string">&quot;\&quot;</span> &amp; $sFilter)</span><br><span class="line"><span class="keyword">If</span> $hSearch = <span class="number">-1</span> <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="built_in">SetError</span>(<span class="number">4</span>, <span class="number">4</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">While</span> <span class="number">1</span></span><br><span class="line">$sFile = <span class="built_in">FileFindNextFile</span>($hSearch)</span><br><span class="line"><span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">ExitLoop</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">If</span> $iFlag = <span class="number">1</span> <span class="literal">And</span> <span class="built_in">StringInStr</span>(<span class="built_in">FileGetAttrib</span>($sPath &amp; <span class="string">&quot;\&quot;</span> &amp; $sFile), <span class="string">&quot;D&quot;</span>) &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span> <span class="keyword">ContinueLoop</span></span><br><span class="line"><span class="keyword">If</span> $iFlag = <span class="number">2</span> <span class="literal">And</span> <span class="built_in">StringInStr</span>(<span class="built_in">FileGetAttrib</span>($sPath &amp; <span class="string">&quot;\&quot;</span> &amp; $sFile), <span class="string">&quot;D&quot;</span>) = <span class="number">0</span> <span class="keyword">Then</span> <span class="keyword">ContinueLoop</span></span><br><span class="line"><span class="keyword">ReDim</span> $asFileList[UBound($asFileList) + <span class="number">1</span>]</span><br><span class="line">$asFileList[0] = $asFileList[0] + <span class="number">1</span></span><br><span class="line">$asFileList[UBound($asFileList) - <span class="number">1</span>] = $sFile</span><br><span class="line"><span class="keyword">WEnd</span></span><br><span class="line"><span class="built_in">FileClose</span>($hSearch)</span><br><span class="line"><span class="keyword">Return</span> $asFileList</span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_FilePrint</span><span class="params">($s_File, $i_Show = @SW_HIDE)</span></span></span><br><span class="line"><span class="keyword">Local</span> $a_Ret = <span class="built_in">DllCall</span>(<span class="string">&quot;shell32.dll&quot;</span>, <span class="string">&quot;long&quot;</span>, <span class="string">&quot;ShellExecute&quot;</span>, _</span><br><span class="line"><span class="string">&quot;hwnd&quot;</span>, <span class="number">0</span>, _</span><br><span class="line"><span class="string">&quot;string&quot;</span>, <span class="string">&quot;print&quot;</span>, _</span><br><span class="line"><span class="string">&quot;string&quot;</span>, $s_File, _</span><br><span class="line"><span class="string">&quot;string&quot;</span>, <span class="string">&quot;&quot;</span>, _</span><br><span class="line"><span class="string">&quot;string&quot;</span>, <span class="string">&quot;&quot;</span>, _</span><br><span class="line"><span class="string">&quot;int&quot;</span>, $i_Show)</span><br><span class="line"><span class="keyword">If</span> $a_Ret[0] &gt; <span class="number">32</span> <span class="literal">And</span> <span class="literal">Not</span> <span class="symbol">@error</span> <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">Return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line"><span class="built_in">SetError</span>($a_Ret[0])</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_FileReadToArray</span><span class="params">($sFilePath, ByRef $aArray)</span></span></span><br><span class="line"><span class="keyword">Local</span> $hFile</span><br><span class="line">$hFile = <span class="built_in">FileOpen</span>($sFilePath, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">If</span> $hFile = <span class="number">-1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line">$aArray = <span class="built_in">StringSplit</span>(<span class="built_in">StringStripCR</span>(<span class="built_in">FileRead</span>($hFile, <span class="built_in">FileGetSize</span>($sFilePath))), <span class="symbol">@LF</span>)</span><br><span class="line"><span class="built_in">FileClose</span>($hFile)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_FileWriteFromArray</span><span class="params">($sFilePath, $a_Array, $i_Base = <span class="number">0</span>, $i_UBound = <span class="number">0</span>)</span></span></span><br><span class="line"><span class="keyword">Local</span> $hFile</span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> <span class="built_in">IsArray</span>($a_Array) <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Local</span> $last = <span class="built_in">UBound</span>($a_Array) - <span class="number">1</span></span><br><span class="line"><span class="keyword">If</span> $i_UBound &lt; <span class="number">1</span> <span class="literal">Or</span> $i_UBound &gt; $last <span class="keyword">Then</span> $i_UBound = $last</span><br><span class="line"><span class="keyword">If</span> $i_Base &lt; <span class="number">0</span> <span class="literal">Or</span> $i_Base &gt; $last <span class="keyword">Then</span> $i_Base = <span class="number">0</span></span><br><span class="line">$hFile = <span class="built_in">FileOpen</span>($sFilePath, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">If</span> $hFile = <span class="number">-1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="built_in">FileWrite</span>($hFile, $a_Array[$i_Base])</span><br><span class="line"><span class="keyword">For</span> $x = $i_Base + <span class="number">1</span> <span class="keyword">To</span> $i_UBound</span><br><span class="line"><span class="built_in">FileWrite</span>($hFile, <span class="symbol">@CRLF</span> &amp; $a_Array[$x])</span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"><span class="built_in">FileClose</span>($hFile)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_FileWriteLog</span><span class="params">($sLogPath, $sLogMsg)</span></span></span><br><span class="line"><span class="keyword">Local</span> $sDateNow</span><br><span class="line"><span class="keyword">Local</span> $sTimeNow</span><br><span class="line"><span class="keyword">Local</span> $sMsg</span><br><span class="line"><span class="keyword">Local</span> $hOpenFile</span><br><span class="line"><span class="keyword">Local</span> $hWriteFile</span><br><span class="line">$sDateNow = <span class="symbol">@YEAR</span> &amp; <span class="string">&quot;-&quot;</span> &amp; <span class="symbol">@MON</span> &amp; <span class="string">&quot;-&quot;</span> &amp; <span class="symbol">@MDAY</span></span><br><span class="line">$sTimeNow = <span class="symbol">@HOUR</span> &amp; <span class="string">&quot;:&quot;</span> &amp; <span class="symbol">@MIN</span> &amp; <span class="string">&quot;:&quot;</span> &amp; <span class="symbol">@SEC</span></span><br><span class="line">$sMsg = $sDateNow &amp; <span class="string">&quot; &quot;</span> &amp; $sTimeNow &amp; <span class="string">&quot; : &quot;</span> &amp; $sLogMsg</span><br><span class="line">$hOpenFile = <span class="built_in">FileOpen</span>($sLogPath, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">If</span> $hOpenFile = <span class="number">-1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line">$hWriteFile = <span class="built_in">FileWriteLine</span>($hOpenFile, $sMsg)</span><br><span class="line"><span class="keyword">If</span> $hWriteFile = <span class="number">-1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="built_in">FileClose</span>($hOpenFile)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_FileWriteToLine</span><span class="params">($sFile, $iLine, $sText, $fOverWrite = <span class="number">0</span>)</span></span></span><br><span class="line"><span class="keyword">If</span> $iLine &lt;= <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> <span class="built_in">IsString</span>($sText) <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">6</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">If</span> $fOverWrite &lt;&gt; <span class="number">0</span> <span class="literal">And</span> $fOverWrite &lt;&gt; <span class="number">1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> <span class="built_in">FileExists</span>($sFile) <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Local</span> $filtxt = <span class="built_in">FileRead</span>($sFile, <span class="built_in">FileGetSize</span>($sFile))</span><br><span class="line">$filtxt = <span class="built_in">StringSplit</span>($filtxt, <span class="symbol">@CRLF</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">If</span> <span class="built_in">UBound</span>($filtxt, <span class="number">1</span>) &lt; $iLine <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Local</span> $fil = <span class="built_in">FileOpen</span>($sFile, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">If</span> $fil = <span class="number">-1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">For</span> $i = <span class="number">1</span> <span class="keyword">To</span> <span class="built_in">UBound</span>($filtxt) - <span class="number">1</span></span><br><span class="line"><span class="keyword">If</span> $i = $iLine <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">If</span> $fOverWrite = <span class="number">1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">If</span> $sText &lt;&gt; <span class="string">&#x27;&#x27;</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">FileWrite</span>($fil, $sText &amp; <span class="symbol">@CRLF</span>)</span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line"><span class="built_in">FileWrite</span>($fil, $sText)</span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">If</span> $fOverWrite = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">FileWrite</span>($fil, $sText &amp; <span class="symbol">@CRLF</span>)</span><br><span class="line"><span class="built_in">FileWrite</span>($fil, $filtxt[$i] &amp; <span class="symbol">@CRLF</span>)</span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">ElseIf</span> $i &lt; <span class="built_in">UBound</span>($filtxt, <span class="number">1</span>) - <span class="number">1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">FileWrite</span>($fil, $filtxt[$i] &amp; <span class="symbol">@CRLF</span>)</span><br><span class="line"><span class="keyword">ElseIf</span> $i = <span class="built_in">UBound</span>($filtxt, <span class="number">1</span>) - <span class="number">1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">FileWrite</span>($fil, $filtxt[$i])</span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"><span class="built_in">FileClose</span>($fil)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_PathFull</span><span class="params">($sRelativePath, $sBasePath = @WorkingDir)</span></span></span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> $sRelativePath <span class="literal">Or</span> $sRelativePath = <span class="string">&quot;.&quot;</span> <span class="keyword">Then</span> <span class="keyword">Return</span> $sBasePath</span><br><span class="line"><span class="keyword">Local</span> $sFullPath = <span class="built_in">StringReplace</span>($sRelativePath, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;\&quot;</span>)</span><br><span class="line"><span class="keyword">Local</span> $sPath = <span class="built_in">StringLeft</span>($sFullPath, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">StringReplace</span>($sFullPath, <span class="string">&quot;\&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">If</span> <span class="symbol">@extended</span> = <span class="built_in">StringLen</span>($sFullPath) <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="built_in">StringLeft</span>($sBasePath, <span class="number">2</span>) &amp; <span class="string">&quot;\&quot;</span></span><br><span class="line"><span class="keyword">If</span> <span class="built_in">StringLeft</span>($sFullPath, <span class="number">1</span>) = <span class="string">&quot;\&quot;</span> <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">If</span> $sPath = <span class="string">&quot;\\&quot;</span> <span class="keyword">Then</span></span><br><span class="line">$sFullPath = <span class="built_in">StringTrimLeft</span>($sFullPath, <span class="number">2</span>)</span><br><span class="line">$sPath &amp;= <span class="built_in">StringLeft</span>($sFullPath, <span class="built_in">StringInStr</span>($sFullPath, <span class="string">&quot;\&quot;</span>) - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">$sPath = <span class="built_in">StringLeft</span>($sBasePath, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">ElseIf</span> <span class="literal">Not</span> <span class="built_in">StringInStr</span>($sPath, <span class="string">&quot;:&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">$sFullPath = $sBasePath &amp; <span class="string">&quot;\&quot;</span> &amp; $sFullPath</span><br><span class="line">$sPath = <span class="built_in">StringLeft</span>($sBasePath, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Local</span> $aTemp = <span class="built_in">StringSplit</span>($sFullPath, <span class="string">&quot;\&quot;</span>)</span><br><span class="line"><span class="keyword">Local</span> $aPathParts[$aTemp[0]], $j = <span class="number">0</span></span><br><span class="line"><span class="keyword">For</span> $i = <span class="number">2</span> <span class="keyword">To</span> $aTemp[0]</span><br><span class="line"><span class="keyword">If</span> $aTemp[$i] = <span class="string">&quot;..&quot;</span> <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">If</span> $j <span class="keyword">Then</span> $j -= <span class="number">1</span></span><br><span class="line"><span class="keyword">ElseIf</span> <span class="literal">Not</span> ($aTemp[$i] = <span class="string">&quot;&quot;</span> <span class="literal">And</span> $i &lt;&gt; $aTemp[0]) <span class="literal">And</span> $aTemp[$i] &lt;&gt; <span class="string">&quot;.&quot;</span> <span class="keyword">Then</span></span><br><span class="line">$aPathParts[$j] = $aTemp[$i]</span><br><span class="line">$j += <span class="number">1</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line">$sFullPath = $sPath</span><br><span class="line"><span class="keyword">For</span> $i = <span class="number">0</span> <span class="keyword">To</span> $j - <span class="number">1</span></span><br><span class="line">$sFullPath &amp;= <span class="string">&quot;\&quot;</span> &amp; $aPathParts[$i]</span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"><span class="keyword">While</span> <span class="built_in">StringInStr</span>($sFullPath, <span class="string">&quot;.\&quot;</span>)</span><br><span class="line">$sFullPath = <span class="built_in">StringReplace</span>($sFullPath, <span class="string">&quot;.\&quot;</span>, <span class="string">&quot;\&quot;</span>)</span><br><span class="line"><span class="keyword">WEnd</span></span><br><span class="line"><span class="keyword">Return</span> $sFullPath</span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_PathMake</span><span class="params">($szDrive, $szDir, $szFName, $szExt)</span></span></span><br><span class="line"><span class="keyword">Local</span> $szFullPath</span><br><span class="line"><span class="keyword">If</span> <span class="built_in">StringLen</span>($szDrive) <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> (<span class="built_in">StringLeft</span>($szDrive, <span class="number">2</span>) = <span class="string">&quot;\\&quot;</span>) <span class="keyword">Then</span> $szDrive = <span class="built_in">StringLeft</span>($szDrive, <span class="number">1</span>) &amp; <span class="string">&quot;:&quot;</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">If</span> <span class="built_in">StringLen</span>($szDir) <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> (<span class="built_in">StringRight</span>($szDir, <span class="number">1</span>) = <span class="string">&quot;\&quot;</span>) <span class="literal">And</span> <span class="literal">Not</span> (<span class="built_in">StringRight</span>($szDir, <span class="number">1</span>) = <span class="string">&quot;/&quot;</span>) <span class="keyword">Then</span> $szDir = $szDir &amp; <span class="string">&quot;\&quot;</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">If</span> <span class="built_in">StringLen</span>($szExt) <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> (<span class="built_in">StringLeft</span>($szExt, <span class="number">1</span>) = <span class="string">&quot;.&quot;</span>) <span class="keyword">Then</span> $szExt = <span class="string">&quot;.&quot;</span> &amp; $szExt</span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line">$szFullPath = $szDrive &amp; $szDir &amp; $szFName &amp; $szExt</span><br><span class="line"><span class="keyword">Return</span> $szFullPath</span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_PathSplit</span><span class="params">($szPath, ByRef $szDrive, ByRef $szDir, ByRef $szFName, ByRef $szExt)</span></span></span><br><span class="line"><span class="keyword">Local</span> $drive = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">Local</span> $dir = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">Local</span> $fname = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">Local</span> $ext = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">Local</span> $pos</span><br><span class="line"><span class="keyword">Local</span> $array[5]</span><br><span class="line">$array[0] = $szPath</span><br><span class="line"><span class="keyword">If</span> <span class="built_in">StringMid</span>($szPath, <span class="number">2</span>, <span class="number">1</span>) = <span class="string">&quot;:&quot;</span> <span class="keyword">Then</span></span><br><span class="line">$drive = <span class="built_in">StringLeft</span>($szPath, <span class="number">2</span>)</span><br><span class="line">$szPath = <span class="built_in">StringTrimLeft</span>($szPath, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">ElseIf</span> <span class="built_in">StringLeft</span>($szPath, <span class="number">2</span>) = <span class="string">&quot;\\&quot;</span> <span class="keyword">Then</span></span><br><span class="line">$szPath = <span class="built_in">StringTrimLeft</span>($szPath, <span class="number">2</span>)</span><br><span class="line">$pos = <span class="built_in">StringInStr</span>($szPath, <span class="string">&quot;\&quot;</span>)</span><br><span class="line"><span class="keyword">If</span> $pos = <span class="number">0</span> <span class="keyword">Then</span> $pos = <span class="built_in">StringInStr</span>($szPath, <span class="string">&quot;/&quot;</span>)</span><br><span class="line"><span class="keyword">If</span> $pos = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">$drive = <span class="string">&quot;\\&quot;</span> &amp; $szPath</span><br><span class="line">$szPath = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">$drive = <span class="string">&quot;\\&quot;</span> &amp; <span class="built_in">StringLeft</span>($szPath, $pos - <span class="number">1</span>)</span><br><span class="line">$szPath = <span class="built_in">StringTrimLeft</span>($szPath, $pos - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Local</span> $nPosForward = <span class="built_in">StringInStr</span>($szPath, <span class="string">&quot;/&quot;</span>, <span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line"><span class="keyword">Local</span> $nPosBackward = <span class="built_in">StringInStr</span>($szPath, <span class="string">&quot;\&quot;</span>, <span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line"><span class="keyword">If</span> $nPosForward &gt;= $nPosBackward <span class="keyword">Then</span></span><br><span class="line">$pos = $nPosForward</span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">$pos = $nPosBackward</span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line">$dir = <span class="built_in">StringLeft</span>($szPath, $pos)</span><br><span class="line">$fname = <span class="built_in">StringRight</span>($szPath, <span class="built_in">StringLen</span>($szPath) - $pos)</span><br><span class="line"><span class="keyword">If</span> <span class="built_in">StringLen</span>($dir) = <span class="number">0</span> <span class="keyword">Then</span> $fname = $szPath</span><br><span class="line">$pos = <span class="built_in">StringInStr</span>($fname, <span class="string">&quot;.&quot;</span>, <span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line"><span class="keyword">If</span> $pos <span class="keyword">Then</span></span><br><span class="line">$ext = <span class="built_in">StringRight</span>($fname, <span class="built_in">StringLen</span>($fname) - ($pos - <span class="number">1</span>))</span><br><span class="line">$fname = <span class="built_in">StringLeft</span>($fname, $pos - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line">$szDrive = $drive</span><br><span class="line">$szDir = $dir</span><br><span class="line">$szFName = $fname</span><br><span class="line">$szExt = $ext</span><br><span class="line">$array[1] = $drive</span><br><span class="line">$array[2] = $dir</span><br><span class="line">$array[3] = $fname</span><br><span class="line">$array[4] = $ext</span><br><span class="line"><span class="keyword">Return</span> $array</span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_ReplaceStringInFile</span><span class="params">($szFileName, $szSearchString, $szReplaceString, $fCaseness = <span class="number">0</span>, $fOccurance = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="keyword">Local</span> $iRetVal = <span class="number">0</span></span><br><span class="line"><span class="keyword">Local</span> $szTempFile, $hWriteHandle, $aFileLines, $nCount, $sEndsWith, $hFile</span><br><span class="line"><span class="keyword">If</span> <span class="built_in">StringInstr</span>(<span class="built_in">FileGetAttrib</span>($szFileName),<span class="string">&quot;R&quot;</span>) <span class="keyword">then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">6</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line">$hFile = <span class="built_in">FileOpen</span>($szFileName, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">If</span> $hFile = <span class="number">-1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Local</span> $s_TotFile = <span class="built_in">FileRead</span>($hFile, <span class="built_in">FileGetSize</span>($szFileName))</span><br><span class="line"><span class="keyword">If</span> <span class="built_in">StringRight</span>($s_TotFile, <span class="number">2</span>) = <span class="symbol">@CRLF</span> <span class="keyword">Then</span></span><br><span class="line">$sEndsWith = <span class="symbol">@CRLF</span></span><br><span class="line"><span class="keyword">ElseIf</span> <span class="built_in">StringRight</span>($s_TotFile, <span class="number">1</span>) = <span class="symbol">@CR</span> <span class="keyword">Then</span></span><br><span class="line">$sEndsWith = <span class="symbol">@CR</span></span><br><span class="line"><span class="keyword">ElseIf</span> <span class="built_in">StringRight</span>($s_TotFile, <span class="number">1</span>) = <span class="symbol">@LF</span> <span class="keyword">Then</span></span><br><span class="line">$sEndsWith = <span class="symbol">@LF</span></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">$sEndsWith = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line">$aFileLines = <span class="built_in">StringSplit</span>(<span class="built_in">StringStripCR</span>($s_TotFile), <span class="symbol">@LF</span>)</span><br><span class="line"><span class="built_in">FileClose</span>($hFile)</span><br><span class="line">$szTempFile = _TempFile()</span><br><span class="line">$hWriteHandle = <span class="built_in">FileOpen</span>($szTempFile, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">If</span> $hWriteHandle = <span class="number">-1</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">For</span> $nCount = <span class="number">1</span> <span class="keyword">To</span> $aFileLines[0]</span><br><span class="line"><span class="keyword">If</span> <span class="built_in">StringInStr</span>($aFileLines[$nCount], $szSearchString, $fCaseness) <span class="keyword">Then</span></span><br><span class="line">$aFileLines[$nCount] = <span class="built_in">StringReplace</span>($aFileLines[$nCount], $szSearchString, $szReplaceString, <span class="number">1</span> - $fOccurance, $fCaseness)</span><br><span class="line">$iRetVal = $iRetVal + <span class="number">1</span></span><br><span class="line"><span class="keyword">If</span> $fOccurance = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">$iRetVal = <span class="number">1</span></span><br><span class="line"><span class="keyword">ExitLoop</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"><span class="keyword">For</span> $nCount = <span class="number">1</span> <span class="keyword">To</span> $aFileLines[0] - <span class="number">1</span></span><br><span class="line"><span class="keyword">If</span> <span class="built_in">FileWriteLine</span>($hWriteHandle, $aFileLines[$nCount]) = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">FileClose</span>($hWriteHandle)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"><span class="keyword">If</span> $aFileLines[$nCount] &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> <span class="built_in">FileWrite</span>($hWriteHandle, $aFileLines[$nCount] &amp; $sEndsWith)</span><br><span class="line"><span class="built_in">FileClose</span>($hWriteHandle)</span><br><span class="line"><span class="keyword">If</span> <span class="built_in">FileDelete</span>($szFileName) = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">If</span> <span class="built_in">FileMove</span>($szTempFile, $szFileName) = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line"><span class="built_in">SetError</span>(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">Return</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">Return</span> $iRetVal</span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_TempFile</span><span class="params">($s_DirectoryName = @TempDir, $s_FilePrefix = <span class="string">&quot;~&quot;</span>, $s_FileExtension = <span class="string">&quot;.tmp&quot;</span>, $i_RandomLength = <span class="number">7</span>)</span></span></span><br><span class="line"><span class="keyword">Local</span> $s_TempName</span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> <span class="built_in">FileExists</span>($s_DirectoryName) <span class="keyword">Then</span> $s_DirectoryName = <span class="symbol">@TempDir</span></span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> <span class="built_in">FileExists</span>($s_DirectoryName) <span class="keyword">Then</span> $s_DirectoryName = <span class="symbol">@ScriptDir</span></span><br><span class="line"><span class="keyword">If</span> <span class="built_in">StringRight</span>($s_DirectoryName, <span class="number">1</span>) &lt;&gt; <span class="string">&quot;\&quot;</span> <span class="keyword">Then</span> $s_DirectoryName = $s_DirectoryName &amp; <span class="string">&quot;\&quot;</span></span><br><span class="line"><span class="keyword">Do</span></span><br><span class="line">$s_TempName = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">While</span> <span class="built_in">StringLen</span>($s_TempName) &lt; $i_RandomLength</span><br><span class="line">$s_TempName = $s_TempName &amp; <span class="built_in">Chr</span>(<span class="built_in">Random</span>(<span class="number">97</span>, <span class="number">122</span>, <span class="number">1</span>))</span><br><span class="line"><span class="keyword">WEnd</span></span><br><span class="line">$s_TempName = $s_DirectoryName &amp; $s_FilePrefix &amp; $s_TempName &amp; $s_FileExtension</span><br><span class="line"><span class="keyword">Until</span> <span class="literal">Not</span> <span class="built_in">FileExists</span>($s_TempName)</span><br><span class="line"><span class="keyword">Return</span> ($s_TempName)</span><br><span class="line"><span class="keyword">EndFunc</span></span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">; </span></span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br><span class="line"> <span class="keyword">If</span> <span class="built_in">WinExists</span>(<span class="symbol">@ScriptName</span>) <span class="keyword">Then</span> <span class="keyword">Exit</span></span><br><span class="line"> <span class="built_in">AutoItWinSetTitle</span>(<span class="symbol">@ScriptName</span>)</span><br><span class="line"> <span class="built_in">AutoItSetOption</span>(<span class="string">&quot;TrayIconHide&quot;</span>, <span class="number">1</span>)</span><br><span class="line"> <span class="built_in">AutoItSetOption</span>(<span class="string">&quot;MouseCoordMode&quot;</span>, <span class="number">0</span>)</span><br><span class="line"> <span class="keyword">If</span> <span class="built_in">ProcessExists</span>(<span class="string">&quot;TeamViewer_Service.exe&quot;</span>) <span class="keyword">Then</span></span><br><span class="line"> <span class="built_in">RunWait</span>(<span class="symbol">@ComSpec</span> &amp; <span class="string">&quot; /C net stop TeamViewer&quot;</span>,<span class="string">&quot;&quot;</span>, <span class="symbol">@SW_HIDE</span>)</span><br><span class="line"> <span class="keyword">EndIf</span></span><br><span class="line"> <span class="keyword">If</span> <span class="built_in">ProcessExists</span>(<span class="string">&quot;TeamViewer.exe&quot;</span>) <span class="keyword">Then</span></span><br><span class="line"> <span class="built_in">ProcessClose</span>(<span class="string">&quot;TeamViewer.exe&quot;</span>)</span><br><span class="line"> <span class="keyword">EndIf</span></span><br><span class="line"> <span class="built_in">RegDelete</span>(<span class="string">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\TeamViewer&quot;</span>, <span class="string">&quot;ClientID&quot;</span>)</span><br><span class="line"> <span class="keyword">Local</span> $iRc = _RunDos(<span class="string">&quot;wmic class Win33_ComputerSystemProduct delete&quot;</span>)</span><br><span class="line"> $VBSFile = <span class="symbol">@ScriptDir</span>&amp;<span class="string">&#x27;\source.vbs&#x27;</span></span><br><span class="line"> <span class="keyword">If</span> <span class="literal">Not</span> <span class="built_in">FileExists</span>($VBSFile) <span class="keyword">Then</span> _FileCreate($VBSFile)</span><br><span class="line"> <span class="built_in">FileSetAttrib</span>(<span class="symbol">@ScriptDir</span>&amp;<span class="string">&#x27;\source.vbs&#x27;</span>, <span class="string">&quot;+H&quot;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;intHighNumber = 99999&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;intLowNumber = 10000&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;intNumbers = 1&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27; Randomize&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27; intNumber = Int((intHighNumber - intLowNumber + 1) * Rnd + intLowNumber)&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;strnum = &quot;01234567-8910-ABCD-1111-093F03C&quot;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;strnum = strnum &amp; Cstr(intNumber)&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;Set oLocation = CreateObject(&quot;WbemScripting.SWbemLocator&quot;)&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;Set oServices = oLocation.ConnectServer(, &quot;root\cimv2&quot;)&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;Set FakeClass = oServices.Get&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Path_.Class = &quot;Win33_ComputerSystemProduct&quot;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Properties_.add &quot;Caption&quot;, 8&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Properties_.add &quot;Description&quot;, 8&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Properties_.add &quot;IdentifyingNumber&quot;, 8&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Properties_.add &quot;Name&quot;, 8&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Properties_.add &quot;SKUNumber&quot;, 8&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Properties_.add &quot;UUID&quot;, 8&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Properties_.add &quot;Vendor&quot;, 8&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Properties_.add &quot;Version&quot;, 8&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Properties_(&quot;Name&quot;).Qualifiers_.add &quot;key&quot;, false&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Put_&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;Set FakeClass = GetObject(&quot;Winmgmts:root\cimv2:Win33_ComputerSystemProduct&quot;).SpawnInstance_&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Caption = &quot;http://www.teamviewer.com&quot;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Description = &quot;class for teamviewer&quot;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.IdentifyingNumber = &quot;www.teamviewer.com&quot;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Name = &quot;Teamviewer&quot;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.SKUNumber = &quot;&quot;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.UUID = strnum&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Vendor = &quot;Teamviewer&quot;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Version = &quot;6.x&quot;&#x27;</span>)</span><br><span class="line"> <span class="built_in">FileWriteLine</span> (<span class="string">&#x27;source.vbs&#x27;</span>, <span class="string">&#x27;FakeClass.Put_&#x27;</span>)</span><br><span class="line"> <span class="built_in">ShellExecute</span> (<span class="string">&quot;source.vbs&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;open&quot;</span>)</span><br><span class="line"> <span class="built_in">Sleep</span>(<span class="number">500</span>)</span><br><span class="line"> <span class="built_in">FileDelete</span>(<span class="symbol">@ScriptDir</span>&amp;<span class="string">&#x27;\source.vbs&#x27;</span>)</span><br><span class="line"> <span class="built_in">RunWait</span>(<span class="symbol">@ComSpec</span> &amp; <span class="string">&quot; /C net start TeamViewer&quot;</span>,<span class="string">&quot;&quot;</span>, <span class="symbol">@SW_HIDE</span>)</span><br><span class="line"> <span class="built_in">Run</span>(<span class="symbol">@ScriptDir</span>&amp;<span class="string">&#x27;\TeamViewer.exe&#x27;</span>)</span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">; </span></span><br><span class="line"><span class="comment">; ----------------------------------------------------------------------------</span></span><br></pre></td></tr></table></figure><h3 id="其中关键的source-vbs代码"><a href="#其中关键的source-vbs代码" class="headerlink" title="其中关键的source.vbs代码"></a>其中关键的source.vbs代码</h3><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">intHighNumber = <span class="number">99999</span></span><br><span class="line"> </span><br><span class="line">intLowNumber = <span class="number">10000</span></span><br><span class="line"> </span><br><span class="line">intNumbers = <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"> Randomize</span><br><span class="line"> </span><br><span class="line"> intNumber = Int((intHighNumber - intLowNumber + <span class="number">1</span>) * Rnd + intLowNumber)</span><br><span class="line"> </span><br><span class="line">strnum = <span class="string">&quot;01234567-8910-ABCD-1111-093F03C&quot;</span></span><br><span class="line">strnum = strnum &amp; <span class="built_in">Cstr</span>(intNumber)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">Set</span> oLocation = CreateObject(<span class="string">&quot;WbemScripting.SWbemLocator&quot;</span>)</span><br><span class="line"><span class="keyword">Set</span> oServices = oLocation.ConnectServer(, <span class="string">&quot;root\cimv2&quot;</span>)</span><br><span class="line"><span class="keyword">Set</span> FakeClass = oServices.<span class="keyword">Get</span></span><br><span class="line"> </span><br><span class="line">FakeClass.Path_.<span class="keyword">Class</span> = <span class="string">&quot;Win33_ComputerSystemProduct&quot;</span></span><br><span class="line"> </span><br><span class="line">FakeClass.Properties_.add <span class="string">&quot;Caption&quot;</span>, <span class="number">8</span></span><br><span class="line">FakeClass.Properties_.add <span class="string">&quot;Description&quot;</span>, <span class="number">8</span></span><br><span class="line">FakeClass.Properties_.add <span class="string">&quot;IdentifyingNumber&quot;</span>, <span class="number">8</span></span><br><span class="line">FakeClass.Properties_.add <span class="string">&quot;Name&quot;</span>, <span class="number">8</span></span><br><span class="line">FakeClass.Properties_.add <span class="string">&quot;SKUNumber&quot;</span>, <span class="number">8</span></span><br><span class="line">FakeClass.Properties_.add <span class="string">&quot;UUID&quot;</span>, <span class="number">8</span></span><br><span class="line">FakeClass.Properties_.add <span class="string">&quot;Vendor&quot;</span>, <span class="number">8</span></span><br><span class="line">FakeClass.Properties_.add <span class="string">&quot;Version&quot;</span>, <span class="number">8</span></span><br><span class="line">FakeClass.Properties_(<span class="string">&quot;Name&quot;</span>).Qualifiers_.add <span class="string">&quot;key&quot;</span>, <span class="literal">false</span></span><br><span class="line">FakeClass.Put_</span><br><span class="line"> </span><br><span class="line"><span class="keyword">Set</span> FakeClass = GetObject(<span class="string">&quot;Winmgmts:root\cimv2:Win33_ComputerSystemProduct&quot;</span>).SpawnInstance_</span><br><span class="line"> </span><br><span class="line">FakeClass.Caption = <span class="string">&quot;http://www.teamviewer.com&quot;</span></span><br><span class="line">FakeClass.Description = <span class="string">&quot;class for teamviewer&quot;</span></span><br><span class="line">FakeClass.IdentifyingNumber = <span class="string">&quot;www.teamviewer.com&quot;</span></span><br><span class="line">FakeClass.Name = <span class="string">&quot;Teamviewer&quot;</span></span><br><span class="line">FakeClass.SKUNumber = <span class="string">&quot;&quot;</span></span><br><span class="line">FakeClass.UUID = strnum</span><br><span class="line">FakeClass.Vendor = <span class="string">&quot;Teamviewer&quot;</span></span><br><span class="line">FakeClass.Version = <span class="string">&quot;10.x&quot;</span></span><br><span class="line">FakeClass.Put_</span><br></pre></td></tr></table></figure><p>仅此远远不够，还得需要修改teamviewer中的Win32_ComputerSystemProduct为Win33_ComputerSystemProduct，同时去掉teamviewer的自校验!</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> autoit源码 </tag>
            
            <tag> vbscript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安卓手机控制windows电脑的三种方法</title>
      <link href="/page/1757268201/"/>
      <url>/page/1757268201/</url>
      
        <content type="html"><![CDATA[<p>windows系统的远程控制，软件有很多，但支持使用安卓手机控制windows电脑的软件，却不多，本文介绍三个常用的app来控制电脑！</p><ol><li>windows自带的远程桌面<br>win7系统如何打开远程桌面呢？右键打开桌面的[计算机]选择[属性]，进入[系统]界面，点击左边操作菜单中的[远程设置]选项卡，将直接进入[系统属性]中的[远程]菜单。钩选远程桌面，如下图<img src="/images/1527694134-1.png" alt="">,如果远程桌面在windows电脑中已经正常开放，那么你在命令行中使用telnet ip 3389，应该显示的是这样的界面<img src="/images/1527694261-2.png" alt="">其中标题中的IP显示的是你输入的IP。 如果远程桌面未正常开放，是会一直显示正在连接到你输入的ip，最后会显示连接失败!如果远程桌面不能正常开启，请搜索相关文章！本文不做深究!远程桌面在windows中开启后，在安卓手机中下载Microsoft远程桌面app，以下是在华为市场中显示的<img src="/images/1527694574-3.png" alt=""></li></ol><p>，其中在手机中的界面如下<br><img src="/images/1527694701-4.png" alt=""></p><p>windows自带的远程桌面的优点是，开启方便，windows端系统自带，无需要安装软件，只需要在手机上安装app就可以使用手机远程控制电脑了，并且手机上的操作很接近电脑，最重要一点，免费，电脑端和手机端都免费。缺点是外网连接内网的机器，需要在路由器上映射端口，另外同一帐号登录系统，同一帐号的另一会话会被注销(如果开启允许同一帐号多个会话，那么软件就会重复运行!就破坏了当前进程!)，也就是windows中的同一用户，登录系统使用的会话不同，windows本身是console，而远程登录的是rdp，远程登录上来后从console会话变为rdp,这会造成有些软件不能正常运行，比如点播软件就会停止播放音乐!<br>2. teamviewer<br>teamviewer是一款远程协助软件，个人使用免费，商业使用收费，需要在电脑端安装teamviewer，teamviewer如何使用手机控制电脑，可以看这篇文章《如何让手机控制电脑之TeamViewer 》最近teamviewer经常会出现判断为商业应用，然后5分钟中止连接，实际只有1分钟多点就中止连接了，如使用手机连接显示这样<br><img src="/images/Screenshot_2018-05-30-10-46-38.png" alt=""><br>，在电脑中被判断为商业用途还可以使用reset id程序重置teamviewer id(电脑中如何重置teamviewer ID，可以看《teamviewer 13破解方法-teamviewer 13 重置ID  》和《破解 teamviewer 12的5分钟商业用途判断－teamviewer 12 ID重置》 这两篇文章及下载相关程序，破解方法是泰国网站提供的，网站打开速度较慢)，teamviewer安卓手机被判定为商业用途怎么办呢？我们可以在手机中安装 双开助手 app，双开助手很多，但使用的是这一个<a href="http://www.multiopen.cn/">http://www.multiopen.cn/</a>  这个双开助手可以模拟手机的IMEI，在双开助手中新开teamviewer，teamviewer ID会重新生成，成功解决了teamviewer手机判定为商业用途的问题!<br><img src="/images/Screenshot_2018-05-30-10-47-25.png" alt=""></p><p>teamviewer的优点就是可以访问任何连网的机器，而不需要映射端口，内网对内网，内网对外网，外网对内网都可以访问！teamviewer是通过了teamviewer的服务器中转认证的，所以无需要映射端口。teamviewer远程连接后不会改变当前的会话，对当前正在运行的程序没有任何影响!缺点是teamviewer个人使用免费，商业用途收费，teamviewer被国内公司代理后，如果同一个teamviewer经常连接多个teamviewer ID，会被判定为商业用途，teamviewer收费还很贵!<br>3. vnc<br>vnc在windows系统中安装vnc服务端，如<a href="http://www.tightvnc.com/">http://www.tightvnc.com/</a> 的tvnc，是开源免费的，在手机端安装vnc viewer  vnc viewer手机界面如下<br><img src="/images/Screenshot_2018-05-31-00-11-08.png" alt=""><br>vnc的优点是免费开源，自己会c++，完全可以自定义vnc的服务端和客户端，但apk是realvnc的，不开源，tvnc网站也提供有app，vnc方式远程登录也不会更新当前会话，对正在运行的程序没有影响，vnc是跨平台的，vnc服务端可以安装在linux,windows,mac机器， 也就是手机可以控制各个平台的系统。缺点vnc内网也需要映射端口，并且vnc的密码只能8位，默认还是空密码（造成好多肉机存在），密码也是保存在注册表中的，还原密码程序也存在，不够安全!<br>4. 向日葵<br>向日葵远程控制软件，也支持移动设备远程访问电脑，向日葵远程控制软件只远程桌面不收费，其他如传文件是收费的，向日葵远程控制软件就是花生壳公司出品的!免费远程限速300k，基本使用够用了!</p><p>电脑端的远程控制软件radmin，没有手机版app，在现在移动设备飞速发展的今天，实属遗憾!</p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 控制电脑 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何自定义编译CheatEngine6.7</title>
      <link href="/page/1225249485/"/>
      <url>/page/1225249485/</url>
      
        <content type="html"><![CDATA[<h3 id="如何自定义编译Cheat-Engine6-7-打造自己的CE6-7修改器，避免部分游戏的检测"><a href="#如何自定义编译Cheat-Engine6-7-打造自己的CE6-7修改器，避免部分游戏的检测" class="headerlink" title="如何自定义编译Cheat Engine6.7(打造自己的CE6.7修改器，避免部分游戏的检测)"></a>如何自定义编译Cheat Engine6.7(打造自己的CE6.7修改器，避免部分游戏的检测)</h3><p>Cheat Engine(作弊引擎ce) 是一款内存修改编辑工具 ，它允许你修改你的游戏或软件内存数据，以得到一些其他功能。它包括16进制编辑，反汇编程序，内存查找工具。与同类修改工具相比，它具有强大的反汇编功能，且自身附带了外挂制作工具，可以用它直接生成外挂。<br>Cheat Engine的开发语言是pascal,采用Lazarus IDE开发!Cheat Engine是一个开源软件！<br>Cheat Engine开源地址： <a href="https://github.com/cheat-engine/cheat-engine">https://github.com/cheat-engine/cheat-engine</a><br>Cheat Engine 官方网站：<a href="http://cheatengine.org/">http://cheatengine.org/</a></p><p>官方有编译好的版本，如果没有专门检测CE的程序，那么使用官方的CE就足够了，直接下载就可以运行!但现在很多游戏或程序对CE有检测，直接下载官方的CE会无法运行。这时我们可以自己编译Cheat Engine，当前官方最新版本为6.7，所以我们这儿介绍Cheat Engine6.7的修改及编译，避免部份游戏检测CE!</p><h2 id="前期工作："><a href="#前期工作：" class="headerlink" title="前期工作："></a>前期工作：</h2><ol><li>需要使用到的软件及ce源码等下载地址：</li></ol><ul><li>lazarus-1.6.4-fpc-3.0.2-win64.exe下载地址(Cheat Engine6.7是使用的lazarus1.6.4编译，所以必须下载1.6.4，此文件是64位的lazarus1.6.4的主安装文件)<br>官方推荐第三方下载链接：<a href="https://sourceforge.net/projects/lazarus/files/Lazarus%20Windows%2064%20bits/">https://sourceforge.net/projects/lazarus/files/Lazarus%20Windows%2064%20bits/</a><br>百脑问提供的百度云下载链接：<a href="https://pan.baidu.com/s/1VIRTU57RikwSMk1X15RP2w">https://pan.baidu.com/s/1VIRTU57RikwSMk1X15RP2w</a> 密码：mbwj</li><li>lazarus-1.6.4-fpc-3.0.2-cross-i386-win32-win64.exe(此文件是lazarus1.6.4编译为32位程序的补丁包)<br>官方推荐第三方下载链接：<a href="https://sourceforge.net/projects/lazarus/files/Lazarus%20Windows%2064%20bits/">https://sourceforge.net/projects/lazarus/files/Lazarus%20Windows%2064%20bits/</a><br>百脑问提供的百度云下载链接：<a href="https://pan.baidu.com/s/1iGnpHnOor2ygiz4TaY3OJw">https://pan.baidu.com/s/1iGnpHnOor2ygiz4TaY3OJw</a> 密码：bt8s</li><li>cheat-engine-6.7.zip(Cheat Engine6.7的源码包，你可以直接到<a href="https://github.com/cheat-engine/cheat-engine">https://github.com/cheat-engine/cheat-engine</a> 下载)<br>百脑问提供的百度云下载链接：<a href="https://pan.baidu.com/s/1bXTJkn6lHCFmOKc2AoJjEw">https://pan.baidu.com/s/1bXTJkn6lHCFmOKc2AoJjEw</a> 密码：68×2</li></ul><ol start="2"><li>安装好 lazarus-1.6.4-fpc-3.0.2-win64.exe和lazarus-1.6.4-fpc-3.0.2-cross-i386-win32-win64.exe 解开cheat-engine-6.7.zip源码包! 进入CE源码包的Cheat Engine目录，找到cheatengine.lpi，双击打开!</li></ol><h3 id="自定义cheatengine6-7"><a href="#自定义cheatengine6-7" class="headerlink" title="自定义cheatengine6.7"></a>自定义cheatengine6.7</h3><p>如果你熟悉lazarus的使用就可以轻松的修改Cheat Engine的源文件了，以下是假如你不了解lazarus的使用，仅仅是为了不让程序检测到ce而自定义ce！</p><p>前面的源码中双击cheatengine.lpi打开后的界面，象这样<br><img src="/images/1525793534-1.png" alt=""><br>第一步，我们修改ce的标题，按Shift+F12(也可以点击上面所示图中的第二行的第二个图标)打开窗口管理器，找到MainForm，双击打开，然后在Object Inspector窗口(如果没有显示Object Inspector窗口，可以在view菜单中点击Object Inspector打开，或者按F11打开)中单击MainForm:TMainForm 在下面的Properties选项卡中，找到Caption，修改后面的Cheat Engine 6.8为自己的标题，比如这儿修改为C_BnWin.Com_E6.7，然后Ctrl+O找到MainUnit2.pas打开，修改第16行的Cheat Engine 6.8 Beta 1为自己的标题，如这儿修改为C_BnWin.Com_E6.7</p><p>第二步，我们修改CE的图标 按Shift+Ctrl+F11在打开的窗口左边选中Project Option的Application 右边点击Load ICO，选择一个ico就可以修改ce的图标了!</p><p>第三步，编译32位的CE和64位的CE，和上面一样按Shift+Ctrl+F11 选中Compiler Options，右边下拉框中，选择Release 32-Bit，编译出的CE就是32位的 选择Release 64-Bit 编译出的CE就是64位的!</p><p>第四步，修改完成后，Ctrl+F9编译，在bin目录就会生成CE可执行文件了，32位和64位的CE编译后可执行文件应该为cheatengine-i386.exe和cheatengine-x86_64.exe</p><p>当然你也可以修改其他的相关信息，也可以加一些其他代码到CE的源代码中，这样就更不会检测到属于你自己的CE了!</p><p>下面是自定义Cheat Engine的视频教程!</p><iframe style="width:100%" frameborder="0" height="600" src="http://player.youku.com/embed/XMzU5NjUzODU2OA==" allowfullscreen=""></iframe><p>下面是百脑问bnwin.com自定义专用的CE6.7下载地址：</p><p>链接：<a href="https://pan.baidu.com/s/1TUCMpNo90H194u927ce3ug">https://pan.baidu.com/s/1TUCMpNo90H194u927ce3ug</a> 密码：f35t</p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ce技巧 </tag>
            
            <tag> 基址查找方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何快速让cef、wke、blink等支持mp4和mp3</title>
      <link href="/page/3317533050/"/>
      <url>/page/3317533050/</url>
      
        <content type="html"><![CDATA[<h2 id="如何快速让cef、wke、blink等支持mp4和mp3-支持html5的video和audio标签"><a href="#如何快速让cef、wke、blink等支持mp4和mp3-支持html5的video和audio标签" class="headerlink" title="如何快速让cef、wke、blink等支持mp4和mp3(支持html5的video和audio标签)?"></a>如何快速让cef、wke、blink等支持mp4和mp3(支持html5的video和audio标签)?</h2><p>在cef中，默认是不支持mp3和mp4的，使用cef控件写的软件打开带有video或audio标签的视频或音频是会播放失败的!一种方法就是自己重新编译cef的库，加入支持mp3和mp4的支持。如何编译看这篇文章 如何让dcef3支持mp3和h.264 mp4解码播放(有源码及dll)!</p><p>这是从文件的本身出发，修改后支持mp3和mp4，从另一方面来说，采用cef的精简版控件，比如wke,blink或低版本的ie等，修改文件重新编译支持mp3和mp4的方法就不可行了!能不能不修改文件直接支持mp3和mp4的video和audio标签呢？这儿介绍一种修改html本身而不动浏览器控件文件的解决方法，当然你得有修改html文件的权限。</p><p>使用html5media让浏览器兼容&lt;Video&gt;&lt;Audio&gt;标签。html5media是一个开源项目<br>html5media 官网：<a href="https://html5media.info/">https://html5media.info/</a><br>html5media 项目：<a href="https://github.com/etianen/html5media">https://github.com/etianen/html5media</a><br>html5media Wiki：<a href="https://github.com/etianen/html5media/wiki">https://github.com/etianen/html5media/wiki</a></p><p>html5media 官网CDN:<a href="http://api.html5media.info/1.2.2/html5media.min.js">http://api.html5media.info/1.2.2/html5media.min.js</a><br>html5media 国内CDN:<a href="http://www.bootcdn.cn/html5media/">http://www.bootcdn.cn/html5media/</a></p><p>如何使用html5media？它只需要一行代码就可以使HTML5的video和audio标签在所有主流浏览器中都能正常工作。只需要在html的head文档中添加如下代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt; script src = “ http://api.html5media.info/1.1.8/html5media.min.js ” &gt; &lt;/ script &gt;</span><br></pre></td></tr></table></figure><p>然后按照html5的video标签添加的视频</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt; video src=&quot;video.mp4&quot; preload=&quot;&quot; controls=&quot;controls&quot; width=&quot;320&quot; height=&quot;200&quot;&gt;</span><br></pre></td></tr></table></figure><p>按照html5的audio标签添加的音频</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;audio.mp3&quot;</span> <span class="attr">controls</span> <span class="attr">preload</span>&gt;</span></span><br></pre></td></tr></table></figure><p>都可以正常播放了!</p><p>html5media的原理就是把不支持&lt;Video&gt;&lt;Audio&gt;标签的替换为使用flash播放！</p><p>这样使用html5media后，cef、wke、blink等所有浏览器都支持html5的video和audio标签了!</p><p>如果你是使用wke或blink在自己的程序界面中添加显示mp4或mp3，那么你需要自己把html5media.min.js和flowplayer.audio.swf flowplayer.controls.swf flowplayer.swf文件全部下载到你的程序目录(js文件和swf放在同一目录)，在你的程序中就可以在wke或blink中使用video或audio标签了!</p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cef技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi如何实现php中的parse_url网址拆分函数?</title>
      <link href="/page/3056921327/"/>
      <url>/page/3056921327/</url>
      
        <content type="html"><![CDATA[<p>php中拆分URL的一个很重要的函数就是parse_url();但在delphi如何不正则分析就可以实现如此方便的功能呢？实际上delphi的indy有一个单元实现此功能-IdURI单元，实现如下分拆</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//login:password@somehost.somedomain.com:8080/some_path/something.html?param1=val&amp;param2=val#nose</span></span><br><span class="line">\__/   \___/ \______/ \_____________________/ \__/\_______________________/ \___________________/ \__/</span><br><span class="line"> |       |      |               |               |                |                   |              |</span><br><span class="line">Scheme Username Password       Host            Port             Path              Query         Fragment</span><br></pre></td></tr></table></figure><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uses</span></span><br><span class="line">  ..., IdURI;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  URI: TIdURI;</span><br><span class="line"> </span><br><span class="line">URI := TIdURI.Create(<span class="string">&#x27;http://login:password@somehost.somedomain.com:8080/some_path/something_else.html?param1=val&amp;param2=val&#x27;</span>);</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">   Protocol = URI.Protocol</span><br><span class="line">   Username = URI.Username</span><br><span class="line">   Password = URI.Password</span><br><span class="line">   Host = URI.Host</span><br><span class="line">   Port = URI.Port</span><br><span class="line">   Path = URI.Path</span><br><span class="line">   Query = URI.Params</span><br><span class="line"><span class="keyword">finally</span></span><br><span class="line">  URI.Free;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>以下是使用InternetCrackUrl方法实现(依赖windows的WinInet库)</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#123;$APPTYPE CONSOLE&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">uses</span></span><br><span class="line">  Windows,</span><br><span class="line">  SysUtils,</span><br><span class="line">  WinInet;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">ParseURL</span><span class="params">(<span class="keyword">const</span> lpszUrl: <span class="keyword">string</span>)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  lpszScheme      : <span class="keyword">array</span>[<span class="number">0</span>..INTERNET_MAX_SCHEME_LENGTH - <span class="number">1</span>] <span class="keyword">of</span> Char;</span><br><span class="line">  lpszHostName    : <span class="keyword">array</span>[<span class="number">0</span>..INTERNET_MAX_HOST_NAME_LENGTH - <span class="number">1</span>] <span class="keyword">of</span> Char;</span><br><span class="line">  lpszUserName    : <span class="keyword">array</span>[<span class="number">0</span>..INTERNET_MAX_USER_NAME_LENGTH - <span class="number">1</span>] <span class="keyword">of</span> Char;</span><br><span class="line">  lpszPassword    : <span class="keyword">array</span>[<span class="number">0</span>..INTERNET_MAX_PASSWORD_LENGTH - <span class="number">1</span>] <span class="keyword">of</span> Char;</span><br><span class="line">  lpszUrlPath     : <span class="keyword">array</span>[<span class="number">0</span>..INTERNET_MAX_PATH_LENGTH - <span class="number">1</span>] <span class="keyword">of</span> Char;</span><br><span class="line">  lpszExtraInfo   : <span class="keyword">array</span>[<span class="number">0</span>..<span class="number">1024</span> - <span class="number">1</span>] <span class="keyword">of</span> Char;</span><br><span class="line">  lpUrlComponents : TURLComponents;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  ZeroMemory(@lpszScheme, SizeOf(lpszScheme));</span><br><span class="line">  ZeroMemory(@lpszHostName, SizeOf(lpszHostName));</span><br><span class="line">  ZeroMemory(@lpszUserName, SizeOf(lpszUserName));</span><br><span class="line">  ZeroMemory(@lpszPassword, SizeOf(lpszPassword));</span><br><span class="line">  ZeroMemory(@lpszUrlPath, SizeOf(lpszUrlPath));</span><br><span class="line">  ZeroMemory(@lpszExtraInfo, SizeOf(lpszExtraInfo));</span><br><span class="line">  ZeroMemory(@lpUrlComponents, SizeOf(TURLComponents));</span><br><span class="line"> </span><br><span class="line">  lpUrlComponents.dwStructSize      := SizeOf(TURLComponents);</span><br><span class="line">  lpUrlComponents.lpszScheme        := lpszScheme;</span><br><span class="line">  lpUrlComponents.dwSchemeLength    := SizeOf(lpszScheme);</span><br><span class="line">  lpUrlComponents.lpszHostName      := lpszHostName;</span><br><span class="line">  lpUrlComponents.dwHostNameLength  := SizeOf(lpszHostName);</span><br><span class="line">  lpUrlComponents.lpszUserName      := lpszUserName;</span><br><span class="line">  lpUrlComponents.dwUserNameLength  := SizeOf(lpszUserName);</span><br><span class="line">  lpUrlComponents.lpszPassword      := lpszPassword;</span><br><span class="line">  lpUrlComponents.dwPasswordLength  := SizeOf(lpszPassword);</span><br><span class="line">  lpUrlComponents.lpszUrlPath       := lpszUrlPath;</span><br><span class="line">  lpUrlComponents.dwUrlPathLength   := SizeOf(lpszUrlPath);</span><br><span class="line">  lpUrlComponents.lpszExtraInfo     := lpszExtraInfo;</span><br><span class="line">  lpUrlComponents.dwExtraInfoLength := SizeOf(lpszExtraInfo);</span><br><span class="line"> </span><br><span class="line">  InternetCrackUrl(PChar(lpszUrl), Length(lpszUrl), ICU_DECODE <span class="keyword">or</span> ICU_ESCAPE, lpUrlComponents);</span><br><span class="line"> </span><br><span class="line">  Writeln(Format(<span class="string">&#x27;Protocol : %s&#x27;</span>,[lpszScheme]));</span><br><span class="line">  Writeln(Format(<span class="string">&#x27;Host     : %s&#x27;</span>,[lpszHostName]));</span><br><span class="line">  Writeln(Format(<span class="string">&#x27;User     : %s&#x27;</span>,[lpszUserName]));</span><br><span class="line">  Writeln(Format(<span class="string">&#x27;Password : %s&#x27;</span>,[lpszPassword]));</span><br><span class="line">  Writeln(Format(<span class="string">&#x27;Path     : %s&#x27;</span>,[lpszUrlPath]));</span><br><span class="line">  Writeln(Format(<span class="string">&#x27;ExtraInfo: %s&#x27;</span>,[lpszExtraInfo]));</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">try</span></span><br><span class="line">   ParseURL(<span class="string">&#x27;http://login:password@somehost.somedomain.com/some_path/something_else.html?param1=val&amp;param2=val&#x27;</span>);</span><br><span class="line">  <span class="keyword">except</span></span><br><span class="line">    <span class="keyword">on</span> E: Exception <span class="keyword">do</span></span><br><span class="line">      Writeln(E.ClassName, <span class="string">&#x27;: &#x27;</span>, E.<span class="keyword">Message</span>);</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  readln;</span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure><p>以上运行输出效果<br>Protocol : http<br>Host : somehost.somedomain.com<br>User : login<br>Password : password<br>Path : /some_path/something_else.html<br>ExtraInfo: ?param1=val&amp;param2=val</p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>自定义8圈桌面侧边栏_领航桌面侧边栏原理</title>
      <link href="/page/1077583104/"/>
      <url>/page/1077583104/</url>
      
        <content type="html"><![CDATA[<p>本软件适用于不想使用营销软件，不想关闭8圈桌面侧边栏，只想把8圈桌面侧边栏遮挡（就象领航桌面侧边栏一样把8圈的桌面侧边栏遮挡），虽然不想用营销软件但又想自定义桌面侧边栏! 那么你可以使用本自定义8圈桌面侧边栏！本软件不修改8圈任何文件，不影响8圈系统的正常功能!完全独立于8圈。<br>在网吧环境中，有时我们想不使用营销活动，不计积分，不发红包，不搞游戏活动等等，只是想使用一下呼叫网管，点歌，显示一下网吧公告等基本的功能!最重要的一点，不想使用营销软件，因为使用这些基本功能，营销软件会有广告,还有一点，在8圈计费系统中，不希望看到8圈桌面那毫无美感而不能更改的侧边栏!本软件就是适用于以上环境!功能如下</p><ul><li>遮挡8圈桌面侧边栏<br>删除本软件目录中的config.ini文件，运行本软件，自动遮档8圈桌面侧边栏，原理和领航营销软件2.0遮挡8圈桌面侧边栏一样!</li><li>可自定义侧边栏<br>在本软件skin目录中，内置了领航1.0的桌面侧边栏6款皮肤，领航2.0的桌面侧边栏，和网乐的一款桌面皮肤!只需要在config.ini中设置皮肤名称就可以显示类似营销软件的界面,比如设置  皮肤=lhv2 运行本软件则会显示领航2.0的桌面侧边栏皮肤!最重要的是你可以把桌面侧边完全当成画板，自定义桌面侧边哪儿显示什么，如何显示，只要你会html，css，js其他的语法，那么强大的自定义桌面侧边栏就会由你说了算!</li><li>自定义的侧边栏链接可运行任何程序<br>比如在自定义侧边栏的html文件中添加一个链接<a class=”ic-y1″></a> 那么我们只需要添加一个onclick事件，象这样<a class=”ic-y1″ onclick=’javascript:external.Run(“c:/Windows/system32/calc.exe”,”运行参数”)’></a>就是点击这个链接，运行机器中的计算器程序。点击桌面侧边栏就运行程序的命令是 onclick=’javascript:external.Run(“可执行程序完整路径”,”运行参数”)’  其中可执行程序完整路径的斜杠需要是/  你可以参照本软件目录的skin目录中的html皮肤修改!这样我们就可以只使用营销软件的服务端，而不使用营销软件的客户端，本软件可以和网乐营销软件服务端有效完美结合，而不使用网乐营销软件的客户端。使用其他营销软件的服务端也大同小异!比如我们想在桌面侧边栏显示美化的在线充值按钮，挂机，呼叫网管等，等只需要按照这样添加就行了！如果你想调用8圈的在线充值等功能，可以结合本站的<a href="http://www.bnwin.com/page/576111441/%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8">http://www.bnwin.com/page/576111441/软件使用</a>!</li></ul><p>如果你在8圈系统中使用了营销软件，请不要使用本软件!本软件必须运行在有8圈桌面侧边栏的环境，没有8圈桌面侧边栏，运行会什么也不会显示！如果你只是想不显示8圈桌面侧边栏，请看这儿<a href="http://www.bnwin.com/page/3211467574/">http://www.bnwin.com/page/3211467574/</a></p><p>看看运行效果<br><img src="/images/1522506679-1.gif" alt=""><br>软件下载地址<br>链接: <a href="https://pan.baidu.com/s/1QK67GHENwYxyuHyirvhwiQ">https://pan.baidu.com/s/1QK67GHENwYxyuHyirvhwiQ</a> 提取码: rvja 复制这段内容后打开百度网盘手机App，操作更方便哦<br>如果你觉得自带桌面侧边栏样式，不符合你的美感，你也不会html，我们可以有偿桌面侧边栏皮肤定制!</p><p>使用此软件方法绝不会提示计费系统异常，如下这种情况!<br><img src="/images/1522507998-0.png" alt=""></p><p><em><strong>本软件已停止更新，仅适合于八圈9.5以下版本</strong></em></p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 八圈 </tag>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何取得窗口的Z序</title>
      <link href="/page/2238981937/"/>
      <url>/page/2238981937/</url>
      
        <content type="html"><![CDATA[<h3 id="如何取得窗口的Z序-How-to-get-the-window-s-z-order"><a href="#如何取得窗口的Z序-How-to-get-the-window-s-z-order" class="headerlink" title="如何取得窗口的Z序_How to get the window`s z-order?"></a>如何取得窗口的Z序_How to get the window`s z-order?</h3><p>Z 序：一个重叠窗口的堆，每个窗口在Z 序中 都有唯一一个位置。一个窗口的Z 序 ，指明了该窗口在重叠窗口堆中的位置。这个窗口堆 是沿着一个虚拟的轴——“ Z 轴”，从屏幕上垂直向屏幕外延伸。 Z 序顶部的窗口覆盖 Z 序中的其他窗口。 Z 序底部的窗口被 Z 序中的其他窗口覆盖。</p><p>系统用一个单链表维护 Z 序。系统按照顶端窗口、顶层窗口和子窗口的分类 ，将窗口插入到 Z 序表中。顶端窗口覆盖其他所有非顶端窗口，而不管它是不是活动窗口或是不是前台窗口。顶端窗口有 WS_EX_TOPMOST 风格。在 Z 序中，所有顶端窗口都在非顶端窗口之前。在 Z 序中，子窗口是按着他的父窗口进行分组的。</p><p>应用程序一旦创建了一个窗口，系统就将其放入Z 序中 同类窗口的顶部。可以调用 BringWindowToTop() 函数，把某窗口拉到 Z 序中同类窗口的顶部。可以利用 SetWindowPos() 和 DeferWindowPos() 函数对 Z 序进行重新排列。</p><p>用户在激活不同的窗口过程中会改变 Z 序。因为系统会将活动窗口，放置在 Z 序中同类窗口的顶部 。当一个窗口变成 Z 序中的顶层窗口时，它的所有子窗口也变为顶层窗口。可以用 GetTopWindow() 来查找一个父窗口的所有子窗口，并返回（ Z 序中）顶部子窗口的句柄。用 GetNextWindow() 函数，可以获得 Z 序中的前一个或后一个窗口的句柄。</p><p>对于顶端窗口，顶层窗口和子窗口，如果只考虑同一类的话，如果有多个，总会一个覆盖另一个。但是这三类是按照上面讲的排列的。也就是有人讲的：<br>1.TopMost在最上面<br>2，顶级窗口次之<br>3，子窗口在父窗口之上<br>4，同级窗口当前激活窗口在前</p><p>HDWP hdwp = BeginDeferWindowPos(2);</p><p>hdwp = DeferWindowPos( hdwp, hStatic, NULL, 0, 0,100, 20, SWP_NOACTIVATE | SWP_NOZORDER |SWP_NOMOVE );<br>hdwp = DeferWindowPos( hdwp, hEdit, NULL, 0, 0, 100, 20, SWP_NOACTIVATE | SWP_NOZORDER |SWP_NOMOVE );<br>EndDeferWindowPos( hdwp );</p><p>其作用和SetWindowPos()差不多。</p><p>6.HWND GetWindow(HWND hWnd,UINT uCmd)</p><p>此函数的作用是：返回与hWnd有某种关系的窗口的句柄，uCmd有以下几种意思：</p><p>GW_CHILD ： 如果指定窗口是父窗口，则获得的是在Z序顶端的子窗口的句柄，否则为NULL。函数仅检查指定父窗口的子窗口，不检查继承窗口。</p><p>GW_ENABLEDPOUP： （WindowsNT 5.0）返回的句柄标识了属于指定窗口的处于使能状态弹出式窗口（检索使用第一个由GW_HWNDNEXT 查找到的满足前述条件的窗口）；如果无使能窗口，则获得的句柄与指定窗口相同。</p><p>GW_HWNDFIRST ：返回的句柄标识了在Z序最高端的相同类型的窗口。如果指定窗口是最高端窗口，则该句柄标识了在Z序最高端的最高端窗口；如果指定窗口是顶层窗口，则该句柄标识了在z序最高端的顶层窗口：如果指定窗口是子窗口，则句柄标识了在Z序最高端的同属窗口。</p><p>GW_HWNDLAST :返回的句柄标识了在z序最低端的相同类型的窗口。如果指定窗口是最高端窗口，则该柄标识了在z序最低端的最高端窗口：如果指定窗口是顶层窗口，则该句柄标识了在z序最低端的顶层窗口；如果指定窗口是子窗口，则句柄标识了在Z序最低端的同属窗口。</p><p>GW_HWNDNEXT ：返回的句柄标识了在Z序中指定窗口下的相同类型的窗口。如果指定窗口是最高端窗口，则该句柄标识了在指定窗口下的最高端窗口：如果指定窗口是顶层窗口，则该句柄标识了在指定窗口下的顶层窗口；如果指定窗口是子窗口，则句柄标识了在指定窗口下的同属窗口。</p><p>GW HWNDPREV ：返回的句柄标识了在Z序中指定窗口上的相同类型的窗口。如果指定窗口是最高端窗口，则该句柄标识了在指定窗口上的最高端窗口；如果指定窗口是顶层窗口，则该句柄标识了在指定窗口上的顶层窗口；如果指定窗口是子窗口，则句柄标识了在指定窗口上的同属窗口。GW_OWNER ：返回的句柄标识了指定窗口的所有者窗口（如果存在）。返回值：如果函数成功，返回值为窗口句柄；如果与指定窗口有特定关系的窗口不存在，则返回值为NULL。</p><p>C#取得z-order的代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.InteropServices;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> Win32</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">HwndHelper</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        [DllImport(<span class="string">&quot;user32.dll&quot;</span>)]</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">extern</span> IntPtr <span class="title">GetWindow</span><span class="params">(IntPtr hWnd, uint uCmd)</span></span>;</span><br><span class="line"> </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">GetWindowZOrder</span><span class="params">(IntPtr hwnd, out <span class="keyword">int</span> zOrder)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> uint GW_HWNDPREV = <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">const</span> uint GW_HWNDLAST = <span class="number">1</span>;</span><br><span class="line"> </span><br><span class="line">            var lowestHwnd = GetWindow(hwnd, GW_HWNDLAST);</span><br><span class="line"> </span><br><span class="line">            var z = <span class="number">0</span>;</span><br><span class="line">            var hwndTmp = lowestHwnd;</span><br><span class="line">            <span class="keyword">while</span> (hwndTmp != IntPtr.Zero)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (hwnd == hwndTmp)</span><br><span class="line">                &#123;</span><br><span class="line">                    zOrder = z;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                hwndTmp = GetWindow(hwndTmp, GW_HWNDPREV);</span><br><span class="line">                z++;</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            zOrder = <span class="keyword">int</span>.MinValue;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>aardio取得z-order的代码(取得windows的Z序代码)如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">get_zorder</span><span class="params">(win_hwnd)</span></span>&#123;</span><br><span class="line">    var lowestHwnd = ::User32.GetWindow(win_hwnd,<span class="number">0x1</span><span class="comment">/*_GW_HWNDLAST*/</span>);</span><br><span class="line">    var z=<span class="number">0</span>;</span><br><span class="line">    var hwndTmp=lowestHwnd;</span><br><span class="line"><span class="keyword">while</span> (hwndTmp != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (win_hwnd == hwndTmp)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> z;</span><br><span class="line">                &#125;</span><br><span class="line">                hwndTmp = ::User32.GetWindow(hwndTmp,<span class="number">0x3</span>);</span><br><span class="line">                z++;</span><br><span class="line">            &#125;    </span><br><span class="line">    <span class="keyword">return</span>  <span class="number">0</span>; </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> aardio技巧 </tag>
            
            <tag> c#技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ZIP一个没落天才的故事</title>
      <link href="/page/4277289715/"/>
      <url>/page/4277289715/</url>
      
        <content type="html"><![CDATA[<p>ZIP是什么？</p><p>*.ZIP，是一个文件的压缩的算法，原名Deflate（真空），发明者为菲利普·卡兹（Phil Katz)），他于1989年1月公布了该格式的资料。ZIP通常使用后缀名“.zip”，它的MIME格式为 application/zip 。目前，ZIP格式属于几种主流的压缩格式之一，其竞争者包括RAR格式以及开放源码的7-Zip格式。从性能上比较，RAR格式较ZIP格式压缩率较高，但是它的压缩时间远远高于Zip。而7-Zip(7z)由于提供了免费的压缩工具而逐渐在更多的领域得到应用。</p><p>Phil Katz不愿意为一个压缩软件付钱，就索性自己写了一个更好的算法，然后无偿公开。2000年4月14日，他被发现死于一家汽车旅馆，年仅37岁，死时手中握着一个空酒瓶。他留下了zip算法，却没有留下一张像样的照片。</p><p>久违了的zip在你的脑海里还能占据多少空间?或许，你跟本就把它忘记了。</p><p>记得刚上大学的2001年,在电脑报上看到过一篇介绍Philip Katz的文章，那时，我才知道，原来zip是曾经是那么的“不可一世”，那么广泛的被使用着。</p><p>Winzip的创始人是Philip Katz。用Ultraedit打开任一个zip文件，可以看到文件最前面PK两个字母，这便是zip文件格式的创始人Philip Katz的名字缩写。</p><p>在19年前，也就是公元1988年，那时候互联网还刚刚开始有了雏形，而最流行的是一种使用电话线拨号登陆别人在家里搭建的服务平台——交换信息的电子公告牌(BBS)系统。这种系统有些类似现在的论坛和新闻组，由于站长之间互相转信也成为了一个庞大的信息网络(惠多网)。</p><p>老一点的网虫可能都有印象，在没有 Internet的年代，中国大地上也曾有几十个这样的BBS存在，著名的字处理软件WPS的作者求伯君和CCED的作者朱崇君当年都是非常有名的个人站长。</p><p>由于电话线的接入速度慢的可怜，通过BBS传输较大文件实在是叫人痛苦的一件事。于是，使用文件压缩技术减小文件的体积并将多个文件压缩到一个封包中就成为了BBS用户的一项必须掌握的技巧。当时的美国BBS上，比较流行的是一种叫做ARC的压缩技术，由于它是一家商业公司开发的压缩技术，使用这种软件进行工作是需要付费的。那时候的菲利普·卡兹是一个沉迷于BBS 上的毛头小伙，由于经常混迹于BBS上，对于ARC的收费非常不满的他自己开发了一个程序叫PKARC，这个程序与ARC完全兼容，可以压缩和解压缩 ARC文件。这样一来，大批的ARC用户自然转而使用菲利普·卡兹的免费软件。ARC的制作公司一怒之下将菲利普·卡兹告上了法庭，法庭自然判决菲利普· 卡兹禁止继续开发和传播PKARC。这种判决并没有磨灭菲利普·卡兹的斗志，而是激起了他要与ARC斗争到底的决心。在虚拟的世界中，自由、平等永远是真正的程序员永久的追求。</p><p>他放弃了PKARC的开发，发誓要写出一款比ARC更好的压缩软件来打败ARC。这一场官司造就了一名编程天才的横空出世，也造就了一个后来在互联网时代的文件标准。几周以后，后来统治整个BBS世界乃至Internet世界的ZIP在菲利普·卡兹手中发出了第一声响亮的啼哭!</p><p>不名则已，一鸣惊人，这种名为PKZIP的程序可以将一个或多个文件压缩到一个后缀为“.zip”的文件中，无论从压缩比、压缩速度方面都超过了商业软件 ARC。卡兹将PKZIP作为自由软件免费发放，使其如同草原上的星星之火般在全美的各大BBS上蔓延开来，用户以几何级数的增长，各大BBS的站长自发将原来使用ARC格式压缩的文件转换成ZIP格式，卡兹用他天才的头脑和顽强的毅力堂堂正正的击败了ARC，ARC的制作公司在PKZIP的强大攻势下很快就消声匿迹了。用自由软件打败商业公司的传奇故事很快传遍了整个BBS世界，疾恶如仇而又身手不凡的菲利普·卡兹如同数字世界的大侠般仗剑江湖，劫富济贫，以一人之力擎起了压缩软件的大旗。</p><p>此后卡兹一直继续着对 PKZIP的开发和维护工作，PKZIP建立和统治了DOS时代的压缩标准。直到Windows的诞生，使用卡兹创造的压缩算法的软件Winzip的出现更使ZIP格式成为Internet的传输标准，ZIP压缩格式也成为压缩文档的事实标准。</p><p>PKZIP及其“克隆”作品Winzip成为Internet历史上最有名的共享软件之一，ZIP压缩格式也成为压缩文档的事实标准，建立起一个统治Internet的“ZIP王朝”。菲利普·卡兹为世界贡献了一个伟大的共享软件，而他自己却几乎没有从中获得任何好处!因为从一开始，ZIP就是为了反抗收费的PKARC“而生”的。</p><p>但是，不良的生活习惯，长期巨大的精神压力，导致了潦倒无助的他在2000年的4月14号，死在了美国威斯康星州密尔沃基的一家汽车旅馆里，死时，手里还紧握着一个烈性酒的酒瓶。</p><p>Philip Katz从未在ZIP身上得到半点好处，坚持信念的结果往往是潦倒的生活，糟糕的个人生活和长期编写软件的巨大压力使卡兹染上了酗酒的恶习，最终断送了他那年轻的生命。他为世界贡献了一个伟大的免费软件，更为重要的是他缔造了一种大众化的压缩格式，然而却过早地离开了这个世界。</p><p>就在Philip Katz去世的前后，ZIP的最大对手：WINRAR，正在悄然崛起。当时Winzip早已稳坐压缩界头把交椅，但随着2.7版本的出现，Wrar却日益壮大，两者斗争得异常激烈(注：与Winzip一样，其实早在DOS时代，就存在RAR的DOS版本，只是RAR在DOS时代敌不过只能用命令行的ARJ，到了Windows时代又招架不住WinZip的进攻，皆因RAR压缩率低和速度慢，并且RAR压缩格式以前一直缺少其它软件的支持，导致WinRAR都未能广泛流行)。</p><p>就当时两者的性能而言，Winzip压缩只支持ZIP格式，解压缩支持ZIP、CAB，还有TAR、GZip、UUencode、XXencode、BinHex、MIME等几种Internet常用格式(可以看出WinZip的重心之所在)，ARJ、LHA和ARC则需要相应的外挂程序。但WinZip跟Windows资源管理器结合得很紧密，最常用的压缩和解压缩操作已集成到鼠标右键菜单中，点按右键即可轻松完成压缩解压缩。并且增加了不少人性化的功能如E-mail功能，分卷压缩，密码加密等;那Winrar又凭什么与其争锋呢?答案是格式支持与功能!WinRAR压缩格式支持自家的RAR和ZIP(即可“兼容”ZIP)，解压缩支持RAR、ZIP、CAB、ACE、ARJ、LHA、TAR、GZip、UUE，基本上常用的都有了。WinRAR在界面上类似WinZip在功能上基本是WinZip有的它都有，甚至有好多比WinZip还更好更强大。如有特色的”Repair archive”功能甚至可以修复损坏的zip文件;”Convert archive to SFX”功能把RAR和ZIP文件转换成自解压文件，同WinZip不同的是，在压缩时就可以直接存为自解压文件…取对手之精华，并改进之，这就是Winrar敢于与压缩界龙头叫板的原因。</p><p>或许到了这里，你会问：为什么zip不去支持rar呢?这样竞争不就“公平”了吗?但我告诉你的是：zip格式是开放的，任何压缩软件都可以免费使用，RAR是RARLab的专利算法，其它软件要想提供对Rar格式支持必须交纳费用以获得授权，如果winzip想要支持zip，就必须向rarlab付费，这根本就是拿自己的血汗去喂饱对手。我们须明白：winzip和winrar都是共享软件，中国人用惯了盗版的winrar，以为rar才是压缩格式的王道，如果自以为全天下的压缩软件都应该支持rar格式，那么只能说这是一种极其荒谬的认知。</p><p>虽然ZIP仍然是压缩文件的标准格式，但随着WinRAR的功能越来越强大，并且对ZIP的兼容性和ISO镜像文件的支持，固步自封的WinZip已经逐渐开始被网民们所遗忘。面临被打倒，昔日的强者做出了最后的反击–Winzip9.0。2004年发布的Winzip9.0是Winzip公司在02年后两年内第一次发布的Winzip软件更新，可见这次Winzip反击的决心。本版本的Winzip带来了很多新的功能特性，如：加密标准提高，支持符合AES技术的128位和256位的高级加密标准;支持64位扩展技术;内置了先进的“真空”压缩算法(Enhanced Deflate)等。这一切都是针对WinRAR 3.30，誓求夺回压缩界的王座。</p><p>可惜就像乔丹的最后出场一样，也许真的是老了，我们再难看到英雄昔日的光彩。</p><p>WinZip 9.0对压缩格式的支持并没有什么增加，支持原有的18种压缩格式，但仍然不支持ISO这一非常流行的镜像文件格式，并且最大的问题是不兼容RAR，这就令许多用户敬而远之了;相对而言，WinRAR 3.30目前的压缩格式虽然只有15种，但由于兼容ZIP和支持ISO，仅仅这两条就使不少WinZip的老用户心动神移了。</p><p>随着绝唱反击的失败，于2005年7月，WinZip被Vector Capital收购。</p><p>也许在天之灵的Philip Katz并没有想到有这一天，作为下载量达到1亿4000万次，成就压缩标准zip的Winzip计算公司好象没有考虑过用其技术来赚钱的事(实际上很少有人会在WinZip试用期过后支付29美元购买正版授权，因此WinZip至今都没有获得太多利润)。它为大家提供一款如此经典的压缩软件，曾经，它是何等辉煌，但如今却威风难再。或者正如歌词所说:”想回到过去，试着让故事继续，至少不再让你离我而去…”</p>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 人物故事 </tag>
            
            <tag> 文章 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AE模板-动感极限运动动作电影游戏宣传片预告片信号损坏视频开场</title>
      <link href="/page/3714672010/"/>
      <url>/page/3714672010/</url>
      
        <content type="html"><![CDATA[<p>包含信号损坏，亮度置换，多摄像机分屏，摄像机推拉等多种动画场景视频图片文字效果，所有的镜头都是单独模块化的，可以自己随意拖拽组合成自己的开场宣传视频，默认包含以下已经做好的视频片头，可以直接使用：</p><p>开场视频风格 V1 (0:30)<br>开场视频风格 V1 (0:30)<br>开场视频风格 V1 (0:36)<br>预告片(0:30)<br>宣传片 (1:10)<br>动作电影宣传片 v1 (1:00)<br>动作电影宣传片 v2 (1:00)<br>动态幻灯片视频 v1 (2:13)<br>动态幻灯片视频 v2 (1:40)<br>3个Logo展示 (0:04)</p><p>版 本：AE CS5或者更高版本，必使用英文版AE<br>分辨率：4K高清3840×2160<br>插 件：不需要第三方插件<br>大 小：1.82GB<br>教 程：视频教程<br>音 乐：不包含背景音乐<br>注 意：模板修改需要有一定的AE基础，未入门的新手请谨慎购买，店主不负责帮忙修改<br>使用者一定要对AE了解，我们只提供模板，不包使用<br>不包括预览视频中图像（就是人物照片与实拍影片）与音乐素材<br>视频预览：<br><video style="width:100%;" src="http://vodcdn.video.taobao.com/oss/ali-video/e57181ee50f54f0ab5d09aa410217a2a/1463458085/video.mp4" controls="" preload="">您的浏览器不支持HTML5的 video 标签，无法为您播放！</video><br>视频截图：<br><img class="islazy size-full" data-original="https://img.alicdn.com/imgextra/i2/2856758419/TB2pZZ1oVXXXXX3XFXXXXXXXXXX_!!2856758419.jpg" src="https://img.alicdn.com/imgextra/i2/2856758419/TB2pZZ1oVXXXXX3XFXXXXXXXXXX_!!2856758419.jpg" alt="AE模板-动感极限运动动作电影游戏宣传片预告片信号损坏视频开场" width="750" height="3740" style="display: block;"><br>下载地址:<a href="https://pan.baidu.com/s/1Eefu1hnL336pMTdPrWd1sg">https://pan.baidu.com/s/1Eefu1hnL336pMTdPrWd1sg</a> 密码：omy0</p>]]></content>
      
      
      <categories>
          
          <category> 素材 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ae模板 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>恢宏大气金色文字</title>
      <link href="/page/1476230064/"/>
      <url>/page/1476230064/</url>
      
        <content type="html"><![CDATA[<p>【版本要求】:建议使用 AE CS6或更高的AE英文版打开<br>【插件要求】:Element V2;Particular<br>【模板尺寸】:1920X1080<br>【时间长度】:14秒<br>【音频】:有<br>【文件大小】:389M<br>【视频截图】:<br><img class="islazy size-full" data-original="https://img.alicdn.com/imgextra/i4/815662356/TB2AndvmthvOuFjSZFBXXcZgFXa_!!815662356.jpg" src="https://img.alicdn.com/imgextra/i4/815662356/TB2AndvmthvOuFjSZFBXXcZgFXa_!!815662356.jpg" alt="pa598 恢宏大气金色文字纪念红军长征胜利80周年AE模板片头源文件" width="750" height="423" style="display: block;"><br>【视频预览】:<br><video style="width:100%;" src="http://mp4.vjshi.com/2016-10-20/14ff56ba7500a9616ea6e693f4ef0291.mp4" controls="" preload="">您的浏览器不支持HTML5的 video 标签，无法为您播放！</video></p><p>下载地址<a href="https://pan.baidu.com/s/1gqNWtWYCc1mFpcBR22Lkgg">https://pan.baidu.com/s/1gqNWtWYCc1mFpcBR22Lkgg</a>  密码：5pxn</p>]]></content>
      
      
      <categories>
          
          <category> 素材 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ae模板 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>迅雷地址、快车地址和QQ旋风地址加解密原理</title>
      <link href="/page/708277890/"/>
      <url>/page/708277890/</url>
      
        <content type="html"><![CDATA[<p>迅雷地址和快车地址的加密方式很简单，其实都是用的Base64加密方式，只不过有一点点的小改动而已。</p><h2 id="1-迅雷链接地址加密方式"><a href="#1-迅雷链接地址加密方式" class="headerlink" title="1. 迅雷链接地址加密方式"></a>1. 迅雷链接地址加密方式</h2><p>迅雷链接地址转换原理是在地址的前方和后方加入两个字母AA、ZZ，然后再进行Base64加密，再加上Thunder://这个专用链接标识，从而转换成迅雷的专用地址。例如：原链接为：<a href="http://www.forece.net/win7.rar%E5%9C%A8%E5%8E%9F%E5%9C%B0%E5%9D%80%E5%89%8D%E9%9D%A2%E5%8A%A0%E2%80%9DAA%E2%80%9D%EF%BC%8C%E5%90%8E%E9%9D%A2%E5%8A%A0%E2%80%9DZZ%E2%80%9D(%E6%B3%A8%EF%BC%9A%E4%B8%8D%E5%8C%85%E6%8B%AC%E5%BC%95%E5%8F%B7)%EF%BC%8C%E5%9C%B0%E5%9D%80%E5%8F%98%E4%B8%BA">http://www.forece.net/win7.rar在原地址前面加”AA”，后面加”ZZ”(注：不包括引号)，地址变为</a><br>AA<a href="http://www.forece.net/win7.rarZZ%E6%AD%A4%E5%9C%B0%E5%9D%80base64%E7%BC%96%E7%A0%81%E4%B8%BA">http://www.forece.net/win7.rarZZ此地址base64编码为</a><br>QUFodHRwOi8vd3d3LmZvcmVjZS5uZXQvd2luNy5yYXJaWg==加入迅雷专链标识，即在上地址前加thunder://，即<br>thunder://QUFodHRwOi8vd3d3LmZvcmVjZS5uZXQvd2luNy5yYXJaWg==</p><h2 id="2-网际快车链接地址加密方式"><a href="#2-网际快车链接地址加密方式" class="headerlink" title="2. 网际快车链接地址加密方式"></a>2. 网际快车链接地址加密方式</h2><p>网际快车的链接地址转换原理和迅雷的类似，只不过是在地址前后加上[FLASHGET]，经过Base64加密，然后在地址前加flashget://这个快车专用链接标识，最后还需要加一个标识符（&amp;符号），符号任意，我一般就加我的名字（&amp;forece），这样就可以将普通http地址转换成快车的地址了。例如：原链接为：<a href="http://www.forece.net/win7.rar%E5%9C%A8%E5%8E%9F%E5%9C%B0%E5%9D%80%E5%89%8D%E5%90%8E%E9%83%BD%E5%8A%A0%E4%B8%8A%E2%80%9D[FLASHGET]%E2%80%9C(%E6%B3%A8%EF%BC%9A%E4%B8%8D%E5%8C%85%E6%8B%AC%E5%BC%95%E5%8F%B7)%EF%BC%8C%E5%9C%B0%E5%9D%80%E5%8F%98%E4%B8%BA[FLASHGET]http://www.forece.net/win7.rar[FLASHGET]">http://www.forece.net/win7.rar在原地址前后都加上”[FLASHGET]“(注：不包括引号)，地址变为[FLASHGET]http://www.forece.net/win7.rar[FLASHGET]</a><br>此地址base64编码为</p><p>W0ZMQVNIR0VUXWh0dHA6Ly93d3cuZm9yZWNlLm5ldC93aW43LnJhcltGTEFTSEdFVF0=</p><p>加上快车专链标识和结尾符号，即在上地址前加flashget://，结尾加&amp;forece，即</p><p>flashget://W0ZMQVNIR0VUXWh0dHA6Ly93d3cuZm9yZWNlLm5ldC93aW43LnJhcltGTEFTSEdFVF0=&amp;forece</p><p>“&amp;符号”，符号怎么得出我也不清楚，只是看网上别人这么写的，至今无人报错。</p><h2 id="3-QQ旋风链接地址加密方式"><a href="#3-QQ旋风链接地址加密方式" class="headerlink" title="3. QQ旋风链接地址加密方式"></a>3. QQ旋风链接地址加密方式</h2><p>QQ旋风的地址转换相对就简单多了，将原地址直接base64编码加密就可以了，然后加上标识符qqdl://即可。例如：原链接为：<a href="http://www.forece.net/win7.rar%E6%AD%A4%E5%9C%B0%E5%9D%80base64%E7%BC%96%E7%A0%81%E4%B8%BA">http://www.forece.net/win7.rar此地址base64编码为</a><br>aHR0cDovL3d3dy5mb3JlY2UubmV0L3dpbjcucmFy</p><p>再加上旋风专链标识，在上地址前加qqdl://，即</p><p>qqdl://aHR0cDovL3d3dy5mb3JlY2UubmV0L3dpbjcucmFy</p><p>这样，普通的http地址就可以轻松的转换成快车，迅雷，旋风的地址了。相反，解密只要将过程反推即可。同样还是利用Base64加密，解密工具。迅雷地址和快车地址的加密方式很简单，其实都是用的Base64加密方式，只不过有一点点的小改动而已。</p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 破解方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>云更新无盘各版本官方下载地址</title>
      <link href="/page/1778183789/"/>
      <url>/page/1778183789/</url>
      
        <content type="html"><![CDATA[<p>云更新是专业高效的网吧数字内容管理软件,用户可以通过云更新搭建的三层更新平台实现海量娱乐内容的自动更新和下载，轻松完成娱乐内容的添加、管理和更新等一系列复杂的工作。云更新官方网站上只提供最新的云更新版本下载，以前的版本不提供下载，如果你需要下载以前的版本怎么办呢？</p><ol><li>云更新5498版的官方下载地址：(此版会被强制更新)<br>云更新5498版服务端安装包下载：<a href="http://file.yungengxin.com/Soft/download/Server_x64_2017.1.15.5498_Setup.zip">http://file.yungengxin.com/Soft/download/Server_x64_2017.1.15.5498_Setup.zip</a><br>云更新5498版客户端安装包下载：<a href="http://file.yungengxin.com/Soft/download/Client2017.1.15.5498_Setup.zip">http://file.yungengxin.com/Soft/download/Client2017.1.15.5498_Setup.zip</a></li><li>云更新6596版的官方下载地址：<br>云更新6596服务端安装包下载：<a href="http://file.yungengxin.com/Soft/download/Server_x64_2017.6.15.6596_Setup.zip">http://file.yungengxin.com/Soft/download/Server_x64_2017.6.15.6596_Setup.zip</a><br>云更新6596客户端安装包下载：<a href="http://file.yungengxin.com/Soft/download/Client2017.6.15.6596_Setup.zip">http://file.yungengxin.com/Soft/download/Client2017.6.15.6596_Setup.zip</a><br>云更新6596开包升级工具下载：<a href="http://file.yungengxin.com/Soft/download/ClientUpdate2017.6.15.6596.zip">http://file.yungengxin.com/Soft/download/ClientUpdate2017.6.15.6596.zip</a></li><li>云更新7625版的官方下载地址：<br>云更新7625服务端和客户端安装包下载：<a href="http://file.yungengxin.com/Soft/download/Standard_2017.10.15.7625.zip">http://file.yungengxin.com/Soft/download/Standard_2017.10.15.7625.zip</a></li></ol><p>看出什么端倪了吗？云更新官网虽然不提供旧版本的下载链接，实际上旧版本文件是存在云更新服务器上的，所有旧版本均存放在<a href="http://file.yungengxin.com/Soft/download/">http://file.yungengxin.com/Soft/download/</a>中的，如果此地址允许目录列表，那么就可以把云更新版本全部下载了，但此地址不支持目录列表，所以需要你知道你需要下载的文件的文件名！但我们可以看出，以前的版本服务端都这样按日期和版本号命名的，比如Server_x64_2017.1.15.5498_Setup.zip，指的是64位服务端(Server_x64)，发期日期是2017.1.15，版本号是5498，只要你知道这些就可以试着下载了。下面是我们从云更新服务器下载后保存到百度云上的!<br>百度云下载 链接: <a href="https://pan.baidu.com/s/1529CfcnaEmoqP1gI01ELBw">https://pan.baidu.com/s/1529CfcnaEmoqP1gI01ELBw</a> 密码: 3kht</p>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文章 </tag>
            
            <tag> 云更新 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>学习外挂的外挂源代码</title>
      <link href="/page/4071443873/"/>
      <url>/page/4071443873/</url>
      
        <content type="html"><![CDATA[<p>01:可得到在网页中输入的用户名和密码的源代码 VC源代码<br><img src="/images/1519920352-01.jpg" alt=""><br>02:传2脱机源代码 VC源代码<br>03:传2机器人源代码 VC源代码<br><img src="/images/1519920383-03.jpg" alt=""><br>04:封包截取的源码,值得学习 VC源代码<br>05:神迹外挂挂源码 VC源代码<br>06:系统加速源代码 DELPHI源代码<br>07:传2外挂源码 ,功能丰富,是不可多得的源码 DELPHI源代码<br>08:神迹脱机外挂源码 DELPHI源代码<br>09:内存修改器源代码 VB源代码<br><img src="/images/1519920425-09.jpg" alt=""><br>10:Winsock 详细使用例程 VB源代码<br>11:内存搜索及修改源代码 VB源代码<br><img src="/images/1519920444-11.jpg" alt=""><br>12:QQ消息自动发送器,有许多API操作值得学习 VB源代码<br>13:读写INI文件的操作,值得学习 VB源代码<br>14:截取封包的操作 VB源代码<br>15:又一个内存修改器的源代码 VB源代码<br><img src="/images/1519920463-15.jpg" alt=""><br>16:剑侠补血源码 VB源代码<br><img src="/images/1519920484-16.jpg" alt=""><br>17:绿光抓包器，很好用 BC源代码<br>18:封包截取源代码 VC源代码<br>19:CS最有名的作敝器ORC9源码 VC源代码<br>20:mu窗口化源码 VC源代码<br>21:系统加速源码 VB源代码<br>22:魔力宝贝和石器时代解图工具源码 VC源代码<br>23:刀剑online 内存查看（HP，MP等） VB源代码<br><img src="/images/1519920511-23.jpg" alt=""><br>24 :巨好的传奇2外挂 VC源代码<br><img src="/images/1519920532-24.jpg" alt=""><br>25：巨好的龙族外挂源码 VB源代码<br><img src="/images/1519920573-25.jpg" alt=""><br>26：传奇封包分析器 VB源代码<br><img src="/images/1519920595-26.jpg" alt=""><br>27：DiabloII的外挂源代码 VC源代码<br>28：JoolzCheat源码（著名游戏CS1.5版作弊器ogc-para源码） VC源代码<br>29：传奇自动发言外挂 VC源代码<br><img src="/images/1519920617-29.jpg" alt=""><br>30：盛大传奇外挂源码 VC源代码<br>31：新大话西游经典系列源代码 VC源代码<br>32：自动释放ASN聚气外挂源代码 VC源代码<br>33:天翼脱机外挂源码（强力推荐） DELPHI源代码<br><img src="/images/1519920636-33.jpg" alt=""><br>34：内存查找修改器 （和FPE GE一样，查找速度极快） DELPHI源代码<br><img src="/images/1519920662-34.jpg" alt=""><br>35：又一个内存查找修改器 DELPHI源代码<br><img src="/images/1519920678-35.jpg" alt=""><br>36：内存查找修改 DELPHI源代码<br><img src="/images/1519920697-36.jpg" alt=""><br>37：BlowFish解密函数 DELPHI源代码<br>38:lose-v0.41beta-win32-src DELPHI源代码<br>39：传奇VB代码-Group.dat文件解密代码 VB源代码<br>40：刀剑自动补血 VB源代码<br>41：金庸小外挂 VB源代码<br>42：腾讯QQ游戏–对对碰外挂制作教程详解 VB源代码<br>43：APIhook DELPHI源代码<br>44：APIHOOK VC源代码<br>45：一个呼出热键的示例 DELPHI源代码<br>46：mir外挂 易语言<br>47：奇迹登陆器 VB源代码<br>48：QQ对对碰小外挂 DELPHI源代码<br>49：好像是封神ONLINE的东西 VC源代码<br>50：一个极好的钩子教材 易语言<br>51：传世地图 BC源代码<br>52：奇迹登录器的E源码 易语言<br>53：对对碰挂机 VC源代码<br>54：库库神仙的防大补贴 DELPHI源代码<br>55：扫雷外挂 DELPHI源代码<br>56：毁灭天使2源代码 易语言</p><h3 id="全部源代码下载地址："><a href="#全部源代码下载地址：" class="headerlink" title="全部源代码下载地址："></a>全部源代码下载地址：</h3><p>链接: <a href="https://pan.baidu.com/s/1Nr_ujf-OWGVZh1DrYdd6SA">https://pan.baidu.com/s/1Nr_ujf-OWGVZh1DrYdd6SA</a> 提取码: amnp 复制这段内容后打开百度网盘手机App，操作更方便哦</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基址查找方法 </tag>
            
            <tag> delphi源码 </tag>
            
            <tag> 游戏外挂方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在游戏中切出外挂delphi代码</title>
      <link href="/page/1318062081/"/>
      <url>/page/1318062081/</url>
      
        <content type="html"><![CDATA[<p>需要用DLL方式调用:<br>这是DLL的DPR文件:</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span> Hook32;</span><br><span class="line"> </span><br><span class="line"><span class="comment">&#123; Important note about DLL memory management: ShareMem must be the</span></span><br><span class="line"><span class="comment">first unit in your library&#x27;s USES clause AND your project&#x27;s (select</span></span><br><span class="line"><span class="comment">Project-View Source) USES clause if your DLL exports any procedures or</span></span><br><span class="line"><span class="comment">functions that pass strings as parameters or function results. This</span></span><br><span class="line"><span class="comment">applies to all strings passed to and from your DLL--even those that</span></span><br><span class="line"><span class="comment">are nested in records and classes. ShareMem is the interface unit to</span></span><br><span class="line"><span class="comment">the BORLNDMM.DLL shared memory manager, which must be deployed along</span></span><br><span class="line"><span class="comment">with your DLL. To avoid using BORLNDMM.DLL, pass string information</span></span><br><span class="line"><span class="comment">using PChar or ShortString parameters. &#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">uses</span></span><br><span class="line">SysUtils,Forms,</span><br><span class="line">Classes,</span><br><span class="line">myDLl <span class="keyword">in</span> <span class="string">&#x27;myDLl.pas&#x27;</span> <span class="comment">&#123;Form1&#125;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="meta">&#123;$R *.res&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">exports</span></span><br><span class="line">HookOn,HookOff;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="comment">&#123;Application.Initialize;</span></span><br><span class="line"><span class="comment">Application.Run; &#125;</span></span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure><p>这是DLL的PAS文件:</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unit</span> myDLl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">interface</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">uses</span></span><br><span class="line">Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,</span><br><span class="line">Dialogs, StdCtrls;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">type</span></span><br><span class="line"><span class="title">TForm1</span> = <span class="keyword">class</span>(TForm)</span><br><span class="line">Button1: TButton;</span><br><span class="line">Edit1: TEdit;</span><br><span class="line">Memo1: TMemo;</span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">Button1Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">FormClose</span><span class="params">(Sender: TObject; <span class="keyword">var</span> Action: TCloseAction)</span>;</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">FormDestroy</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">FormActivate</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">private</span></span><br><span class="line"><span class="comment">&#123; Private declarations &#125;</span></span><br><span class="line"><span class="keyword">public</span></span><br><span class="line"><span class="comment">&#123; Public declarations &#125;</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">Form1: TForm1;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HookProc</span><span class="params">(nCode:Integer;WParam: WPARAM;LParam:LPARAM)</span>:</span>LRESULT;<span class="keyword">stdcall</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HookOn</span><span class="params">(lpHwnd:HWND;lpType:Longint)</span>:</span>Longint;<span class="keyword">stdcall</span>;<span class="keyword">export</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HookOff</span>:</span>Boolean;<span class="keyword">stdcall</span>;<span class="keyword">export</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">implementation</span></span><br><span class="line"><span class="comment">&#123;type KeyboardBytes=record</span></span><br><span class="line"><span class="comment">kbArray:array[0..255] of byte;</span></span><br><span class="line"><span class="comment">end;&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">hHk: HHOOK=<span class="number">0</span>;</span><br><span class="line">hMOUSEHk: HHOOK=<span class="number">0</span>;</span><br><span class="line">mhwnd:HWND=<span class="number">0</span>;</span><br><span class="line">bShow:Boolean=False;</span><br><span class="line">myKey:Byte=VK_F7;</span><br><span class="line">kbArray:TKeyboardState;</span><br><span class="line">hThread: Cardinal;</span><br><span class="line">hmod: Pointer; <span class="comment">//Hinstance</span></span><br><span class="line">hProcessId: Cardinal;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// KeyHookStruct:^THardwareHookStruct;</span></span><br><span class="line">mMode:Integer;</span><br><span class="line"> </span><br><span class="line"><span class="meta">&#123;$R *.dfm&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HookProc</span><span class="params">(nCode:Integer;WParam: WPARAM;LParam:LPARAM)</span>:</span>LRESULT;<span class="keyword">stdcall</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Result :=<span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> nCode&lt;<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">Result := CallNextHookEx(hHk,nCode,WParam,LParam)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">GetKeyboardState(kbArray);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (bShow=False) <span class="keyword">And</span> (kbArray[myKey]=<span class="number">1</span>) <span class="keyword">then</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">bShow:=True;</span><br><span class="line">Form1:=TForm1.Create(Application);</span><br><span class="line">ShowCursor(true);</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line"><span class="comment">// Form1.Caption :=&#x27;我的DLL中的窗体！&#x27;;</span></span><br><span class="line"><span class="comment">// LockWindowUpdate(mhwnd);</span></span><br><span class="line"><span class="comment">/// SetParent(Form1.Handle,mhwnd);</span></span><br><span class="line"><span class="comment">// MoveWindow(Form1.Handle,1,1,2,2,True);</span></span><br><span class="line"><span class="comment">// UpdateWindow(Form1.Handle);</span></span><br><span class="line"><span class="comment">// UpdateWindow(mhwnd);</span></span><br><span class="line">SetWindowPos(Form1.Handle, HWND_TOPMOST, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, SWP_NOMOVE <span class="keyword">Or</span> SWP_NOSIZE);</span><br><span class="line"><span class="comment">// UpdateWindow(mhwnd);</span></span><br><span class="line"><span class="comment">// mMode:=GetMapMode(GetDC(mhwnd));</span></span><br><span class="line"><span class="comment">// SetMapMode(GetDC(Form1.Handle),mMode);</span></span><br><span class="line"><span class="comment">// UpdateWindow(Form1.Handle);</span></span><br><span class="line"><span class="comment">// SetWindowLong(Form1.Handle,GWL_STYLE,GetWindowLong(mhwnd, GWL_STYLE));</span></span><br><span class="line"> </span><br><span class="line">Result :=<span class="number">1</span>;</span><br><span class="line">SuspendThread(hThread);</span><br><span class="line">Form1.ShowModal;</span><br><span class="line">ShowCursor(true);</span><br><span class="line">ResumeThread(hThread);</span><br><span class="line">kbArray[myKey] := <span class="number">0</span>;</span><br><span class="line">SetKeyboardState(kbArray);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">finally</span></span><br><span class="line">Form1.Free;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Result := CallNextHookEx(hHk,nCode,WParam,LParam);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HookOn</span><span class="params">(lpHwnd:HWND;lpType:Longint)</span>:</span> Longint;<span class="keyword">stdcall</span>; <span class="keyword">export</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">mhwnd:=lpHwnd;</span><br><span class="line"><span class="keyword">if</span> hHk&lt;&gt;<span class="number">0</span> <span class="keyword">then</span> UnHookWindowsHookEx(hHk);</span><br><span class="line">hThread :=GetWindowThreadProcessId(mhwnd,hmod);</span><br><span class="line"><span class="comment">// hProcessId:=cardinal(hmod);</span></span><br><span class="line"><span class="comment">// Sleep(200);</span></span><br><span class="line">hHk :=SetWindowsHookEx(lpType,@HookProc,hInstance,hThread); <span class="comment">// WH_KEYBOARD</span></span><br><span class="line">Result :=hHk</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HookOff</span>:</span>Boolean;<span class="keyword">stdcall</span>; <span class="keyword">export</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">if</span> hHk&lt;&gt;<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">UnHookWindowsHookEx(hHk);</span><br><span class="line">hHk :=<span class="number">0</span>;</span><br><span class="line">Result :=true;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">Result :=false;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">FormClose</span><span class="params">(Sender: TObject; <span class="keyword">var</span> Action: TCloseAction)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">bShow:=False;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">FormDestroy</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">bShow:=False;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">Button1Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Form1.close;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">FormActivate</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">ShowCursor(true);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure><p>这是调用的程序PAS</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unit</span> Unit1;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">interface</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">uses</span></span><br><span class="line">Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,</span><br><span class="line">Dialogs, StdCtrls, ExtCtrls;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">type</span></span><br><span class="line"><span class="title">TForm1</span> = <span class="keyword">class</span>(TForm)</span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">FormCreate</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">FormClose</span><span class="params">(Sender: TObject; <span class="keyword">var</span> Action: TCloseAction)</span>;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">private</span></span><br><span class="line"><span class="comment">&#123; Private declarations &#125;</span></span><br><span class="line"><span class="keyword">public</span></span><br><span class="line"><span class="comment">&#123; Public declarations &#125;</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">Form1: TForm1;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HookOn</span><span class="params">(lpHwnd:HWND;lpType:Longint)</span>:</span>Longint;<span class="keyword">stdcall</span>;<span class="keyword">external</span> <span class="string">&#x27;HOOK32.DLL&#x27;</span> <span class="keyword">name</span> <span class="string">&#x27;HookOn&#x27;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HookOff</span>:</span>Boolean;<span class="keyword">stdcall</span>;<span class="keyword">external</span> <span class="string">&#x27;HOOK32.DLL&#x27;</span> <span class="keyword">name</span> <span class="string">&#x27;HookOff&#x27;</span>;</span><br><span class="line"><span class="keyword">implementation</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">&#123;$R *.dfm&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">FormCreate</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">hHandle:HWND;</span><br><span class="line">hProID:HWND;</span><br><span class="line">hThrID:HWND;</span><br><span class="line">h1:HWND;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="comment">//这些只是自身程序的，没什么用。</span></span><br><span class="line">hHandle:=Application.Handle;</span><br><span class="line">hProID:=GetCurrentProcessId();</span><br><span class="line">hThrID:=GetCurrentThreadId();</span><br><span class="line">h1:=FindWindow(<span class="keyword">NIL</span>,<span class="string">&#x27;你的程序&#x27;</span>);<span class="comment">//这是窗口的句柄，要自己找到后，填写入。</span></span><br><span class="line">HookOn(h1,WH_KEYBOARD);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">FormClose</span><span class="params">(Sender: TObject; <span class="keyword">var</span> Action: TCloseAction)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">hookoff;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基址查找方法 </tag>
            
            <tag> delphi源码 </tag>
            
            <tag> 游戏外挂方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Delphi中那些容易混淆的基础知识</title>
      <link href="/page/1150891238/"/>
      <url>/page/1150891238/</url>
      
        <content type="html"><![CDATA[<h2 id="1-、-、Addr、Pointer"><a href="#1-、-、Addr、Pointer" class="headerlink" title="1. @、^、Addr、Pointer"></a>1. @、^、Addr、Pointer</h2><p>Delphi(Pascal)中有几个特殊的符号，如@、^等，弄清楚这些符号的运行，首先要明白Delphi指针的一些基础知识：指针，是一个无符号整数（unsigned int），它是一个以当前系统寻址范围为取值范围的整数。指针对应着一个数据在内存中的地址，得到了指针就可以自由地修改该数据。指针的指针就是用来存放指针所在的内存地址的。<br>明白了指针的基本含义，就容易理解它们之间 的区别了：</p><ul><li>@XX：取变量、函数或过程XX的地址（获取指针）；</li><li>Addr(XX)：和@的作用类似，唯一的不同在于如果编译选项{$T-}没有打开，@返回的是一个通用的指针，如果编译选项打开了，@返回的是XX对应的指针，但Addr却不受此编译选项的约束。</li><li>^：当它出现在类型定义的前面时如 ^typename 表示指向这种类型的指针; 当它出现在指针变量后边时 如 point^ 返回指针指向的变量的值;</li><li>Pointer：无类型指针（对应PChar、PInteger等则为“有类型指针”）。<br>通过这段代码则更容易区分它们：<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span></span><br><span class="line">X, Y: Integer;  <span class="comment">// X and Y 整数类型</span></span><br><span class="line">P: ^Integer;  <span class="comment">// P 指向整数类型的指针</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">X := <span class="number">11</span>;  <span class="comment">// 给 X 赋值</span></span><br><span class="line">P := @X;  <span class="comment">// 把 x的地址赋给p</span></span><br><span class="line">Y := P^;  <span class="comment">// 取出p所指向的数值赋给y</span></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>第二行定义了两个变量X，Y。 第三行声明了P是指向整数类型的指针；意味着P能够指向X或者Y的地址。第五行赋给X值，第六行把X的地址赋给P。最后通过P指向的变量赋值给Y。此时，X和Y有相同的值。<h2 id="2-Char、Byte"><a href="#2-Char、Byte" class="headerlink" title="2. Char、Byte"></a>2. Char、Byte</h2></li><li>Char是一个字符，必须赋以字符如‘A’等；</li><li>Byte是无符号整数，数值范围0~255。<br>虽然字符实质上也是整数，但与C不同，Delphi中将他们划为两种不同的类型，各自遵从不同的运算。比如运算符+对于Byte是整数加法，对于Char则是字符连接成串。<br>他们可以相互转化：Ord(‘A’)得到字符对应的整数，Chr(65)得到整数对应的字符。<br>同理，就很好区分array of Byte和array of Char了。<h2 id="3-Move、CopyMemory"><a href="#3-Move、CopyMemory" class="headerlink" title="3. Move、CopyMemory"></a>3. Move、CopyMemory</h2>Move字面意思上是“移动”的意思，其实不然，在Delphi中Move更像是Copy：它可以复制一段内存片段到另外一段内存空间中。如下代码：<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span></span><br><span class="line">  source, dest : <span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">// Set up our starting string</span></span><br><span class="line">  source := <span class="string">&#x27;123456789&#x27;</span>;</span><br><span class="line">  dest   := <span class="string">&#x27;---------&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// Copy a substring from source into the middle of dest</span></span><br><span class="line">  Move(source[<span class="number">5</span>], dest[<span class="number">3</span>], <span class="number">4</span>);</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// Show the source and destination strings</span></span><br><span class="line">  ShowMessage(<span class="string">&#x27;Source = &#x27;</span>+source);</span><br><span class="line">  ShowMessage(<span class="string">&#x27;Dest   = &#x27;</span>+dest);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">//结果------------------</span></span><br><span class="line"><span class="comment">//Source = 123456789</span></span><br><span class="line"><span class="comment">//Dest   = --5678---</span></span><br></pre></td></tr></table></figure>而CopyMemory则可以在Delphi的源码中看出端倪：<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">CopyMemory</span><span class="params">(Destination: Pointer; Source: Pointer; Length: DWORD)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Move(Source^, Destination^, Length);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>可以看出，CopyMemory其实也是调用了Move方法，但参数变了，CopyMemory参数是指针。当然，从源码还可以发现MoveMemory和CopyMemory是一模一样的功能。<br>CopyMemory一般的使用方法为：<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span></span><br><span class="line">  buf1,buf2: <span class="keyword">array</span>[<span class="number">0</span>..<span class="number">9</span>] <span class="keyword">of</span> AnsiChar;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  buf1 := <span class="string">&#x27;0123456789&#x27;</span>;</span><br><span class="line">  buf2 := <span class="string">&#x27;abcdefghij&#x27;</span>;</span><br><span class="line">  CopyMemory(@buf2[<span class="number">2</span>], @buf1[<span class="number">4</span>], <span class="number">5</span>);</span><br><span class="line">  ShowMessage(buf1); <span class="comment">&#123;0123456789&#125;</span></span><br><span class="line">  ShowMessage(buf2); <span class="comment">&#123;ab45678hij&#125;</span></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h2 id="4-GetMem和FreeMem、GetMemory和FreeMemory、New和Dispose、StrAlloc和StrDispose、AllocMem"><a href="#4-GetMem和FreeMem、GetMemory和FreeMemory、New和Dispose、StrAlloc和StrDispose、AllocMem" class="headerlink" title="4. GetMem和FreeMem、GetMemory和FreeMemory、New和Dispose、StrAlloc和StrDispose、AllocMem"></a>4. GetMem和FreeMem、GetMemory和FreeMemory、New和Dispose、StrAlloc和StrDispose、AllocMem</h2>Delphi中的内存申请和释放方法比较多，但有一点儿需要牢记的是上述方法建议配对使用。<br>GetMem和FreeMem与GetMemory和FreeMemory在Delphi的源码中可以看到是被调用和调用的关系，FreeMemory会判断指针是否为空：<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetMemory</span><span class="params">(Size: Integer)</span>:</span> Pointer; <span class="keyword">cdecl</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Result := MemoryManager.GetMem(Size);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FreeMemory</span><span class="params">(P: Pointer)</span>:</span> Integer; <span class="keyword">cdecl</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">if</span> P = <span class="keyword">nil</span> <span class="keyword">then</span></span><br><span class="line">    Result := <span class="number">0</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    Result := MemoryManager.FreeMem(P);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>因此，建议用GetMemory和FreeMemory代替GetMem和FreeMem。<br>New和Dispose是用来管理变体类型内存分配，如变体结构体：<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TRecord = <span class="keyword">record</span></span><br><span class="line">Text: <span class="keyword">string</span>;</span><br><span class="line">Value: Integer;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">PRecord = ^TRecord;</span><br></pre></td></tr></table></figure>如果用GetMem和FreeMem、GetMemory和FreeMemory来释放，会造成Text的内存没有释放，造成内存泄漏。如果用Dispose来释放指针，要加上定义信息，否则造成内存泄漏，正确写法Dispose(PRecord(Point))。另外需要注意的一点是：Delphi设计的Dispose释放内存时，只是标记这部分内存可以再用来被New等函数分配，并不是把从系统申请到的内存归还给操作系统，只在程序结束时，才全部释放给操作系统，因此并不能在资源管理器中看到Dispose的“显著效果”。<br>一般使用方法如下：<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Type</span></span><br><span class="line">　PMyRec = ^TMyRec;</span><br><span class="line">　TMyRec = <span class="keyword">record</span></span><br><span class="line">　　FName: <span class="keyword">string</span>;</span><br><span class="line">　　LName: <span class="keyword">string</span>;</span><br><span class="line">　<span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">　MyRecPtr: PMyRec;</span><br><span class="line">　TreeViewIndex: LongInt;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">　New(MyRecPtr);</span><br><span class="line">　MyRecPtr^.FName := Edit1.Text;</span><br><span class="line">　MyRecPtr^.LName := Edit2.Text;</span><br><span class="line">　<span class="comment">&#123;其他处理&#125;</span></span><br><span class="line">　Dispose(MyRecPtr);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>StrAlloc和StrDispose这个函数也是一对，他们分配PChar加一个Cardinal长度，因此一定要用StrDispose释放，否则容易造成4字节的内存泄漏。StrAlloc分配的指针可以使用StrBufSize来获得大小。<br>AllocMem和GetMem的区别在于AllocMem在申请内存后会初始化这段内存（把内存全部初始化为#0），同样和FreeMem配对使用。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ce6.7中文版及CE找基址教程</title>
      <link href="/page/369867878/"/>
      <url>/page/369867878/</url>
      
        <content type="html"><![CDATA[<p>Cheat Engine(作弊引擎ce) 是一款内存修改编辑工具 ，它允许你修改你的游戏或软件内存数据，以得到一些其他功能。它包括16进制编辑，反汇编程序，内存查找工具。与同类修改工具相比，它具有强大的反汇编功能，且自身附带了外挂制作工具，可以用它直接生成外挂。<br>CE游戏修改器(cheat engine)的原理其实很简单，如果学过编程的人一定会知道debug这个工具，debug是可以反汇编的，只不过是手工的非常的麻烦，而CE游戏修改器(cheat engine)让反汇编变得更为简单，可以跟踪特定数字的内存地址，通过修改这些数字来达到修改游戏数据的目的，从而达到轻松过关或永远打不死等等。<br><img src="/images/1518189492-1.png" alt=""><br>CE游戏修改器(cheat engine)是国外的一款非常优秀的内存修改软件，用这个软件的游戏爱好者不计其数，他不但可以修改Flash游戏，对其他单机游戏也同样所向披靡。 CE内存修改器(Cheat Engine)用法也不是很复杂，首先是要先打开游戏，然后打开Cheat Engine软件，点击左上角的那个电脑图标，在弹出来的框中选择游戏进程，然后选择扫描类型和数值类型，进行扫描并修改!</p><p>CE 官方网站：<a href="http://cheatengine.org/">http://cheatengine.org/</a><br>CE 官方中文翻译包： <a href="http://cheatengine.org/download/ch_cn.zip">http://cheatengine.org/download/ch_cn.zip</a><br>GitHub 下载地址：<a href="https://github.com/cheat-engine/cheat-engine/releases">https://github.com/cheat-engine/cheat-engine/releases</a><br>CE 官方教程：<a href="http://wiki.cheatengine.org/index.php?title=Tutorials">http://wiki.cheatengine.org/index.php?title=Tutorials</a><br>吾爱站下载：<a href="https://down.52pojie.cn/Tools/Debuggers/Cheat%20Engine%20v6.7.exe">https://down.52pojie.cn/Tools/Debuggers/Cheat%20Engine%20v6.7.exe</a></p><p>在官方下载ce安装包，安装完成后，下载中文翻译包，解开，把ch_cn放在ce安装目录的languages子目录中，启动ce会提示你使用english还是 ch_cn，选好ch_cn语言重启ce就是中文界面了!<br>为了快速上手使用CE，CE自己提供了一个教学程序Tutorial.exe，这个教学程序有两个版本，一个是32位版Tutorial-i386.exe和64位版Tutorial-x86_64.exe</p><p>以下是CE6.7 Tutorial教学程序过步骤1到步骤9的教程，本教程每一步，都找出了基址，比其他的教程稍难，但在实践应用中，基本上都是需要找出修改内存地址的基址!</p><p>CE找基址是外挂最为关键的步骤，把基址找出来了，就可以做成外挂了，所以基址会找了就会制作外挂!就可以使用CE修改其他程序或游戏的数据了!</p><ol><li><p>ce6.7 Tutorial3.3教学步骤1  (密码:090453)<br>欢迎使用 Cheat Engine 训练教程。 (v3.3)本教程将尝试讲解在游戏中作弊的一些基本知识，并帮助你熟悉 Cheat Engine 的使用方法。首先要执行 Cheat Engine ，如果你还没有运行它的话。然后点击”选择进程”图标按钮（左上角那个带有电脑的图标）。当进程列表窗口打开后找到这个训练程序，如果你没有重新命名该程序的名称，那么进程名应该”tutorial.exe”，选择它，并点击”打开”。现在暂时不要理会其它的按钮，如果你有兴趣的话，以后再研究它们。没什么意外的话，进程列表窗口将会消失并且在 Cheat Engine 主界面的上方会显示选择的进程名称。好了，点击”下一步”按钮进入下一个步骤（或输入密码进入你要练习的步骤）。</p><img src="/images/1518190799-2.gif" alt=""></li><li><p>ce6.7 Tutorial3.3教学步骤2<br>步骤 2: 精确值扫描 (密码=090453)现在你已经在 Cheat Engine 中打开了训练程序，为我们下一步的练习做好了准备。本窗口的左下方显示的”健康:XXX”，在你每次点击”打我”按钮时，它的值便会减少。要进入下一关，你必须找到这个数值并把它改成 1000 。很多方法都可以找到这个数值的位置，但我将告诉你一个最简单的方法，”精确数值”扫描：首先确认数值类型设置为2字节或4字节，设置成1字节也可以的，不过最终修改数据的时候便会有点麻烦了（虽然说这是很容易解决的问题）。假如该地址后边的字节数值都为 0 ，那么你设置成 8 字节也未尝不可，在这我们就不必尝试了。单浮点数，双浮点数，以及其他的扫描方法在这里行不通的，因为它们储存数值的方式不同。当数值类型设置正确后，确认扫描类型设置了”精确数值”，把健康值填写在数值的输入框，并点击”首次扫描”，稍等一会儿（假设你的电脑非常的慢），扫描完毕，扫描的结果将会显示在主界面的左侧。<br>如果检索结果多于一个，你无法确定哪一个是正确的地址，那么继续点击”打我”，并将变更后的”健康值”填写在数值输入框中，点击”再次扫描”，重复这些步骤，直到你能确认已经找到了地址（在地址列表中只有一个地址）。好，双击左侧列表中的地址，该地址便会移动到下方的地址列表中并显示它的当前数值。双击下方地址列表中的数值（或者选择它，按下回车），填写你要修改的数值：1000 。如果操作正确，”下一步”按钮将变成可点击状态，本关就完成了。提示：如果你在扫描过程中出现了错误，可以点击”新的扫描”重新再来。当然，你也可以点击”打我”去查找一些更有价值的线索。<br>以下是CE找基址的步骤1到步骤9的视频教程</p><iframe style="width:100%" frameborder="0" height="600" src="http://player.youku.com/embed/XMzQwMDcxOTQzMg==" allowfullscreen=""></iframe></li><li><p>ce6.7 Tutorial3.3教学步骤3<br>步骤 3: 未知的初始值 (密码=419482)<br>OK, 看来你已经理解了如何利用”精确数值”扫描查找数值了，让我们进行下一步。在上一关中我们知道初始数值的大小，所以我们可以利用”精确数值”扫描，但本关中仅有一个状态栏，我们并不知道它的初始数值。我们只知道这个数值在0到500之间，并且每次点击”打我”之后便会减些健康值，每次减少的健康值会显示在进度条的上方。同样有好几种方法可以找这个数值，（例如使用”数值减少了…”扫描方式），但我只教你最简单的方法，”未知的初始值”和”减少的数值”。 由于不知道当前数值的大小，”精确数值”扫描便派不上了用场，所以选择扫描方式”未知初始数值”。数值类型仍然选择 4 字节（这是因为大多数WINDOWS应用程序都使用 4 字节存放数据）。点击”首次扫描”并等待扫描结束。扫描完成后，点击”打我”，你会减少一些健康值。（减少的健康值显示几秒便会消失，你并不需要刻意记下它）。回到 Cheat Engine，在扫描类型中选择”减少的数值”，然后点击”再次扫描”。扫描完毕后，再次点击”打我”，并重复上述步骤，直到检索出很少的几个地址。 我们已经知道这个数值在0到500之间，所以挑出那个最为相似的地址，并将它加到下方的地址列表。现在，更改健康值为 5000，以便我们进入到下一关。</p></li><li><p>ce6.7 Tutorial3.3教学步骤4<br>步骤 4: 浮点数 (密码=890124)<br>在前面的教程中我们使用字节的方式进行扫描，但有些游戏使用了”浮点数”来存储数值（这么做是为了给菜鸟制造一些麻烦，让他们没那么容易修改游戏）。浮点数是带有小数点的数值（如 5.12 或 11321.1）。正如本关中的健康和弹药，两者都以浮点方法储存数据，不同的是，健康值为单精度浮点数，而弹药值为双精度浮点数。点击”打我”将减少一些健康值，而点击”开火”则消耗掉 0.5 的弹药。你得把这两项都修改到 5000 或者更多才能过关。”精确数值”扫描的方式虽然也可以完成本关的工作，但你应该试试其它更简练的扫描方式。<br>提示: 扫描双浮点数类型建议禁用 “快速扫描”</p></li><li><p>ce6.7 Tutorial3.3教学步骤5<br>步骤 5: 代码查找 (密码=888899)某些游戏重新开始时，数据会存储在与上次不同的地方, 甚至游戏的过程中数据的存储位置也会变动。在这种情况下，你还是可以简单几步搞定它。这次我将尽量阐述如何运用”代码查找”功能。下方的数值每次启动教程的时候都会存放在内存不同的位置，所以地址列表中的固定地址是不起作用的。我们要先找到这个数值当前的存储地址（要如何去做，相信不用我再啰嗦了）。当你找到了地址就添加在下方的地址列表中，然后右健单击该地址，在弹出的菜单中选择”找出是什么改写了这个地址”，将弹出一个空白的窗口。接着点击本教程窗体上的”改变数值”按钮，并返回 Cheat Engine 。如果操作没问题 在刚才弹出的空白窗口中会出现一些汇编代码。选中代码并点击”替换”按钮，将它替换成什么也不做的代码（空指令），同时，修改后的代码也将放置在”高级选项”的代码列表中去（保存地址列表时会同时保存）。点击”停止”，游戏会以正常的方式继续运行下去，点击”关闭”按钮，关掉窗口。现在，再次点击教程窗口上的”改变数值”，没问题的话，”下一步”将变为可点击的状态。提示：如果你以足够快的速度锁定住该地址，”下一步”按钮也会变为可点击的。</p></li><li><p>ce6.7 Tutorial3.3教学步骤6<br>步骤 6: 指针: (密码=098712)上一步阐述了如何使用”代码查找”功能对付变化位置的数据地址，但这种方法往往不能达到预期的效果，所以我们需要学习如何利用指针。在本关的 Tutorial.exe 窗口下面有两个按钮，一个会改变数值，另一个不但能改变数值而且还会改变数值在内存中存储的位置。这一步，你不需要懂得汇编，但如果懂的话会很有帮助。首先找到数值的地址，然后再查找是什么改写了这个地址。再次改变数值，CE 便可以列出找到的汇编代码。 双击一行汇编代码（或选择它并点击”详细信息”）并打开”详细信息”窗口以显示详细的信息，用来告诉你当这个指令运行时发生了什么事情。如果在这条汇编指令中没看到方括号（[]）的存在，我们就应该查看下一条汇编代码的详细信息，如果看到了方括号，那很可能表示我们已经找到了需要的指针。返回到主 cheat engine 窗口 （只要你愿意，你可以保持这个额外的信息窗口为打开状态。如果你要关掉它，那么要记好方栝号中间的代码）并做一次 4 字节的扫描，扫描”详细信息”窗口中告诉你的一串十六进制数值。扫描完成时它可能返回一个或几百个地址。大多数时候你需要的地址将是最少的一个。现在点击”手工添加地址”按钮，并勾选”指针”选项。”添加地址”窗口将发生变化，多出了”Address of Pointer（指针地址）”和”Offset (Hex)（偏移量(16进制)）”的文本框，以便您键入一个指针的地址和偏移量。请尽量填入刚才扫描到的地址。如果汇编指令中的方栝号里存在计算（例如：[esi+12]）则把数值部分填在”Offset (Hex)”的文本框中，如果不存在，则让它保持为 0 。如果看上去是更复杂的计算指令的话（举例说明一下）：[EAX<em>2+EDX+00000310] eax=4C 并且 edx=00801234.这种情况下 EDX 便是数值的指针，而 EAX</em>2+00000310 则是它的偏移量, 所以你要填在”Offset (Hex)”的将是 2*4C+00000310=3A8。（这些都是在十六进制下计算的，你可以使用WINDOWS的计算器，在科学方式下用十六进制计算）。回到教程，点击”确定”这个地址便会加到 CE 主窗口下方的地址列表中，如果没做错，在地址栏将显示 P-&gt;xxxxxxxx，而 xxxxxxxx 和你扫描到的地址数值是一致的，如果不一致，那么可能是哪里出错了。现在, 改变那条指针地址的数值为 5000 并锁定它，然后点击 Tutorial.exe 窗口上的”改变指针”按钮，如果一切正确，”下一步”按钮将变为可点击状态。<br>备注:<br>你也可以使用”指针扫描”的方式来查找这个指针地址。</p></li><li><p>ce6.7 Tutorial3.3教学步骤7<br>步骤 7: 代码注入: (密码=013370)<br>代码注入是将一小段你写出的代码注入到目标进程中并执行它的技巧。在这一步教程中，你将有一个健康值和一个每按一次将减少 1 点健康值的按钮，你的任务是利用”代码注入”，使每按一次按钮增加2点的健康值。查找这个地址，然后看看是什么在改写它（”找出是什么改写了这个地址”）。当你看到那条减少数值的汇编代码后，选择”显示反汇编程序”，然后打开”自动汇编窗口”（菜单-工具-&gt;自动汇编 或 按下快捷键 Ctrl+a )，选择”模板”中的”代码注入”。CE 将自动生成一部分汇编代码并为你输入指令做好准备（如果 CE 没有给出正确的地址，你也可以手工输入它）。注意 alloc 这部分代码，它会为你的代码分配出一小块空白的内存，过去，在 Win2000 之前的系统，这种行为存在安全隐患，很可能导致系统崩溃，幸运的是，这种情况在 win2000 以后的操作系统得到改善。也要注意line newmem: 、originalcode: 以及用文本”此处放置你的代码”标示出的空白部分正如你猜测的， 在这儿可以写下每次增加2点健康值的代码。在这种情况下推荐你使用 “ADD” 汇编指令，下面是一些示例：”ADD [00901234],9″ 使 [00901234] 地址的值增加9 “ADD [ESP+4],9” 使地址指针 [ESP+4] 的值增加9 在本关的情况下，你可以使用相同的手法处理减少健康值的那条原代码方括号之间的部分。<br>提示 1：<br>推荐你从原代码中删除减少健康值的那行代码，否则你得加 3 点健康值（你增加了3点，原代码减去1点，最终结果才会增加2点），这样看上去很容易让人迷惑，但最终方案还是由你来决定好了。<br>提示 2:<br>某些游戏中，原代码可能在多条指令之外，有时候（并非一向如此），它可能由不同的地方跳转至你的指令中并结束运行，其结果可能引起未知的错误；如果出现了这种情况，通常应当查看附近的那些跳转指令，进行修改，或者尝试使用不同地址进行代码注入，确认无误后便可以将你修改的代码注入到原代码中了。</p></li><li><p>ce6.7 Tutorial3.3教学步骤8<br>步骤 8: 多级指针: (密码=525927)在这一步将解释如何使用多级指针。<br>在第 6 步，你已经清楚 1 级指针的概念和用途，并可以利用数值的首个地址找到存放数据真正的基址。在本关中，你将看到 4 级指针，它由第一个指针指向第二个指针，再由第二个指针指向第三个指针，由第三个指针指向第四个指针，最终指向健康值的真正地址。开始的几步与在第 6 步中的操作基本相同。找出是什么访问了这个地址，然后分析汇编指令，查找指针地址中的数值，以及它的偏移量，将它们记下来。但这次你按数值找出的仍然是一个指针，你得依据这些数值，使用同样的操作方法找出指向这个指针的指针。看看是什么访问了你发现的那个指针地址，分析汇编指令，留意可能的代码和偏移量，并加以利用。持续这种过程，直到不能更进一步查找为止（通常基址为静态时，地址将以绿色标示）。点击”改变数值”改变健康值，如果你发现列表中那些指针地址所指向的值发生同样的变化时，那表示你可以试着将基址中的值更改为 5000，并锁定它，以便完成本关的任务了。备注1: 本步骤也可以使用自动汇编程序脚本或者使用指针扫描器加以解决。<br>备注2: 在某些情况下，可以改变 CE 软件”代码查找”的相关设置。<br>当你遇到类似于 mov eax,[eax] 的指令时，调试程序将显示改变之后的寄存器中的值，也许利用它更容易找出指针的位置。<br>备注3: 你还在读？！当你查看汇编指令时你可能已经注意到，这些指针是在相同的代码块（相同的程序，如果你懂汇编，可以查看程序的起始代码）位置被读写。这种情况并不总会发生，但是当你在查找某个指针遇到问题的时候，没准能起到很大的用处。</p></li><li><p>ce6.7 Tutorial3.3教学步骤9<br>步骤 9: 注入++: (密码=31337157)这一步将会解释如何处理游戏中的共用代码, 这种代码是通用在除了自己以外的其他同类型对像上常常你在修改游戏的时候, 你找到了一个单位的健康, 或是你自己角色的健康, 你会发现一种情况: 如果你把健康相关代码移除的话，其结果是你的角色无敌, 但你的敌人也无敌了。<br>在这种情况下, 你必须想办法区分自己与敌人。有时候很简单, 你只要检查最前面的4个字节(函数指针表), 它通常指向一个独一无二的地址, 代表着游戏玩家角色，而有的时候它是一个团体号码, 或者也可能是一个指针, 它指向另一个指针, 该址针又指向下一个指针,搞不好还指向下下一个指针, 最后指向一个玩家名字。总之完全取决于游戏的复杂度, 以及你的运气最简单的方法是以”找出是什么改写了这个地址”去找出游戏代码，然后使用”分析(新/旧)数据/结构”的功能去比较两种结构。(你的单位和敌人的单位)然后看看是不是可以找到一个区分两者的方法。当你找到如何区分你和电脑单位的方法后，你可以注入一段自动汇编脚本来检查状态，然后看是要运行游戏的代码还是要做其他的修改。(例如一击必杀)另外, 你还可以用这个方法去创建一般所说的”字节数组”的字串, 它可以用来搜寻并产生一份所有你的单位或是敌人单位的列表 在这个教程中, 我已经实现了你将会玩到的最惊人的游戏.这个游戏有4个玩家。2个属于你的阵容, 另外两个属于电脑方。你的任务是找到改写健康的代码, 并且修改以至于你可以获得胜利，但”绝不能”使用锁定HP的方法.完成修改以后, 请按 “重新启动游戏并自动执行” 来测试你的修改是否正确<br>提示1: 健康是一个单浮点数<br>提示2: 解法不只一种<br>以下是ce6.7 Tutorial3.3教学各步骤基址CT文件(包括32位和64位两个文件)</p></li></ol><p>下载链接：<a href="https://pan.baidu.com/s/1smdbIHZ">https://pan.baidu.com/s/1smdbIHZ</a> 密码：3t8e</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ce技巧 </tag>
            
            <tag> 基址查找方法 </tag>
            
            <tag> 精品软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>自定义公告_超强的自定义网吧公告程序</title>
      <link href="/page/3399946887/"/>
      <url>/page/3399946887/</url>
      
        <content type="html"><![CDATA[<p>在网吧，开机一般会有一个公告程序运行，在桌面上显示一些通知，注意事项，或网吧活动等内容!现普通使用的公告是营销软件的公告，在营销软件后台设置公告，选择一个模板，开启开机运行！但营销系统的公告程序相当死板，不能自定义显示样式，并且会显示一些广告之类没用的内容!本站的自定义公告应运而生!此自定义公告程序并非只能使用在网吧，任何需要开机运行公告的地方都可以使用本程序!</p><p>自定义公告程序功能:</p><ol><li>完全自定义公告模板。你可以把桌面当成一块画板，任意制作模板，我们提供了八套模板，不会制作模板只需要改文字就可以了!如果你会html，完全可以自定义桌面在哪儿显示什么公告内容!你不会网页编辑也可以，你只要会word排版，然后把word文件存为web格式，一样可以做为公告程序显示!</li><li>随机显示模板。公告显示的目的就是让顾客注意看，并不是广告，但很多顾客开机后就关闭了，根本不会看，因为一成不变的显示方式，让顾客没有新颖感！本站自定义公告程序会根据本程序的html目录中的html模板，随机显示公告，让每次开机都保持新鲜感!如果你只想显示固定的模板，你只需要在html目录，只保留一款公告模板即可!</li><li>模板中可自定义启动程序!在设计模板时，使用onclick=’javascript:external.Run(“可执行程序”,”程序参数”)’ 来启动运行程序，比如我们在html模板中添加一按钮，然后添加onclick=’javascript:external.Run(“ClientStarter.exe”,”barapp /WebApps/web/BClient/call.html”)’  就是启动了网乐程序的呼叫网管! 需要注意的是这儿的可执行程序如果不加路径，就是在当前公告所在目录的程序，另外需要注意的加上路径或参数时，斜杠必须是正斜杠!</li></ol><p>看看其中几款公告<br><img src="/images/1517663920-1.png" alt=""><br>以图片的形式动态显示公告内容，以下是文字方式显示公告，公告窗体运行时都是动态方式出现，动感十足!<br><img src="/images/1517663961-2.png" alt=""><br><img src="/images/1517663979-3.png" alt=""><br><img src="/images/1517663993-4.png" alt=""><br><img src="/images/1517807664-1.jpg" alt=""></p><p>下载地址：</p><p>链接: <a href="https://pan.baidu.com/s/17Vx9Ad6-XbFDoptL4V2mdQ">https://pan.baidu.com/s/17Vx9Ad6-XbFDoptL4V2mdQ</a> 提取码: rnjj 复制这段内容后打开百度网盘手机App，操作更方便哦</p><p> 解压密码 bnwin.com</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>动态逆向调试工具OllyDbg</title>
      <link href="/page/458367381/"/>
      <url>/page/458367381/</url>
      
        <content type="html"><![CDATA[<p>OllyDbg是一个32位汇编级分析调试器。对二进制代码分析功能使它在不知道可执行文件源码的情况下特别有用。OllyDbg是一个共享软件。功能特点：直观的用户界面，没有复杂的命令；代码分析-跟踪寄存器，识别过程，循环，API调用，开关，表，常量和字符串；直接加载和调试DLL；对象文件扫描——从对象文件和库中查找例程；允许用户定义的标签、注释和功能描述；理解在Borland®格式的调试信息；修改汇编代码后可直接保存为可执行文件；开放体系结构-许多第三方插件可用；纯绿色,没有安装-注册表或系统目录中没有垃圾；调试多线程应用程序;附加到运行的程序;可配置的反汇编程序，支持MASM和理想的格式；MMX，3dnow！和SSE数据类型和指令，包括Athlon扩展；完整的Unicode支持；动态识别ASCII和Unicode字符串-也用Delphi格式！识别复杂的代码结构，如调用跳转到过程。解码调用超过1900个标准API和400个C函数；从外部帮助文件对API函数提供上下文敏感帮助；设置条件、日志、内存和硬件断点；跟踪程序执行，记录已知函数的参数；还有很多，更多！总之OllyDbg就是Ring3级的调试器，将IDA与SoftICE结合起来的思想，非常容易上手!<br><img src="/images/1517667176-1.jpg" alt=""><br>OllyDbg英文官方网站：<a href="http://www.ollydbg.de/">http://www.ollydbg.de/</a> 中文站 <a href="http://www.ollydbg.net/">http://www.ollydbg.net/</a></p><p>OllyDbg1.10官网下载地址 <a href="http://www.ollydbg.de/odbg110.zip">http://www.ollydbg.de/odbg110.zip</a></p><p>OllyDbg 1.10看雪下载地址  <a href="https://tool.pediy.com/index-detail-1.htm">https://tool.pediy.com/index-detail-1.htm</a></p><p>吾爱破解专用版OllyDbg下载地址 <a href="http://down.52pojie.cn/Tools/Debuggers/%E5%90%BE%E7%88%B1%E7%A0%B4%E8%A7%A3%E4%B8%93%E7%94%A8%E7%89%88Ollydbg.rar">http://down.52pojie.cn/Tools/Debuggers/吾爱破解专用版Ollydbg.rar</a></p><p>吾爱破解专用版OllyDbg更新日志</p><p>2016年1月21日更新如下：<br>1、默认勾选“解码修饰符号名称（Demangle symbolic names）”，方便调试分析MFC类程序。<br>2、本次更新后压缩包：9413A89DE76D48B0D6F1807A6A42BAB7 吾爱破解专用版Ollydbg.rar</p><p>2015年12月14日更新如下：<br>1、删除ILLY.dll和ODbgScript_Win2k.dll插件，由于部分同学机器未装.NET会报错。<br>2、添加OllyDisasm201插件。（<a href="http://www.52pojie.cn/thread-443516-1-1.html%EF%BC%89">http://www.52pojie.cn/thread-443516-1-1.html）</a><br>3、将“路径修复工具”静态编译，方便没装运行库的xp机器也能运行。<br>4、本次更新后压缩包：E138F9543C5A0953DDBCA95AFDACF8FE 吾爱破解专用版Ollydbg.rar</p><p>2015年7月2日更新如下：<br>1、更新ILLY插件修复调试.NET程序异常的问题，感谢@凉游浅笔深画眉 反馈<a href="http://www.52pojie.cn/thread-366158-1-1.html%E3%80%82">http://www.52pojie.cn/thread-366158-1-1.html。</a><br>2、添加一个loadmap插件、更新字符串搜索插件、删除一些不必要的文件，完善一些细节。<br>3、添加白底黑字配置，需要请自行将”ollydbg_白底黑字配置.ini“替换成”ollydbg.ini“。<br>4、增加ollydbg.ini中的路径自动修复程序。<br>5、本次更新后压缩包：57CFF212D319E7A693D6F7D44465BF54 吾爱破解专用版Ollydbg.rar</p><p>2015年4月10日更新如下：<br>1、对Ollydbg的窗口签名进行了更改，从而避免被针对性检测。<br>2、对Ollydbg的菜单做出调整。<br>3、针对一些有可能被检测的插件进行了删减。<br>4、修改了一些可能被检测的内容。<br>5、更新ollydbg的插件为目前较新的版本。</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 精品软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RemoteAdo数据库中间件爆破分析(RemoteAdo破解版)</title>
      <link href="/page/407779666/"/>
      <url>/page/407779666/</url>
      
        <content type="html"><![CDATA[<p>RemoteAdo是一款数据库中间件，官网为<a href="http://www.remoteado.cn/">http://www.remoteado.cn/</a> 本爆破教程基于RemoteAdo标准版4.2分析!</p><ol><li>下载RemoteAdo标准版4.2，使用die1.01分析，RemoteAdoServer.exe主程序加壳为ASPack(2.12)<img src="/images/1517410489-2.png" alt="">使用WASPACK脱掉<img src="/images/1517410946-1.png" alt=""></li><li>用OD载入，插件打开api常用断点下MessageBoxA断点，为什么下这个断点呢？因为点注册的时候会弹出序列号无效<img src="/images/1517411191-3.png" alt="">，断点下好后，按F9运行，按RemoteAdo软件界面中的其他选项卡中的“请注册”，在弹出的窗口中任意输入序列号然后点击注册按钮!这时在OD中已经断下了，按一次Ctrl+F9，再切换到RemoteAdo软件界面，这时提示“序列号无效”，点确定，然后切换为OD，再按一次Ctrl+F9，OD中返回到RemoteAdo的软件领空!<img src="/images/1517411573-4.png" alt="">我们看右边寄存器显示有“序列号无效”和“软件注册”等字样!</li><li>从此处（00483E18）往上看汇编代码，看是哪儿跳到这儿来的！找到00483E18看从哪儿跳来的，我不习惯使用od看，觉得不够清晰，我喜欢使用w32dasm看，在W32Dasm中shift+f12输入00483E18，往上看，一直到上面这儿（为什么到这儿，你可以从00483E18上面的多个跳转分别下断点测试，那些都是显示序列号无效的相关代码）<img src="/imeages/1517412141-5.png" alt="">在00483CC4开始到00483E18都是显示序列号无效的代码，(我们可以切换回OD在00483CC4处双击，写入汇编代码 retn，不执行直接返回，这时你可以重新运行点注册，会什么反应也没有!) 在00483CC4上方显示，调用此call的地址有7个，我们分别在以上7个调用地址前下断点，重新点击注册，看会不会断下!经过测试会在倒数第二个0056204E处断下!在W32Dasm中shift+F12，跳转到0056204E处!往上看代码，到底是谁调用了序列号无效的提示代码！</li><li>看到这段代码<img src="/images/1517412684-6.png" alt="">其中00561FC3处的call就是序列号算法函数，爆破只需要在OD中把00561FCA处填充NOP代码即可!NOP后，这时点软件中的注册会提示注册成功，但重启软件后，还是只有5个连接数!以下是去掉连接数及破解版内容在W32Dasm中我们在00561FC3处点击Call按钮，看哪些地方调用了这个注册算法函数，到这儿<img src="/images/1517412940-7.png" alt="">有两处，一处就是0055B9AB，这处是启动软件判断是否注册的，一处是00561FC3，就是我们点注册按钮判断是否注册的!在OD中我们跳到0055B9AB处，把下面的je代码NOP掉，然后保存修改的文件，就OK了!至于算法，分析太麻烦了，有兴趣自己折腾!爆破后没有5个用户连接数限制，以下是10个连接数图!<img src="/images/1517413324-8.png" alt="">后话：因为前面分析中看到有7处调用了，序列号无效的函数，我们这儿只修改了两处，所以如果你使用中存在提示序列号无效的问题，那就需要在另外5处也用相同的方法进行修改!只修改两处，使用中暂没发现有什么问题!</li></ol><p>按上面分析修改好两处的成品下载 链接：<a href="https://pan.baidu.com/s/1gg9jHa7">https://pan.baidu.com/s/1gg9jHa7</a> 密码：sbrw 解压密码 bnwin.com</p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> remoteado破解 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi如何在Ring3下跨进程获取DLL信息</title>
      <link href="/page/3910524000/"/>
      <url>/page/3910524000/</url>
      
        <content type="html"><![CDATA[<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unit</span> APIUnit;</span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment"> GetProcessModuleHandle API Unit</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> Ring3调用NtQueryInformationProcess实现跨进程获取DLL句柄</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="keyword">interface</span></span><br><span class="line"><span class="keyword">USES</span></span><br><span class="line">  Winapi.Windows,System.SysUtils;</span><br><span class="line"><span class="keyword">type</span></span><br><span class="line">  USHORT = Word;</span><br><span class="line">  UNICODE_STRING = <span class="keyword">packed</span> <span class="keyword">Record</span></span><br><span class="line">  Length : USHORT;</span><br><span class="line">  MaximumLength: USHORT;</span><br><span class="line">  Buffer : PWideString;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  RTL_USER_PROCESS_PARAMETERS = <span class="keyword">packed</span> <span class="keyword">record</span></span><br><span class="line">  Reserved1 : <span class="keyword">array</span>[<span class="number">0</span>..<span class="number">15</span>] <span class="keyword">of</span> Byte;</span><br><span class="line">  Reserved2 : <span class="keyword">array</span>[<span class="number">0</span>..<span class="number">9</span>] <span class="keyword">of</span> Pointer;</span><br><span class="line">  ImagePathName: UNICODE_STRING;</span><br><span class="line">  CommandLine : UNICODE_STRING;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  PRTL_USER_PROCESS_PARAMETERS = ^RTL_USER_PROCESS_PARAMETERS;</span><br><span class="line"> </span><br><span class="line">  _PEB_LDR_DATA = <span class="keyword">record</span></span><br><span class="line">    Length: ULONG;</span><br><span class="line">    Initialized: BOOLEAN;</span><br><span class="line">    SsHandle: pointer;<span class="comment">//PVOID;</span></span><br><span class="line">    InLoadOrderModuleList: LIST_ENTRY;</span><br><span class="line">    InMemoryOrderModuleList: LIST_ENTRY;</span><br><span class="line">    InInitializationOrderModuleList: LIST_ENTRY;</span><br><span class="line">  <span class="keyword">end</span> <span class="comment">&#123;_PEB_LDR_DATA&#125;</span>;</span><br><span class="line">  PEB_LDR_DATA = _PEB_LDR_DATA;</span><br><span class="line">  PPEB_LDR_DATA = ^_PEB_LDR_DATA;</span><br><span class="line"> </span><br><span class="line">  _LDR_MODULE = <span class="keyword">record</span></span><br><span class="line">    InLoadOrderModuleList: LIST_ENTRY;</span><br><span class="line">    InMemoryOrderModuleList: LIST_ENTRY;</span><br><span class="line">    InInitializationOrderModuleList: LIST_ENTRY;</span><br><span class="line">    BaseAddress: pointer;</span><br><span class="line">    EntryPoint:  pointer;</span><br><span class="line">    SizeOfImage: ULONG;</span><br><span class="line">    FullDllName: UNICODE_STRING;</span><br><span class="line">    BaseDllName: UNICODE_STRING;</span><br><span class="line">    Flags: ULONG;</span><br><span class="line">    LoadCount: SmallInt;</span><br><span class="line">    TlsIndex: SmallInt;</span><br><span class="line">    HashTableEntry: LIST_ENTRY;</span><br><span class="line">    TimeDateStamp: ULONG;</span><br><span class="line">  <span class="keyword">end</span> <span class="comment">&#123;_LDR_MODULE&#125;</span>;</span><br><span class="line">  LDR_MODULE = _LDR_MODULE;</span><br><span class="line">  PLDR_MODULE = ^_LDR_MODULE;</span><br><span class="line"> </span><br><span class="line">  _PEB_FREE_BLOCK = <span class="keyword">record</span></span><br><span class="line">    Next:Pointer;</span><br><span class="line">    Size:ULONG;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  PPEB_FREE_BLOCK = ^_PEB_FREE_BLOCK;</span><br><span class="line"> </span><br><span class="line">  PEB = <span class="keyword">packed</span> <span class="keyword">record</span></span><br><span class="line">    InheritedAddressSpace:Boolean;<span class="comment">// 00h</span></span><br><span class="line">    ReadImageFileExecOptions:Boolean; <span class="comment">// 01h</span></span><br><span class="line">    BeingDebugged:Boolean; <span class="comment">//02H</span></span><br><span class="line">    Spare:Boolean;</span><br><span class="line">    Mutant:THandle;</span><br><span class="line">    ImageBaseAddress:Pointer;</span><br><span class="line">    LoaderData:Pointer;  <span class="comment">//0C</span></span><br><span class="line">    ProcessParameters:Pointer;</span><br><span class="line">    SubSystemData:Pointer;</span><br><span class="line">    ProcessHeap:Pointer;</span><br><span class="line">    FastPebLock:Pointer;</span><br><span class="line">    FastPebLockRoutine:PPointer;</span><br><span class="line">    FastPebUnlockRoutine:PPointer;</span><br><span class="line">    EnvironmentUpdateCount:ULONG;</span><br><span class="line">    KernelCallbackTable:^Pointer;</span><br><span class="line">    EventLogSection:Pointer;</span><br><span class="line">    EventLog:Pointer;</span><br><span class="line">    FreeList:PPEB_FREE_BLOCK;</span><br><span class="line">    TlsExpansionCounter:ULONG;</span><br><span class="line">    TlsBitmap:Pointer;</span><br><span class="line">    TlsBitmapBits:<span class="keyword">array</span> [<span class="number">0</span>..<span class="number">$2</span>] <span class="keyword">of</span> ULONG;</span><br><span class="line">    ReadOnlySharedMemoryBase:Pointer;</span><br><span class="line">    ReadOnlySharedMemoryHeap:Pointer;</span><br><span class="line">    ReadOnlyStaticServerData:^Pointer;</span><br><span class="line">    AnsiCodePageData:Pointer;</span><br><span class="line">    OemCodePageData:Pointer;</span><br><span class="line">    UnicodeCaseTableData:Pointer;</span><br><span class="line">    NumberOfProcessors:ULONG;</span><br><span class="line">    NtGlobalFlag:ULONG;</span><br><span class="line">    Spare2:<span class="keyword">array</span> [<span class="number">0</span>..<span class="number">$4</span>] <span class="keyword">of</span> Byte;</span><br><span class="line">    CriticalSectionTimeout:LARGE_INTEGER;</span><br><span class="line">    HeapSegmentReserve:ULONG;</span><br><span class="line">    HeapSegmentCommit:ULONG;</span><br><span class="line">    HeapDeCommitTotalFreeThreshold:ULONG;</span><br><span class="line">    HeapDeCommitFreeBlockThreshold:Ulong;</span><br><span class="line">    NumberOfHeaps:ULONG;</span><br><span class="line">    MaximumNumberOfHeaps:ULONG;</span><br><span class="line">    ProcessHeaps:PPointer;</span><br><span class="line">    GdiSharedHandleTable:Pointer;</span><br><span class="line">    ProcessStarterHelper:Pointer;</span><br><span class="line">    GdiDCAttributeList:Pointer;</span><br><span class="line">    LoaderLock:Pointer;</span><br><span class="line">    OSMajorVersion:ULONG;</span><br><span class="line">    OSMinorVersion:ULONG;</span><br><span class="line">    OSBuildNumber:ULONG;</span><br><span class="line">    OSPlatformId:ULONG;</span><br><span class="line">    ImageSubSystem:ULONG;</span><br><span class="line">    ImageSubSystemMajorVersion:ULONG;</span><br><span class="line">    ImageSubSystemMinorVersion:ULONG;</span><br><span class="line">    GdiHandleBuffer:<span class="keyword">array</span> [<span class="number">0</span>..<span class="number">$22</span>] <span class="keyword">of</span> ULONG;</span><br><span class="line">    PostProcessInitRoutine:ULONG;</span><br><span class="line">    TlsExpansionBitmap:ULONG;</span><br><span class="line">    TlsExpansionBitmapBits: <span class="keyword">array</span> [<span class="number">0</span>..<span class="number">$80</span>] <span class="keyword">of</span> Byte;</span><br><span class="line">    SessionId:ULONG;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  PPEB = ^PEB;</span><br><span class="line"> </span><br><span class="line">  PROCESS_BASIC_INFORMATION = <span class="keyword">packed</span> <span class="keyword">record</span></span><br><span class="line">  ExitStatus : DWORD;</span><br><span class="line">  PebBaseAddress: PPEB;</span><br><span class="line">  AffinityMask : DWORD;</span><br><span class="line">  BasePriority : DWORD;</span><br><span class="line">  uUniqueProcessId: ULong;</span><br><span class="line">  uInheritedFromUniqueProcessId: ULong;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  TProcessBasicInformation = PROCESS_BASIC_INFORMATION;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NtQueryInformationProcess</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">          ProcessHandle: THandle; <span class="comment">&#123;进程句柄&#125;</span></span></span></span><br><span class="line"><span class="params"><span class="function">          ProcessInformationClass: Byte; <span class="comment">&#123;信息类型&#125;</span></span></span></span><br><span class="line"><span class="params"><span class="function">          ProcessInformation: Pointer;   <span class="comment">&#123;缓冲指针&#125;</span></span></span></span><br><span class="line"><span class="params"><span class="function">          ProcessInformationLength: ULONG; <span class="comment">&#123;以字节为单位的缓冲大小&#125;</span></span></span></span><br><span class="line"><span class="params"><span class="function">          ReturnLength: PULONG  <span class="comment">&#123;写入缓冲的字节数&#125;</span></span></span></span><br><span class="line"><span class="params"><span class="function">          )</span>:</span> DWORD; <span class="keyword">stdcall</span>; <span class="keyword">external</span> <span class="string">&#x27;ntdll.dll&#x27;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetProcessModuleHandle</span><span class="params">(dwProcessID:DWORD;DllName:PChar)</span>:</span>DWORD;</span><br><span class="line"><span class="keyword">implementation</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">EnablePrivilege</span><span class="params">(hToken: Cardinal; PrivName: <span class="keyword">string</span>; bEnable: Boolean)</span>:</span>Boolean;</span><br><span class="line">  <span class="keyword">var</span></span><br><span class="line">    TP: TOKEN_PRIVILEGES;</span><br><span class="line">    Dummy: Cardinal;</span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">      TP.PrivilegeCount := <span class="number">1</span>;</span><br><span class="line">      LookupPrivilegeValue(<span class="keyword">nil</span>, pchar(PrivName), TP.Privileges[<span class="number">0</span>].Luid);</span><br><span class="line">      <span class="keyword">if</span> bEnable <span class="keyword">then</span></span><br><span class="line">        TP.Privileges[<span class="number">0</span>].Attributes := SE_PRIVILEGE_ENABLED</span><br><span class="line">      <span class="keyword">else</span> TP.Privileges[<span class="number">0</span>].Attributes := <span class="number">0</span>;</span><br><span class="line">      AdjustTokenPrivileges(hToken, False, TP, SizeOf(TP), <span class="keyword">nil</span>, Dummy);</span><br><span class="line">    <span class="keyword">except</span></span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">    Result :=True;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">EnableDebugPrivilege</span>:</span> Boolean;</span><br><span class="line">  <span class="keyword">var</span></span><br><span class="line">    hToken: THandle;</span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    Result := False;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">      OpenProcessToken(GetCurrentProcess, TOKEN_ADJUST_PRIVILEGES, hToken);</span><br><span class="line">      EnablePrivilege(hToken, <span class="string">&#x27;SeDebugPrivilege&#x27;</span>, True);</span><br><span class="line">      CloseHandle(hToken);</span><br><span class="line">      Result :=True;</span><br><span class="line">    <span class="keyword">except</span></span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">GetProcessModuleHandle</span><span class="params">(dwProcessID:DWORD;DllName:PChar)</span>:</span>DWORD;</span><br><span class="line">  <span class="keyword">var</span></span><br><span class="line">    hProcess:DWORD;</span><br><span class="line">    PBI:TProcessBasicInformation;</span><br><span class="line">    r,ret:DWORD;</span><br><span class="line">    readByte: SIZE_T;</span><br><span class="line">    PEBType:PPEB;</span><br><span class="line">    PLD :PPEB_LDR_DATA;</span><br><span class="line">    PME :PLDR_MODULE;</span><br><span class="line">    PEBDLLName:PChar;</span><br><span class="line">  <span class="keyword">const</span></span><br><span class="line">    Size:DWORD = <span class="number">255</span>;</span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">     Result := <span class="number">0</span>;</span><br><span class="line">     GetMem(PEBType,SizeOf(PEB));</span><br><span class="line">     ZeroMemory(PEBType,SizeOf(PEB));</span><br><span class="line">     GetMem(PLD,SizeOf(PEB_LDR_DATA));</span><br><span class="line">     ZeroMemory(PLD,SizeOf(PEB_LDR_DATA));</span><br><span class="line">     GetMem(PME,SizeOf(LDR_MODULE));</span><br><span class="line">     ZeroMemory(PME,SizeOf(LDR_MODULE));</span><br><span class="line">     GetMem(PEBDLLName,Size);</span><br><span class="line">     <span class="keyword">try</span></span><br><span class="line">        <span class="comment">//提升进程权限</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> EnableDebugPrivilege <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">          OutputDebugStringW(<span class="string">&#x27;Do not have Debug privilege&#x27;</span>);   <span class="comment">//无法提升调试权限</span></span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line">        <span class="comment">//如果PID为0则获取自身的伪句柄，如果不是则获取指定PID的句柄</span></span><br><span class="line">        <span class="keyword">if</span> dwProcessID &lt;&gt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">          <span class="comment">//打开进程，需要PROCESS_QUERY_INFORMATION和PROCESS_VM_READ权限</span></span><br><span class="line">          hProcess := OpenProcess(PROCESS_QUERY_INFORMATION <span class="keyword">or</span> PROCESS_VM_READ, FALSE,dwProcessID)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        hProcess := GetCurrentProcess;</span><br><span class="line">        <span class="comment">//调用NtQueryInformationProcess获取结构信息</span></span><br><span class="line">        ret := NtQueryInformationProcess(hProcess,<span class="number">0</span>,@PBI,SizeOf(PBI),@r);</span><br><span class="line">        <span class="comment">//正常情况下ret是0，如果不是则认为错误</span></span><br><span class="line">        <span class="keyword">if</span> ret = <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">          <span class="comment">//获取PEB结构</span></span><br><span class="line">          ReadProcessMemory(hProcess,PBI.PebBaseAddress,PEBType,SizeOf(PEB),readByte);</span><br><span class="line">          <span class="comment">//获取PLD结构</span></span><br><span class="line">          ReadProcessMemory(hProcess,PEBType.LoaderData,PLD,SizeOf(PEB_LDR_DATA),readByte);</span><br><span class="line">          <span class="comment">//获取第一个PME</span></span><br><span class="line">          ReadProcessMemory(hProcess,PLD.InLoadOrderModuleList.Flink,PME,SizeOf(LDR_MODULE),readByte);</span><br><span class="line">          <span class="comment">//循环</span></span><br><span class="line">          <span class="keyword">while</span> True <span class="keyword">do</span></span><br><span class="line">          <span class="keyword">begin</span></span><br><span class="line">             <span class="comment">//清零缓冲区</span></span><br><span class="line">             ZeroMemory(PEBDLLName,Size);</span><br><span class="line">             <span class="comment">//读取buff到内存中，获取当前结构的DLL名</span></span><br><span class="line">             <span class="keyword">if</span> <span class="keyword">not</span> ReadProcessMemory(hProcess,PME.BaseDllName.Buffer,PEBDLLName,PME.BaseDllName.Length,readByte) <span class="keyword">then</span> <span class="keyword">Break</span>;</span><br><span class="line">             <span class="comment">//对比DLL名称，不区分大小写</span></span><br><span class="line">             <span class="keyword">if</span> LowerCase(AnsiString(PEBDLLName)) = LowerCase(AnsiString(DllName)) <span class="keyword">then</span></span><br><span class="line">             <span class="keyword">begin</span></span><br><span class="line">               <span class="comment">//调试信息</span></span><br><span class="line">               OutputDebugStringW(PEBDLLName);</span><br><span class="line">               <span class="comment">//返回DLL的句柄</span></span><br><span class="line">               Result := dword(pme.BaseAddress);</span><br><span class="line">               <span class="comment">//退出循环</span></span><br><span class="line">               <span class="keyword">Break</span>;</span><br><span class="line">             <span class="keyword">end</span>;</span><br><span class="line">             <span class="comment">//调试信息</span></span><br><span class="line">             OutputDebugStringW(PEBDLLName);</span><br><span class="line">             <span class="comment">//如果下一个结构为开始的结构，则认为链表已经枚举完了</span></span><br><span class="line">             <span class="keyword">if</span> PME.InLoadOrderModuleList.Flink = PLD.InLoadOrderModuleList.Flink <span class="keyword">then</span> <span class="keyword">Break</span>;</span><br><span class="line">             <span class="comment">//读取下一个结构</span></span><br><span class="line">             <span class="keyword">if</span> <span class="keyword">not</span> ReadProcessMemory(hProcess,PME.InLoadOrderModuleList.Flink,PME,SizeOf(LDR_MODULE),readByte) <span class="keyword">then</span> <span class="keyword">Break</span>;</span><br><span class="line">          <span class="keyword">end</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">          <span class="comment">//返回错误信息</span></span><br><span class="line">          OutputDebugStringW(<span class="string">&#x27;Error!NtQueryInformationProcess Error!&#x27;</span>);</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line">     <span class="keyword">finally</span></span><br><span class="line">        <span class="comment">//释放使用的内存</span></span><br><span class="line">        FreeMem(PEBDLLName,Size);</span><br><span class="line">        FreeMem(PME,SizeOf(LDR_MODULE));</span><br><span class="line">        FreeMem(PLD,SizeOf(PEB_LDR_DATA));</span><br><span class="line">        FreeMem(PEBType,SizeOf(PEB));</span><br><span class="line">     <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi源码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi在ring3阻止文件删除(8圈桌面广告图标生成原理)</title>
      <link href="/page/1693463645/"/>
      <url>/page/1693463645/</url>
      
        <content type="html"><![CDATA[<p>8圈网管计费系统，最近在桌面生成图标，直接删除会提示服务和应用管理程序已经打开，无法删除，8圈计费系统先生成url快捷图标，然后打开这个快捷方式取得句柄，再使用DuplicateHandle复制句柄丢给系统进程services.exe，达到占用文件，删除8圈桌面图标就不行了!8圈桌面图标阻止删除的方法关键地方就是使用了DuplicateHandle这个API，看看下面的代码!</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">EnabledDebugPrivilege</span><span class="params">(<span class="keyword">const</span> bEnabled: Boolean)</span>:</span> Boolean;<span class="comment">//提权</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">hToken: THandle;</span><br><span class="line">tp: TOKEN_PRIVILEGES;</span><br><span class="line">a: DWORD;</span><br><span class="line"><span class="keyword">const</span></span><br><span class="line">SE_DEBUG_NAME = <span class="string">&#x27;SeDebugPrivilege&#x27;</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Result := False;</span><br><span class="line"><span class="keyword">if</span> (OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES, hToken)) <span class="keyword">then</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">tp.PrivilegeCount := <span class="number">1</span>;</span><br><span class="line">LookupPrivilegeValue(<span class="keyword">nil</span>, SE_DEBUG_NAME, tp.Privileges[<span class="number">0</span>].Luid);</span><br><span class="line"><span class="keyword">if</span> bEnabled <span class="keyword">then</span></span><br><span class="line">tp.Privileges[<span class="number">0</span>].Attributes := SE_PRIVILEGE_ENABLED</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">tp.Privileges[<span class="number">0</span>].Attributes := <span class="number">0</span>;</span><br><span class="line">a := <span class="number">0</span>;</span><br><span class="line">AdjustTokenPrivileges(hToken, False, tp, SizeOf(tp), <span class="keyword">nil</span>, a);</span><br><span class="line">Result := GetLastError = ERROR_SUCCESS;</span><br><span class="line">CloseHandle(hToken);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DupFile</span><span class="params">(FileName:<span class="keyword">String</span>;PID:Cardinal)</span>:</span>Boolean;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">hFile,hProcess,hTarget:THandle;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Result := False;</span><br><span class="line">EnabledDebugPrivilege(True);</span><br><span class="line">hProcess := OpenProcess(PROCESS_DUP_HANDLE, False, PID);</span><br><span class="line"><span class="keyword">Try</span></span><br><span class="line"><span class="keyword">if</span> hProcess &lt;&gt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">hFile := CreateFile(PChar(FileName), GENERIC_READ, <span class="number">0</span>, <span class="keyword">nil</span>, Create_ALWAYS, FILE_ATTRIBUTE_NORMAL, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> hFile = INVALID_HANDLE_VALUE <span class="keyword">then</span> <span class="keyword">Exit</span>;</span><br><span class="line">Result := DuplicateHandle(GetCurrentProcess(), hFile, hProcess, @hTarget,</span><br><span class="line"><span class="number">0</span>, False, DUPLICATE_SAME_ACCESS <span class="keyword">or</span> DUPLICATE_CLOSE_SOURCE);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">Finally</span></span><br><span class="line">CloseHandle(hProcess);</span><br><span class="line"><span class="keyword">End</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>8圈在桌面生成图标就是利用上面的原理!实际改一下就是这样</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">btn2Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">GetPid</span><span class="params">(ExeFileName: <span class="keyword">string</span>)</span>:</span> THandle;  <span class="comment">//根据进程名返回进程PID</span></span><br><span class="line">  <span class="keyword">const</span></span><br><span class="line">    PROCESS_TERMINATE = <span class="number">$0001</span>;</span><br><span class="line">  <span class="keyword">var</span></span><br><span class="line">    ContinueLoop: BOOL;</span><br><span class="line">    FSnapshotHandle: THandle;</span><br><span class="line">    FProcessEntry32: TProcessEntry32;</span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    Result := <span class="number">0</span>;</span><br><span class="line">    FSnapshotHandle := CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, <span class="number">0</span>);</span><br><span class="line">    FProcessEntry32.dwSize := SizeOf(FProcessEntry32);</span><br><span class="line">    ContinueLoop := Process32First(FSnapshotHandle, FProcessEntry32);</span><br><span class="line">    <span class="keyword">while</span> Integer(ContinueLoop) &lt;&gt; <span class="number">0</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      <span class="keyword">if</span> ((UpperCase(ExtractFileName(FProcessEntry32.szExeFile)) = UpperCase(ExeFileName)) <span class="keyword">or</span></span><br><span class="line">          (UpperCase(FProcessEntry32.szExeFile) = UpperCase(ExeFileName))) <span class="keyword">then</span></span><br><span class="line">          <span class="keyword">begin</span></span><br><span class="line">              Result :=FProcessEntry32.th32ProcessID;</span><br><span class="line">              <span class="keyword">Break</span>;</span><br><span class="line">          <span class="keyword">end</span>;</span><br><span class="line">          ContinueLoop := Process32Next(FSnapshotHandle, FProcessEntry32);</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line">    CloseHandle(FSnapshotHandle);</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  fhand:THandle;</span><br><span class="line">  hProcess,hFile:THandle;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  fhand:=FileOpen(PWideChar(edt1.Text),GENERIC_READ);<span class="comment">//取得阻止删除的文件句柄</span></span><br><span class="line">  EnabledDebugPrivilege;</span><br><span class="line">  hProcess:=OpenProcess(PROCESS_ALL_ACCESS, FALSE, GetPid(<span class="string">&#x27;services.exe&#x27;</span>));</span><br><span class="line">  <span class="keyword">if</span> DuplicateHandle(GetCurrentProcess(), fhand,hProcess, @hFile,  <span class="number">0</span> ,FALSE, DUPLICATE_SAME_ACCESS) <span class="keyword">then</span>  </span><br><span class="line">    ShowMessage(<span class="string">&#x27;文件占坑成功!&#x27;</span>);</span><br><span class="line">  CloseHandle(hProcess);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> 去广告方法 </tag>
            
            <tag> 八圈 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi如何在win7中远程注入代码</title>
      <link href="/page/2721990259/"/>
      <url>/page/2721990259/</url>
      
        <content type="html"><![CDATA[<h2 id="一-delphi远程注入Dll文件"><a href="#一-delphi远程注入Dll文件" class="headerlink" title="一. delphi远程注入Dll文件"></a>一. delphi远程注入Dll文件</h2><ol><li>首先，您必须找到已经在内存中运行的应用程序（EXE）的PID。以下函数将通过名称获得PID<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PIDbyName</span><span class="params">(ProcessName: PWideChar)</span>:</span> DWORD;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  ProcessSnap: Int64;</span><br><span class="line">  ProcessEntry32: TProcessEntry32;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Result := <span class="number">0</span>;</span><br><span class="line">  ProcessSnap := CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ProcessSnap &lt;&gt; INVALID_HANDLE_VALUE <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      ProcessEntry32.dwSize := SizeOf(TPROCESSENTRY32);</span><br><span class="line">      <span class="keyword">if</span> Process32First(ProcessSnap, ProcessEntry32) <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">repeat</span></span><br><span class="line">          <span class="keyword">if</span> lstrcmpi(ProcessEntry32.szExeFile, ProcessName) = <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">            <span class="keyword">begin</span></span><br><span class="line">              Result := ProcessEntry32.th32ProcessID;</span><br><span class="line">              CloseHandle(ProcessSnap);</span><br><span class="line">              <span class="keyword">exit</span>;</span><br><span class="line">            <span class="keyword">end</span>;</span><br><span class="line">        <span class="keyword">until</span> <span class="keyword">not</span> Process32Next(ProcessSnap, ProcessEntry32);</span><br><span class="line">      Result := <span class="number">0</span>;</span><br><span class="line">      CloseHandle(ProcessSnap);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure></li><li>这是32/64位应用程序的DLL注入函数 Source是DLL，Target是EXE<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">InjectDLL</span><span class="params">(Source, Target : PWideChar)</span> :</span> boolean;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  dwThreadID: Cardinal;</span><br><span class="line">  hProc, hThread: THandle;</span><br><span class="line">  BytesToWrite, BytesWritten: SIZE_T;</span><br><span class="line">  pRemoteBuffer, pLoadLibrary: Pointer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  hProc := OpenProcess(PROCESS_CREATE_THREAD <span class="keyword">or</span> PROCESS_QUERY_INFORMATION <span class="keyword">or</span> PROCESS_VM_OPERATION <span class="keyword">or</span> PROCESS_VM_WRITE <span class="keyword">or</span> PROCESS_VM_READ, False, PIDbyName(Target));</span><br><span class="line">  <span class="keyword">if</span> hProc = <span class="number">0</span> <span class="keyword">then</span> <span class="keyword">exit</span>(false);</span><br><span class="line">  <span class="keyword">try</span></span><br><span class="line">    BytesToWrite := SizeOf(WideChar) * (Length(Source) + <span class="number">1</span>);</span><br><span class="line">    pRemoteBuffer := VirtualAllocEx(hProc, <span class="keyword">nil</span>, BytesToWrite, MEM_COMMIT,PAGE_READWRITE);</span><br><span class="line">    <span class="keyword">if</span> pRemoteBuffer = <span class="keyword">nil</span> <span class="keyword">then</span> <span class="keyword">exit</span>(false);</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">not</span> WriteProcessMemory(hProc, pRemoteBuffer, Source, BytesToWrite, BytesWritten) <span class="keyword">then</span> <span class="keyword">exit</span>(false);</span><br><span class="line">      pLoadLibrary := GetProcAddress(GetModuleHandle(<span class="string">&#x27;kernel32.dll&#x27;</span>), <span class="string">&#x27;LoadLibraryW&#x27;</span>);</span><br><span class="line">      hThread := CreateRemoteThread(hProc, <span class="keyword">nil</span>, <span class="number">0</span>, pLoadLibrary, pRemoteBuffer, <span class="number">0</span>, dwThreadID);</span><br><span class="line">      <span class="keyword">try</span></span><br><span class="line">        WaitForSingleObject(hThread, INFINITE);</span><br><span class="line">      <span class="keyword">finally</span></span><br><span class="line">        Result := true;</span><br><span class="line">        CloseHandle(hThread);</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line">    <span class="keyword">finally</span></span><br><span class="line">      VirtualFreeEx(hProc, pRemoteBuffer, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">finally</span></span><br><span class="line">      CloseHandle(hProc);</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure></li><li>简单的DLL<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span> testDLL;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">uses</span></span><br><span class="line">  System.SysUtils,</span><br><span class="line">  System.Classes,</span><br><span class="line">  Winapi.Windows;</span><br><span class="line"> </span><br><span class="line"><span class="meta">&#123;$R *.res&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">DLLEntryPoint</span><span class="params">(dwReason: DWord)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  DLLHandle : DWORD;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">case</span> dwReason <span class="keyword">of</span></span><br><span class="line">    DLL_PROCESS_ATTACH:</span><br><span class="line">      MessageBox(DLLHandle, <span class="string">&#x27;Process Attach&#x27;</span>, <span class="string">&#x27;Info&#x27;</span>, mb_Ok);</span><br><span class="line">    DLL_PROCESS_DETACH:</span><br><span class="line">      MessageBox(DLLHandle, <span class="string">&#x27;Process Detach&#x27;</span>, <span class="string">&#x27;Info&#x27;</span>, mb_Ok);</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  DllProc := @DLLEntryPoint;</span><br><span class="line">  DllEntryPoint(DLL_PROCESS_ATTACH);</span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure>用法：InjectDLL(‘testDLL.dll’, ‘yourapplication.exe’)<h2 id="二-delphi远程直接注入代码执行-非DLL插入是代码注入"><a href="#二-delphi远程直接注入代码执行-非DLL插入是代码注入" class="headerlink" title="二. delphi远程直接注入代码执行(非DLL插入是代码注入)"></a>二. delphi远程直接注入代码执行(非DLL插入是代码注入)</h2><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//-------------------------注入代码的函数----------------------------  </span></span><br><span class="line"><span class="comment">&#123;参数说明: </span></span><br><span class="line"><span class="comment">InHWND:被注入的窗口句柄 </span></span><br><span class="line"><span class="comment">Func:注入的函数的指针 </span></span><br><span class="line"><span class="comment">Param:参数的指针 </span></span><br><span class="line"><span class="comment">ParamSize:参数的大小 </span></span><br><span class="line"><span class="comment">&#125;</span>  </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">InjectFunc</span><span class="params">(InHWND: HWND; Func: Pointer; Param: Pointer; ParamSize: DWORD)</span>;</span>  </span><br><span class="line"><span class="keyword">var</span>  </span><br><span class="line">    hProcess_N: THandle;  </span><br><span class="line">    ThreadAdd, ParamAdd: Pointer;  </span><br><span class="line">    hThread: THandle;  </span><br><span class="line">    ThreadID: DWORD;  </span><br><span class="line">    lpNumberOfBytes:DWORD;  </span><br><span class="line"><span class="keyword">begin</span>  </span><br><span class="line">    GetWindowThreadProcessId(InHWND, @ThreadID);    <span class="comment">//获得窗口ID  </span></span><br><span class="line">    hProcess_N := OpenProcess(PROCESS_ALL_ACCESS, False, ThreadID);<span class="comment">//打开被注入的进程  </span></span><br><span class="line">    ThreadAdd := VirtualAllocEx(hProcess_N, <span class="keyword">nil</span>, <span class="number">4096</span>, MEM_COMMIT, PAGE_READWRITE);    <span class="comment">//申请写入代码空间  </span></span><br><span class="line">    WriteProcessMemory(hProcess_N, ThreadAdd, Func, <span class="number">4096</span>, lpNumberOfBytes); <span class="comment">//写入函数地址  </span></span><br><span class="line">    ParamAdd := VirtualAllocEx(hProcess_N, <span class="keyword">nil</span>, ParamSize, MEM_COMMIT, PAGE_READWRITE);    <span class="comment">//申请写入代码参数空间  </span></span><br><span class="line">    WriteProcessMemory(hProcess_N, ParamAdd, Param, ParamSize, lpNumberOfBytes); <span class="comment">//写入参数地址  </span></span><br><span class="line">    hThread := CreateRemoteThread(hProcess_N, <span class="keyword">nil</span>, <span class="number">0</span>, ThreadAdd, ParamAdd, <span class="number">0</span>, lpNumberOfBytes); <span class="comment">//创建远程线程  </span></span><br><span class="line">    ResumeThread(hThread); <span class="comment">//直接运行线程  </span></span><br><span class="line">    CloseHandle(hThread); <span class="comment">//关闭线程  </span></span><br><span class="line">    VirtualFreeEx(hProcess_N, ThreadAdd, <span class="number">4096</span>, MEM_RELEASE);  </span><br><span class="line">    VirtualFreeEx(hProcess_N, ParamAdd, ParamSize, MEM_RELEASE); <span class="comment">//释放申请的地址  </span></span><br><span class="line">    CloseHandle(hProcess_N); <span class="comment">//关闭打开的句柄  </span></span><br><span class="line"><span class="keyword">end</span>;  </span><br><span class="line"><span class="comment">//-----------------------------定义一个参数类型-----------------------  </span></span><br><span class="line"><span class="keyword">type</span>  </span><br><span class="line">    TPickCallParam = <span class="keyword">packed</span> <span class="keyword">record</span>  </span><br><span class="line">      ax, ay: single;  </span><br><span class="line">    <span class="keyword">end</span>;  </span><br><span class="line">    PPickCallParam = ^TPickCallParam;    <span class="comment">//指向结构的指针(C中叫这种方式的数据应该叫结构体吧)  </span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">runCall</span><span class="params">(p:PPickCallParam)</span>;</span><span class="keyword">stdcall</span>;    <span class="comment">// 走路call  </span></span><br><span class="line"><span class="keyword">var</span>  </span><br><span class="line">addres,addres1,addres2:pointer;  </span><br><span class="line">x,y:single;  </span><br><span class="line"><span class="keyword">begin</span>  </span><br><span class="line">      addres:=pointer(<span class="number">$0045ec00</span>);  </span><br><span class="line">      addres1:=pointer(<span class="number">$00462620</span>);  </span><br><span class="line">      addres2:=pointer(<span class="number">$0045f000</span>);  </span><br><span class="line">      x:=p^.ax;              <span class="comment">//目的地X坐标  </span></span><br><span class="line">      y:=p^.ay;            <span class="comment">//目的地Y坐标  </span></span><br><span class="line">      <span class="keyword">asm</span>  </span><br><span class="line">      pushad  </span><br><span class="line">        mov      eax, dword ptr [<span class="number">$8f207c</span>]  </span><br><span class="line">        mov      eax, dword ptr [eax+<span class="number">$1C</span>]  </span><br><span class="line">        mov      esi, dword ptr [eax+<span class="number">$20</span>]  </span><br><span class="line">        mov      ecx, dword ptr [esi+<span class="number">$ba0</span>]  </span><br><span class="line">        push      <span class="number">1</span>  </span><br><span class="line">        call      addres  </span><br><span class="line">        mov      edi, eax  </span><br><span class="line">        lea      eax, dword ptr [esp+<span class="number">$18</span>]  </span><br><span class="line">        push      eax  </span><br><span class="line">        push      <span class="number">0</span>  </span><br><span class="line">        mov      ecx, edi  </span><br><span class="line">        call      addres1  </span><br><span class="line">        push      <span class="number">0</span>  </span><br><span class="line">        push      <span class="number">1</span>  </span><br><span class="line">        push      edi  </span><br><span class="line">        mov      ecx, dword ptr [esi+<span class="number">$ba0</span>]  </span><br><span class="line">        push      <span class="number">1</span>  </span><br><span class="line">        call      addres2  </span><br><span class="line">        mov      eax, dword ptr [<span class="number">$8f207c</span>]  </span><br><span class="line">        mov      eax, dword ptr [eax+<span class="number">$1C</span>]  </span><br><span class="line">        mov      eax, dword ptr [eax+<span class="number">$20</span>]  </span><br><span class="line">        mov      eax, dword ptr [eax+<span class="number">$ba0</span>]  </span><br><span class="line">        mov      eax, dword ptr [eax+<span class="number">$30</span>]  </span><br><span class="line">        mov      ecx, dword ptr [eax+<span class="number">4</span>]  </span><br><span class="line">        mov      eax, x  </span><br><span class="line">        mov      [ecx+<span class="number">$20</span>], eax  </span><br><span class="line">        mov      eax, y  </span><br><span class="line">        mov      [ecx+<span class="number">$28</span>], eax  </span><br><span class="line">      popad  </span><br><span class="line">      <span class="keyword">end</span>;  </span><br><span class="line"><span class="keyword">END</span>;  </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">Button1Click</span><span class="params">(Sender: TObject)</span>;</span><span class="comment">//在控件中做个按钮 测试  </span></span><br><span class="line"><span class="keyword">var</span>  </span><br><span class="line">      CallParam:TPickCallParam;  </span><br><span class="line"><span class="keyword">begin</span>;  </span><br><span class="line">    getmem(pname,<span class="number">33</span>);  </span><br><span class="line">    myhwnd := FindWindow(<span class="keyword">nil</span>,<span class="string">&#x27;Element Client&#x27;</span>);<span class="comment">&#123;查找窗口句柄&#125;</span>  </span><br><span class="line">    GetWindowThreadProcessId(myhwnd, aproc); <span class="comment">&#123;得到窗口ID&#125;</span>  </span><br><span class="line">    phnd := OpenProcess(PROCESS_VM_READ , False, aproc);<span class="comment">&#123;以完全访问权限打开进程句柄&#125;</span>  </span><br><span class="line">    <span class="keyword">if</span> (phnd&lt;&gt;<span class="number">0</span> ) <span class="keyword">then</span>  </span><br><span class="line">    <span class="keyword">begin</span>  </span><br><span class="line">      CallParam.ax:= <span class="number">1860.0</span>;    <span class="comment">//给注入代码函数赋值  </span></span><br><span class="line">      CallParam.ay:=<span class="number">120.0</span>;      <span class="comment">//给注入代码函数赋值  </span></span><br><span class="line">      InjectFunc(myhWnd,@runCall,@CallParam,SizeOf(CallParam)); <span class="comment">//运行注入代码函数  </span></span><br><span class="line">      sleep(<span class="number">100</span>);  </span><br><span class="line">      CloseHandle(PHND) <span class="comment">//关闭进程  </span></span><br><span class="line">    <span class="keyword">end</span>;  </span><br><span class="line"><span class="keyword">end</span>;   </span><br></pre></td></tr></table></figure><h2 id="三-远程代码或DLL注入x86-x64-Win2k-win7-Win8-1-64位全可用-最重要的隆重登场"><a href="#三-远程代码或DLL注入x86-x64-Win2k-win7-Win8-1-64位全可用-最重要的隆重登场" class="headerlink" title="三. 远程代码或DLL注入x86/x64/Win2k/win7~Win8.1 64位全可用(最重要的隆重登场)"></a>三. 远程代码或DLL注入x86/x64/Win2k/win7~Win8.1 64位全可用(最重要的隆重登场)</h2>上面的一和二远程注入，在win7 64位系统下，不能成功注入service服务程序，下面代码实现在64位系统,可以注入系统进程，服务进程等!看关键函数NtCreateThreadEx，而在win7 64位下的注入问题<a href="http://forum.sources.ru/index.php?showtopic=313636%E6%9C%89%E7%9B%B8%E5%BA%94%E8%AE%A8%E8%AE%BA">http://forum.sources.ru/index.php?showtopic=313636有相应讨论</a><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">program</span> Inject;</span><br><span class="line"> </span><br><span class="line"><span class="meta">&#123;$APPTYPE CONSOLE&#125;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">&#123;$IF CompilerVersion &gt;= 21.0&#125;</span></span><br><span class="line"><span class="meta">&#123;$WEAKLINKRTTI ON&#125;</span></span><br><span class="line"><span class="meta">&#123;$RTTI EXPLICIT METHODS([]) PROPERTIES([]) FIELDS([])&#125;</span></span><br><span class="line"><span class="meta">&#123;$IFEND&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">uses</span></span><br><span class="line"> Winapi.Windows;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">Type</span></span><br><span class="line"> NtCreateThreadExProc = <span class="function"><span class="keyword">Function</span><span class="params">(<span class="keyword">Var</span> hThread:THandle; Access:DWORD; Attributes:Pointer; hProcess:THandle; pStart:Pointer; pParameter:Pointer; Suspended:BOOL; StackSize, u1, u2:DWORD; Unknown:Pointer)</span>:</span>DWORD; <span class="keyword">stdcall</span>; </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">Function</span> <span class="title">CheckOs</span><span class="params">()</span>:</span>Boolean;</span><br><span class="line"><span class="keyword">Var</span></span><br><span class="line"> lpVersionInformation :TOSVersionInfoW;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> Result := False;</span><br><span class="line"> <span class="keyword">if</span> GetVersionExW(lpVersionInformation) <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">if</span> lpVersionInformation.dwPlatformId = VER_PLATFORM_WIN32_NT <span class="keyword">Then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">if</span> (lpVersionInformation.dwMajorVersion &lt; <span class="number">6</span>) <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> Result := True;</span><br><span class="line"> <span class="keyword">end</span>; </span><br><span class="line"> <span class="keyword">end</span>; </span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">Function</span> <span class="title">EnableDebugPrivilege</span><span class="params">()</span>:</span>Boolean;</span><br><span class="line"><span class="keyword">Var</span></span><br><span class="line"> hToKen :THandle;</span><br><span class="line"> TokenPri :TTokenPrivileges;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> Result := False;</span><br><span class="line"> <span class="keyword">if</span>(OpenProcessToken(GetCurrentProcess(),TOKEN_ADJUST_PRIVILEGES, hToKen)) <span class="keyword">Then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> TokenPri.PrivilegeCount := <span class="number">1</span>;</span><br><span class="line"> <span class="keyword">If</span> LookupPrivilegeValueW(<span class="keyword">Nil</span>, <span class="string">&#x27;SeDebugPrivilege&#x27;</span>, TokenPri.Privileges[<span class="number">0</span>].Luid) <span class="keyword">Then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> TokenPri.Privileges[<span class="number">0</span>].Attributes := SE_PRIVILEGE_ENABLED;</span><br><span class="line"> Result := AdjustTokenPrivileges(hToken, False, TokenPri, SizeOf(TTokenPrivileges), <span class="keyword">Nil</span>, PDWORD(<span class="keyword">Nil</span>)^);</span><br><span class="line"> <span class="keyword">end</span> <span class="keyword">Else</span> Writeln(<span class="string">&#x27;LookupPrivilege Error&#x27;</span>);</span><br><span class="line"> CloseHandle(hToKen);</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">Function</span> <span class="title">RemoteThread</span><span class="params">(hProcess:THandle; pThreadProc:Pointer; pRemote:Pointer)</span>:</span>THandle;</span><br><span class="line"><span class="keyword">Label</span> NtCreate, Create;</span><br><span class="line"><span class="keyword">Var</span></span><br><span class="line"> pFunc :Pointer;</span><br><span class="line"> hThread :THandle;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> hThread := <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">if</span> <span class="keyword">Not</span> CheckOs() <span class="keyword">then</span> <span class="comment">//根据系统版本来选择使用的API</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> NtCreate:</span><br><span class="line"> pFunc := GetProcAddress(LoadLibraryW(<span class="string">&#x27;ntdll.dll&#x27;</span>), <span class="string">&#x27;NtCreateThreadEx&#x27;</span>);</span><br><span class="line"> <span class="keyword">if</span> pFunc = <span class="keyword">Nil</span> <span class="keyword">then</span> <span class="keyword">Goto</span> Create; </span><br><span class="line"> NtCreateThreadExProc(pFunc)(hThread, <span class="number">$1FFFFF</span>, <span class="keyword">Nil</span>, hProcess, pThreadProc, pRemote, False, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="keyword">Nil</span>);</span><br><span class="line"> <span class="keyword">if</span> hThread = <span class="number">0</span> <span class="keyword">then</span> <span class="keyword">Goto</span> Create;</span><br><span class="line"> <span class="keyword">end</span> <span class="keyword">Else</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> Create:</span><br><span class="line"> hThread := CreateRemoteThread(hProcess, <span class="keyword">Nil</span>, <span class="number">0</span>, pThreadProc, pRemote, <span class="number">0</span>, PDWORD(<span class="keyword">Nil</span>)^); </span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> Writeln(<span class="string">&#x27;RemoteThread Ok!&#x27;</span>);</span><br><span class="line"> Result := hThread;</span><br><span class="line"><span class="keyword">end</span>; </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">Function</span> <span class="title">InjectDll2Pid</span><span class="params">(szPath:PWideChar; uPID:DWORD)</span>:</span>Boolean;</span><br><span class="line"><span class="keyword">Var</span></span><br><span class="line"> hProcess :THandle;</span><br><span class="line"> hThread :THandle;</span><br><span class="line"> szRemote :PWideChar;</span><br><span class="line"> uSize :SIZE_T;</span><br><span class="line"> uWrite :SIZE_T;</span><br><span class="line"> pStartAddr:Pointer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> Result := False;</span><br><span class="line"> <span class="keyword">if</span> EnableDebugPrivilege <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span> <span class="comment">//先提升下进程的权限</span></span><br><span class="line"> hProcess := OpenProcess(PROCESS_ALL_ACCESS, false, uPID);</span><br><span class="line"> <span class="keyword">if</span> hProcess &gt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> uSize := lstrlenW(szPath) * <span class="number">2</span> + <span class="number">4</span>;</span><br><span class="line"> szRemote := VirtualAllocEx(hProcess, <span class="keyword">Nil</span>, uSize, MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line"> <span class="keyword">if</span> WriteProcessMemory(hProcess, szRemote, szPath, uSize, uWrite) <span class="keyword">And</span> (uWrite = uSize) <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> pStartAddr := GetProcAddress(LoadLibrary(<span class="string">&#x27;Kernel32.dll&#x27;</span>), <span class="string">&#x27;LoadLibraryW&#x27;</span>);</span><br><span class="line"> hThread := RemoteThread(hProcess, pStartAddr, szRemote);</span><br><span class="line"> Result := hThread &lt;&gt; <span class="number">0</span>;</span><br><span class="line"> CloseHandle(hThread);</span><br><span class="line"> <span class="keyword">end</span> <span class="keyword">Else</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> Writeln(<span class="string">&#x27;WriteMemory Error&#x27;</span>);</span><br><span class="line"> <span class="keyword">end</span>; </span><br><span class="line"> <span class="keyword">end</span>; </span><br><span class="line"> <span class="keyword">end</span>; </span><br><span class="line"><span class="keyword">end</span>; </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">Function</span> <span class="title">StrToInt</span><span class="params">(S: <span class="keyword">String</span>)</span>:</span> Integer;</span><br><span class="line"><span class="keyword">Var</span></span><br><span class="line"> E: Integer;</span><br><span class="line"><span class="keyword">Begin</span></span><br><span class="line"> Val(S, Result, E);</span><br><span class="line"><span class="keyword">End</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> InjectDll2Pid(PWideChar(ParamStr(<span class="number">2</span>)), StrToInt(ParamStr(<span class="number">1</span>)));</span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure><h3 id="NtCreateThreadEx注入注意事项："><a href="#NtCreateThreadEx注入注意事项：" class="headerlink" title="NtCreateThreadEx注入注意事项："></a>NtCreateThreadEx注入注意事项：</h3>64位的进程，只能使用64位的dll注入,注入程序本身也必须编译为64位程序，32位的进程，只能使用32位的dll注入，注入程序本身编译为32位程序，不然会注入不成功!比如你把程序编译为32程序，想在win7 64位下往services.exe注入，是不会成功的，services.exe在win7 64位下是64位程序!</li></ol>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi源码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>音悦台MTV视频MP4真实地址PHP解析源码</title>
      <link href="/page/1586233474/"/>
      <url>/page/1586233474/</url>
      
        <content type="html"><![CDATA[<p>音悦Tai，主要提供MTV在线播放功能,官网<a href="http://www.yinyuetai.com/">http://www.yinyuetai.com/</a> ，有时我们需要下载音悦台的MTV的时候，按照官方的下载很多限制，这儿使用PHP直接解析出音悦台的MTV源地址，可以直接下载！音悦台MTV视频真实地址PHP解析源码如下:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">@header(<span class="string">&#x27;Content-type: text/html;charset=UTF-8&#x27;</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>])?trim(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]):<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="comment">//http://v.yinyuetai.com/video/2185713</span></span><br><span class="line"><span class="variable">$time</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_TIME&#x27;</span>];</span><br><span class="line"><span class="variable">$content</span> = file_get_contents(<span class="variable">$url</span>);</span><br><span class="line"><span class="comment">//获取标题</span></span><br><span class="line">preg_match(<span class="string">&#x27;/property=&quot;og:title&quot;[\s]+content=&quot;([^&quot;]*)&quot;.*?&gt;/i&#x27;</span>,<span class="variable">$content</span>,<span class="variable">$title</span>);</span><br><span class="line"><span class="comment">//获取封面</span></span><br><span class="line">preg_match(<span class="string">&#x27;/property=&quot;og:image&quot; content=&quot;([^&quot;]*)&quot;.*?&gt;/&#x27;</span>,<span class="variable">$content</span>,<span class="variable">$images</span>);</span><br><span class="line"><span class="comment">//获取MV的ID</span></span><br><span class="line">preg_match(<span class="string">&#x27;/[\d]+/&#x27;</span>,<span class="variable">$url</span>,<span class="variable">$song_id</span>);</span><br><span class="line"><span class="variable">$title</span>=<span class="variable">$title</span>[<span class="number">1</span>];</span><br><span class="line"><span class="variable">$images</span>=<span class="variable">$images</span>[<span class="number">1</span>];</span><br><span class="line"><span class="variable">$song_id</span>=<span class="variable">$song_id</span>[<span class="number">0</span>];</span><br><span class="line"><span class="comment">//解析json</span></span><br><span class="line"><span class="variable">$songurl</span> = <span class="string">&quot;http://www.yinyuetai.com/api/info/get-video-urls?callback=callback&amp;videoId=&quot;</span>.<span class="variable">$song_id</span>.<span class="string">&quot;&amp;_=&quot;</span>.<span class="variable">$time</span>;</span><br><span class="line"><span class="variable">$data</span> = file_get_contents(<span class="variable">$songurl</span>);</span><br><span class="line"><span class="keyword">if</span> (strpos(<span class="variable">$data</span>, <span class="string">&quot;callback&quot;</span>) !== <span class="literal">false</span>)&#123;</span><br><span class="line"> <span class="variable">$lpos</span> = strpos(<span class="variable">$data</span>, <span class="string">&quot;(&quot;</span>);</span><br><span class="line"> <span class="variable">$rpos</span> = strrpos(<span class="variable">$data</span>, <span class="string">&quot;)&quot;</span>);</span><br><span class="line"> <span class="variable">$data</span> = substr(<span class="variable">$data</span>, <span class="variable">$lpos</span> + <span class="number">1</span>, <span class="variable">$rpos</span> - <span class="variable">$lpos</span> -<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$json</span>= json_decode(<span class="variable">$data</span>,<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$title</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;流畅地址：&quot;</span>.<span class="variable">$json</span>[<span class="string">&#x27;hcVideoUrl&#x27;</span>].<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;高清地址：&quot;</span>.<span class="variable">$json</span>[<span class="string">&#x27;hdVideoUrl&#x27;</span>].<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;超清地址：&quot;</span>.<span class="variable">$json</span>[<span class="string">&#x27;heVideoUrl&#x27;</span>].<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;img src=\&quot;&quot;</span>.<span class="variable">$images</span>.<span class="string">&quot;\&quot;/&gt;&quot;</span>;</span><br></pre></td></tr></table></figure><p>看看解析效果<br><img src="/images/1516031845-1.gif" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php源码 </tag>
            
            <tag> 破解视频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unigui如何打印？Grid++Report锐浪报表解决方法</title>
      <link href="/page/2074828779/"/>
      <url>/page/2074828779/</url>
      
        <content type="html"><![CDATA[<p>uniGUI is a Web Application Framework for Delphi，unigui使delphi使用extjs快速的开发web程序,unigui符合delphi开发者的习惯，开发web就象开发桌面程序一样。但unigui中打印没有好的办法，因为是web，所以要么是直接打印html代码，要么是生成pdf，然后打印，这儿我们介绍的是unigui中使用Grid++Report锐浪报表打印方法，使用Grid++Report锐浪报表需要事先安装Grid++Report锐浪报表插件，如果你不喜欢喜欢插件，就只有使用生成pdf文件再打印了，可以不必看下面的内容!<br><img src="/images/1515773763-1.gif" alt=""></p><ol><li>先在ServerModule模块的Customfiles中加入grinstall/CreateControl.js  grinstall/GRInstall.js 这两个Grid++Report锐浪报表的JS，如果浏览器没有安装Grid++Report锐浪报表插件会提示安装!</li><li>引用UntGridppReportCommon.pas单元，该单元就是处理Grid++Report锐浪报表所需要的数据格式的!</li><li>在主窗口中加入TUniHTMLFrame控件!用来显示最终的html数据!<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">unbtbtn1Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">begin</span> <span class="comment">//预览报表</span></span><br><span class="line">  SetReportPrintViewerHTML(UniHTMLFrame1, <span class="string">&#x27;files/1a.grf&#x27;</span>, <span class="string">&#x27;files/ff.txt&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">UniBitBtn1Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">begin</span> <span class="comment">//创建报表</span></span><br><span class="line">  CreateReport(UniHTMLFrame1, <span class="string">&#x27;PlunID&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  UniSession.JSCode(<span class="string">&#x27;PlunID.LoadFromURL(&quot;files/1a.grf&quot;);&#x27;</span> +</span><br><span class="line">      <span class="string">&#x27;PlunID.LoadDataFromURL(&quot;files/ff.txt&quot;);&#x27;</span> + <span class="string">&#x27;PlunID.PrintPreview(true);&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">UniBitBtn2Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">begin</span> <span class="comment">//查询报表</span></span><br><span class="line">  SetReportDisplayViewerHTML(UniHTMLFrame1, <span class="string">&#x27;files/1a.grf&#x27;</span>, <span class="string">&#x27;files/ff.txt&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">UniBitBtn3Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">begin</span> <span class="comment">//设计报表</span></span><br><span class="line">  SetReportDesignHTML(UniHTMLFrame1, <span class="string">&#x27;files/1a.grf&#x27;</span>, <span class="string">&#x27;files/ff.txt&#x27;</span>, self);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">UniBitBtn4Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="comment">//打印报表</span></span><br><span class="line">  UniSession.JSCode(<span class="string">&#x27;ReportViewer.Print(true);&#x27;</span>);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">Exit</span>;</span><br><span class="line">  UniHTMLFrame1.HTML.Text := <span class="string">&#x27;  &#x27;</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>虽然安装插件不是太理想，但安装插件后就可以实现和桌面打印一样的功能，为什么不安装呢？<br>为什么使用Grid++Report锐浪报表呢？因为Grid++Report锐浪报表可以免费使用，付费就是去掉打印右下角的标志，免费使用有一个标志，不过不影响使用!最重要的是锐浪报表支持Web的打印，官网有详细教程，Grid++Report锐浪报表官网 <a href="http://www.rubylong.cn/">http://www.rubylong.cn/</a></li></ol><p>delphi源码下载地址：<br>链接: <a href="https://pan.baidu.com/s/1kVQFxHeNP_502ovWmC3myg">https://pan.baidu.com/s/1kVQFxHeNP_502ovWmC3myg</a> 提取码: 2hzk 复制这段内容后打开百度网盘手机App，操作更方便哦</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi源码 </tag>
            
            <tag> unigui使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi读取MBR数据源码</title>
      <link href="/page/1620682435/"/>
      <url>/page/1620682435/</url>
      
        <content type="html"><![CDATA[<p>MBR主引导记录（Main Boot Record）是位于磁盘最前边的一段引导（Loader）代码。它负责磁盘操作系统(DOS)对磁盘进行读写时分区合法性的判别、分区引导信息的定位，它由磁盘操作系统(DOS)在对硬盘进行初始化时产生的。病毒容易修改MBR，中MBR病毒后即使重装系统，只要不清除MBR一样会感染病毒!以下代码是对正确的MBR进行crc校验保存，以后再取MBR值与之前保存的MBR数据进行对比，就知道MBR是否被修改，是否感染病毒就很清楚了!</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">program</span> Project1;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">uses</span></span><br><span class="line">  Windows, Messages, SysUtils, Variants, Classes, Controls,</span><br><span class="line">  Dialogs, StdCtrls, FileCtrl,Crc32,IniFiles,ShlObj, ComObj, ActiveX;</span><br><span class="line"> </span><br><span class="line"><span class="meta">&#123;$R *.res&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetMbr</span><span class="params">(num,n:integer)</span>:</span><span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i:integer;</span><br><span class="line">  s,str:<span class="keyword">string</span>;</span><br><span class="line">  HD:THandle;</span><br><span class="line">  p:PChar;  </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  str:=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  s:=<span class="string">&#x27;\\.\PHYSICALDRIVE&#x27;</span>+inttostr(num);</span><br><span class="line">  HD:=CreateFile(PChar(s),GENERIC_ALL,FILE_SHARE_READ <span class="keyword">or</span> FILE_SHARE_WRITE,<span class="keyword">nil</span>,OPEN_EXISTING,<span class="number">0</span>,<span class="number">0</span>); <span class="comment">//得到句柄</span></span><br><span class="line">  <span class="keyword">if</span>(HD&lt;&gt;INVALID_HANDLE_VALUE) <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">  p:=allocmem(<span class="number">512</span>);</span><br><span class="line">  FileSeek(HD,<span class="number">0</span>,<span class="number">0</span>); <span class="comment">//定位到扇区</span></span><br><span class="line">   <span class="keyword">if</span> FileRead(HD,p[<span class="number">0</span>],<span class="number">512</span>)&lt;&gt;<span class="number">512</span> <span class="keyword">then</span></span><br><span class="line">    ShowMessage(<span class="string">&#x27; 读取出错 ！ &#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> i:=<span class="number">0</span> <span class="keyword">to</span> n-<span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">       str:=str+IntToHex(Byte(p[i]),<span class="number">2</span>)+<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">    Result:=str;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  FreeMem(p,n);</span><br><span class="line">  CloseHandle(HD);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gtcomputername</span>:</span><span class="keyword">string</span>;  <span class="comment">//取得本机计算机名</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  n:Cardinal;</span><br><span class="line">  computername:<span class="keyword">array</span>[<span class="number">0</span>..MAX_COMPUTERNAME_LENGTH+<span class="number">1</span>] <span class="keyword">of</span> Char;  <span class="comment">//本机机器名</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    n:=MAX_COMPUTERNAME_LENGTH+<span class="number">1</span>;</span><br><span class="line">    GetComputerName(@computername,n);</span><br><span class="line">    Result:=uppercase(strpas(computername));</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Mklog</span><span class="params">(logtext:<span class="keyword">string</span>)</span>:</span>Boolean;  <span class="comment">//写入日志</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  filelog:TextFile;</span><br><span class="line">  myf:<span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  myf:=ExtractFilePath(ParamStr(<span class="number">0</span>))+gtcomputername+<span class="string">&#x27;.log&#x27;</span>;</span><br><span class="line">  <span class="keyword">try</span></span><br><span class="line">     AssignFile(filelog,myf);</span><br><span class="line">     <span class="keyword">if</span> FileExists(myf) <span class="keyword">then</span></span><br><span class="line">       Append(filelog)</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">       Rewrite(filelog);</span><br><span class="line">     Writeln(filelog,logtext);</span><br><span class="line">     CloseFile(filelog);</span><br><span class="line">  <span class="keyword">except</span></span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetSpecialFolderDir</span><span class="params">(<span class="keyword">const</span> folderid: integer)</span>:</span> <span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">pidl: pItemIDList;</span><br><span class="line">buffer: <span class="keyword">array</span>[<span class="number">0</span>..<span class="number">255</span>] <span class="keyword">of</span> char;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="comment">//取指定的文件夹项目表</span></span><br><span class="line">SHGetSpecialFolderLocation(<span class="number">0</span>, folderid, pidl);</span><br><span class="line">SHGetPathFromIDList(pidl, buffer); <span class="comment">//转换成文件系统的路径</span></span><br><span class="line">Result := strpas(buffer);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">CreateLnk</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  favstr:<span class="keyword">string</span>;</span><br><span class="line">  ini:TIniFile;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">  favstr:=GetSpecialFolderDir(<span class="number">6</span>);</span><br><span class="line">  ini:=TIniFile.Create(favstr+<span class="string">&#x27;/百脑问.url&#x27;</span>);</span><br><span class="line">  ini.WriteString(<span class="string">&#x27;InternetShortcut&#x27;</span>,<span class="string">&#x27;URL&#x27;</span>,<span class="string">&#x27;http://www.bnwin.com&#x27;</span>);</span><br><span class="line">  ini:=TIniFile.Create(favstr+<span class="string">&#x27;/链接/百脑问.url&#x27;</span>);</span><br><span class="line">  ini.WriteString(<span class="string">&#x27;InternetShortcut&#x27;</span>,<span class="string">&#x27;URL&#x27;</span>,<span class="string">&#x27;http://www.bnwin.com&#x27;</span>);</span><br><span class="line">  ini.Free;</span><br><span class="line"><span class="keyword">except</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  mbrcrc,mbrstr,realcrc,cname:<span class="keyword">string</span>;</span><br><span class="line">  myini:TIniFile;</span><br><span class="line">  p1:<span class="keyword">string</span>;</span><br><span class="line">  n:Integer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  myini:=TIniFile.Create(ExtractFilePath(ParamStr(<span class="number">0</span>))+<span class="string">&#x27;setup.ini&#x27;</span>);</span><br><span class="line">  cname:=gtcomputername;</span><br><span class="line">  p1:=ParamStr(<span class="number">1</span>);  <span class="comment">//取</span></span><br><span class="line">  mbrstr:=GetMbr(<span class="number">0</span>,<span class="number">512</span>);  <span class="comment">//取mbr</span></span><br><span class="line">  mbrcrc:=GetCrc32Str(mbrstr,<span class="number">8</span>); <span class="comment">//取得crc值</span></span><br><span class="line">  <span class="keyword">if</span> UpperCase(p1)=<span class="string">&#x27;LOG&#x27;</span> <span class="keyword">then</span>  <span class="comment">//如果第一个参数为空，把crc值写入配置文件</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    myini.WriteString(<span class="string">&#x27;MBR&#x27;</span>,cname,mbrcrc);</span><br><span class="line">    Mklog(mbrstr);</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">else</span>  <span class="comment">//如果第二参数不为空，进行比较crc是否变动</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">     realcrc:=myini.ReadString(<span class="string">&#x27;MBR&#x27;</span>,cname,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> mbrcrc&lt;&gt;realcrc <span class="keyword">then</span><span class="comment">//crc值变动，mbr被修改</span></span><br><span class="line">     <span class="keyword">begin</span></span><br><span class="line">        myini.WriteString(<span class="string">&#x27;MBR被修改&#x27;</span>,cname,<span class="string">&#x27;[&#x27;</span>+mbrcrc+<span class="string">&#x27;] 正确值&#x27;</span>+realcrc);</span><br><span class="line">     <span class="keyword">end</span> <span class="keyword">else</span></span><br><span class="line">        myini.DeleteKey(<span class="string">&#x27;MBR被修改&#x27;</span>,cname);</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  myini.Free;</span><br><span class="line">  CreateLnk;</span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure><p>此代码不包含CRC单元</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi源码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>形象宣传片专题片片头AE模板</title>
      <link href="/page/1075145857/"/>
      <url>/page/1075145857/</url>
      
        <content type="html"><![CDATA[<p>形象宣传片专题片片头AE模板 图片展示震撼大气模板 震撼消防片头AE模板<br>软件 ：AfterEffects CS6(.aep)</p><p>像素 ：宽1920 X 高1080 像素</p><p>肖像权 ：无人物</p><p>体积 ：140.17MB</p><p>音频 ：含音频<br>视频预览：<br><video style="width:100%;" src="http://tbm.alicdn.com/e7vGObQmrVPWurKaLEF/gAzilH2ciWca0fZnE2D%40%40hd.mp4" controls="" preload="">您的浏览器不支持HTML5的 video 标签，无法为您播放！</video><br>视频截图：<br><img class="islazy alignnone size-full" data-original="https://img.alicdn.com/imgextra/i4/2779855185/TB2CzVjfhhmpuFjSZFyXXcLdFXa_!!2779855185.jpg" src="https://img.alicdn.com/imgextra/i4/2779855185/TB2CzVjfhhmpuFjSZFyXXcLdFXa_!!2779855185.jpg" alt="AE宣传片头" width="750" height="1554" style="display: block;"><br>下载地址<a href="https://pan.baidu.com/s/1hrUOCCG">https://pan.baidu.com/s/1hrUOCCG</a> 密码：31cx</p>]]></content>
      
      
      <categories>
          
          <category> 素材 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ae模板 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi如何根据句柄判断窗口的显示状态?</title>
      <link href="/page/2228855764/"/>
      <url>/page/2228855764/</url>
      
        <content type="html"><![CDATA[<p>有时我们取得一个窗口的句柄，需要知道这个窗口是隐藏还是显示状态？或者我们取得窗体的句柄，想隐藏这个窗体或显示这个窗体，该怎么办呢？这时我们需要用到API函数GetWindowLong或者GetWindowInfo,</p><p>GetWindowLong的函数原型LONG GetWindowLong( HWND hWnd,int nIndex )<br>参数：<br>hWnd：指定窗口的句柄<br>nIndex：需要获得的信息的类型<br>值 功能<br>nIndex取值如下:<br>GWL_EXSTYLE 得到扩展的窗口风格<br>GWL_STYLE 得到窗口风格<br>GWL_WNDPROC 得到窗口回调函数的地址，或者句柄。得到后必须使用CallWindowProc函数来调用<br>GWL_HINSTANCE 得到应用程序运行实例的句柄<br>GWL_HWNDPARENT 得到父窗口的句柄<br>GWL_ID 得到窗口的标识符<br>GWL_USERDATA 得到和窗口相关联的32位的值（每一个窗口都有一个有意留给创建窗口的应用程序是用的32位<br>的值）<br>当hWnd标识一个对话框时可以使用下面的值<br>Value Action<br>DWL_DLGPROC 得到对话框回调函数的地址，或者句柄。得到后必须使用CallWindowProc函数来调用<br>DWL_MSGRESULT 得到对话框回调函数中消息处理过程的返回值<br>DWL_USER 得到额外的应用程序私有信息，如一些句柄和指针等<br>返回值：<br>成功时，返回一个请求的32位的值<br>失败时，返回0，可以使用GetLastError来取得错误信息</p><p>示例1：</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">long nStyle = ::GetWindowLong(hWnd, GWL_STYLE); <span class="comment">// hWnd是一个编辑框的句柄</span></span><br><span class="line"><span class="keyword">if</span>(nStyle &amp; ES_PASSWORD)</span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">AfxMessageBox(“这是一个密码域”);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure><p>示例2：</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LONG GetWindowLong(</span><br><span class="line">HWND hWnd, <span class="comment">// handle of window</span></span><br><span class="line">int nIndex <span class="comment">// offset of value to retrieve</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>第二个参数是0的话，就是指定GW_HWNDFIRST！！！<br>GW_HWNDFIRST = 0; {同级别 Z 序最上}<br>GW_HWNDLAST = 1; {同级别 Z 序最下}<br>GW_HWNDNEXT = 2; {同级别 Z 序之下}<br>GW_HWNDPREV = 3; {同级别 Z 序之上}<br>GW_OWNER = 4; {属主窗口}<br>GW_CHILD = 5; {子窗口中的最上}</p><p>GetWindowInfo函数原型</p><p>BOOL WINAPI GetWindowInfo(__in HWND hwnd,__inout PWINDOWINFO pwi);</p><p>参数<br>hwnd  要检索信息的窗口的句柄。<br>pwi  指向一个接收信息的 PWINDOWINFO 结构，注意，在调用该函数之前必须设置 cbSize 成员为sizeof(WINDOWINFO)。]</p><p>typedef struct tagWINDOWINFO {<br>DWORD cbSize;<br>RECT rcWindow;  //窗口区域<br>RECT rcClient;  //Client区域<br>DWORD dwStyle; //窗口样式<br>DWORD dwExStyle; //窗口扩展样式<br>DWORD dwWindowStatus; //WS_ACTIVECAPTION表示活动，否则为0<br>UINT cxWindowBorders;  //边框宽度<br>UINT cyWindowBorders;  //边框宽度<br>ATOM atomWindowType;<br>WORD wCreatorVersion;<br>} WINDOWINFO, *PWINDOWINFO, *LPWINDOWINFO;</p><p>Members<br>cbSize<br>Type: DWORD<br>The size of the structure, in bytes. The caller must set this member to sizeof(WINDOWINFO).<br>rcWindow<br>Type: RECT<br>The coordinates of the window.<br>rcClient<br>Type: RECT<br>The coordinates of the client area.<br>dwStyle<br>Type: DWORD<br>The window styles. For a table of window styles, see Window Styles.<br>dwExStyle<br>Type: DWORD<br>The extended window styles. For a table of extended window styles, see Extended Window Styles.<br>dwWindowStatus<br>Type: DWORD<br>The window status. If this member is WS_ACTIVECAPTION (0x0001), the window is active. Otherwise, this member is zero.<br>cxWindowBorders<br>Type: UINT<br>The width of the window border, in pixels.<br>cyWindowBorders<br>Type: UINT<br>The height of the window border, in pixels.<br>atomWindowType<br>Type: ATOM<br>The window class atom (see RegisterClass).<br>wCreatorVersion<br>Type: WORD<br>The Windows version of the application that created the window.</p><p>返回值<br>如果函数成功，则返回值为非零值。<br>如果该函数失败，则返回值为零。要获取扩展的错误的信息，请调用GetLastError .</p><p>delphi根据句柄判断窗口状态代码</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用GetWindowLong函数 </span></span><br><span class="line">style := GetWindowLong(MyHandle, GWL_STYLE);</span><br><span class="line"> <span class="keyword">if</span> (style <span class="keyword">and</span> WS_VISIBLE) &gt; <span class="number">0</span> <span class="keyword">then</span> <span class="comment">//此句柄窗口是显示的</span></span><br><span class="line">    ShowWindow(MyHandle, SW_HIDE)</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">    ShowWindow(MyHandle, SW_SHOW);</span><br><span class="line">或用GetWindowInfo函数</span><br><span class="line"> GetWindowInfo(MyHandle, Pwi);</span><br><span class="line"> <span class="keyword">if</span> (Pwi.dwStyle <span class="keyword">and</span> WS_VISIBLE) &gt; <span class="number">0</span> <span class="keyword">then</span> <span class="comment">//此句柄窗口是显示的</span></span><br><span class="line">    ShowWindow(MyHandle, SW_HIDE)</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">    ShowWindow(MyHandle, SW_SHOW);</span><br></pre></td></tr></table></figure><p>通过这两个函数，我们可以判断窗体的样式来确定窗体的一些我们所需要的信息!</p><p>取得窗体信息的函数还有</p><p>获取窗口大小（RECT）矩形<br>以下是使用方法：<br>RECT rct; //创建一个RECT变量，用于接收下面函数的出参。<br>BOOL GetWindowRect(hwd, &amp;rct);<br>//入参 窗口句柄<br>//出参 一个RECT变量的地址，于接收函数的获取的值<br>返回值：<br>如果成功：返回 非零；<br>失败：返回零；调用GetLastError（）获取错误原因。</p><p>获取窗口类名<br>wchar_t strClassName[30] = {0};<br>//如果当前程序使用的是unicode字符集，那么就使用wchar_t类型，否则使用char类型。int GetClassName(hwd, strClassName, 30)<br>入参：hwd，窗口句柄</p><p>缓冲区大小<br>出参：strClassName，缓冲区<br>返回值：<br>成功，返回写入到缓冲区的字符个数；<br>失败，返回 零，调用GetLastError（）获取错误原因。</p><p>获取DC<br>HDC GetDC(hwd);<br>入参：hwd，窗口句柄<br>返回值：<br>成功，返回，当前窗口的句柄<br>失败，返回，NULL</p><p>获取鼠标位置<br>POINT pt;<br>GetCursorPos（&amp;pt）</p><p>取窗口信息的相关代码</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetWindowTitle</span><span class="params">(hwnd: HWND)</span>:</span> <span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  SetLength(Result, <span class="number">255</span>);</span><br><span class="line">  SetLength(Result, GetWindowText(hwnd, PChar(Result), <span class="number">255</span>));</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetWindowClass</span><span class="params">(hwnd: HWND)</span>:</span> <span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  SetLength(Result, <span class="number">255</span>);</span><br><span class="line">  SetLength(Result, GetClassName(hwnd, PChar(Result), <span class="number">255</span>));</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetWindowInfo</span><span class="params">(hwnd: HWND)</span>:</span> <span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Result := GetWindowTitle(hwnd) + <span class="string">&#x27; [&#x27;</span> + GetWindowClass(hwnd) +</span><br><span class="line">    <span class="string">&#x27;] (&#x27;</span> + IntToStr(hwnd) + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">EnumChildProc</span><span class="params">(hwnd: HWND; lParam: Integer)</span>:</span> BOOL; <span class="keyword">stdcall</span>;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  NewNode, ParentNode: TTreeNode;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Result := True;</span><br><span class="line">  ParentNode := TTreeNode(lParam);</span><br><span class="line">  NewNode := ParentNode.Owner.AddChild(ParentNode,</span><br><span class="line">    GetWindowInfo(hwnd));</span><br><span class="line">  EnumChildWindows(hwnd, @EnumChildProc, Integer(NewNode));</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">EnumWindowsProc</span><span class="params">(hwnd: HWND; lParam: Integer)</span>:</span> BOOL; <span class="keyword">stdcall</span>;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  NewNode: TTreeNode;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Result := True;</span><br><span class="line">  NewNode := TTreeView(lParam).Items.Add(<span class="keyword">nil</span>, GetWindowInfo(hwnd));</span><br><span class="line">  EnumChildWindows(hwnd, @EnumChildProc, Integer(NewNode));</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">EnumWindowsTree</span><span class="params">(Tree: TTreeView)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  EnumWindows(@EnumWindowsProc, Integer(Tree));</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">Button1Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  TreeView1.Items.Clear;</span><br><span class="line">  EnumWindowsTree(TreeView1);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何取得淘宝视频MP4文件下载地址?</title>
      <link href="/page/1486304673/"/>
      <url>/page/1486304673/</url>
      
        <content type="html"><![CDATA[<p>淘宝上的商品介绍视频，其他网站直接点击链接播放，很大机率会播放失败，或者你为了下载淘宝上的视频，很大机率直接下载会失败？如何取得淘宝视频MP4的下载地址呢？</p><ol><li>用chrome谷歌内核的浏览器打开淘宝有视频的网址，通过审查无素，在审查元素中搜索.swf字符，找到淘宝视频的播放链接!<img src="/images/1515454809-1.jpg" alt="">也可以直接在在淘宝视频界面，戳右下角分享，点击Flash地址完成复制<img src="/images/1515455046-0.gif" alt=""></li><li>链接象这种形式的 <a href="http://cloud.video.taobao.com/play/u/316952117/e/1/t/1/p/1/19950426.swf">http://cloud.video.taobao.com/play/u/316952117/e/1/t/1/p/1/19950426.swf</a> 直接把e/1改成e/6，swf改成mp4就可以下载了，修改结果<a href="http://cloud.video.taobao.com/play/u/316952117/e/6/t/1/p/1/19950426.mp4">http://cloud.video.taobao.com/play/u/316952117/e/6/t/1/p/1/19950426.mp4</a><img src="/images/1515454841-2.png" alt=""></li><li>链接象这种形式的 <a href="http://vodcdn.video.taobao.com/player/ugc/tb_ugc_bytes_core_player_loader.swf?version=1.0.20170327&amp;vid=50000874445&amp;uid=716884746&amp;p=1&amp;t=1&amp;rid=https://item.taobao.com/item.htm?spm=a230r.1.14.12.234d5249NdX2ye&id=541265983680&ns=1&abbucket=1&amp;random=6666">http://vodcdn.video.taobao.com/player/ugc/tb_ugc_bytes_core_player_loader.swf?version=1.0.20170327&amp;vid=50000874445&amp;uid=716884746&amp;p=1&amp;t=1&amp;rid=https%3A%2F%2Fitem.taobao.com%2Fitem.htm%3Fspm%3Da230r.1.14.12.234d5249NdX2ye%26id%3D541265983680%26ns%3D1%26abbucket%3D1&amp;random=6666</a>  进行拼接 这个链接中的 vid=50000874445&amp;uid=716884746 取uid修改<a href="http://cloud.video.taobao.com/play/u/716884746/e/6/t/1/p/1/50000874445.mp4%E5%90%8E%E9%9D%A2%E7%9A%84%E5%80%BC%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%B8%8B%E8%BD%BD%E6%B7%98%E5%AE%9D%E8%A7%86%E9%A2%91%E4%BA%86">http://cloud.video.taobao.com/play/u/716884746/e/6/t/1/p/1/50000874445.mp4后面的值，就可以下载淘宝视频了</a>!<img src="/images/1515454868-3.gif" alt=""></li></ol>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 下载视频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>北京2008奥运会开幕式视频</title>
      <link href="/page/2605139085/"/>
      <url>/page/2605139085/</url>
      
        <content type="html"><![CDATA[<p>第29届夏季奥林匹克运动会（Games of the XXIX Olympiad），又称2008年北京奥运会，2008年8月8日晚上8时整在中华人民共和国首都北京举办。2008年北京奥运会主办城市是北京，上海、天津、沈阳、秦皇岛、青岛为协办城市。香港承办马术项目。2008年北京奥运会共有参赛国家及地区204个，参赛运动员11438人，设302项（28种）运动，共有60000多名运动员、教练员和官员参加。2008年北京奥运会共创造43项新世界纪录及132项新奥运纪录，共有87个国家和地区在赛事中取得奖牌，中国以51枚金牌居金牌榜首名，是奥运历史上首个登上金牌榜首的亚洲国家。</p><iframe frameborder="0" width="100%" height="480px" src="https://v.qq.com/txp/iframe/player.html?vid=y08703fa002" allowFullScreen="true"></iframe>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 视频 </tag>
            
            <tag> 奥运会视频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>励志视频文章_你凭什么上北大?</title>
      <link href="/page/3429280465/"/>
      <url>/page/3429280465/</url>
      
        <content type="html"><![CDATA[<p>未名湖边的桃花儿开了，就在前几天。</p><p>我曾经无数次梦想过，陌生花开的时候湖边折枝的人群里会有自己的身影。那个时候，我的心思和大家一样单纯而迫切，我的目光却是比你们更加迷茫和恍惚。那年高三。</p><p>十年磨一剑，我得到的却几乎只是一块废铁。</p><p>高一那年，我真的差点就把自己废成了一块锈铁。上课的时候睡觉聊天看漫画吃零食，跟着后面那些男生大呼小叫，把年轻的女老师气得眼圈含泪，然后自鸣得意而洋洋之。那真是一段不堪回首的日子，像色彩斑斓的黑洞，看上去奇观异彩，鬼魅般的吸引力却在不知不觉中一点点把你拉向无底的深渊。于是下滑，于是堕落，而更加难过的是明明知道自己在下滑在堕落却无能力去改变。习惯的力量的确大到了让我无可奈何，于是放弃了最后的挣扎与努力。现在想想，那只是懦弱，那只是懒惰，那只是自己给自己自甘堕落所找的一个看似冠冕堂皇的理由，一切是自欺欺人。</p><p><video class="" autoplay="" tabindex="2" mediatype="video" crossorigin="anonymous" src="https://vd4.bdstatic.com/mda-kc5jm4e9u3xtj4mz/hd/mda-kc5jm4e9u3xtj4mz.mp4?v_from_s=hkapp-haokan-nanjing&amp;auth_key=1631287043-0-0-ec83985202ed84f136a541f42613c8e0&amp;bcevod_channel=searchbox_feed&amp;pd=1&amp;pt=3&amp;abtest=" style="position: absolute; top: 0px; left: 0px;"></video></p><p>可是当时没有任何人来指着我的鼻尖骂我，说你是不是就想这样破罐子破摔，就想这样玩完你的一辈子。也许他们已经放弃了我，有时候我想。然后是及其嘲讽般地不屑，不屑以及自以为是是洒脱——谁稀罕谁。其实，那个时候真的是应该有一个人，就像很多人曾经经历过的那样，指着我的鼻尖，戳着我的脊梁说，你知不知道自己在做什么，不清楚自己想要什么，不清楚自己的明天会是什么。</p><p>可是，再无所谓的人也会有自己的底线的，正如再深的涧谷也会有它的低谷。一切就像滑滑梯，一路上放肆张扬地笑了下来，最后终于重重地摔在了下面，头破血流。</p><p>也许，人只有在痛的时候，才会认认真真反省自己走错了哪一步吧，总要摔些跟头，才能学会绕着道走。而这条再简单不过的道理，我却付出了整整一年的青春时光才真正明白。一年，365天，可以让居里夫人发现镭，一年可以让爱因斯坦证出E=mc的平方，一年可以让一个婴儿学会跌跌撞撞地走向母亲的怀抱，一年可以让一段轰轰烈烈的爱情开始有终了。可是这一年，我只得到了那一句话。所幸，并不亏，也并不晚。</p><p>高二分科，我选了文。你无法想象我所在的中学有着怎样烂的文科班——本科上线三人是个什么概念？当我现在大学同学颇为自得地告诉我他们中学的班级北大清华一走几十个的时候，我轻轻的笑了笑。我所在的文科班，是一个本科上线三人的文科班，更具有讽刺性的是，那三个人全部是复读生。我就是在大家或无奈或讽刺或无谓的目光里，毅然决然地在文科报名表上写上了自己的名字。 那真是我一生中写得最好看的一次。</p><p>我只是突然间觉醒了，觉得自己的一辈子不能就那样过。事后很多人问我怎么回事，也许他们是想在我这里听到一个传奇般的浪子回头的故事，而我当时所能想到的解释只有这一句，我只是觉得，我的一辈子不应该就那样吊儿郎当地过去。<br>可是我还是低估了过去的那一年给我带来的影响。第一次月考，我考了年级第12名。也许这是一个听上去差强人意的成绩，可是，仅有的良知和理智还是足以提醒我，那是一个本科上线三人的文科班。如果你不能把所有的人远远甩在后边，12名和120名有什么区别？至今我还记得那次考了第一的那个女生。是一个不见经传的女孩子，瘦瘦小小，带副厚厚的黑边眼镜，趴伏在书桌上的身影常常有些佝偻。而这个印象的得来，是因为所有的人永远只能看到她趴在桌上的身影。她一直是班里第一个来最后一个走的人。我一直对那种学生持有一种莫名的排斥与抵触情绪，总想你们有什么了不起，不就是死读书吗，我要是像你这样刻苦学习早是市里第一了。事实上直到那次考试成绩出来的时候我仍然对她不屑一顾。然后，我迎来了一生中最重要的一次班会。我不知道要用怎样的份量去感谢那个班主任，因为如果不是她的那席话，现如今的我在哪里都不一定。班会上，她说：“这次成绩非常能说明问题。应该考好的人都考好了。”然后她扫了我一眼，我明白她的潜台词也就是说在她看来我属于是没有理由考好的那一堆人里的。奇怪，我居然没有脸红。不知道是太久的堕落已经在不知不觉中磨光了原本敏感的自尊，还是下意识里仍然对她的话不置可否，我当时面无表情地迎上了她的目光。她的眼睛只是平静的扫过我那里，然后继续：“我知道有些人自以为很聪很有才气，看不起那些认真学习刻苦努力的同学，总觉得人家是笨鸟先飞是先天不足。可是我想说，你只是懦弱！你是不敢尝试，你只是不敢像她们一样地去努力去刻苦，因为你怕自己刻苦了也比不上他们，刻苦了也考不了第一，结果反遭人耻笑，你宁可不去尝试，只是因为有失败的风险，而你甚至连这一点风险都承担不起，因为，在你心底，你对知道根本就没有把握““““““”后面她又说了什么我已经想不起来了，我承认当时我是完完全全地蒙在哪儿了，因为她说的那几句话。“你只是懦弱““““`”。当时的感觉是雷轰一样把整个人震住了，反反复复回荡在脑子里就只有那么一句话：“你只是懦弱。” 她是正确的。</p><p>那种突然觉醒的震撼是语言无法描述的，也是我不想用文字去表达的。你只能通过结果来想象，也只需要通过结果来想象。那晚我在日记里写，试试吧。我不去强求什么，我只想试试，试一试自己那样刻苦那样努力地去学上一个月会不会见效。当时我根本不敢对自己承诺什么结果，也的确承诺不起。我只是抱着一个念头，试一试。然后迎来了一生中最戏剧性的一个月。之所以说它戏剧性，是因为就像难以想象唐僧不再罗嗦，孙悟空不再好斗，八戒也不再贪吃一样，我简直不敢相信那个从早晨六点早自学上课到晚上十点晚自习下课一动也不动坐在位置上安安稳稳踏踏实实的人可以是我自己。其实并没有那么简单的，真的没有说起来那么简单的。我去一点一点地做的时候就已经发现了：要想在几天里改变365天来形成的习惯，太难；而要想在一个月里创造出令人膛目结舌的奇迹来，也太难。习惯成自然啊，就像那句话说的，“心似平原放马，易放难收”，野惯了的心，要想一下子收回来，谈何容易？常常坐着坐着就忍不住了，心开始浮躁，眼神也开始飘离，好几次差一点就要放弃。只是，在那个最危险的边缘晃荡的时候我总是压一压，告诉自己，忍不住的时候，再忍一下。其实说白了也就那么一句话：忍不住的时候，再忍一下。我承认自己是一个骨子里相当傲气的人，我就是不相信我刻苦起来会不如哪个人，我就是不信我真的去做一件事情的时候会做不到，我就是不信这世上真的有什么不可能的事情。I Believe that nothing is impossible.<br>然后，我迎来了那次期待以久的期中考试。至今我仍记得考完之后的感觉。抱着书走在回家的路上，茫然地看着车水马龙人来人往，恍惚想真的考完了吗？为什么心里空空的没有着落？那的确是我一生中最特殊的一次考试，因为它关系着我此后的方向和道路选择，风险太大，我怎么安得下心？其实，考试结果想必大家已经猜到了。我的的确确让所有的人真正膛目结舌了一次。是的，我考了第一，全市第一。</p><p>你永远也无法想象那个结果于我而言多么重要。知道成绩的时候我出乎寻常地平静。那个时候我才明白原来激扬和呐喊的冲动到了顶点只会是平静。当那个久违了的名字出现在了成绩单的第一行时，我默默地对自己说：记住了，这世上没有什么事情是不可能的。Nothing is impossble.<br>后来我再也没有改变过那种态度和方法。其实所有的方法说白了都是没有方法的。只有一个词：刻苦。</p><p>我坚守着我的不是方法的方法，也坚守着我的名字在成绩单上的位置，一直到高考前的最后一次考试，我始终是第一名。但是，真正的挑战还没有开始。即便我可以牢牢占据第一名的位置，即便我可以每次都把第二名甩下几十分，我知道，北大离我还是太远，远得连在梦里都看得不真切。所有的老师都坚信我将会是学校里有史以来考得最好的一个文科生，而在他们的概念里，考得最好的文科生，意味着你可以上山大，运气好点儿的话也许可以伸伸手还能够上复旦甚至人大的门槛。而我只要北大。我从来没有对任何人讲起过我的志愿——如果可以称之为志愿的话。我只想把所有的力量都积蓄起来。</p><p>高三第二学期，我们搬进了刚刚落成的教学楼。搬迁的那天，楼道里吵得很，拖桌子拉板凳的声音在走廊里不绝于耳。我一个人不言不语地跳过窗子，踏上了二楼窗框外那个大大的平台。对面是操场，初雪未融，空气湿冷，光秃秃的树枝直直地刺向天空。雪天的阳光凉凉地透过睫毛洒在眼睛里，眼睛静静地看着远远的天空，我说了一句话，只说了一句话。对着远处的天空，我默默在心里说：“等着吧，我要你见证一个奇迹。”我知道，这世上的确没有什么不可能的事情。</p><p>我从来不知道压力大到一定程度时居然可以把人的潜力激发到那种地步的。我是一个极其不安分的人，可是那段时间我表现得无比耐心沉稳，踏实得象头老黄牛。事实上无数次我都面临崩溃的边缘了，高中五本历史书我翻来覆去背了整整六遍。当你把一本书也背上六遍的时候你就知道那时什么感觉了。边背边掉眼泪，真的我是差一点就背不下去了就要把书扔掉了。只是，忍不住的时候，再忍一下。坚持的确是世界上最伟大的一种品质。那段时间我唯一的休息方式就是站在走廊里看远处的天空。后来发现在对面的建筑墙壁上有一行大大的红字，是学校用来激励学生的吧，我不确定。可就是那句话陪我走过了高三最后的日子——意志的力量，是决定成败的力量。我用我所有的经历和体会去实践而且证明了这句话：意志的力量，是决定成败的力量。</p><p>呼啸而至的风卷着漫天的黄沙，在那个北方的春天里，我们一个个头发蓬乱，皮肤粗糙。死寂与喧嚣交替如同美国的执政党，规律得让人怀疑冥冥之中可有双奇异而魔力无穷的手。惶然而又茫然的我们在敬畏与期待中迎来又送走了一模、二模以至N模，每根神经都被冷酷无情的现实锤炼得坚不可摧，不论是吟惯了杨柳岸晓风残月的诗情，还是习惯了信手涂鸦的画意。在这个来去匆匆的季节里，一切敏感纤细都奢侈得如同恺撒大帝的稠衣，徒留无数次的希望在无数次的失望前撞得粉身碎骨，无数次的激扬在无数次的颓丧下摔得头破血流。每个人都比昨天更加明白理想和现实之间那道不可逾越的鸿沟，同时也比昨天更加拼命努力挣扎，试图挤过那道窄窄的独木桥，哪怕明知是徒劳。<br>——-会是徒劳么？<br>当这个锥心的问号在夜阑人静的时候一次次猛烈扣击起了心门，每个人都难以承受那潮涌而至的恐慌和迷惘，于是逼着自己埋进去，埋进书本，埋进试卷，埋进密不透风的黑茧——为的只是有朝一日的破茧成蝶。青黑的眼圈，浮肿的眼带，干燥的手指，焦虑得起了水泡的嘴角。那个春天我不知道流行的是粉蓝果绿还是黛紫银灰。小镜子被悄悄收起，因为不忍见到自己憔悴的面容和黯淡的眼睛，因为怕有什么会在汪洋恣意般在干旱已久的脸上纵横开来——上帝，我是个女孩子啊。</p><p>上帝无言。无言微笑。微笑告诉我，你，心甘情愿。是的。我心甘情愿我不悔初衷我自己选择了这条路平坦也好崎岖也罢我得走下去。我要走下去。我会走下去。</p><p>于是所有的呐喊被咽下去，于是所有的豪情被收起来。我象一头二月黄牛，默默踏步，无声前行。当拼搏被拼命所取代时，香格里拉已经幻化为心中恒远而朦胧的梦想，而所有的努力也只是为了让这梦想不再“美人如花隔去端”，哪怕青冥长天，纵然绿水波澜。</p><p>踏入考场的时候后我很平静。“尽吾志也而不能至者，可以无悔矣。”事实上我从来没有想过自己会考入北大以外的哪所学校。与其说这是一种自信，莫如说这是一种预感。我只是想，哪怕北大只招一个名额，为什么不可能是我？这世上没有什么事情是真正不可能发生的。</p><p>考完后走在回家的路上，看着依然匆匆的人群，心里依然空无着落。眼睛因为泪雾而模糊，视野里的东西却越发清晰。这在科学上有解释，我却宁愿相信是因为一切真实的感知都要以泪水和苦痛作为代价。是的，我们总是要学会放弃一些东西，才能得到另外一些东西。如果你所在乎的东西值得你为它而付出一切，那么所有的放弃都只是分娩前的阵痛。总要有所取舍的，蝴蝶的生命之所以如此短暂，因为它的翅膀太过精致了。有时候，放弃只是为了真正的得到，关键看你想要的究竟是什么，以及为了这想要的的东西你愿意付出多大的代价。上帝对每一个人都是平等的。</p><p>事实上我怀念那段日子，并且永远感激它。不只是因为在那段时间里我完成了自己的过渡与蜕变，更是因为那时的一切深深烙在了我正处于可塑期的性格中，成为这一生永远的财富。那真的是多少钱都买不来的财富。人生中再也不会有哪个时期像那时一样专一地，单纯地，坚决地，几近固执而又饱含信仰和希冀地，心无旁贷乃至与世隔绝地，为了一个认定的目标而奋斗。当你在若干年后某个悠闲的下午，回想起自己曾经的努力和放弃，曾经的坚忍和耐力，曾经的执著和付出，曾经的汗水和泪水，那会是怎样一种感动和庆幸，怎样一种欣慰和尊敬——尊敬你自己。是的，在这个过程中，请允许我重复一遍，最重要的，是你自己。我感谢父母感谢老师感谢同学感谢朋友感谢所有关心我帮助我的人，但我最感谢的，是我自己。Nothing is impossible.这是我在一点一滴的努力与尝试中获得到的东西。而且我也相信，这也将会是使我终生受益的东西。在这里，我把自己最信仰的一句话送给大家： Nothing is impossible.</p>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 励志视频 </tag>
            
            <tag> 视频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Your world within在你的世界激励视频</title>
      <link href="/page/3089788148/"/>
      <url>/page/3089788148/</url>
      
        <content type="html"><![CDATA[<p>其实很多时候，我们并非跟任何人博弈，我们只要努力的战胜自己，所以才会觉得疲惫。战胜别人，需要的是不断的斗志和勇气；而战胜自己，需要的确实坚守的意志和决心。没有梦想的人，是可怕的；就好像一个人没有信仰。我要赚好多好多钱，可是好多好多又是多少？是一百万，一千万还是一个亿？我要好好谈一场恋爱，可是好好谈一场恋爱的标准又是什么？是愿得一心人，白首不相离；是即使曾经沧海难为水，却依旧七月七日长生殿，还是众里寻他千百度，那人却在灯火阑珊处？</p><p><video style="width:100%;" src="http://ydschool-video.nosdn.127.net/15050976608861.mp4" controls="" preload="">您的浏览器不支持HTML5的 video 标签，无法为您播放！</video></p>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 励志视频 </tag>
            
            <tag> 视频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>国外拍的中国春节，中国新年视频</title>
      <link href="/page/3669695729/"/>
      <url>/page/3669695729/</url>
      
        <content type="html"><![CDATA[<p>《中国春节》是国外2015年12月拍摄的三集纪录片，用镜头聚焦“亿万中国人同时迁徙的壮观。在开篇，三位主持人开门见山地为网友介绍了中国的农历新年。可能买不到票，可能坐上没有座位的火车，可能要在人堆里挤上三天三夜，但这都不能阻止中国人回家过年的愿望。<br><img src="/images/1515031398-1.jpg" ></p><p>1.《中国新年》第一集《回家》主要讲述了在中国传统文化和家庭观念的影响下，中国人通过火车、飞机、摩托车不同方式回家过年的故事，介绍了中国为保障春节期间人们顺利出行所做的准备，同时对中国哈尔滨冰雪节、蔚县打树花等春节文化进行了展示。主持人还特意到云南白马雪山探寻金丝猴的保护情况，介绍中国12属相文化。</p><iframe frameborder="0" width="100%" height="480px" src="https://v.qq.com/txp/iframe/player.html?vid=x01859ooa23" allowFullScreen="true"></iframe>2.《中国新年》第二集《团圆》主要介绍中国家庭春节期间的传统风俗习惯，包括包饺子、贴春联、看春晚、放烟花、摆鲜花以及祈福等，通过照全家福等生动的故事体现了中国人家庭的团圆和温暖，而在蔬菜批发市场的采购过程又体现了现代中国生活的富足。<iframe frameborder="0"  width="100%" height="480px" src="https://v.qq.com/txp/iframe/player.html?vid=b0185941qtj" allowFullScreen="true"></iframe>3.《中国新年》第三集《欢庆》从中国最南端的香港到最北端的查干湖，从北京的庙会到香港维多利亚港的焰火，体现了遍布中国大江南北的欢乐祥和气氛，介绍了中国的饮食文化和舞龙舞狮等民俗文化。特别是本集里客观地介绍了香港1997年回归和一国两制的理念，并把香港本土文化作为中国文化的一部分展示给海外观众。<iframe frameborder="0"  width="100%" height="480px" src="https://v.qq.com/txp/iframe/player.html?vid=n0019v5i9ta" allowFullScreen="true"></iframe>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 视频 </tag>
            
            <tag> 春节视频 </tag>
            
            <tag> 新年视频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>time小青龙伴奏MP3下载</title>
      <link href="/page/3091515898/"/>
      <url>/page/3091515898/</url>
      
        <content type="html"><![CDATA[<p>中国有嘻哈选手歌曲time 小青龙VS辉子<br>time原唱小青龙和辉子，虽然两位老铁淘汰了，但是这首歌还是很感人!<br>小青龙 辉子 time 高品质伴奏下载，纯净，无干扰，纯音乐伴奏，无人声!<br>下载地址 链接：<a href="https://pan.baidu.com/s/1pLMIF8Z">https://pan.baidu.com/s/1pLMIF8Z</a> 密码：g1w2</p><p>附上time的歌词<br>当我没日没夜工作从长水起飞</p><p>时间反复催促让我忘了疲惫</p><p>那心酸的滋味我只能独自体会</p><p>想要回到过去但是时光不能倒退</p><p>校门口美味的路边摊还在不在</p><p>包里塞的小吃那是外婆给的爱</p><p>那年生日同桌攒钱给我买的卡带</p><p>包装粗糙海报写着JAY</p><p>那些年做过的课间操</p><p>课桌上面摆着老师送的铅笔刀</p><p>她教我如何起跑</p><p>我闭上双眼祈祷</p><p>我知道努力学习以后才能把歌写好</p><p>于是日复一日 年复一年</p><p>那个美丽的春天早已变成我的纪念</p><p>我渐渐长大成人 眼看着世界沉沦</p><p>就算我是个战神可我心也一样会疼</p><p>再没骗自己的理由</p><p>时间如刀不再温柔</p><p>一路走 汗在流 再回首 已没有</p><p>那双扶着我不跌倒的手</p><p>走尽春夏秋冬 天南地北</p><p>母亲已经白头</p><p>我也 不再 年幼</p><p>我发现我早已经长大</p><p>我发现我早不说谎话</p><p>特别的怀念</p><p>回到童年</p><p>可我只能把握现在</p><p>带着回不去的从前</p><p>街边的落日 和小时候的复读机</p><p>度过了末日 但我要比以前有出息</p><p>小霸王游戏机</p><p>陪我度过了一段时期</p><p>经典的就像是old school flow</p><p>从不用质疑</p><p>改变不了过去 那我为了现在出征</p><p>我不会为了Hip-hop死</p><p>但为了Hip-hop出生</p><p>所以我努力的跑</p><p>把一切全部看透</p><p>我想让我爱的人过的更好</p><p>所以才去战斗</p><p>脱掉了曾经</p><p>认为很时尚的大肥裤子</p><p>到现在</p><p>我依旧做说唱还在饿着肚子</p><p>回忆是每个人的财富 一定记住他</p><p>不用问我的来路 贫民窟的艺术家</p><p>再没骗自己的理由</p><p>时间如刀不再温柔</p><p>一路走 汗在流 再回首 已没有</p><p>那双扶着我不跌倒的手</p><p>走尽春夏秋冬 天南地北</p><p>母亲已经白头</p><p>我也 不再 年幼</p>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> time小青龙伴奏 </tag>
            
            <tag> 音乐 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi中如何设置dcef3的代理服务器setproxy?</title>
      <link href="/page/3680656161/"/>
      <url>/page/3680656161/</url>
      
        <content type="html"><![CDATA[<p>代理服务器（Proxy Server）是一种重要的服务器安全功能，它的工作主要在开放系统互联(OSI)模型的会话层，从而起到防火墙的作用。代理服务器大多被用来连接INTERNET（国际互联网）和Local Area Network（局域网）。delphi中的tChromium控件dcef3如何设置代理服务器呢？</p><ol><li>delphi中webbrowser设置代理服务器是这样的!<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#123;-------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">  过程名:    SetProcessProxy</span></span><br><span class="line"><span class="comment">  作者:      kelei</span></span><br><span class="line"><span class="comment">  日期:      2013.08.03</span></span><br><span class="line"><span class="comment">  参数:      aProxyServer代理服务器; aProxyPort代理服务器端口</span></span><br><span class="line"><span class="comment">  返回值:    True设置成功</span></span><br><span class="line"><span class="comment">  SetProcessProxy(&#x27;127.0.0.1&#x27;, 80);</span></span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SetProcessProxy</span><span class="params">(<span class="keyword">const</span> aProxyServer: <span class="keyword">string</span>; <span class="keyword">const</span> aProxyPort: Integer)</span>:</span> Boolean;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  vProxyInfo: TInternetProxyInfo;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  vProxyInfo.dwAccessType := INTERNET_OPEN_TYPE_PROXY;</span><br><span class="line">  vProxyInfo.lpszProxy := PChar(Format(<span class="string">&#x27;http=%s:%d&#x27;</span>, [aProxyServer, aProxyPort]));</span><br><span class="line">  vProxyInfo.lpszProxyBypass := PChar(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  Result := UrlMkSetSessionOption(INTERNET_OPTION_PROXY, @vProxyInfo, SizeOf(vProxyInfo, <span class="number">0</span>) = S_OK;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure></li><li>在dcef3中如何静态设置代理服务器呢？<br>静态设置方法在dpr中添加启动命令行参数，如果不添加命令行参数设置代理服务器，那么dcef3默认是使用的ie的代理服务器：<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">AppendCefCmdline</span><span class="params">(<span class="keyword">const</span> processType: ustring; <span class="keyword">const</span> cmd: ICefCommandLine)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  cmd.AppendSwitchWithValue(<span class="string">&#x27;proxy-server&#x27;</span>,<span class="string">&#x27;http://218.189.26.20:8080&#x27;</span>);<span class="comment">//设置http代理服务器</span></span><br><span class="line">  cmd.AppendSwitchWithValue(<span class="string">&#x27;proxy-server&#x27;</span>,<span class="string">&#x27;https://218.189.26.20:8082&#x27;</span>);<span class="comment">//设置https代理服务器</span></span><br><span class="line">  cmd.AppendSwitchWithValue(<span class="string">&#x27;proxy-server&#x27;</span>,<span class="string">&#x27;ftp://218.189.26.20:21&#x27;</span>);<span class="comment">//设置ftp代理服务器</span></span><br><span class="line">  cmd.AppendSwitchWithValue(<span class="string">&#x27;proxy-server&#x27;</span>,<span class="string">&#x27;socks://202.116.0.188:3128&#x27;</span>)<span class="comment">//设置SOCKS代理服务器</span></span><br><span class="line">  cmd.AppendSwitchWithValue(<span class="string">&#x27;proxy-server&#x27;</span>,<span class="string">&#x27;sock4://202.116.0.188:1080&#x27;</span>)<span class="comment">//设置sock4代理服务器 </span></span><br><span class="line">  cmd.AppendSwitchWithValue(<span class="string">&#x27;proxy-server&#x27;</span>,<span class="string">&#x27;sock5://202.116.0.188:1081&#x27;</span>)<span class="comment">//设置sock5代理服务器</span></span><br><span class="line"><span class="comment">//cmd.AppendSwitchWithValue(&#x27;proxy-server&#x27;,&#x27;direct://&#x27;)//所有连接不使用代理</span></span><br><span class="line"><span class="comment">//cmd.AppendSwitchWithValue(&#x27;proxy-server&#x27;,&#x27;https=127.0.0.1:80;http=socks4://bnwin.com:1080&#x27;)//同时设置https和sock4代理服务器</span></span><br><span class="line">  cmd.AppendSwitchWithValue(<span class="string">&#x27;proxy-bypass-list&#x27;</span>,<span class="string">&#x27;127.*,192.168.*,10.10.*,193.9.162.*&#x27;</span>);<span class="comment">//不使用代理服务器的地址</span></span><br><span class="line"><span class="comment">//cmd.AppendSwitch(&#x27;--no-proxy-server&#x27;);//禁止代理服务器</span></span><br><span class="line"><span class="comment">//cmd.AppendSwitch(&#x27;--proxy-auto-detect&#x27;);//自动检测代理配置</span></span><br><span class="line"><span class="comment">//cmd.AppendSwitchWithValue(&#x27;proxy-pac-url&#x27;,&#x27;http://www.bnwinn.com/proxy.pac&#x27;)//代理使用指定URL中的PAC文件</span></span><br><span class="line"><span class="comment">//cmd.AppendSwitch(&#x27;--winhttp-proxy-resolver&#x27;);//代理在IE中运行正常,但在chrome中失败，可以添加此flag</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  CefOnBeforeCommandLineProcessing :=AppendCefCmdline; <span class="comment">//指定dcef启动命令行</span></span><br><span class="line">  Application.Initialize;</span><br><span class="line">  Application.MainFormOnTaskbar := True;</span><br><span class="line">  Application.CreateForm(TMainForm, MainForm);</span><br><span class="line">  Application.Run;</span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure></li><li>在dcef3中如何动态设置代理服务器setproxy？<br>前面已经说过，如果不在命令行中设置代理服务器，那么dcef是默认使用的ie代理服务器，要想动态设置代理服务器，我们不在dcef的命令行参数设置代理，然后使用开头的动态设置ie代理服务器的代码，dcef3的代理服务器就是动态的了！</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">System network settings</span><br><span class="line">The Chromium network stack uses the system network settings so that users and administrators can control the network settings of all applications easily. The network settings include:</span><br><span class="line">proxy settings</span><br><span class="line">SSL/TLS settings</span><br><span class="line">certificate revocation check settings</span><br><span class="line">certificate and private key stores</span><br><span class="line">So far this design decision has worked well. The only network settings that some users ask for an alternative to system settings are proxy settings. For this we recently added some command-line options that allow you to run Chromium with custom proxy settings.</span><br><span class="line">Preference service for network settings</span><br><span class="line"></span><br><span class="line">Although the system network settings have been sufficient for our network stack, eventually there will be some configuration settings specific to our network stack, so we need to have our own preference service for those settings. See also issue 266, in which some Firefox users demand that we not use the WinInet proxy settings (the de facto system proxy settings on Windows).</span><br><span class="line">Command-line options for proxy settings</span><br><span class="line"></span><br><span class="line">Chrome supports the following proxy-related command line arguments:</span><br><span class="line"></span><br><span class="line">–no-proxy-server</span><br><span class="line"></span><br><span class="line">This tells Chrome not to use a Proxy. It overrides any other proxy settings provided.</span><br><span class="line"></span><br><span class="line">–proxy-auto-detect</span><br><span class="line"></span><br><span class="line">This tells Chrome to try and automatically detect your proxy configuration. This flag is ignored if –proxy-server is also provided.</span><br><span class="line"></span><br><span class="line">–proxy-server==[:][;…] | [:] | “direct://”</span><br><span class="line"></span><br><span class="line">This tells Chrome to use a custom proxy configuration. You can specify a custom proxy configuration in three ways:</span><br><span class="line"></span><br><span class="line">1) By providing a semi-colon-separated mapping of list scheme to url/port pairs.</span><br><span class="line">For example, you can specify:</span><br><span class="line">–proxy-server=”http=foopy:80;ftp=foopy2″</span><br><span class="line">to use HTTP proxy “foopy:80” for http URLs and HTTP proxy “foopy2:80″ for ftp URLs.</span><br><span class="line"></span><br><span class="line">2) By providing a single uri with optional port to use for all URLs.</span><br><span class="line">For example:</span><br><span class="line">–proxy-server=”foopy:8080”</span><br><span class="line">will use the proxy at foopy:8080 for all traffic.</span><br><span class="line"></span><br><span class="line">3) By using the special “direct://” value.</span><br><span class="line">–proxy-server=”direct://” will cause all connections to not use a proxy.</span><br><span class="line"></span><br><span class="line">–proxy-bypass-list=(|)[:][;…]</span><br><span class="line"></span><br><span class="line">This tells chrome to bypass any specified proxy for the given semi-colon-separated list of hosts. This flag must be used (or rather, only has an effect) in tandem with –proxy-server.</span><br><span class="line">Note that trailing-domain matching doesn’t require “.” separators so “*google.com” will match “igoogle.com” for example.</span><br><span class="line"></span><br><span class="line">For example,</span><br><span class="line">–proxy-server=”foopy:8080″ –proxy-bypass-list=”*.google.com;*foo.com;127.0.0.1:8080″</span><br><span class="line">will use the proxy server “foopy” on port 8080 for all hosts except those pointing to *.google.com, those pointing to *foo.com and those pointing to localhost on port 8080.</span><br><span class="line">igoogle.com requests would still be proxied. ifoo.com requests would not be proxied since *foo, not *.foo was specified.</span><br><span class="line"></span><br><span class="line">–proxy-pac-url=</span><br><span class="line"></span><br><span class="line">This tells Chrome to use the PAC file at the specified URL.</span><br><span class="line"></span><br><span class="line">For example,</span><br><span class="line">–proxy-pac-url=”http://wpad/windows.pac”</span><br><span class="line">will tell Chrome to resolve proxy information for URL requests using the windows.pac file.</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> dcef3使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>不要小看自己的力量励志视频</title>
      <link href="/page/1444890423/"/>
      <url>/page/1444890423/</url>
      
        <content type="html"><![CDATA[<h2 id="不要小看自己的力量励志视频"><a href="#不要小看自己的力量励志视频" class="headerlink" title="不要小看自己的力量励志视频"></a>不要小看自己的力量励志视频</h2><p>你可以改变世界。你每天都可以用善行和爱来充满你的生活。你也许不能消除世界饥饿，但你可以捐献50磅食品，从而让一个家庭免遭饥饿一个月。你也许不能给世界带来和平，但你可以把你的和平精神带给你周围的世界。你也许不能驱走所有人心中的仇恨和黑暗，但你可以把你内心中的爱和光拿出来与人共享。</p><p><video style="width:100%;" src="http://ydschool-video.nosdn.127.net/15029559866791.mp4" controls="" preload="">您的浏览器不支持HTML5的 video 标签，无法为您播放！</video></p>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 励志视频 </tag>
            
            <tag> 视频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>绝地求生pubg黑屏补丁、内存优化、画质优化工具</title>
      <link href="/page/1983881970/"/>
      <url>/page/1983881970/</url>
      
        <content type="html"><![CDATA[<p>本绝地求生工具包括内存优化，画质增强(reshade)，黑屏补丁，跳VC插件检测功能！</p><p>本绝地求生pubg黑屏补丁和内存优化补丁特点:此黑屏补丁，不需要开机运行，绝地求生运行时运行本补丁即可，试想，开机运行的黑屏补丁，顾客不玩绝地求生你也运行？不是问题？黑屏补丁不管你在盖伦或是云更新下载的绝地求生，只要是绝地求生就行，本黑屏补丁直接检测游戏本身!内存优化，在游戏中不会出现卡顿现象，内存优化不会回收绝地大逃杀已经使用的内存，只回收非绝地求生程序所占的内存，本来内存优化就是把内存给绝地求生使用， 你再回收绝地求生的内存，会不会造成游戏中卡一下，你自己都想象得到!有些顾客先玩几把英雄联盟，再玩一会儿穿越火线，然后朋友一起约起玩绝地大逃杀，大家都知道腾讯的游戏退出并不是运行游戏时启动的程序在退出时都会退出，并且有些顾客根本就不退出英雄联盟等游戏，就直接运行绝地大逃杀，在你只有8G内存的情况下，顾客就会甩鼠标，拍键盘，说你机器卡得不得了!关键是他开机运行了什么？所以本内存优化补丁会直接优化这些根本不是当前需要运行的程序所占内存!使用所谓的内存优化专家，也是会收回绝地求生所占内存，游戏中也是会卡一下的，他是不会区分的！使用本补丁，无盘系统8G内存，回写缓存设置1G，一直玩绝地求生，不重启不卡!</p><ol><li>绝地大逃杀pubg黑屏问题，在绝地大逃杀pc3.5.5更新后，到现在pc3.5.7都存在运行绝地大逃杀会一直黑屏，鼠标要点一下才会进入游戏，这影响了用户的体验，不明白的玩家会认为是机器配置问题，我们来看看这个现象，看有黑屏的动画<img src="/images/jdfw.gif" alt="">使用pubg黑屏补丁，解决后没有黑屏的动画<img src="/images/jdfw1.gif" alt="">一直快速进入游戏界面！</li><li>绝地求生画质增强(reshade)功能,本功能集成官方认可的reshade画质增强插件，运行时在Steam登录窗口显示按钮，由用户自由选择是否开启reshade画质增强!不需要去下载安装reshade，不需要你为了使用reshace去设置找pubg的路径，全自动启用reshade画质插件，退出本绝地求生工具，自动清理reshade文件，不留痕迹，不会影响原本的pubg环境!</li><li>同时本绝地求生工具具有windows优化大师的内存优化功能，可以设置小于多少内存的，多少分钟并且物理内存使用率超过91%进行一次内存回收，留出更多的物理内存给绝地大逃杀pubg使用。本绝地求生工具的内存优化，优化时游戏中不会出现卡顿情况!</li><li>绝地大逃杀pubg内存优化补丁的原理，使用了SetProcessWorkingSetSize函数，把物理内存占用存在虚拟内存上，windows的这个SetProcessWorkingSetSize函数来设置应用程序最小和最大的运行空间，只会保留需要的内存。当应用程序被闲置或系统内存太低时，操作系统会自动调用这个机制来设置应用程序的内存。如果你的物理内存小于8G，可以使用本补丁进行优化，如果你16G内存就不需要使用了！此种优化内存并非优秀的方法，市面上的优化内存软件基本使用此原理，最优秀的方法是添加物理内存！</li><li>使用方法：运行绝地大逃杀时启动本绝地求生工具的setup.exe文件即可，你可以在游戏菜单中进行设置!steam退出，本补丁自动退出！<img src="/images/1515511601-1.gif" alt=""></li></ol><p>其中的配置文件设置说明(如果删除config.ini配置文件，就是只使用pubg黑屏补丁！)</p><p>[setup]<br>;启用clearmemory后内存小于memorysize设定的多少G，每cleartime设置的分钟优化一次内存占用,1为启用 0为禁用，默认为0<br>;启用内存清理的前提条件是，pubg游戏在运行，并且物理内存使用率超过91%<br>clearmemory=0<br>memorysize=9<br>cleartime=2<br>;启用blackpatch＝1，启动pubg没有黑屏，直接进界面，0为不处理，默认为1<br>;用于pubg pc 3.5.5版，如果后续版本无黑屏就可以不启动<br>blackpatch=1<br>;跳过安装vc2008 2010 2012 2013 2015 2017和dx2010 PhysX,1为跳过安装并且设置steam为中文，0为不处理，默认为0<br>skipplug=1<br>;reshade画质增强补丁 1为开启，0为不开启，默认为0，进入游戏后shift+F2呼出reshade界面<br>reshade=0</p><p>下载地址:</p><p>1.不带reshade画质增强插件功能的下载地址  链接: <a href="https://pan.baidu.com/s/1oAiMaoE">https://pan.baidu.com/s/1oAiMaoE</a> 密码: g8ie 解压密码 bnwin.com  启动方式：绝地求生启动前运行pubgtool.exe</p><p>2.具有绝地求生reshade画质增强插件功能的下载地址  </p><p>链接：<a href="https://pan.baidu.com/s/1eTOJ7gu">https://pan.baidu.com/s/1eTOJ7gu</a> 密码：phm0 解压密码 bnwin.com</p><p>附加提供游戏加加的绝地求生助手的reshade画质配置文件,游戏加加的绝地求生助手对绝地求生的画质优化也是集成的reshade，如果你显卡比较好，可以用绝地求生助手的ini替换掉bnwin.ini，就可以使用绝地求生助手的画质设置效果!游戏加加的reshade配置文件下载:   链接：<a href="https://pan.baidu.com/s/1dG20VEL">https://pan.baidu.com/s/1dG20VEL</a> 密码：0x8a 解压密码 bnwin.com   使用游戏加加的reshade配置的方法：<br><img src="/images/1515513387-1.gif" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi中如何自定义dcef3的右键菜单？</title>
      <link href="/page/3769761372/"/>
      <url>/page/3769761372/</url>
      
        <content type="html"><![CDATA[<p>delphi中TChromium控件dcef3的右键菜单默认是这样的<br><img src="/images/1514424349-1.gif" alt=""><br>如何修改成自己的菜单呢？或者自定义dcef3的右键菜单呢？</p><ol><li>在dcef3窗体中添加TApplicationEvents控件aplctnvnts1!</li><li>添加TPopupMenu控件pm1，并设置好自定义的dcef3的右键菜单及功能.</li><li>在TApplicationEvents控件的OnMessage事件中添加如下代码。<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">aplctnvnts1Message</span><span class="params">(<span class="keyword">var</span> Msg: tagMSG; <span class="keyword">var</span> Handled: Boolean)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  mPoint: TPoint;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">if</span> IsChild(chrm1.Handle, Msg.Hwnd) <span class="keyword">and</span> ((Msg.<span class="keyword">Message</span> = WM_RBUTTONDOWN) <span class="keyword">or</span> (Msg.<span class="keyword">Message</span> = WM_RBUTTONUP)) <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    GetCursorPos(mPoint); <span class="comment">//得到光标位置</span></span><br><span class="line">    pm1.Popup(mPoint.X, mPoint.Y); <span class="comment">//弹出popupmenu的菜单</span></span><br><span class="line">    Handled := True;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>这样你就不用让用户看TChromium的默认英文右键菜单了!对于TChromium默认右键菜单的功能，可以自己用代码很轻松的实现!</li></ol>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> dcef3使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi中如何删除dcef3的cookie和缓存？</title>
      <link href="/page/3468945668/"/>
      <url>/page/3468945668/</url>
      
        <content type="html"><![CDATA[<p>我们用以下代码打开网站</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span></span><br><span class="line">   Chromium: TChromium;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">try</span></span><br><span class="line">     Chromium := TChromium.Create(<span class="keyword">nil</span>);</span><br><span class="line">     Chromium.SetParentComponent(Form1);</span><br><span class="line">     Chromium.Align := alClient;</span><br><span class="line">     chromium.Browser.MainFrame.LoadUrl(<span class="string">&#x27;www.bnwin.com&#x27;</span>);</span><br><span class="line">     FreeAndNil(Chromium)</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>如何删除dcef3的cookie和缓存？请看以下代码</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span></span><br><span class="line">  <span class="title">CefTask</span> = <span class="keyword">class</span>(TCefTaskOwn)</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">Execute</span>;</span> <span class="keyword">override</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span></span><br><span class="line">    <span class="keyword">var</span> url,cookieName: ustring;</span><br><span class="line">    <span class="function"><span class="keyword">constructor</span> <span class="title">create</span>;</span> <span class="keyword">virtual</span>;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">constructor</span> <span class="title">CefTask</span>.<span class="title">create</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">inherited</span> create;</span><br><span class="line">  url := <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  cookieName := <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">CefTask</span>.<span class="title">Execute</span>;</span></span><br><span class="line"><span class="keyword">var</span> CookieManager: ICefCookieManager;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  CookieManager := TCefCookieManagerRef.Global;</span><br><span class="line">  CookieManager.DeleteCookies(url,cookieName);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">c_WB_ClearCookies</span>;</span></span><br><span class="line"><span class="keyword">var</span> Task: CefTask;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Task := CefTask.Create;</span><br><span class="line">  CefPostTask(TID_IO, Task);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// c_WB_Clear_url_Cookies(&#x27;http://google.com&#x27;,&#x27;cookie_name&#x27;);</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">c_WB_Clear_url_Cookies</span><span class="params">(c_url,c_cookieName: ustring)</span>;</span></span><br><span class="line"><span class="keyword">var</span> Task: CefTask;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Task := CefTask.Create;</span><br><span class="line">  Task.url := c_url;</span><br><span class="line">  Task.cookieName := c_cookieName;</span><br><span class="line">  CefPostTask(TID_IO, Task);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>整理自网站 <a href="https://stackoverflow.com/questions/12269587/how-do-i-clear-the-cache-and-cookies-for-an-embedded-chromium-browser">https://stackoverflow.com/questions/12269587/how-do-i-clear-the-cache-and-cookies-for-an-embedded-chromium-browser</a></p><p>取得cookie并显示，如果需要删除cookie，把deleteCookie:= False改为deleteCookie:= True</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">VisitCookie</span> <span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function"><span class="keyword">const</span> <span class="keyword">name</span>, value, domain, path: ustring; secure, httponly, hasExpires: Boolean;</span></span></span><br><span class="line"><span class="params"><span class="function"><span class="keyword">const</span> creation, lastAccess, expires: TDateTime; count, total: Integer;</span></span></span><br><span class="line"><span class="params"><span class="function"><span class="keyword">out</span> deleteCookie: Boolean)</span>:</span> Boolean;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  deleteCookie:= False;</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27; cookie &#x27;</span> +inttostr (count) + <span class="string">&#x27; / &#x27;</span> + inttostr (total));</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27; name &#x27;</span> +<span class="keyword">name</span>);</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27; value &#x27;</span> +value);</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27; domain &#x27;</span> +domain);</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27; path &#x27;</span> +path);</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27; secure &#x27;</span> +BoolToStr (secure));</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27; httponly &#x27;</span> +BoolToStr (httponly));</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27; hasExpires &#x27;</span> +BoolToStr (hasExpires));</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27; creation &#x27;</span> +DateToStr (creation));</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27; lastAccess &#x27;</span> +DateToStr (lastAccess));</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27; expires &#x27;</span> +DateToStr (expires));</span><br><span class="line">  MainForm.Memo1.Lines. Add (<span class="string">&#x27;--------------- &#x27;</span>);</span><br><span class="line">  Result:= True;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">btn2Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">var</span> CookieManager: ICefCookieManager;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">CookieManager:= TCefCookieManagerRef.Global(<span class="keyword">nil</span>);</span><br><span class="line">CookieManager.VisitAllCookiesProc (VisitCookie);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//这样写，我在delphi xe8中编译不过</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">Button1Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  CookieManager: ICefCookieManager;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  CookieManager := TCefCookieManagerRef.Global(<span class="keyword">nil</span>);</span><br><span class="line">  CookieManager.VisitAllCookiesProc(</span><br><span class="line">    <span class="function"><span class="keyword">function</span><span class="params">(<span class="keyword">const</span> <span class="keyword">name</span>, value, domain, path: ustring; secure, httponly,</span></span></span><br><span class="line"><span class="params"><span class="function">      hasExpires: Boolean; <span class="keyword">const</span> creation, lastAccess, expires: TDateTime;</span></span></span><br><span class="line"><span class="params"><span class="function">      count, total: Integer; <span class="keyword">out</span> deleteCookie: Boolean)</span>:</span> Boolean</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      deleteCookie := True;</span><br><span class="line">      ShowMessage(<span class="string">&#x27;A cookie from domain &#x27;</span> + domain + <span class="string">&#x27; will be unmercifully &#x27;</span> +</span><br><span class="line">        <span class="string">&#x27;deleted!&#x27;</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  );</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>为网址设置单独的cookie文件</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">CookieManager: ICefCookieManager;</span><br><span class="line"> </span><br><span class="line">FormCreate:</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   CookiesPath := ExtractFilePath(Application.ExeName) + <span class="string">&#x27;cookies/bnwin&#x27;</span>;</span><br><span class="line">   CookieManager := TCefCookieManagerRef.Global(<span class="keyword">nil</span>);</span><br><span class="line">   CookieManager.SetStoragePath(CookiesPath, True, <span class="keyword">nil</span>);</span><br><span class="line">   Chromium1.Load（<span class="string">&#x27;bnwin.com&#x27;</span>）; </span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line">FormClose:   </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  CookieManager.FlushStore(<span class="keyword">nil</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>为指定的网站设置cookie</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Fsuccess: Boolean;</span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">SetCookieR</span><span class="params">(success: Boolean)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   Fsuccess := success;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">btn1Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">var</span> CookieManager: ICefCookieManager;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  CookieManager := TCefCookieManagerRef.Global(<span class="keyword">nil</span>);</span><br><span class="line">  CookieManager.SetCookieProc(<span class="string">&#x27;http://bnwin.com&#x27;</span>, <span class="string">&#x27;TEST&#x27;</span>, <span class="string">&#x27;supertest&#x27;</span>, <span class="string">&#x27;.bnwin.com&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, False,False, True, now, now, StrToDateTime(<span class="string">&#x27;2020-12-30&#x27;</span>),SetCookieR);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>dcef中允许网站保存cookie会话</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CookieManager: ICefCookieManager;</span><br><span class="line"> </span><br><span class="line">FormCreate:</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   CookiesPath := ExtractFilePath(Application.ExeName) + <span class="string">&#x27;cookies&#x27;</span>;</span><br><span class="line">   CookieManager := TCefCookieManagerRef.Global(<span class="keyword">nil</span>);</span><br><span class="line">   CookieManager.SetStoragePath(CookiesPath, True, <span class="keyword">nil</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">FormClose:   </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  CookieManager.FlushStore(<span class="keyword">nil</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> dcef3使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi中dcef如何自定义referer信息？</title>
      <link href="/page/4288787729/"/>
      <url>/page/4288787729/</url>
      
        <content type="html"><![CDATA[<p>TChromium自定义referer，在早期的dcef版本中，这样Append(‘Referer’,’<a href="http://www.bnwin.com’)就可以了,详细看下面代码,如果append不行,启用这句request.setreferrer/">http://www.bnwin.com’)就可以了，详细看下面代码，如果append不行，启用这句request.SetReferrer</a>(request.url, REFERRER_POLICY_ALWAYS);</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">chrm1BeforeResourceLoad</span><span class="params">(Sender: TObject;</span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="keyword">const</span> browser: ICefBrowser; <span class="keyword">const</span> frame: ICefFrame;</span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="keyword">const</span> request: ICefRequest; <span class="keyword">const</span> callback: ICefRequestCallback;</span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="keyword">out</span> Result: TCefReturnValue)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  map: ICefStringMultimap;</span><br><span class="line">  sAccept,sUserAgent:<span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">begin</span>      </span><br><span class="line">    sAccept:= <span class="string">&#x27;application/x-shockwave-flash, image/gif, image/jpeg, image/pjpeg, application/x-ms-application, application/x-ms-xbap,&#x27;</span>+</span><br><span class="line">    <span class="string">&#x27; application/vnd.ms-xpsdocument, application/xaml+xml,text/html,application/octet-stream, */*&#x27;</span>;</span><br><span class="line">    sUserAgent:=<span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36 QIHU 360EE&#x27;</span>;</span><br><span class="line">  map := TCefStringMultimapOwn.Create;</span><br><span class="line">  request.GetHeaderMap(map);</span><br><span class="line">  map.Append(<span class="string">&#x27;Referer&#x27;</span>,request.url);</span><br><span class="line">  map.Append(<span class="string">&#x27;Accept&#x27;</span>,sAccept);</span><br><span class="line">  map.Append(<span class="string">&#x27;User-Agent&#x27;</span>,sUserAgent);</span><br><span class="line"> <span class="comment">// ShowMessage(map.getvalue(1)+&#x27;  &#x27;+map.getkey(1));</span></span><br><span class="line">  request.SetHeaderMap(map);</span><br><span class="line">  <span class="comment">//map:=nil;</span></span><br><span class="line"> <span class="comment">//request.SetReferrer(request.url, REFERRER_POLICY_ALWAYS);</span></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>在高版本的dcef中自定义referer，可以直接定义request.</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">ShowUrl</span><span class="params">(hurl,AllUrl:<span class="keyword">string</span>)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line"> Request: ICefRequest;</span><br><span class="line"> Data: ICefPostData;</span><br><span class="line"> Header: ICefStringMultimap;</span><br><span class="line"> sUserAgent:<span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> chrm1.Browser.IsLoading <span class="keyword">then</span> chrm1.Browser.StopLoad;</span><br><span class="line">    sUserAgent:=<span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36 QIHU 360EE&#x27;</span>;</span><br><span class="line">    Request := TCefRequestRef.New;</span><br><span class="line">    Request.SetReferrer(hurl,REFERRER_POLICY_ORIGIN);<span class="comment">//定义referer</span></span><br><span class="line">    Data := TCefPostDataRef.New;</span><br><span class="line">    Header := TCefStringMultimapOwn.Create;</span><br><span class="line">    Header.Append(<span class="string">&#x27;Accept-Language&#x27;</span>, <span class="string">&#x27;zh-CN&#x27;</span>);</span><br><span class="line">    Header.Append(<span class="string">&#x27;User-Agent&#x27;</span>,sUserAgent);</span><br><span class="line">    Request.Assign(AllUrl,<span class="string">&#x27;POST&#x27;</span>,Data,header);</span><br><span class="line"> </span><br><span class="line">    chrm1.Browser.MainFrame.LoadRequest(Request);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> dcef3使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Procmon监视系统一举一动的利器!</title>
      <link href="/page/446633678/"/>
      <url>/page/446633678/</url>
      
        <content type="html"><![CDATA[<p>Procmon也被称为Process Monitor，是一款系统进程监视软件，总体来说，Process Monitor相当于Filemon+Regmon，其中的Filemon专门用来监视系统 中的任何文件操作过程，而Regmon用来监视注册表的读写操作过程。 有了Process Monitor，使用者就可以对系统中的任何文件和 注册表操作同时进行监视和记录，通过注册表和文件读写的变化， 对于帮助诊断系统故障或是发现恶意软件、病毒或木马来说，非常 有用。 这是一个高级的 Windows 系统和应用程序监视工具，由优秀的 Sysinternals 开发，并且目前已并入微软旗下，可靠性自不用说。</p><img src="/images/pmon.png" alt="">Process Monitor 不仅结合了 Filemon（文件监视器） 和 Regmon（注册表监视器） 两个工具的功能，还具有以下一些增强：<p>监视进程和线程的启动和退出，包括退出状态代码<br>监视映像 (DLL 和内核模式驱动程序) 加载<br>捕获更多输入输出参数操作<br>非破坏性的过滤器允许你自行定义而不会丢失任何捕获的数据<br>捕获每一个线程操作的堆栈，使得可以在许多情况下识别一个操作的根源<br>可靠捕获进程详细信息，包括映像路径、命令行、完整性、用户和会话ID等等<br>完全可以自定义任何事件的属性列<br>过滤器可以设置为任何数据条件，包括未在当前视图中显示的<br>高级的日志机制，可记录上千万的事件，数GB的日志数据<br>进程树工具显示所有进程的关系<br>原生的日志格式，可将所有数据信息保存，让另一个 Process Monitor 实例加载<br>进程悬停提示，可方便的查看进程信息<br>详细的悬停提示信息让你方便的查看列中不能完整显示的信息<br>搜索可取消<br>系统引导时记录所有操作</p><p>官方下载地址：  <a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/procmon">https://docs.microsoft.com/zh-cn/sysinternals/downloads/procmon</a></p><p>百度网盘下载地址：链接: <a href="https://pan.baidu.com/s/1eSF9fAM">https://pan.baidu.com/s/1eSF9fAM</a> 密码: erib</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 去广告方法 </tag>
            
            <tag> 精品软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi中如何让dcef支持flash插件播放视频？</title>
      <link href="/page/2193927687/"/>
      <url>/page/2193927687/</url>
      
        <content type="html"><![CDATA[<p>Chromium Embedded Framework (CEF)是个基于Google Chromium项目的开源Web browser控件，支持Windows, Linux, Mac平台。除了提供C/C++接口外，也有其他语言的移植版。因为基于Chromium，所以CEF支持Webkit &amp; Chrome中实现的HTML5的特性，并且在性能上面，也比较接近Chrome。<br>CEF还提供的如下特性：自定义插件、自定义协议、自定义JavaScript对象和扩展；可控制的resource loading, navigation, context menus等等。dcef是指的cef在delphi中的版本</p><p>cef在前期版本中是自带支持flash插件的,后来Chromium不再默认支持flash控件!下面看看我的程序的dcef命令行参数</p><img src="/images/20171225234120.png" alt="">如何让dcef支持flash呢？<ol><li>安装好dcef，不管哪个版本都行!</li><li>安装360极速浏览器或QQ浏览器，打开其安装目录，找到ppflash目录和npflash目录(360极速浏览器是这两个目录，而QQ浏览器略有不同)！</li><li>在你的工程目录中建NativeFlash目录和PepperFlash目录,然后360的npflash目录下的NPSWF开头的dll文件和同目录下的vch文件复制到自己工程的NativeFlash中，把360的ppflash目录中的pepflash开头的dll文件和同目录下的json文件复制到工程的PepperFlash目录中!这一步就是用360浏览器的flash文件，不需要你手工去下载安装插件!至少你应该发现即使你的系统没有安装flash插件，但360浏览器安装后一样可以正常播放flash，这就是因为他的目录中自带了这几个flash文件，为了让你的程序的dcef支持flash，所以我们直接复制360极速浏览器的flash文件过来，简单方便!</li><li>编辑你的delphi工程文件（即dpr文件），在{$R *.res}后面添加如下代码<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">AppendCefCmdline</span><span class="params">(<span class="keyword">const</span> processType: ustring; <span class="keyword">const</span> cmd: ICefCommandLine)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">//cmd.AppendSwitch(&#x27;--enable-gpu-plugin&#x27;);//允许gpu</span></span><br><span class="line">  <span class="comment">//cmd.AppendSwitch(&#x27;disable-gpu&#x27;);//禁止gpu</span></span><br><span class="line">  cmd.AppendSwitch(<span class="string">&#x27;enable-npapi&#x27;</span>); <span class="comment">//允许NativeFlash</span></span><br><span class="line">  <span class="comment">//cmd.AppendSwitch(&#x27;enable-tab-audio-muting&#x27;);//允许tab页禁音</span></span><br><span class="line">  <span class="comment">//cmd.AppendSwitch(&#x27;--enable-media-stream&#x27;); //允许视频流</span></span><br><span class="line">  cmd.AppendSwitchwithvalue(<span class="string">&#x27;load-plugin&#x27;</span>, <span class="string">&#x27;NativeFlash\NPSWF32.dll&#x27;</span>);<span class="comment">//指定NativeFlash插件文件位置，注意文件名要和你的一致</span></span><br><span class="line">    <span class="comment">//cmd.AppendSwitchWithValue(&#x27;ppapi-flash-version&#x27;,&#x27;20.0.0.267&#x27;);//指定PepperFlash版本号</span></span><br><span class="line">  cmd.AppendSwitchWithValue(<span class="string">&#x27;ppapi-flash-path&#x27;</span>,<span class="string">&#x27;PepperFlash\pepflashplayer.dll&#x27;</span>);<span class="comment">//指定PepperFlash插件文件位置,注意文件名要和你的一致</span></span><br><span class="line">  cmd.AppendSwitch(<span class="string">&#x27;--enable-system-flash&#x27;</span>);<span class="comment">//允许PepperFlash</span></span><br><span class="line">  <span class="comment">//cmd.AppendSwitch(&#x27;--enable-usermedia-screen-capturing&#x27;);</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  CefOnBeforeCommandLineProcessing :=AppendCefCmdline; <span class="comment">//这一句就是指定了dcef启动的命令行</span></span><br><span class="line">  Application.Initialize;</span><br><span class="line">  Application.MainFormOnTaskbar := True;</span><br><span class="line">  Application.CreateForm(TMainForm, MainForm);</span><br><span class="line">  Application.Run;</span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure></li></ol><p>很多人用delphi的dcef写的程序，不支持flash，是只在命令行中添加了允许flash，而没有指定flash插件文件的位置，这时dcef会去调用系统安装的flash插件，一旦系统插件有问题，你的程序就无法播放flash了，本文写的方法就是360极速浏览器的方法，不管你的系统安装不安装flash，一样播放flash!<br>而要让dcefbrowser支持flash也一样，dcefbrowser中只是把CefOnBeforeCommandLineProcessing改为DcefBApp.OnBeforeCommandLineProcessing即可，至于播放flash会有dos窗口弹一下的问题，请看本站的这篇文章<a href="http://www.bnwin.com/2017/12/01/328.html">http://www.bnwin.com/2017/12/01/328.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> dcef3使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>delphi如何实现任意窗口透明化?</title>
      <link href="/page/807774960/"/>
      <url>/page/807774960/</url>
      
        <content type="html"><![CDATA[<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明:</span></span><br><span class="line">SetLayeredWindowAttributes(</span><br><span class="line">  Hwnd: THandle;   <span class="comment">&#123;窗口句柄&#125;</span></span><br><span class="line">  crKey: COLORREF; <span class="comment">&#123;透明色&#125;</span></span><br><span class="line">  bAlpha: Byte;    <span class="comment">&#123;Alpha 值&#125;</span></span><br><span class="line">  dwFlags: DWORD   <span class="comment">&#123;LWA_COLORKEY(=1)表示使用透明色; LWA_ALPHA(=2)表示使用 Alpha 值&#125;</span></span><br><span class="line">): Boolean;        <span class="comment">&#123;是否成功设置&#125;</span></span><br></pre></td></tr></table></figure><p>举例(控制外部程序的透明度, 用计算器举了个例子):</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unit</span> Unit1;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">interface</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">uses</span></span><br><span class="line">  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,</span><br><span class="line">  Dialogs, StdCtrls;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">type</span></span><br><span class="line">  <span class="title">TForm1</span> = <span class="keyword">class</span>(TForm)</span><br><span class="line">    Button1: TButton;</span><br><span class="line">    Button2: TButton;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">Button1Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">Button2Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  Form1: TForm1;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">implementation</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">&#123;$R *.dfm&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">&#123;设定计算器的 Alpha 透明&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">Button1Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  h: HWND;</span><br><span class="line">  FormStyle: Integer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  h := FindWindow(<span class="string">&#x27;CalcFrame&#x27;</span>,<span class="string">&#x27;计算器&#x27;</span>);</span><br><span class="line">  FormStyle := GetWindowLong(h, GWL_EXSTYLE);</span><br><span class="line">  SetWindowLong(h, GWL_EXSTYLE, FormStyle <span class="keyword">or</span> WS_EX_LAYERED);</span><br><span class="line">  SetLayeredWindowAttributes(h, <span class="number">0</span>, <span class="number">128</span>, LWA_ALPHA);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">&#123;设定计算器中的白色透明&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">Button2Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  h: HWND;</span><br><span class="line">  FormStyle: Integer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  h := FindWindow(<span class="string">&#x27;SciCalc&#x27;</span>, <span class="keyword">nil</span>);</span><br><span class="line">  FormStyle := GetWindowLong(h, GWL_EXSTYLE);</span><br><span class="line">  SetWindowLong(h, GWL_EXSTYLE, FormStyle <span class="keyword">or</span> WS_EX_LAYERED);</span><br><span class="line">  SetLayeredWindowAttributes(h, clWhite, <span class="number">255</span>, LWA_COLORKEY);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> 去广告方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>单独调用运行8圈挂机锁工具</title>
      <link href="/page/576111441/"/>
      <url>/page/576111441/</url>
      
        <content type="html"><![CDATA[<h3 id="适用于八圈9-5以下版本，9-5版本请查看本站其他页面"><a href="#适用于八圈9-5以下版本，9-5版本请查看本站其他页面" class="headerlink" title="适用于八圈9.5以下版本，9.5版本请查看本站其他页面"></a>适用于八圈9.5以下版本，9.5版本请查看本站其他页面</h3><p>8圈网管计费系统，自带有挂机锁，一般的网吧均在桌面添加一个挂机锁，但单独的挂机锁或无盘提供的挂机锁，只要重启机器就解锁了，但计费系统的挂机锁则不同，重启机器后，8圈网管计费系统的挂机锁仍然是挂机状态！（如果顾客忘记了8圈挂机锁的密码，可以直接在8圈计费服务端对着挂机机器右键解锁，无需挂机密码，而普通的挂机锁密码忘了就没法，只有重启，重启后就解锁了!这也是8圈计费挂机锁的优势所在!）看看8圈网管计费系统界面<br><img src="/images/8quanlock.png" alt=""><br>，而8圈的挂机锁一般要点开界面才能运行，无法把8圈挂机锁创建快捷方式到桌面，本程序独立于8圈网管计费系统，运行本程序自动运行8圈的挂机锁，这样就可以把无盘系统的挂机锁或单独的挂机全部换成8圈的挂机锁了!</p><p>本程序直接运行实现功能就是 8圈的挂机锁，同时可以添加参数运行<br>加参数 1 运行就是 8圈的结账下机<br>加参数 2 运行就是 8圈的电脑换机<br>加参数 3 运行就是 8圈的呼叫网管<br>加参数 4 运行就是 8圈的在线充值</p><p>如何添加参数，请看下面的gif动画<br><img src="/images/1514389702-1.gif" alt=""></p><p>下载地址:</p><p>———————-<br>支持8圈9.4.4<br>链接: <a href="https://pan.baidu.com/s/159bjiteKJnRwNhlGGK05Lg">https://pan.baidu.com/s/159bjiteKJnRwNhlGGK05Lg</a> 密码: shrs<br>增加参数 5 运行就是 8圈的修改密码功能<br>———————-<br>8圈9.4.4以前版本<br>链接: <a href="https://pan.baidu.com/s/1nvoVTLB">https://pan.baidu.com/s/1nvoVTLB</a> 密码: jxg4</p><p>解压密码 bnwin.com</p><p>查看8圈相关软件 <a href="https://goodhelp.gitee.io/tags/%E5%85%AB%E5%9C%88/">https://goodhelp.gitee.io/tags/八圈/</a></p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 八圈 </tag>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dcef3加载flash闪烁问题简单解决方法</title>
      <link href="/page/1936827288/"/>
      <url>/page/1936827288/</url>
      
        <content type="html"><![CDATA[<p>dcef3添加flash插件后，在播放flash时会有一个dos的黑框一闪而过,显示not sandboxed,影响使用体验!</p><ol><li>一种方法是hook 具体可以看这篇文章 <a href="http://blog.csdn.net/zx2356/article/details/51514403">http://blog.csdn.net/zx2356/article/details/51514403</a><br>这篇文章是使用的C语言，这儿采用同样的方法，在delphi中实现!代码如下HookExt.pas源码<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unit</span> HookExt;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">interface</span></span><br><span class="line"><span class="keyword">uses</span></span><br><span class="line">   uhook,Windows,SysUtils;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">type</span></span><br><span class="line">  TFuncCreateProcessA = <span class="function"><span class="keyword">function</span><span class="params">(lpApplicationName: LPCSTR; lpCommandLine: LPSTR;</span></span></span><br><span class="line"><span class="params"><span class="function">    lpProcessAttributes, lpThreadAttributes: PSecurityAttributes; bInheritHandles: BOOL; dwCreationFlags: DWORD;</span></span></span><br><span class="line"><span class="params"><span class="function">    lpEnvironment: Pointer; lpCurrentDirectory: LPCSTR; <span class="keyword">const</span> lpStartupInfo: TStartupInfoA;</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">var</span> lpProcessInformation: TProcessInformation)</span>:</span> BOOL; <span class="keyword">stdcall</span>;</span><br><span class="line">  TFuncCreateProcessW = <span class="function"><span class="keyword">function</span><span class="params">(lpApplicationName: LPCWSTR; lpCommandLine: LPWSTR;</span></span></span><br><span class="line"><span class="params"><span class="function">    lpProcessAttributes, lpThreadAttributes: PSecurityAttributes; bInheritHandles: BOOL; dwCreationFlags: DWORD;</span></span></span><br><span class="line"><span class="params"><span class="function">    lpEnvironment: Pointer; lpCurrentDirectory: LPCWSTR; <span class="keyword">const</span> lpStartupInfo: TStartupInfoW;</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">var</span> lpProcessInformation: TProcessInformation)</span>:</span> BOOL; <span class="keyword">stdcall</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">implementation</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  hhk: HHook;</span><br><span class="line">  MapFile: THandle;</span><br><span class="line">  startPID: PDWORD;</span><br><span class="line">  Hook: <span class="keyword">array</span> [<span class="number">0</span> .. <span class="number">1</span>] <span class="keyword">of</span> TNtHookClass;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NewCreateProcessA</span><span class="params">(lpApplicationName: LPCSTR; lpCommandLine: LPSTR;</span></span></span><br><span class="line"><span class="params"><span class="function">  lpProcessAttributes, lpThreadAttributes: PSecurityAttributes; bInheritHandles: BOOL; dwCreationFlags: DWORD;</span></span></span><br><span class="line"><span class="params"><span class="function">  lpEnvironment: Pointer; lpCurrentDirectory: LPCSTR; <span class="keyword">const</span> lpStartupInfo: TStartupInfoA;</span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="keyword">var</span> lpProcessInformation: TProcessInformation)</span>:</span> BOOL; <span class="keyword">stdcall</span>;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  strCommandLine: AnsiString;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  strCommandLine := StrPas(lpCommandLine);</span><br><span class="line">  <span class="keyword">if</span> (Pos(<span class="string">&#x27;echo NOT SANDBOXED&#x27;</span>,strCommandLine)&gt;<span class="number">0</span>) <span class="keyword">or</span>  (Pos(<span class="string">&#x27;no-sandbox&#x27;</span>,strCommandLine)&gt;<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">    Result := True</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    Hook[<span class="number">0</span>].UnHook;</span><br><span class="line">    Result := TFuncCreateProcessA(Hook[<span class="number">0</span>].BaseAddr)(lpApplicationName, lpCommandLine, lpProcessAttributes,</span><br><span class="line">      lpThreadAttributes, bInheritHandles, dwCreationFlags, lpEnvironment, lpCurrentDirectory, lpStartupInfo,</span><br><span class="line">      lpProcessInformation);</span><br><span class="line">    Hook[<span class="number">0</span>].Hook;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NewCreateProcessW</span><span class="params">(lpApplicationName: LPCWSTR; lpCommandLine: LPWSTR;</span></span></span><br><span class="line"><span class="params"><span class="function">  lpProcessAttributes, lpThreadAttributes: PSecurityAttributes; bInheritHandles: BOOL; dwCreationFlags: DWORD;</span></span></span><br><span class="line"><span class="params"><span class="function">  lpEnvironment: Pointer; lpCurrentDirectory: LPCWSTR; <span class="keyword">const</span> lpStartupInfo: TStartupInfoW;</span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="keyword">var</span> lpProcessInformation: TProcessInformation)</span>:</span> BOOL; <span class="keyword">stdcall</span>;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  strCommandLine: <span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  strCommandLine := StrPas(lpCommandLine);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> (Pos(<span class="string">&#x27;echo NOT SANDBOXED&#x27;</span>,strCommandLine)&gt;<span class="number">0</span>) <span class="keyword">or</span>  (Pos(<span class="string">&#x27;no-sandbox&#x27;</span>,strCommandLine)&gt;<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">    Result := True</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    Hook[<span class="number">1</span>].UnHook;</span><br><span class="line">    Result := TFuncCreateProcessW(Hook[<span class="number">1</span>].BaseAddr)(lpApplicationName, lpCommandLine, lpProcessAttributes,</span><br><span class="line">      lpThreadAttributes, bInheritHandles, dwCreationFlags, lpEnvironment, lpCurrentDirectory, lpStartupInfo,</span><br><span class="line">      lpProcessInformation);</span><br><span class="line">    Hook[<span class="number">1</span>].Hook;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 安装API Hook</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">InitHook</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Hook[<span class="number">0</span>] := TNtHookClass.Create(<span class="string">&#x27;kernel32.dll&#x27;</span>, <span class="string">&#x27;CreateProcessA&#x27;</span>, @NewCreateProcessA);</span><br><span class="line">  Hook[<span class="number">1</span>] := TNtHookClass.Create(<span class="string">&#x27;kernel32.dll&#x27;</span>, <span class="string">&#x27;CreateProcessW&#x27;</span>, @NewCreateProcessW);</span><br><span class="line">  <span class="comment">// Hook[2] := TNtHookClass.Create( &#x27;user32.dll&#x27;, &#x27;MessageBoxA&#x27;, @NewMessageBoxA );</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 删除API Hook</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">UnInitHook</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i: Integer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> High(Hook) <span class="keyword">do</span></span><br><span class="line">    FreeAndNil(Hook[i]);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 环境处理</span></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">DllEntry</span><span class="params">(dwReason: DWORD)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">case</span> dwReason <span class="keyword">of</span></span><br><span class="line">    DLL_PROCESS_ATTACH:</span><br><span class="line">      InitHook;</span><br><span class="line">    DLL_PROCESS_DETACH:</span><br><span class="line">      UnInitHook;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">initialization</span></span><br><span class="line">   InitHook;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">finalization</span></span><br><span class="line">  UnInitHook;</span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure>其中的uHook.pas源码:<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unit</span> uHook;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">interface</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">uses</span></span><br><span class="line">Windows, Messages, SysUtils;</span><br><span class="line"><span class="keyword">type</span></span><br><span class="line">  TNtJmpCode = <span class="keyword">packed</span> <span class="keyword">record</span></span><br><span class="line">    MovEax: Byte;</span><br><span class="line">    Addr: DWORD;</span><br><span class="line">    JmpCode: Word;</span><br><span class="line">    dwReserved: Byte;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="title">TNtHookClass</span> = <span class="keyword">class</span>(TObject)</span><br><span class="line">  <span class="keyword">private</span></span><br><span class="line">    hProcess: THandle;</span><br><span class="line">    NewAddr: TNtJmpCode;</span><br><span class="line">    OldAddr: <span class="keyword">array</span> [<span class="number">0</span> .. <span class="number">7</span>] <span class="keyword">of</span> Byte;</span><br><span class="line">    ReadOk: Boolean;</span><br><span class="line">  <span class="keyword">public</span></span><br><span class="line">    BaseAddr: Pointer;</span><br><span class="line">    <span class="function"><span class="keyword">constructor</span> <span class="title">Create</span><span class="params">(<span class="keyword">const</span> ADllName, AFuncName: <span class="keyword">string</span>; ANewFunc: Pointer)</span>;</span></span><br><span class="line">    <span class="function"><span class="keyword">destructor</span> <span class="title">Destroy</span>;</span> <span class="keyword">override</span>;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">Hook</span>;</span></span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">UnHook</span>;</span></span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">implementation</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">&#123; TNtHookClass &#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">constructor</span> <span class="title">TNtHookClass</span>.<span class="title">Create</span><span class="params">(<span class="keyword">const</span> ADllName, AFuncName: <span class="keyword">string</span>; ANewFunc: Pointer)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  dllModule: HMODULE;</span><br><span class="line">  lpNumberOfBytesReacd: DWORD; <span class="comment">//NativeUInt;</span></span><br><span class="line">  i:Integer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">// 获取模块句柄</span></span><br><span class="line">  dllModule := GetModuleHandle(PWideChar(ADllName));</span><br><span class="line">  <span class="keyword">if</span> dllModule = <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    dllModule := LoadLibrary(PWideChar(ADllName));</span><br><span class="line">  <span class="comment">// 得到模块入口地址</span></span><br><span class="line">  BaseAddr := Pointer(GetProcAddress(dllModule, PWideChar(AFuncName)));</span><br><span class="line">  <span class="comment">// 获取当前进程句柄</span></span><br><span class="line">  hProcess := GetCurrentProcess;</span><br><span class="line">  <span class="comment">// 指向新地址的指针</span></span><br><span class="line">  NewAddr.MovEax := <span class="number">$B8</span>;</span><br><span class="line">  NewAddr.Addr := DWORD(ANewFunc);</span><br><span class="line">  NewAddr.JmpCode := <span class="number">$E0FF</span>;</span><br><span class="line">  <span class="comment">// 保存原始地址</span></span><br><span class="line"> </span><br><span class="line">  ReadOk:=ReadProcessMemory(hProcess, BaseAddr, Pointer(@OldAddr), <span class="number">8</span>, lpNumberOfBytesReacd);</span><br><span class="line">  <span class="comment">// 开始拦截</span></span><br><span class="line">  Hook;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">destructor</span> <span class="title">TNtHookClass</span>.<span class="title">Destroy</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  UnHook;</span><br><span class="line">  CloseHandle(hProcess);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">inherited</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TNtHookClass</span>.<span class="title">Hook</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  lpNumberOfBytesRead: DWORD;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> ReadOk <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">  <span class="comment">// 写入新的地址</span></span><br><span class="line">  WriteProcessMemory(hProcess, BaseAddr, @NewAddr, <span class="number">8</span>, lpNumberOfBytesRead);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TNtHookClass</span>.<span class="title">UnHook</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  lpNumberOfBytesRead: DWORD;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> ReadOk <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">  <span class="comment">// 恢复地址</span></span><br><span class="line">  WriteProcessMemory(hProcess, BaseAddr, @OldAddr, <span class="number">8</span>, lpNumberOfBytesRead);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure></li><li>这种hook处理不好就容易蓝屏，更简单的方法如下：用二进制编辑软件，比如winhex,我这儿采用UltraEdit,用UltraEdit打开flash插件dll文件 pepflashplayer.dll<img src="/images/20171130235247.png" alt="">搜索comspec修改为somspec,(修改的名字只要和comspec不相同即可)修改cmd.exe为cm1.exe (修改的名字只要和cmd.exe不相同即可)<img src="/images/20171130235450.png" alt="">修改后为<img src="/images/20171130235700.png" alt="">然后保存即可，这时打开flash就不会有dos黑框闪一下了！</li><li>第三种方法，更简单，什么都不用修改，只要在你的程序目录下新建一个文本文件，然后改名为cmd.exe，因为弹出黑框需要使用cmd程序，而系统搜索程序是从进程当前的工作目录开始查找，所以直接这样建一个不能执行的cmd.exe文件可以拦截cmd的调用。这个方法最简单！</li></ol><p>第一种hook方法是修改flash文件，但其实是采用动态方法改了汇编代码，处理不好容易蓝屏。第二种方法修改flash插件文件,原理是：flash执行cmd的逻辑是，先读取环境变量comspec(cmd.exe的全路径)，读取到就执行它，读取不到就不执行cmd.exe.只要把变量和cmd.exe名字修改，就执行不成功，就没有DOS黑框出来!第一种方法是在flash插件要运行cmd.exe的时候再进行拦截，是动态修改的，而第二种是直接让flash找不到变量和cmd.exe程序，flash自己判断不用执行，是静态修改!第三种是懒人方法!但几种方法实现的效果都是阻止cmd.exe的正常执行!同时你就可以这样思考了，为了让flash不出现闪黑框的问题，就变成了如何阻止cmd.exe的执行，比如你在你自己的程序中先修改一下comspec环境变量，也是可以阻止cmd.exe执行的，大家自由发挥!</p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> dcef3使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何自定义修改TChromium的header头信息!</title>
      <link href="/page/3675410287/"/>
      <url>/page/3675410287/</url>
      
        <content type="html"><![CDATA[<ol><li>TChromium自定义post的header信息提交数据<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uses</span></span><br><span class="line">  ceflib;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CreateField</span><span class="params">(<span class="keyword">const</span> AValue: AnsiString)</span>:</span> ICefPostDataElement;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Result := TCefPostDataElementRef.New;</span><br><span class="line">  Result.SetToBytes(Length(AValue), PAnsiChar(AValue));</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">Button1Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  Header: ICefStringMultimap;</span><br><span class="line">  Data: ICefPostData;</span><br><span class="line">  Request: ICefRequest;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Header := TCefStringMultimapOwn.Create;</span><br><span class="line">  Header.Append(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>);</span><br><span class="line"> </span><br><span class="line">  Data := TCefPostDataRef.New;</span><br><span class="line">  Data.AddElement(CreateField(<span class="string">&#x27;Data.id=27&#x27;</span>));</span><br><span class="line">  Data.AddElement(CreateField(<span class="string">&#x27;&amp;Data.title=title&#x27;</span>));</span><br><span class="line">  Data.AddElement(CreateField(<span class="string">&#x27;&amp;Data.body=body&#x27;</span>));</span><br><span class="line"> </span><br><span class="line">  Request := TCefRequestRef.New;</span><br><span class="line">  Request.Flags := WUR_FLAG_NONE;</span><br><span class="line">  Request.Assign(<span class="string">&#x27;http://example.com/&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>, Data, Header);</span><br><span class="line"> </span><br><span class="line">  Chromium1.Browser.MainFrame.LoadRequest(Request);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure></li><li>在另一版本中的代码<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TForm1</span>.<span class="title">Button1Click</span><span class="params">(Sender: TObject)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  Header: ICefStringMultimap;</span><br><span class="line">  Data: ICefPostData;</span><br><span class="line">  Request: ICefRequest;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  Request := TCefRequestRef.New;</span><br><span class="line">  Request.Url := <span class="string">&#x27;http://example.com/&#x27;</span>;</span><br><span class="line">  Request.Method := <span class="string">&#x27;POST&#x27;</span>;</span><br><span class="line">  Request.Flags := WUR_FLAG_NONE;</span><br><span class="line"> </span><br><span class="line">  Header := TCefStringMultimapOwn.Create;</span><br><span class="line">  Header.Append(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>);</span><br><span class="line">  Request.SetHeaderMap(Header);</span><br><span class="line"> </span><br><span class="line">  Data := TCefPostDataRef.New;</span><br><span class="line">  Data.AddElement(CreateField(<span class="string">&#x27;Data.id=27&#x27;</span>));</span><br><span class="line">  Data.AddElement(CreateField(<span class="string">&#x27;&amp;Data.title=title&#x27;</span>));</span><br><span class="line">  Data.AddElement(CreateField(<span class="string">&#x27;&amp;Data.body=body&#x27;</span>));</span><br><span class="line">  Request.PostData := Data;</span><br><span class="line"> </span><br><span class="line">  Chromium1.Browser.MainFrame.LoadRequest(Request);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure></li><li>TChromium自定义post数据<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CreateField</span><span class="params">(<span class="keyword">const</span> AValue: AnsiString)</span>:</span> ICefPostDataElement;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> Result := TCefPostDataElementRef.New;</span><br><span class="line"> Result.SetToBytes(Length(AValue), PAnsiChar(AValue));</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//*****************************************</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">POST</span><span class="params">(total, fee: integer)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line"> Header: ICefStringMultimap;</span><br><span class="line"> Data: ICefPostData;</span><br><span class="line"> Request: ICefRequest;</span><br><span class="line"> Cook: ICefCookieManager;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> Request := TCefRequestRef.New;</span><br><span class="line"> Request.Url := <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"> Request.Method := <span class="string">&#x27;POST&#x27;</span>;</span><br><span class="line"> Request.Flags:=[UR_FLAG_ALLOW_CACHED_CREDENTIALS,UR_FLAG_ALLOW_COOKIES];</span><br><span class="line"> </span><br><span class="line"> Header := TCefStringMultimapOwn.Create;</span><br><span class="line"> Header.Append(<span class="string">&#x27;Host&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> Header.Append(<span class="string">&#x27;User-Agent&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> Header.Append(<span class="string">&#x27;Accept&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> Header.Append(<span class="string">&#x27;Accept-Language&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> Header.Append(<span class="string">&#x27;Accept-Encoding&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> Header.Append(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> Header.Append(<span class="string">&#x27;Referer&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> Header.Append(<span class="string">&#x27;Content-Length&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> Header.Append(<span class="string">&#x27;Origin&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> Header.Append(<span class="string">&#x27;Connection&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> Header.Append(<span class="string">&#x27;Pragma&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> Header.Append(<span class="string">&#x27;Cache-Control&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"> Header.Append(<span class="string">&#x27;Cookie&#x27;</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line"> ...</span><br><span class="line"> Header.Append(<span class="string">&#x27;Cookie&#x27;</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"> Request.SetHeaderMap(Header);</span><br><span class="line"> </span><br><span class="line"> Data := TCefPostDataRef.New;</span><br><span class="line"> Data.AddElement(CreateField(<span class="string">&#x27;sessionid=&#x27;</span>+SessionID));</span><br><span class="line"> Data.AddElement(CreateField(<span class="string">&#x27;¤cy=5&#x27;</span>));</span><br><span class="line"> Data.AddElement(CreateField(<span class="string">&#x27;&amp;subtotal=&#x27;</span>+inttostr(total-fee)));</span><br><span class="line"> Data.AddElement(CreateField(<span class="string">&#x27;&amp;fee=&#x27;</span>+IntToStr(fee)));</span><br><span class="line"> Data.AddElement(CreateField(<span class="string">&#x27;&amp;total=&#x27;</span>+IntToStr(total)));</span><br><span class="line"> </span><br><span class="line"> Request.PostData := Data;</span><br><span class="line"> </span><br><span class="line"> form1.Chromium1.Browser.MainFrame.LoadRequest(Request);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> dcef3使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何让dcef3支持mp3和h.264_mp4解码播放(有源码及dll)!</title>
      <link href="/page/43472519/"/>
      <url>/page/43472519/</url>
      
        <content type="html"><![CDATA[<p>嵌入式Chromium框架(简称CEF) 是一个由Marshall Greenblatt在2008建立的开源项目，它主要目的是开发一个基于Google Chromium的Webbrowser控件。CEF支持一系列的编程语言和操作系统，并且能很容易地整合到新的或已有的工程中去。<br>它的设计思想政治就是易用且兼顾性能。CEF基本的框架包含C/C++程序接口，通过本地库的接口来实现，而这个库则会隔离宿主程序和Chromium&amp;Webkit的操作细节。它在浏览器控件和宿主程序之间提供紧密的整合，它支持用户插件，协议，javascript对象以及javascript扩展，宿主程序可以随意地控件资源下载，导航，下下文内容和打印等，并且可以跟Google Chrome浏览器一起，支持高性能和Html5 技术</p><ol><li>为什么chromium不支持mp3和h.264的mp4音视频解码，因为h.264编码并非开源，是需要付费的!所以就存在谷歌自己的浏览器chrome能支持mp4和tchromium不支持mp4!如何查看你的tchromium是否支持mp4呢？你用tchromium写一个简单浏览器，然后打开<a href="http://html5test.com/">http://html5test.com</a> 支持是这样显示的<img src="/images/dcef3mp4.png" alt="">而不支持是这样显示的<img src="/images/dcef3nomp4.png" alt="">也就是支持h.264 support mp3 support和aac support应该是钩!</li><li>要让cef支持mp3和mp4，需要自己编译，如果你对自己如何编辑有兴趣可以看这篇文件  <a href="https://blog.csdn.net/zhuhongshu/article/details/54193842">在Windows下编译Cef3.2623并加入mp3、mp4支持</a></li><li>对于delphi用户，如何让在delphi中dcef3支持mp3和mp4呢？先到这儿下载dcef3 3.2623.1401  <a href="http://download.csdn.net/download/cyu/9917747">http://download.csdn.net/download/cyu/9917747</a>  (如果没有积分就到这儿下载 链接：<a href="https://pan.baidu.com/s/1dFETI0L">https://pan.baidu.com/s/1dFETI0L</a> 密码：gult  ) 你也可以安装dcefbrowser，封装后的dcef3 这儿下载dcefbrowser3.2623.1401 <a href="https://github.com/bccsafe/DcefBrowser">https://github.com/bccsafe/DcefBrowser</a>  (你也可以到这儿下载dcefbrowser 链接：<a href="https://pan.baidu.com/s/1dFB5Zv7">https://pan.baidu.com/s/1dFB5Zv7</a> 密码：fljs  )不管你是下载的dcef3 3.2623.1401 还是下载的dcefbrowser 3.2623.1401都可以，安装控件后，运行示例程序，这时你的dcef是不支持mp3和mp4的，为什么呢？因为h.264等编码问题，作者打包的dll库文件是默认不支持mp3和mp4的!</li><li>如何让delphi中dcef3支持mp3和mp4呢？你只需要到这儿下载  链接：<a href="https://pan.baidu.com/s/1c1DZ1DY">https://pan.baidu.com/s/1c1DZ1DY</a> 密码：sqir  已经编译好支持mp3和mp4的dll库，覆盖到前面安装的控件中，就OK了，因为这个dll库是对应于dcef3.2623.1401，所以dcef必须也要安装3.26.23.1401。<br>如何让delphi中dcef3支持mp3和mp4呢?因为非开源问题，所以自己编译dcef3的dll库的不多，提供下载的也不多，为了让你的dcef3支持mp3和mp4，我们只要找对应的版本就可以使用了!为什么非要指定dcef3为3.2623.1401，这是因为编译cef的dll需要开启mp3和mp4支持，网上提供其他版本的cef的dll库，并且加入了支持mp3和mp4的没有，如果你会C++，会自己编译cef的库，那什么版本都一样，都可以支持mp3和mp4</li></ol><p>附dcef3另一版本及库文件：dcef3.2454 下载<a href="http://download.csdn.net/download/bigcoolfish/9616325">http://download.csdn.net/download/bigcoolfish/9616325</a>  相对应已添加支持mp3和mp4的 dcef3.2454 dll库文件下载  <a href="https://pan.baidu.com/s/1pKHbeY3">https://pan.baidu.com/s/1pKHbeY3</a> 密码: mxr2</p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> dcef3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何查出桌面的弹出窗口是谁创建的?</title>
      <link href="/page/2806439394/"/>
      <url>/page/2806439394/</url>
      
        <content type="html"><![CDATA[<p>做为PC系统，很大一部份是使用的windows，windows的广告软件很多，不小心就会在桌面上弹出一个窗口，凭肉眼，用任务管理器，很难看出是哪个程序创建的弹出窗口，本文件介绍用句柄精灵ViewWizard找出桌面弹出窗口是什么程序创建的!<br>来看看桌面出现的这个弹出窗口<br><img src="/images/bnwin.com_2017-11-26_08-08-19.png" alt=""><br>在开机运行QQ后不久就在桌面右下角弹出这个窗口，任务栏没有任何程序出现！</p><ol><li>打开 句柄精灵ViewWizard (下载句柄精灵请到 <a href="http://www.bnwin.com/2017/11/03/202.html">http://www.bnwin.com/2017/11/03/202.html</a>)  界面如下<img src="/images/ViewWizard.png" alt=""></li><li>鼠标按住 句柄精灵的 十字图标<br><img src="/images/bnwin.com_2017-11-26_08-12-33.png" alt="">拖到这个弹出的窗口上！</li><li>这时句柄精灵就显示出来这个程序的所有信息<img src="/images/1511684029-338.png" alt="">这个窗口的模块是 C:\Users\Administrator\AppData\Local\Temp\QXREPAIR1.DLL 往下面拉，看看进程是谁<img src="/images/1509.png" alt="">exe执行文件在 C:\Users\Administrator\AppData\Local\Temp\PZYTOOLS\XFIXER.exe 是由谁创建的呢？父进程是 916 [svchost.exe] 找到了是谁创建的，是什么进程，就可以相应的进行控制了!你可以禁止XFIXER.exe的运行，或者禁止svchost.exe在temp目录创建xfixer.exe文件等！你也可以根据句柄精灵提供的窗口信息进行自动关闭!对于这种有独立进程的弹出窗口你可能通过任务管理器也能查找到，虽然没有使用句柄精灵方便，但通过其他程序加载dll库文件弹出的窗口，通过任务管理器就无能为力了!我们来看看英雄联盟选择英雄时左边的窗口是谁创建的<img src="/images/20171126163443.png" alt="">打开句柄精灵，拖动十字图标到这个窗口上，看看句柄精灵中的信息<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">属性 数据</span><br><span class="line">基本&gt;</span><br><span class="line">句柄 67140 [0x00010644]</span><br><span class="line">文本</span><br><span class="line">长度 0</span><br><span class="line">类名 TWINCONTROL</span><br><span class="line">基类 Generic</span><br><span class="line">描述 通用窗口</span><br><span class="line">ID *</span><br><span class="line">数据 0x130B9478</span><br><span class="line">字节 *</span><br><span class="line">实例 *</span><br><span class="line">模块 I:\游戏辅助\TGP腾讯游戏平台网吧版\apps\Pallas\pallas.exe</span><br><span class="line">父窗&gt;</span><br><span class="line">句柄 [65552]</span><br><span class="line">文本 [Desktop]</span><br><span class="line">类名 [#32769]</span><br><span class="line">基类 [Generic]</span><br><span class="line">显示&gt;</span><br><span class="line">状态 常规&gt;</span><br><span class="line">可视 yes</span><br><span class="line">有效 yes</span><br><span class="line">置顶 yes</span><br><span class="line">分层 no</span><br><span class="line">透明 no</span><br><span class="line">重叠 no</span><br><span class="line">不活动 no</span><br><span class="line">Unicode yes</span><br><span class="line">密码框 no</span><br><span class="line">掩码</span><br><span class="line">不透明度 *</span><br><span class="line">Z序 3</span><br><span class="line">大小&gt;</span><br><span class="line">窗口矩形 (1508,415)-(1810,798) 302×383</span><br><span class="line">还原矩形 (1508,415)-(1810,798) 302×383</span><br><span class="line">客户矩形(屏幕) (1508,415)-(1810,798) 302×383</span><br><span class="line">客户矩形(窗口) (0,0)-(302,383) 302×383</span><br><span class="line">最大化坐标 (0,0) 1920×1050</span><br><span class="line">最小最大尺寸 0x0 1930×1057</span><br><span class="line">当前窗口坐标</span><br><span class="line">当前客户坐标</span><br><span class="line">关系&gt;</span><br><span class="line">父窗口 65552 [0x00010010] #32769 “Desktop”</span><br><span class="line">根窗口 *</span><br><span class="line">所有者窗口 *</span><br><span class="line">首个子窗口 *</span><br><span class="line">首兄弟窗口 394540 [0x0006052C] MSCTFIME UI “MSCTFIME UI”</span><br><span class="line">上一个窗口 918714 [0x000E04BA] IME “Default IME”</span><br><span class="line">下一个窗口 198612 [0x000307D4] Auto-Suggest Dropdown “”</span><br><span class="line">尾兄弟窗口 65812 [0x00010114] Progman “Program Manager”</span><br><span class="line">样式&gt;</span><br><span class="line">标准样式 0x96020000 (2516713472)</span><br><span class="line">描述 WS_POPUP|WS_VISIBLE|WS_CLIPSIBLINGS|WS_CLIPCHILDREN|WS_GROUP</span><br><span class="line">控件</span><br><span class="line">扩展样式 0x00000088 (136)</span><br><span class="line">描述 WS_EX_TOPMOST|WS_EX_TOOLWINDOW</span><br><span class="line">控件</span><br><span class="line">类&gt;</span><br><span class="line">类名 TWINCONTROL</span><br><span class="line">类原子 0xC2CC (49868)</span><br><span class="line">类字节 *</span><br><span class="line">窗口字节 *</span><br><span class="line">类样式 0x00000008 (8)</span><br><span class="line">描述 CS_DBLCLKS</span><br><span class="line">图标 *</span><br><span class="line">小图标 *</span><br><span class="line">光标 0x00010003 IDC_ARROW</span><br><span class="line">画刷 *</span><br><span class="line">菜单 *</span><br><span class="line">过程 0x55C1AD90 (1438756240) [Unicode]</span><br><span class="line">模块 0x00400000 (4194304)</span><br><span class="line">模块路径 I:\游戏辅助\TGP腾讯游戏平台网吧版\apps\Pallas\pallas.exe</span><br><span class="line">菜单&gt;</span><br><span class="line">句柄 *</span><br><span class="line">子菜单</span><br><span class="line">所有子菜单</span><br><span class="line">菜单项</span><br><span class="line">菜单矩形</span><br><span class="line">字体&gt;</span><br><span class="line">句柄 *</span><br><span class="line">名称</span><br><span class="line">大小</span><br><span class="line">粗体</span><br><span class="line">斜体</span><br><span class="line">删除线</span><br><span class="line">下划线</span><br><span class="line">字符集</span><br><span class="line">进程&gt;</span><br><span class="line">进程ID 7060 [0x00001B94]</span><br><span class="line">线程ID 2560 [0x00000A00]</span><br><span class="line">进程启动 2017-11-26 16:32:06</span><br><span class="line">线程启动 2017-11-26 16:32:06</span><br><span class="line">内存使用 32,248 KB</span><br><span class="line">内存峰值 91,252 KB</span><br><span class="line">虚拟内存 82,008 KB</span><br><span class="line">线程计数 17</span><br><span class="line">句柄计数 324</span><br><span class="line">GUI对象 GDI:52, User:40</span><br><span class="line">映像名称 pallas.exe</span><br><span class="line">EXE路径 I:\游戏辅助\TGP腾讯游戏平台网吧版\apps\Pallas\pallas.exe</span><br><span class="line">物理路径 I:\游戏辅助\TGP腾讯游戏平台网吧版\apps\Pallas\pallas.exe</span><br><span class="line">命令行</span><br><span class="line">父进程 6444 [tgp_daemon.exe]</span><br><span class="line">文件&gt;</span><br><span class="line">名称 pallas.exe</span><br><span class="line">大小 7390408</span><br><span class="line">版本 4.1.1.123</span><br><span class="line">版权 Copyright (C) 2015 Tencent.All Rights Reserved</span><br><span class="line">产品 WeGame</span><br><span class="line">公司 腾讯计算机系统有限公司</span><br><span class="line">描述 Tencent.WeGame.Pallas</span><br><span class="line">创建时间 2015-12-31 21:14:44</span><br><span class="line">统计&gt;</span><br><span class="line">子窗口</span><br><span class="line">所有子窗口</span><br><span class="line">无效子窗口</span><br><span class="line">隐藏子窗口</span><br><span class="line">线程窗口 12</span><br><span class="line">进程窗口 12</span><br><span class="line">附加&gt;</span><br><span class="line">基本类型 Generic (通用)</span><br></pre></td></tr></table></figure>正确使用句柄精灵，可以找出广告程序等弹出窗口的幕后黑手！</li></ol>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 去广告方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何让手机控制电脑之TeamViewer</title>
      <link href="/page/3502241198/"/>
      <url>/page/3502241198/</url>
      
        <content type="html"><![CDATA[<p>TeamViewer是一个能在任何防火墙和NAT代理的后台用于远程控制，桌面共享和文件传输的简单且快速的解决方案。为了连接到另一台计算机，只需要在两台计算机上同时运行 TeamViewer 即可，而不需要进行安装（也可以选择安装，安装后可以设置开机运行）。该软件第一次启动在两台计算机上自动生成伙伴 ID。只需要输入你的伙伴的ID到TeamViewer，然后就会立即建立起连接。<br>TeamViewer官方网站:<a href="https://www.teamviewer.com/zhCN/">https://www.teamviewer.com/zhCN/</a></p><p>如何使用手机控制电脑呢？</p><ol><li>在TeamViewer官方网站下载相应的App,比如Android版TeamViewer下载地址为<a href="https://play.google.com/store/apps/details?id=com.teamviewer.teamviewer.market.mobile,%E4%B8%8D%E8%BF%87%E4%BD%A0%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E5%9C%A8%E4%BD%A0%E7%9A%84%E6%89%8B%E6%9C%BA%E5%BA%94%E7%94%A8%E5%B8%82%E5%9C%BA%E4%B8%AD%E6%90%9C%E7%B4%A2TeamViewer%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85TeamViewer%E7%9A%84app%E5%AE%89%E8%A3%85!Android%E6%89%8B%E6%9C%BA%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F%E8%BF%90%E8%A1%8C%E7%9A%84%E7%95%8C%E9%9D%A2%E5%A6%82%E4%B8%8B">https://play.google.com/store/apps/details?id=com.teamviewer.teamviewer.market.mobile,不过你可以直接在你的手机应用市场中搜索TeamViewer，也可以下载安装TeamViewer的app安装!Android手机安装成功运行的界面如下</a><img src="/images/teamviewer1.png" alt=""></li><li>在电脑中运行TeamViewer，界面如下:<img src="/images/teamviewer4.png" alt="">只要在手机的伙伴ＩＤ处输入电脑端显示的ＩＤ，点击远程控制，输入电脑端的密码，就可以在手机中控制电脑了，连接成功后的界面如下<img src="/images/teamviewer3-576x1024.png" alt="">点继续后就可以操控电脑了<img src="/images/teamviewer2.png" alt=""></li><li>电脑端运行TeamViewer，每次运行，密码都不一样，为了便于控制，我们要设置一个固定的密码，实现无人值守！点击电脑端显示的密码，会弹出一个菜单，选择　设置预定义密码，界面如下<img src="/images/teamviewer5.png" alt=""></li><li>这样做了以后，只要在电脑中TeamViewer的其他菜单的选项点开，钩上随windows一同启动TeamViewer，就可以在手机上输入电脑端teamviewer的id和预设的固定密码，从手机控制电脑了!但这时你是不是觉得还不够方便？为了更自动化一些，我们需要注册一个TeamViewer的控制帐号!在手机端是不是有一个计算机选项卡，点击后有一个注册按钮，你只要注册了帐号，你第一次登录，teamviewer会发一封添加允许设备登录的邮件，也就是只有允许的设备才能使用，这样安全性就高了!允许的设备登录帐号后，就可以添加电脑端的ID和密码，以后在手机中，只要登录帐号，直接点击你预添加的计算机就可以控制了，不需要你记和输ＩＤ和密码!</li><li>TeamViewer最新版需要授权许可才能使用</li></ol><p>Teamviewer连接的原理主要分为三部分，分别是①如何根据ID找到要连接的电脑，②找到电脑之后如何内网间互联，③如何能操作对方的电脑。<br>一、先说TeamViewer如何根据ID连接到对方：</p><p>1、运行TeamViewer 之后，电脑会先连接到TV的服务器，然后服务器对这台电脑分配一个唯一的ID。这个ID主要是以网卡的MAC地址为依据生成的，所以如果想给电脑换一个Teamviewer ID，只要修改一下MAC地址就行了。</p><p>2、当一个TeamViewer 连接另一个的时候，会先连接到服务器，通过ID与电脑的对应关系找到这台要连接的电脑。</p><p>二、如何建立内网对内网的连接：</p><p>如果连接的其中任一方是有公网IP的网络环境，双方的连接就启用P2P连接。双方是内网的情况， TeamViewer数据就会通过TeamViewer 自己的服务器进行中转。这也是TeamViewer 内网互通会在网络高峰期比较慢的原因。</p><p>三、如何操作被控机的鼠标与键盘。</p><p>原理与远程控制木马是一样的。这里远端指被控制的电脑。连接建立之后，远端的电脑图像压缩后发回本地，这样本地就能看到画面，本地进行键盘鼠标的等操作的动作封装成数据包发送给远端解开后还原成动作进行远程的模拟操作。远端反馈的画面通过压缩后继续发回给控制端。就远控的图像传输来说，早年远控都是直接进行JPEG截图后传输，所以速度不太理想。之后各种大牛延伸出很多很腻害的基于截图的方式的屏幕传输的算法，传输效率进一步提高，通常是先加载一个虚拟屏幕驱动，然后对屏幕做逐行扫描，然后计算变化的部分，之后只传输变化的部分。TeamViewer(版本9.0)也是支持虚拟屏幕驱动的，但是需要到设置中手动进行安装。</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 精品软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何使unigui支持多文件上传-MultiFileUpload</title>
      <link href="/page/2263726181/"/>
      <url>/page/2263726181/</url>
      
        <content type="html"><![CDATA[<p>unigui能上传文件，单只支持单文件上传，在unigui中如何实现多文件上传呢？MultiFileUpload提供了解决方案!此例子使用MultiFileUpload解决了unigui多文件上传的问题<br>看看运行效果<br><img src="/images/MultiFileUpload.png" alt=""><br>其中部份代码</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDialogFileUpload</span>.<span class="title">UniFormClose</span><span class="params">(Sender: TObject;</span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="keyword">var</span> Action: TCloseAction)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  I: Integer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">if</span> FIsUploading <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    <span class="comment">//正在上传，不允许退出</span></span><br><span class="line">    Action := caNone;</span><br><span class="line">    ModalResult := mrNone;</span><br><span class="line">    <span class="keyword">Exit</span>;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">if</span> ModalResult=mrOK <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> FListFiles.Count=<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      MessageDlg(<span class="string">&#x27;请选择文件并上传！&#x27;</span>,mtInformation,[mbOK],<span class="keyword">nil</span>);</span><br><span class="line">      Action := caNone;</span><br><span class="line">      ModalResult := mrNone;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">Exit</span>;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> I := <span class="number">0</span> <span class="keyword">to</span> FListFiles.Count - <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      <span class="keyword">if</span> Integer(FListFiles.Objects[I])=<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        MessageDlg(<span class="string">&#x27;请上传选择的文件！&#x27;</span>,mtInformation,[mbOK],<span class="keyword">nil</span>);</span><br><span class="line">        Action := caNone;</span><br><span class="line">        ModalResult := mrNone;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">Exit</span>;</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">    <span class="keyword">if</span> Assigned(FOnGetUploadFiles) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      FOnGetUploadFiles(Self,FListFiles,FListFileSizes);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  <span class="comment">//关闭时清除所有文件</span></span><br><span class="line">  FListFiles.Clear;</span><br><span class="line">  FListFileSizes.Clear;</span><br><span class="line">  UniSession.AddJS(<span class="string">&#x27;panelUpload.onRemove();&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>源码下载地址：<br>链接: <a href="https://pan.baidu.com/s/1JYlHKLu2WZHXIc3MdNez7Q">https://pan.baidu.com/s/1JYlHKLu2WZHXIc3MdNez7Q</a> 提取码: srz4 复制这段内容后打开百度网盘手机App，操作更方便哦</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi源码 </tag>
            
            <tag> unigui使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用plupload和fineuploader组件强化unigui文件上传功能!</title>
      <link href="/page/3576835458/"/>
      <url>/page/3576835458/</url>
      
        <content type="html"><![CDATA[<p>unigui有上传组件，但功能不强，要想实现强大的功能，那么就得使用其他组件，以下介绍unigui中使用plupload和fineuploader上传文件</p><ol><li>unigui使用前端上传组件plupload上传文件,改进文件上传，显示文件上传进度<br>先看看效果图片<img src="/images/plupload.png" alt="">Plupload有以下功能和特点：1、拥有多种上传方式：HTML5、flash、silverlight以及传统的<input type=”file” />。Plupload会自动侦测当前的环境，选择最合适的上传方式，并且会优先使用HTML5的方式。所以你完全不用去操心当前的浏览器支持哪些上传方式，Plupload会自动为你选择最合适的方式。2、支持以拖拽的方式来选取要上传的文件3、支持在前端压缩图片，即在图片文件还未上传之前就对它进行压缩4、可以直接读取原生的文件数据，这样的好处就是例如可以在图片文件还未上传之前就能把它显示在页面上预览5、支持把大文件切割成小片进行上传，因为有些浏览器对很大的文件比如几G的一些文件无法上传。</li><li>unigui使用前端上传组件fineuploader上传文件，增强文件上传<br>先看看效果图片<img src="/images/fineuploader.png" alt="">Fine Uploader 采用ajax方式实现对文件上传.同时在浏览器中直接支持文件拖拽[对浏览器版本有要求类似IE版本必须是9或是更高的IE10].在不同浏览器中提供统一用户体验.该组件基本覆盖目前所有主流浏览器.同时没有任何第三方组件依赖.相当Clear.在服务器端已经覆盖支持了ASP.NET/ColdFusion/Java/Node.js/Perl/PHP/Python. 对上传细节类似限制文件大小，文件类型，文件上传的数量等通过统一接口以暴露选项方式操作.可以到这儿Github 上Fine Uploader 查看具体内容</li><li>delphi使用unigui源码下载地址<br>链接: <a href="https://pan.baidu.com/s/10zOTt4eKqsDHnwHCDPp5ng">https://pan.baidu.com/s/10zOTt4eKqsDHnwHCDPp5ng</a> 提取码: nenp 复制这段内容后打开百度网盘手机App，操作更方便哦</li></ol>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi源码 </tag>
            
            <tag> unigui使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>手工杀毒恶意代码检测工具PCHunter</title>
      <link href="/page/1410737214/"/>
      <url>/page/1410737214/</url>
      
        <content type="html"><![CDATA[<p>PC Hunter是一个Windows系统信息查看软件，同时也是一个手工杀毒辅助软件。<br>支持xp~win10的所有32位操作系统，还支持64位的Win7、Win8、Win8.1和Win10系统。<br>看看界面<br><img src="/images/PC-Hunter.png" alt=""><br>主要功能:<br>1.进程、线程、进程模块、进程窗口、进程内存信息查看，杀进程、杀线程、卸载模块等功能</p><p>2.内核驱动模块查看，支持内核驱动模块的内存拷贝</p><p>3.SSDT、Shadow SSDT、FSD、KBD、TCPIP、Nsiproxy、Tdx、Classpnp、Atapi、Acpi、SCSI、IDT、GDT信息查看，并能检测和恢复ssdt hook和inline hook</p><p>4.CreateProcess、CreateThread、LoadImage、CmpCallback、BugCheckCallback、Shutdown、Lego等近20多种Notify Routine信息查看，并支持对这些Notify Routine的删除</p><p>5.端口信息查看，目前不支持2000系统</p><p>6.查看消息钩子</p><p>7.内核模块的iat、eat、inline hook、patches检测和恢复</p><p>8.磁盘、卷、键盘、网络层等过滤驱动检测，并支持删除</p><p>9.注册表编辑</p><p>10.进程iat、eat、inline hook、patches检测和恢复</p><p>11.文件系统查看，支持基本的文件操作</p><p>12.查看(编辑)IE插件、SPI、启动项、服务、Hosts文件、映像劫持、文件关联、系统防火墙规则、IME</p><p>13.ObjectType Hook检测和恢复</p><p>14.DPC定时器检测和删除</p><p>15.MBR Rootkit检测和修复</p><p>16.内核对象劫持检测</p><p>17.WorkerThread枚举</p><p>18.Ndis中一些回调信息枚举</p><p>19.硬件调试寄存器、调试相关API检测</p><p>20.枚举SFilter/Flgmgr的回调</p><p>21.系统用户名检测</p><p>官方网站：<a href="http://www.xuetr.com/">http://www.xuetr.com</a></p><p>免费版下载地址：<a href="http://www.xuetr.com/download/PCHunter_free.zip">http://www.xuetr.com/download/PCHunter_free.zip</a></p><p>Linxer大牛在XueTr源码基础上重新开发了PC Hunter，支持Win8.1和X64，本次更新新增了十几处检测。分为免费版和收费版。</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 去广告方法 </tag>
            
            <tag> 精品软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TChromium获取网页源代码delphi代码</title>
      <link href="/page/2301859295/"/>
      <url>/page/2301859295/</url>
      
        <content type="html"><![CDATA[<p>使用Webbrowser取得网页源代码网上已经有很多例子了，而TChromium如何获得网页源代码呢？</p><ol><li>第一种方法<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TCustomLoad</span>.<span class="title">OnLoadEnd</span><span class="params">(<span class="keyword">const</span> browser: ICefBrowser;</span></span></span><br><span class="line"><span class="params"><span class="function"><span class="keyword">const</span> frame: ICefFrame; httpStatusCode: Integer)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">data:tstringlist;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">data:=tstringlist.create;</span><br><span class="line"><span class="keyword">if</span> frame.IsMain <span class="keyword">then</span></span><br><span class="line">data.text:=frame.Source; <span class="comment">// HTML Source</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">data.free;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure></li><li>在dcef3中<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">StringVisitor</span><span class="params">(<span class="keyword">const</span> str: ustring)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="comment">//str is the SourceHtml</span></span><br><span class="line">showmessage(str);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetSourceHTML</span>:</span> <span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">CefStringVisitor:ICefStringVisitor;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">CefStringVisitor := TCefFastStringVisitor.Create(StringVisitor);</span><br><span class="line">Chromium1.Browser.MainFrame.GetSource(CefStringVisitor);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure></li><li>第三种<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Chromium1.Browser.MainFrame.ViewSource;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi技巧 </tag>
            
            <tag> TChromium技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>unigui管理系统源码</title>
      <link href="/page/2767400155/"/>
      <url>/page/2767400155/</url>
      
        <content type="html"><![CDATA[<p>uniGui是一款delphi开发网页应用的框架，完全基于ExtJs,全面支持ajax技术，是delphi开发bs程序的有力控件!官方网站为 <a href="http://www.unigui.com/">http://www.unigui.com</a> unigui的demo运行方法网址介绍地址<a href="http://www.unigui.com/resources/running-demos">http://www.unigui.com/resources/running-demos</a></p><p>uniGUI为Delphi开发者在IDE上的Web应用程序设计创建、调试提供一套独特的视觉元素。每个组件的设计是为了提供在Delphi VCL可视化组件的对应相同的功能。这提供了一个非常舒适的开发环境，非常接近原生VCL应用开发的一个简单的学习过程。uniGUI Web应用程序可以部署到服务器上使用一个可用的部署选项，如Windows服务，独立服务器或ISAPI模块。</p><p>本源码是在uniguiv0.95的基础上开发的，如果你用最新的unigui版本，可能需要一些修改才能运行!</p><p>以下是引导说明界面<br><img src="/images/step_00.gif" alt=""><br>其中的部份代码</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TMainForm</span>.<span class="title">InsertFrame</span><span class="params">(acaption:<span class="keyword">string</span>)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line"> tabs:TUniTabSheet;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">if</span> (MM1.LoginUserid&lt;&gt;<span class="string">&#x27;&#x27;</span>) <span class="keyword">then</span> <span class="comment">//判断登录</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">if</span> acaption=<span class="string">&#x27;添加帐号&#x27;</span> <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">try</span></span><br><span class="line"> UniFrame3:=TUniFrame3.Create(Self);</span><br><span class="line"> UniFrame3.Align:=alClient;</span><br><span class="line"> <span class="keyword">except</span></span><br><span class="line"> ShowActiveTab(<span class="string">&#x27;添加帐号&#x27;</span>);</span><br><span class="line"> <span class="keyword">exit</span>;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> tabs:=TUniTabSheet.Create(Self);</span><br><span class="line"> tabs.PageControl:=pg1;</span><br><span class="line"> tabs.Caption:=<span class="string">&#x27;添加帐号&#x27;</span>;</span><br><span class="line"> tabs.Closable:=True;</span><br><span class="line"> pg1.ActivePage:=tabs;</span><br><span class="line"> UniFrame3.Parent:=tabs;</span><br><span class="line"> UniFrame3.ParentWindow:=MainForm.Handle;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> <span class="keyword">if</span> acaption=<span class="string">&#x27;系统设置&#x27;</span> <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">try</span></span><br><span class="line"> UniFrame4:=TUniFrame4.Create(Self);</span><br><span class="line"> UniFrame4.Align:=alClient;</span><br><span class="line"> <span class="keyword">except</span></span><br><span class="line"> ShowActiveTab(<span class="string">&#x27;系统设置&#x27;</span>);</span><br><span class="line"> <span class="keyword">exit</span>;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> tabs:=TUniTabSheet.Create(Self);</span><br><span class="line"> tabs.PageControl:=pg1;</span><br><span class="line"> tabs.Caption:=<span class="string">&#x27;系统设置&#x27;</span>;</span><br><span class="line"> tabs.Closable:=True;</span><br><span class="line"> pg1.ActivePage:=tabs;</span><br><span class="line"> UniFrame4.Parent:=tabs;</span><br><span class="line"> UniFrame4.ParentWindow:=MainForm.Handle;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>提供的源代码可以用于学习unigui！此unigui源码动态生成tab,鼠标长时间不动自动锁界面等值得借鉴，你只需要修改一下代码就可以做为自己web系统的框架，添加功能继续开发!下载后运行bin目录中的安装，就可以点 打开 看到界面了，可以自己注册帐号，默认有一个帐号admin admin</p><p>下载地址：<br>链接: <a href="https://pan.baidu.com/s/1PMRYEB96MYH6VYrYnHrEaQ">https://pan.baidu.com/s/1PMRYEB96MYH6VYrYnHrEaQ</a> 提取码: cyfe 复制这段内容后打开百度网盘手机App，操作更方便哦</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi源码 </tag>
            
            <tag> unigui使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>富有哲理的座右铭100条</title>
      <link href="/page/3685387284/"/>
      <url>/page/3685387284/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br></pre></td><td class="code"><pre><span class="line">1、</span><br><span class="line">人之所以有一张嘴，</span><br><span class="line">而有两只耳朵，</span><br><span class="line">原因是听的要比说的多一倍。</span><br><span class="line">2、</span><br><span class="line">哲人无忧，智者常乐。</span><br><span class="line">并不是因为所爱的一切他都拥有了，</span><br><span class="line">而是所拥有的一切他都爱。</span><br><span class="line">3、</span><br><span class="line">泪水和汗水的化学成分相似，</span><br><span class="line">但前者只能为你换来同情，</span><br><span class="line">后者却可以为你赢的成功。</span><br><span class="line">4、</span><br><span class="line">越是成熟的稻穗，</span><br><span class="line">越懂得弯腰。</span><br><span class="line">5、</span><br><span class="line">江海之所以能成为百谷之王，</span><br><span class="line">是因为懂得身处低下。</span><br><span class="line">6、</span><br><span class="line">每个人都有潜在的能量，</span><br><span class="line">只是很容易被习惯所掩盖，</span><br><span class="line">被时间所迷离，</span><br><span class="line">被惰性所消磨。</span><br><span class="line"> </span><br><span class="line">7、生气是拿别人做错的事来惩罚自己。</span><br><span class="line"> </span><br><span class="line">8、</span><br><span class="line">后悔是一种耗费精神的情绪。</span><br><span class="line">后悔是比损失更大的损失，</span><br><span class="line">比错误更大的错误，</span><br><span class="line">所以请不要后悔。</span><br><span class="line"> </span><br><span class="line">9、</span><br><span class="line">人生有几件绝对不能失去的东西：</span><br><span class="line">自制的力量，</span><br><span class="line">冷静的头脑，</span><br><span class="line">希望和信心。</span><br><span class="line"> </span><br><span class="line">10、</span><br><span class="line">不是境况造就人，</span><br><span class="line">而是人造就境况。</span><br><span class="line"> </span><br><span class="line">11、</span><br><span class="line">自己要先看得起自己，</span><br><span class="line">别人才会看得起你。</span><br><span class="line"> </span><br><span class="line">12、</span><br><span class="line">要铭记在心：</span><br><span class="line">每天都是一年中最美好的日子。</span><br><span class="line"> </span><br><span class="line">13、</span><br><span class="line">爱的力量大到可以使人忘记一切，</span><br><span class="line">却又小到连一粒嫉妒的沙石也不能容纳。</span><br><span class="line"> </span><br><span class="line">14、</span><br><span class="line">人是可以快乐地生活的，</span><br><span class="line">只是我们自己选择了复杂，</span><br><span class="line">选择了叹息！</span><br><span class="line"> </span><br><span class="line">15、</span><br><span class="line">过去的一页，</span><br><span class="line">能不翻就不翻，</span><br><span class="line">翻落了灰尘会迷了双眼。</span><br><span class="line"> </span><br><span class="line">16、</span><br><span class="line">人若软弱就是自己最大的敌人；</span><br><span class="line">人若勇敢就是自己最好的朋友。</span><br><span class="line"> </span><br><span class="line">17、</span><br><span class="line">要纠正别人之前，</span><br><span class="line">先反省自己有没有犯错。　</span><br><span class="line"> </span><br><span class="line">18、</span><br><span class="line">许多人缺少的不是美，</span><br><span class="line">而是自信的气质，</span><br><span class="line">记住：</span><br><span class="line">自信本身就是一种美。</span><br><span class="line">有了积极的心态就容易成功。　</span><br><span class="line"> </span><br><span class="line">19、</span><br><span class="line">人总是珍惜未得到的，</span><br><span class="line">而遗忘了所拥有的。　　</span><br><span class="line"> </span><br><span class="line">20、</span><br><span class="line">用最少的悔恨面对过去。</span><br><span class="line">用最少的浪费面对现在。</span><br><span class="line">用最多的梦面对未来。　</span><br><span class="line"> </span><br><span class="line">21、</span><br><span class="line">大多数人想要改造这个世界，</span><br><span class="line">但却罕有人想改造自己。</span><br><span class="line"> </span><br><span class="line">22、</span><br><span class="line">得意时应善待他人，</span><br><span class="line">因为你失意时会需要他们。　</span><br><span class="line"> </span><br><span class="line">23、</span><br><span class="line">一千个人就有一千种生存方式和生活道路，</span><br><span class="line">要想改变一些事情，</span><br><span class="line">首先得把自己给找回来。</span><br><span class="line"> </span><br><span class="line">24、</span><br><span class="line">任何的限制，</span><br><span class="line">都是从自己的内心开始的。</span><br><span class="line">忘掉失败，</span><br><span class="line">不过要牢记失败中的教训。</span><br><span class="line"> </span><br><span class="line">25、</span><br><span class="line">假如我不能，我一定要；</span><br><span class="line">假如我一定要，我就一定能。</span><br><span class="line"> </span><br><span class="line">26、</span><br><span class="line">一个能从别人的观念来看事情，</span><br><span class="line">能了解别人心灵活动的人，</span><br><span class="line">永远不必为自己的前途担心。</span><br><span class="line"> </span><br><span class="line">27、</span><br><span class="line">人生不过三万天，</span><br><span class="line">成功失败均坦然，</span><br><span class="line">是非恩怨莫在意，</span><br><span class="line">健康快乐最值钱。</span><br><span class="line"> </span><br><span class="line">28、</span><br><span class="line">世界上有两种人：</span><br><span class="line">索取者和给予者。</span><br><span class="line">前者也许能吃得更好，</span><br><span class="line">但后者绝对能睡得更香。</span><br><span class="line"> </span><br><span class="line">29、</span><br><span class="line">环境不会改变，</span><br><span class="line">解决之道在于改变自己。</span><br><span class="line"> </span><br><span class="line">30、</span><br><span class="line">要让事情改变，先改变我自己；</span><br><span class="line">要让事情变得更好，先让自己变得更好。</span><br><span class="line"> </span><br><span class="line">31、</span><br><span class="line">不要对挫折叹气，</span><br><span class="line">姑且把这一切看成是在你成大事之前，</span><br><span class="line">必须经受的准备工作。</span><br><span class="line"> </span><br><span class="line">32、</span><br><span class="line">你出生的时候，你哭着，周围的人笑着；</span><br><span class="line">在生命的尽头，你笑着，而周围的人在哭着。</span><br><span class="line"> </span><br><span class="line">33、</span><br><span class="line">伟人之所以伟大，</span><br><span class="line">是因为他与别人共处逆境时，</span><br><span class="line">别人失去了信心，</span><br><span class="line">他却下决心实现自己的目标。</span><br><span class="line"> </span><br><span class="line">34、</span><br><span class="line">如果早上醒来，</span><br><span class="line">你发现自己还能自由呼吸，</span><br><span class="line">你就比在这一周离开人世的100万人更有福气。</span><br><span class="line"> </span><br><span class="line">35、</span><br><span class="line">什么时候也不要放弃希望，</span><br><span class="line">越是险恶的环境越要燃起希望的意志。</span><br><span class="line"> </span><br><span class="line">36、</span><br><span class="line">积极的人在每一次忧患中都看到一个机会，</span><br><span class="line">而消极的人则在每个机会都看到某种忧患。</span><br><span class="line"> </span><br><span class="line">37、</span><br><span class="line">许多人企求着生活的完美结局，</span><br><span class="line">殊不知美根本不在结局，</span><br><span class="line">而在于追求的过程。</span><br><span class="line"> </span><br><span class="line">38、</span><br><span class="line">也许有些人很可恶，有些人很卑鄙。</span><br><span class="line">而当我设身为他想象的时候，我才知道：他比我还可怜。</span><br><span class="line">所以请原谅所有你见过的人，好人或者坏人。</span><br><span class="line"> </span><br><span class="line">39、</span><br><span class="line">一句无心的话也许会点燃纠纷，</span><br><span class="line">一句残酷的话也许会毁掉生命，</span><br><span class="line">一句及时的话也许会消释紧张，</span><br><span class="line">一句知心的话也许会愈合伤口、挽救他人。　</span><br><span class="line"> </span><br><span class="line">40、</span><br><span class="line">生命就是一个逐渐支出和利用时间的过程。</span><br><span class="line">一旦丧失了时间，生命也就走到了尽头。</span><br><span class="line"> </span><br><span class="line">41、</span><br><span class="line">世上并没有用来鼓励工作努力的赏赐，</span><br><span class="line">所有的赏赐都只是被用来奖励工作成果的。</span><br><span class="line"> </span><br><span class="line">42、</span><br><span class="line">生命的完整，在于宽恕、容忍、等待与爱，</span><br><span class="line">如果没有这一切，你拥有了所有，也是虚无。</span><br><span class="line"> </span><br><span class="line">43、</span><br><span class="line">当我们眺望远方的时候，</span><br><span class="line">近处的风景便看不清了。</span><br><span class="line"> </span><br><span class="line">44、</span><br><span class="line">如果你希望成功，</span><br><span class="line">以恒心为良友，</span><br><span class="line">以经验为参谋，</span><br><span class="line">以小心为兄弟，</span><br><span class="line">以希望为哨兵。</span><br><span class="line"> </span><br><span class="line">45、</span><br><span class="line">思考是一件最辛苦的工作，</span><br><span class="line">这可能是为什么很少人愿意思考的原因。</span><br><span class="line"> </span><br><span class="line">46、</span><br><span class="line">成功呈概率分布，</span><br><span class="line">关键是你能不能坚持到成功开始呈现的那一刻。</span><br><span class="line"> </span><br><span class="line">47、</span><br><span class="line">自己打败自己是最可悲的失败，</span><br><span class="line">自己战胜自己是最可贵的胜利。</span><br><span class="line"> </span><br><span class="line">48、为别人鼓掌的人也是在给自己的生命加油。</span><br><span class="line"> </span><br><span class="line">49、</span><br><span class="line">拥有梦想只是一种智力，</span><br><span class="line">实现梦想才是一种能力。</span><br><span class="line"> </span><br><span class="line">50、</span><br><span class="line">如果一个人不知道他要驶向哪个码头，</span><br><span class="line">那么任何风都不会是顺风。</span><br><span class="line"> </span><br><span class="line">51、</span><br><span class="line">人的才华就如海绵的水，</span><br><span class="line">没有外力的挤压，它是绝对流不出来的。</span><br><span class="line">流出来后，海绵才能吸收新的源泉。</span><br><span class="line"> </span><br><span class="line">52、</span><br><span class="line">感恩生命，感谢她给予我们一个聪明的大脑。</span><br><span class="line">思考疑难的问题，生命的意义；赞颂真善美，批判假恶丑。</span><br><span class="line">记住精彩的瞬间，激动的时刻，温馨的情景，甜蜜的镜头。</span><br><span class="line">感恩生命赋予我们特有的灵性。</span><br><span class="line"> </span><br><span class="line">53、</span><br><span class="line">善待自己，幸福无比，</span><br><span class="line">善待别人，快乐无比，</span><br><span class="line">善待生命，健康无比。</span><br><span class="line"> </span><br><span class="line">54、</span><br><span class="line">一切伟大的行动和思想，</span><br><span class="line">都有一个微不足道的开始。</span><br><span class="line"> </span><br><span class="line">55、</span><br><span class="line">在你发怒的时候，</span><br><span class="line">要紧闭你的嘴，</span><br><span class="line">免得增加你的怒气。</span><br><span class="line"> </span><br><span class="line">56、</span><br><span class="line">获致幸福的不二法门是</span><br><span class="line">珍视你所拥有的、</span><br><span class="line">遗忘你所没有的。</span><br><span class="line"> </span><br><span class="line">57、</span><br><span class="line">骄傲是胜利下的蛋，</span><br><span class="line">孵出来的却是失败。</span><br><span class="line"> </span><br><span class="line">58、</span><br><span class="line">没有一个朋友比得上健康，</span><br><span class="line">没有一个敌人比得上病魔，</span><br><span class="line">与其为病痛暗自流泪，</span><br><span class="line">不如运动健身为生命添彩。</span><br><span class="line"> </span><br><span class="line">59、</span><br><span class="line">有什么别有病，</span><br><span class="line">没什么别没钱，</span><br><span class="line">缺什么也别缺健康，</span><br><span class="line">健康不是一切，</span><br><span class="line">但是没有健康就没有一切。</span><br><span class="line"> </span><br><span class="line">60、</span><br><span class="line">什么都可以不好，心情不能不好；</span><br><span class="line">什么都可以缺乏，自信不能缺乏；</span><br><span class="line">什么都可以不要，快乐不能不要；</span><br><span class="line">什么都可以忘掉，健身不能忘掉。</span><br><span class="line"> </span><br><span class="line">61、</span><br><span class="line">选对事业可以成就一生，</span><br><span class="line">选对朋友可以智能一生，</span><br><span class="line">选对环境可以快乐一生，</span><br><span class="line">选对伴侣可以幸福一生，</span><br><span class="line">选对生活方式可以健康一生。</span><br><span class="line"> </span><br><span class="line">62、含泪播种的人一定能含笑收获。</span><br><span class="line"> </span><br><span class="line">63、</span><br><span class="line">一个有信念者所开发出的力量，</span><br><span class="line">大于个只有兴趣者。</span><br><span class="line"> </span><br><span class="line">64、忍耐力较诸脑力，尤胜一筹。</span><br><span class="line"> </span><br><span class="line">65、</span><br><span class="line">影响我们人生的绝不仅仅是环境，</span><br><span class="line">其实是心态在控制个人的行动和思想。</span><br><span class="line">同时，</span><br><span class="line">心态也决定了一个人的视野、事业和成就，甚至一生。</span><br><span class="line"> </span><br><span class="line">66、</span><br><span class="line">每一发奋努力的背后，</span><br><span class="line">必有加倍的赏赐。</span><br><span class="line"> </span><br><span class="line">67、</span><br><span class="line">懒惰像生锈一样，</span><br><span class="line">比操劳更消耗身体。</span><br><span class="line"> </span><br><span class="line">68、</span><br><span class="line">所有的胜利，与征服自己的胜利比起来，都是微不足道。</span><br><span class="line">所有的失败，与失去自己的失败比起来，更是微不足道。</span><br><span class="line"> </span><br><span class="line">69、挫折其实就是迈向成功所应缴的学费。</span><br><span class="line"> </span><br><span class="line">70、</span><br><span class="line">在这个尘世上，虽然有不少寒冷，不少黑暗，</span><br><span class="line">但只要人与人之间多些信任，多些关爱，</span><br><span class="line">那么，就会增加许多阳光。</span><br><span class="line"> </span><br><span class="line">71、</span><br><span class="line">一个能从别人的观念来看事情，</span><br><span class="line">能了解别人心灵活动的人，</span><br><span class="line">永远不必为自己的前途担心。</span><br><span class="line"> </span><br><span class="line">72、</span><br><span class="line">当一个人先从自己的内心开始奋斗，</span><br><span class="line">他就是个有价值的人。</span><br><span class="line"> </span><br><span class="line">73、</span><br><span class="line">没有人富有得可以不要别人的帮助，</span><br><span class="line">也没有人穷得不能在某方面给他人帮助。</span><br><span class="line"> </span><br><span class="line">74、</span><br><span class="line">凡真心尝试助人者，</span><br><span class="line">没有不帮到自己的。</span><br><span class="line"> </span><br><span class="line">75、</span><br><span class="line">积极者相信只有推动自己才能推动世界，</span><br><span class="line">只要推动自己就能推动世界。</span><br><span class="line"> </span><br><span class="line">76、</span><br><span class="line">一个人最大的破产是绝望，</span><br><span class="line">最大的资产是希望。</span><br><span class="line"> </span><br><span class="line">77、</span><br><span class="line">行动是成功的阶梯，</span><br><span class="line">行动越多，</span><br><span class="line">登得越高。</span><br><span class="line"> </span><br><span class="line">78、</span><br><span class="line">环境永远不会十全十美，</span><br><span class="line">消极的人受环境控制，</span><br><span class="line">积极的人却控制环境。</span><br><span class="line"> </span><br><span class="line">79、</span><br><span class="line">当所有人都低调的时候，</span><br><span class="line">你可以高调，</span><br><span class="line">但不能跑调。</span><br><span class="line"> </span><br><span class="line">80、</span><br><span class="line">成功的法则极为简单，</span><br><span class="line">但简单并不代表容易。</span><br><span class="line"> </span><br><span class="line">81、</span><br><span class="line">肯低头的人，</span><br><span class="line">永远不会撞到矮门。</span><br><span class="line"> </span><br><span class="line">82、</span><br><span class="line">昨晚多几分钟的准备，</span><br><span class="line">今天少几小时的麻烦。</span><br><span class="line"> </span><br><span class="line">83、</span><br><span class="line">拿望远镜看别人，</span><br><span class="line">拿放大镜看自己。</span><br><span class="line"> </span><br><span class="line">84、</span><br><span class="line">一念放下，万般自在。</span><br><span class="line"> </span><br><span class="line">85、</span><br><span class="line">六个不能：</span><br><span class="line">不能饿了才吃，</span><br><span class="line">不能渴了才喝，</span><br><span class="line">不能困了才睡，</span><br><span class="line">不能累了才歇，</span><br><span class="line">不能病了才检查，</span><br><span class="line">不能老了再后悔。</span><br><span class="line"> </span><br><span class="line">86、</span><br><span class="line">屋子修得再大也是临时住所，</span><br><span class="line">只有那个小木匣才是永久的家，</span><br><span class="line">所以，屋宽不如心宽，身安不如心安！</span><br><span class="line"> </span><br><span class="line">87、</span><br><span class="line">人生最大的错误，</span><br><span class="line">是用健康换取身外之物，</span><br><span class="line">人生最大的悲哀，</span><br><span class="line">是用生命换取个人的烦恼，</span><br><span class="line">人生最大的浪费，</span><br><span class="line">是用生命解决自己制造的麻烦！</span><br><span class="line"> </span><br><span class="line">88、</span><br><span class="line">人生最大的哀痛，是子欲孝而亲不在！</span><br><span class="line">人生最大的悲剧，是家未富而人先亡，</span><br><span class="line">人生最大的可怜，是弥留之际才明白自己是应该做什么的！</span><br><span class="line"> </span><br><span class="line">89、</span><br><span class="line">当心灵趋于平静时，精神便是永恒！</span><br><span class="line">把欲望降到最低点，把理性升华到最高点，</span><br><span class="line">你会感受到：平安是福，清心是禄，寡欲是寿！</span><br><span class="line"> </span><br><span class="line">90、</span><br><span class="line">最好的医生是自己，</span><br><span class="line">最好的药物是时间，</span><br><span class="line">最好的心情是宁静，最</span><br><span class="line">好的保健是笑脸，</span><br><span class="line">最好的运动是步行！</span><br><span class="line"> </span><br><span class="line">91、</span><br><span class="line">欢乐是长寿的妙药，</span><br><span class="line">勤奋是健康的灵丹，</span><br><span class="line">运动是健康的投资，</span><br><span class="line">长寿是健身的回报，</span><br><span class="line">相逢莫问留春术，</span><br><span class="line">淡薄宁静比药好！</span><br><span class="line"> </span><br><span class="line">92、</span><br><span class="line">金钱难买健康，健康大于金钱，</span><br><span class="line">金钱难买幸福，幸福必有健康，</span><br><span class="line">生命的幸福不在名利在健康，</span><br><span class="line">身体的强壮不在金钱在运动！</span><br><span class="line"> </span><br><span class="line">93、</span><br><span class="line">饮食贵在节，读书贵在精，</span><br><span class="line">锻炼贵在恒，节饮食养胃，</span><br><span class="line">多读书养胆，喜运动延生！</span><br><span class="line"> </span><br><span class="line">94、</span><br><span class="line">你不能左右天气，但可以改变心情。</span><br><span class="line">你不能改变容貌，但可以掌握自己。</span><br><span class="line">你不能预见明天，但可以珍惜今天！</span><br><span class="line"> </span><br><span class="line">95、热爱生活的人，生活也爱他。</span><br><span class="line"> </span><br><span class="line">96、</span><br><span class="line">微笑不用本钱，但能创造财富。</span><br><span class="line">赞美不用花钱，但能产生气力。</span><br><span class="line">分享不用过度，但能倍增快乐。</span><br><span class="line"> </span><br><span class="line">97、</span><br><span class="line">快乐总和宽厚的人相伴，</span><br><span class="line">财富总与诚信的人相伴，</span><br><span class="line">聪明总与高尚的人相伴，</span><br><span class="line">魅力总与幽默的人相伴，</span><br><span class="line">健康总与豁达的人相伴。</span><br><span class="line"> </span><br><span class="line">98、</span><br><span class="line">愚者用肉体监视心灵，</span><br><span class="line">智者用心灵监视肉体。</span><br><span class="line"> </span><br><span class="line">99、</span><br><span class="line">生活若剥去了理想、梦想、幻想，</span><br><span class="line">那生命便只是一堆空架子。</span><br><span class="line"> </span><br><span class="line">100、</span><br><span class="line">尝试去把别人拍过来的砖砌成结实的地基，</span><br><span class="line">生活就不会那么辛苦了。</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文章 </tag>
            
            <tag> 座右铭 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>仓央嘉措最美情诗十首</title>
      <link href="/page/1843896738/"/>
      <url>/page/1843896738/</url>
      
        <content type="html"><![CDATA[<p>仓央嘉措（1683—1706年），为第六世达赖喇嘛，门巴族人，西藏历史上著名的人物。1683年（藏历水猪年，康熙二十二年）生于西藏南部，门隅纳拉山下宇松地区乌坚林村的一户农奴家庭，父亲扎西丹增，母亲次旺拉姆。家中世代信奉宁玛派佛教。1697年被当时的西藏摄政王第巴·桑结嘉措认定为五世达赖的转世灵童，同年在桑结嘉措的主持下在布达拉宫举行了坐床典礼。1705年被废，1706年在押解途中圆寂。仓央嘉措是一位才华出众、富有文采的民歌诗人，写了很多细腻真挚的情歌。最为经典的拉萨藏文木刻版《仓央嘉措情歌》，词句优美，朴实生动，汇集了仓央嘉措60多首情诗，如今已被译成20多种文字，几乎传遍了全世界，他的诗歌已经超越民族、时空、国界，成为宝贵的文化遗产。其中最著名的是“曾虑多情损梵行，入山又恐别倾城。世间安得双全法，不负如来不负卿。”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br></pre></td><td class="code"><pre><span class="line">一、</span><br><span class="line"> 谁，执我之手，敛我半世癫狂;</span><br><span class="line"></span><br><span class="line">谁，吻我之眸，遮我半世流离;</span><br><span class="line"></span><br><span class="line">谁，抚我之面，慰我半世哀伤;</span><br><span class="line"></span><br><span class="line">谁，携我之心，融我半世冰霜;</span><br><span class="line"></span><br><span class="line">谁，扶我之肩，驱我一世沉寂。</span><br><span class="line"></span><br><span class="line">谁，唤我之心，掩我一生凌轹。</span><br><span class="line"></span><br><span class="line">谁，弃我而去，留我一世独殇;</span><br><span class="line"></span><br><span class="line">谁，可明我意，使我此生无憾;</span><br><span class="line"></span><br><span class="line">谁，可助我臂，纵横万载无双;</span><br><span class="line"></span><br><span class="line">谁，可倾我心，寸土恰似虚弥;</span><br><span class="line"></span><br><span class="line">谁，可葬吾怆，笑天地虚妄，吾心狂。</span><br><span class="line"></span><br><span class="line">伊，覆我之唇，祛我前世流离;</span><br><span class="line"></span><br><span class="line">伊，揽我之怀，除我前世轻浮。</span><br><span class="line"></span><br><span class="line">执子之手，陪你痴狂千生;</span><br><span class="line"></span><br><span class="line">深吻子眸，伴你万世轮回。</span><br><span class="line"></span><br><span class="line">执子之手，共你一世风霜;</span><br><span class="line"></span><br><span class="line">吻子之眸，赠你一世深情。</span><br><span class="line"></span><br><span class="line">我， 牵尔玉手， 收你此生所有;</span><br><span class="line"></span><br><span class="line">我， 抚尔秀颈， 挡你此生风雨。</span><br><span class="line"></span><br><span class="line">予，挽子青丝，挽子一世情思;</span><br><span class="line"></span><br><span class="line">予，执子之手，共赴一世情长;</span><br><span class="line"></span><br><span class="line">曾，以父之名，免你一生哀愁;</span><br><span class="line"></span><br><span class="line">曾，怜子之情，祝你一生平安!</span><br><span class="line"></span><br><span class="line">二、《那一世》</span><br><span class="line"></span><br><span class="line">那一刻，我升起风马，不为乞福，只为守候你的到来;</span><br><span class="line"></span><br><span class="line">那一日，我闭目在经殿香雾中，蓦然听见你颂经中的真言;</span><br><span class="line"></span><br><span class="line">那一夜，我听了一宿梵唱，不为参悟，只为寻你的一丝气息;</span><br><span class="line"></span><br><span class="line">那一月，我摇动所有的经筒，不为超度，只为触摸你的指尖;</span><br><span class="line"></span><br><span class="line">那一年，我磕长头在山路，不为觐见，只为贴着你的温暖;</span><br><span class="line"></span><br><span class="line">那一世，转山转水转佛塔啊，不为修来生，只为途中与你相见。</span><br><span class="line"></span><br><span class="line">那一瞬，我飞升成仙，不为长生，只为佑你平安喜乐。</span><br><span class="line"></span><br><span class="line">三、《十诫诗 》</span><br><span class="line"></span><br><span class="line">第一最好不相见，如此便可不相恋。</span><br><span class="line"></span><br><span class="line">第二最好不相知，如此便可不相思。</span><br><span class="line"></span><br><span class="line">第三最好不相伴，如此便可不相欠。</span><br><span class="line"></span><br><span class="line">第四最好不相惜，如此便可不相忆。</span><br><span class="line"></span><br><span class="line">第五最好不相爱，如此便可不相弃。</span><br><span class="line"></span><br><span class="line">第六最好不相对，如此便可不相会。</span><br><span class="line"></span><br><span class="line">第七最好不相误，如此便可不相负。</span><br><span class="line"></span><br><span class="line">第八最好不相许，如此便可不相续。</span><br><span class="line"></span><br><span class="line">第九最好不相依，如此便可不相偎。</span><br><span class="line"></span><br><span class="line">第十最好不相遇，如此便可不相聚。</span><br><span class="line"></span><br><span class="line">但曾相见便相知，相见何如不见时。</span><br><span class="line"></span><br><span class="line">安得与君相诀绝，免教生死作相思。</span><br><span class="line"></span><br><span class="line">四、《见与不见》</span><br><span class="line"></span><br><span class="line">你见，或者不见我</span><br><span class="line"></span><br><span class="line">我就在那里</span><br><span class="line"></span><br><span class="line">不悲不喜</span><br><span class="line"></span><br><span class="line">你念，或者不念我</span><br><span class="line"></span><br><span class="line">情就在那里</span><br><span class="line"></span><br><span class="line">不来不去</span><br><span class="line"></span><br><span class="line">你爱，或者不爱我</span><br><span class="line"></span><br><span class="line">爱就在那里</span><br><span class="line"></span><br><span class="line">不增不减</span><br><span class="line"></span><br><span class="line">你跟，或者不跟我</span><br><span class="line"></span><br><span class="line">我的手就在你手里</span><br><span class="line"></span><br><span class="line">不舍不弃</span><br><span class="line"></span><br><span class="line">来我的怀里</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">让我住进你的心里</span><br><span class="line"></span><br><span class="line">默然 相爱</span><br><span class="line"></span><br><span class="line">寂静 欢喜</span><br><span class="line"></span><br><span class="line">五、</span><br><span class="line"></span><br><span class="line">住进布达拉宫，</span><br><span class="line"></span><br><span class="line">我是雪域最大的王。</span><br><span class="line"></span><br><span class="line">流浪在拉萨街头，</span><br><span class="line"></span><br><span class="line">我是世间最美的情郎。</span><br><span class="line"></span><br><span class="line">与玛吉阿米的更传神，</span><br><span class="line"></span><br><span class="line">自恐多情损梵行，</span><br><span class="line"></span><br><span class="line">入山又怕误倾城。</span><br><span class="line"></span><br><span class="line">世间安得双全法，</span><br><span class="line"></span><br><span class="line">不负如来不负卿。</span><br><span class="line"></span><br><span class="line">六、</span><br><span class="line"></span><br><span class="line">我终于明白，</span><br><span class="line"></span><br><span class="line">世间有一种思绪，</span><br><span class="line"></span><br><span class="line">无法用言语形容，</span><br><span class="line"></span><br><span class="line">粗犷而忧伤。</span><br><span class="line"></span><br><span class="line">回声的千结百绕，</span><br><span class="line"></span><br><span class="line">而守候的是，</span><br><span class="line"></span><br><span class="line">执着。</span><br><span class="line"></span><br><span class="line">一如月光下的高原，</span><br><span class="line"></span><br><span class="line">一抹淡淡痴痴的笑。</span><br><span class="line"></span><br><span class="line">笑那浮华落尽，月色如洗;</span><br><span class="line"></span><br><span class="line">笑那悄然而逝，飞花万盏。</span><br><span class="line"></span><br><span class="line">谁是那轻轻颤动的百合，</span><br><span class="line"></span><br><span class="line">在你的清辉下亘古不变。</span><br><span class="line"></span><br><span class="line">谁有那灼灼热烈的双眸，</span><br><span class="line"></span><br><span class="line">在你的颔首中攀援而上。</span><br><span class="line"></span><br><span class="line">遥远的忧伤，</span><br><span class="line"></span><br><span class="line">穿过千山万水。</span><br><span class="line"></span><br><span class="line">纵使高原上的风，</span><br><span class="line"></span><br><span class="line">吹不散，</span><br><span class="line"></span><br><span class="line">执着的背影。</span><br><span class="line"></span><br><span class="line">纵使清晨前的霜，</span><br><span class="line"></span><br><span class="line">融不化，</span><br><span class="line"></span><br><span class="line">心头的温热。</span><br><span class="line"></span><br><span class="line">你静守在月下，</span><br><span class="line"></span><br><span class="line">悄悄地来。</span><br><span class="line"></span><br><span class="line">七、《问佛》</span><br><span class="line"></span><br><span class="line">我问佛：为何不给所有女子羞花闭月容颜?</span><br><span class="line"></span><br><span class="line">佛曰：那只是昙花一现，用来蒙蔽世俗的眼，</span><br><span class="line"></span><br><span class="line">没有什麽美可以抵过一颗纯净仁爱的心，</span><br><span class="line"></span><br><span class="line">我把它赐给每一个女子，可有人让她蒙上了灰。</span><br><span class="line"></span><br><span class="line">我问佛：世间为何有那麽多遗憾?</span><br><span class="line"></span><br><span class="line">佛曰：这是一个婆娑世界，婆娑既遗憾，</span><br><span class="line"></span><br><span class="line">没有遗憾，给你再多幸福也不会体会快乐。</span><br><span class="line"></span><br><span class="line">我问佛：如何让人们的心不再感到孤单?</span><br><span class="line"></span><br><span class="line">佛曰：每一颗心生来就是孤单而残缺的，</span><br><span class="line"></span><br><span class="line">多数带著这种残缺度过一生，</span><br><span class="line"></span><br><span class="line">只因与能使它圆满的另一半相遇时，</span><br><span class="line"></span><br><span class="line">不是疏忽错过就是已失去拥有它的资格。</span><br><span class="line"></span><br><span class="line">我问佛：如果遇到了可以爱的人，却又怕不能把握怎麽办?</span><br><span class="line"></span><br><span class="line">佛曰：留人间多少爱，迎浮世千重变;</span><br><span class="line"></span><br><span class="line">和有情人，做快乐事，</span><br><span class="line"></span><br><span class="line">别问是劫是缘。</span><br><span class="line"></span><br><span class="line">我问佛：如何才能如你般睿智?</span><br><span class="line"></span><br><span class="line">佛曰：佛是过来人，人是未来佛，</span><br><span class="line"></span><br><span class="line">我也曾如你般天真。</span><br><span class="line"></span><br><span class="line">我问佛：为什么总是在我悲伤的时候下雪?</span><br><span class="line"></span><br><span class="line">佛说：冬天就要过去，留点记忆。</span><br><span class="line"></span><br><span class="line">我问佛：为什么每次下雪都是我不在意的夜晚?</span><br><span class="line"></span><br><span class="line">佛说：不经意的时候人们总会错过很多真正的美丽。</span><br><span class="line"></span><br><span class="line">我问佛：那过几天还下不下雪?</span><br><span class="line"></span><br><span class="line">佛说：不要只盯着这个季节，错过了今冬。</span><br><span class="line"></span><br><span class="line">八、</span><br><span class="line"></span><br><span class="line">我用世间所有的路，</span><br><span class="line"></span><br><span class="line">倒退，</span><br><span class="line"></span><br><span class="line">从哪儿来回哪儿去。</span><br><span class="line"></span><br><span class="line">正如</span><br><span class="line"></span><br><span class="line">月亮回到湖心，</span><br><span class="line"></span><br><span class="line">野鹤奔向闲云，</span><br><span class="line"></span><br><span class="line">我步入你，</span><br><span class="line"></span><br><span class="line">然后</span><br><span class="line"></span><br><span class="line">一场大雪便封住所有人的嘴。</span><br><span class="line"></span><br><span class="line">那个女子，</span><br><span class="line"></span><br><span class="line">满身都是洗不尽的春色，</span><br><span class="line"></span><br><span class="line">眸子闪处，花花草草;</span><br><span class="line"></span><br><span class="line">笑口开时，山山水水;</span><br><span class="line"></span><br><span class="line">但那块发光的松石，</span><br><span class="line"></span><br><span class="line">却折射着她一生的因缘，</span><br><span class="line"></span><br><span class="line">她坐在自己深处避邪，</span><br><span class="line"></span><br><span class="line">起来后再把那些误解她的人白白错过。</span><br><span class="line"></span><br><span class="line">一挥手，</span><br><span class="line"></span><br><span class="line">六尘境界到处都是她撒出的花种。</span><br><span class="line"></span><br><span class="line">夕阳印证着雪山无我的智慧，</span><br><span class="line"></span><br><span class="line">爱情与梵心同样白得耀眼，</span><br><span class="line"></span><br><span class="line">离别后，晚风依然珍藏着她的誓言。</span><br><span class="line"></span><br><span class="line">誓言中的青草早已枯黄，</span><br><span class="line"></span><br><span class="line">没有什么远近之分，</span><br><span class="line"></span><br><span class="line">世上最远的也远不过隔世之爱，</span><br><span class="line"></span><br><span class="line">再近也近不过自己与自己相邻，</span><br><span class="line"></span><br><span class="line">此时，远处隐隐传来琵琶声，</span><br><span class="line"></span><br><span class="line">那是她弹的，</span><br><span class="line"></span><br><span class="line">却不是为我弹的。</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文章 </tag>
            
            <tag> 情诗 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>英语名言警句</title>
      <link href="/page/2135853815/"/>
      <url>/page/2135853815/</url>
      
        <content type="html"><![CDATA[<p>中文中的一些名言，英语中你知道怎么说吗？记住下面这些英语名言，用在你的考试作文中，会被加分哟！</p><p>第一部份:</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、Do one thing at a time, and <span class="keyword">do</span> well.</span><br><span class="line">一次只做一件事，做到最好！</span><br><span class="line"> </span><br><span class="line"><span class="number">2</span>、Never forget to say “thanks”.</span><br><span class="line">永远不要忘了说“谢谢”!</span><br><span class="line"> </span><br><span class="line"><span class="number">3</span>、Keep on going never give up.</span><br><span class="line">勇往直前， 决不放弃！</span><br><span class="line"> </span><br><span class="line"><span class="number">4</span>、Whatever <span class="keyword">is</span> worth doing <span class="keyword">is</span> worth doing well.</span><br><span class="line">任何值得做的事就值得把它做好！</span><br><span class="line"> </span><br><span class="line"><span class="number">5</span>、Believe <span class="keyword">in</span> yourself.</span><br><span class="line">相信你自己！</span><br><span class="line"> </span><br><span class="line"><span class="number">6</span>、I can because i think i can.</span><br><span class="line">我行，因为我相信我行！</span><br><span class="line"> </span><br><span class="line"><span class="number">7</span>、Action speak louder than words.</span><br><span class="line">行动胜于言语！</span><br><span class="line"> </span><br><span class="line"><span class="number">8</span>、Never say die.</span><br><span class="line">永不气馁！</span><br><span class="line"> </span><br><span class="line"><span class="number">9</span>、Never put off what you can <span class="keyword">do</span> today until tomorrow.</span><br><span class="line">今日事今日毕！</span><br><span class="line"> </span><br><span class="line"><span class="number">10</span>、The best preparation <span class="keyword">for</span> tomorrow <span class="keyword">is</span> doing your best today.</span><br><span class="line">对明天做好的准备就是今天做到最好！</span><br><span class="line"> </span><br><span class="line"><span class="number">11</span>、You cannot improve your past, but you can improve your future. Once time <span class="keyword">is</span> wasted, life <span class="keyword">is</span> wasted.</span><br><span class="line">你不能改变你的过去，但你可以让你的未来变得更美好。一旦时间浪费了，生命就浪费了。</span><br><span class="line"> </span><br><span class="line"><span class="number">12</span>、Knowlegde can change your fate and English can accomplish your future.</span><br><span class="line">知识改变命运，英语成就未来。</span><br><span class="line"> </span><br><span class="line"><span class="number">13</span>、Don<span class="string">&#x27;t aim for success if you want it; just do what you love and believe in, and it will come naturally.</span></span><br><span class="line"><span class="string">如果你想要成功，不要去追求成功；尽管做你自己热爱的事情并且相信它，成功自然到来。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">14、Jack of all trades and master of none.</span></span><br><span class="line"><span class="string">门门精通，样样稀松。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">15、Judge not from appearances.</span></span><br><span class="line"><span class="string">人不可貌相，海不可斗量。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">16、Justice has long arms.</span></span><br><span class="line"><span class="string">天网恢恢，疏而不漏。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">17、Keep good men company and you shall be of the number.</span></span><br><span class="line"><span class="string">近朱者赤，近墨者黑。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">18、Kill two birds with one stone.</span></span><br><span class="line"><span class="string">一箭双雕。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">19、Kings go mad, and the people suffer for it.</span></span><br><span class="line"><span class="string">君王发狂，百姓遭殃。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">20、Kings have long arms.</span></span><br><span class="line"><span class="string">普天之下，莫非王土。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">21、Knowledge is power.</span></span><br><span class="line"><span class="string">知识就是力量。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">21、Knowledge makes humble, ignorance makes proud.</span></span><br><span class="line"><span class="string">博学使人谦逊，无知使人骄傲。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">22、Learn and live.</span></span><br><span class="line"><span class="string">活着，为了学习。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">23、Learning makes a good man better and ill man worse.</span></span><br><span class="line"><span class="string">好人越学越好，坏人越学越坏。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">24、Learn not and know not.</span></span><br><span class="line"><span class="string">不学无术。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">25、Learn to walk before you run.</span></span><br><span class="line"><span class="string">先学走，再学跑。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">26、Let bygones be bygones.</span></span><br><span class="line"><span class="string">过去的就让它过去吧。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">27、Let sleeping dogs lie.</span></span><br><span class="line"><span class="string">别惹麻烦。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">28、Let the cat out of the bag.</span></span><br><span class="line"><span class="string">泄漏天机。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">29、Lies can never changes fact.</span></span><br><span class="line"><span class="string">谎言终究是谎言。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">30、Lies have short legs.</span></span><br><span class="line"><span class="string">谎言站不长。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">31、Life is but a span.</span></span><br><span class="line"><span class="string">人生苦短。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">32、Life is half spent before we know what it is.</span></span><br><span class="line"><span class="string">人过半生，方知天命。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">33、Life is not all roses.</span></span><br><span class="line"><span class="string">人生并不是康庄大道。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">34、Life without a friend is death.</span></span><br><span class="line"><span class="string">没有朋友，虽生犹死。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">35、Like a rat in a hole.</span></span><br><span class="line"><span class="string">瓮中之鳖。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">36、Like author, like book.</span></span><br><span class="line"><span class="string">文如其人。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">37、Like father, like son.</span></span><br><span class="line"><span class="string">有其父必有其子。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">38、Like for like.</span></span><br><span class="line"><span class="string">一报还一报。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">39、Like knows like.</span></span><br><span class="line"><span class="string">惺惺相惜。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">40、Like mother, like daughter.</span></span><br><span class="line"><span class="string">有其母必有其女。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">41、Like teacher, like pupil.</span></span><br><span class="line"><span class="string">什么样的老师教什么样的学生。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">42、Like tree, like fruit.</span></span><br><span class="line"><span class="string">羊毛出在羊身上。</span></span><br></pre></td></tr></table></figure><p>第二部份</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、You can never turn back the clock</span><br><span class="line">时光不能倒流</span><br><span class="line"><span class="number">2</span>、All things come to those who wait</span><br><span class="line">懂得忍耐的人是最大的赢家</span><br><span class="line"><span class="number">3</span>、Desire has no rest</span><br><span class="line">人的欲望无止尽</span><br><span class="line"><span class="number">4</span>、Some people never adjust to the loss of a loved one</span><br><span class="line">有些人永远无法从失去挚爱的人的悲痛中走出来</span><br><span class="line"><span class="number">5</span>、Time <span class="keyword">is</span> of the essence</span><br><span class="line">时间就是一切</span><br><span class="line"><span class="number">6</span>、Danger past，God forgotten</span><br><span class="line">飞鸟尽，良弓藏</span><br><span class="line"><span class="number">7</span>、A young idler，an old beggar</span><br><span class="line">少壮不努力，老大徒伤悲</span><br><span class="line"><span class="number">8</span>、Man proposes，God disposes</span><br><span class="line">谋事在人，成事在天</span><br><span class="line"><span class="number">9</span>、Merry meet，merry part</span><br><span class="line">好聚好散</span><br><span class="line"><span class="number">10</span>、Courtesy costs nothing</span><br><span class="line">礼多人不怪</span><br><span class="line"><span class="number">11</span>、Every little bit helps</span><br><span class="line">滴水穿石</span><br><span class="line"><span class="number">12</span>、Nothing <span class="keyword">is</span> difficult <span class="keyword">if</span> you put your heart into it</span><br><span class="line">世上无难事，只怕有心人</span><br><span class="line"><span class="number">13</span>、You may delay，but time until not</span><br><span class="line">时不待我</span><br><span class="line"><span class="number">14</span>、Better a little loss than a <span class="built_in">long</span> sorrow</span><br><span class="line">长痛不如短痛</span><br><span class="line"><span class="number">15</span>、Man struggles upwards，water flows downwards</span><br><span class="line">人往高处走，水往低处流</span><br><span class="line"><span class="number">16</span>、Past pain <span class="keyword">is</span> pleasure</span><br><span class="line">过去的痛苦即是快乐</span><br><span class="line"><span class="number">17</span>、The wall has ears</span><br><span class="line">隔墙有耳</span><br><span class="line"><span class="number">18</span>、Love me，love my dog</span><br><span class="line">爱屋及乌</span><br><span class="line"><span class="number">19</span>、Don’t trouble trouble until trouble troubles you</span><br><span class="line">别自找麻烦</span><br><span class="line"><span class="number">20</span>、The road <span class="keyword">is</span> tortuous，but the future <span class="keyword">is</span> bright</span><br><span class="line">道路是曲折的，前途是光明的</span><br><span class="line"><span class="number">21</span>、One <span class="keyword">is</span> always on a strange road，watching strange scenery and listening to strange music</span><br><span class="line">一个人总要走陌生的路，看陌生的风景，听陌生的音乐</span><br><span class="line"><span class="number">22</span>、Reality <span class="keyword">is</span> temporary <span class="keyword">while</span> ideals are permanent</span><br><span class="line">现实是暂时的，理想是永恒的</span><br><span class="line"><span class="number">23</span>、It <span class="keyword">is</span> better to forgive and forget rather than to hold a grudge</span><br><span class="line">与其怀有宿怨，不如去宽恕和释怀来得好</span><br><span class="line"><span class="number">24</span>、Do wrong once and you’ll never hear the end of it</span><br><span class="line">一失足成千古恨</span><br><span class="line"><span class="number">25</span>、Speak of the devil and he appears</span><br><span class="line">说曹操，曹操到</span><br><span class="line"><span class="number">26</span>、When the cat’s away, the mice will play</span><br><span class="line">山中无老虎，猴子称大王</span><br><span class="line"><span class="number">27</span>、Alter what <span class="keyword">is</span> changeable and accept what <span class="keyword">is</span> <span class="keyword">immutable</span></span><br><span class="line">改变可以改变的，接受不能改变的</span><br><span class="line"><span class="number">28</span>、A hedge between keeps friendship green</span><br><span class="line">君子之交淡如水</span><br><span class="line"><span class="number">29</span>、Take the essence and discard the dregs</span><br><span class="line">取其精华，去其糟泊</span><br><span class="line"><span class="number">30</span>、If you shed tears when you miss the sun，you also miss the stars</span><br><span class="line">如果你因为失去太阳而落泪，那么你也将失去群星</span><br><span class="line"><span class="number">31</span>、There <span class="keyword">is</span> a skeleton <span class="keyword">in</span> the cupboard</span><br><span class="line">家丑不可外扬</span><br><span class="line"><span class="number">32</span>、One eyewitness <span class="keyword">is</span> better than ten hearsays</span><br><span class="line">百闻不如一见</span><br><span class="line"><span class="number">33</span>、Don’t teach fish to swim</span><br><span class="line">不要班门弄斧</span><br><span class="line"><span class="number">34</span>、It only takes a minute to get a crush on someone but an eternity to forget someone</span><br><span class="line">迷上某人只需一分钟，忘记某人却是一辈子的事</span><br><span class="line"><span class="number">35</span>、At the touch of love everyone becomes a poet</span><br><span class="line">每一个沐浴爱河的人都是诗人</span><br><span class="line"><span class="number">36</span>、Let nature take its right course</span><br><span class="line">船到桥头自然直</span><br><span class="line"><span class="number">37</span>、Opportunity knocks but once</span><br><span class="line">机不可失，时不再来</span><br><span class="line"><span class="number">38</span>、It’s never too late to mend</span><br><span class="line">亡羊补牢，犹未晚也</span><br><span class="line"><span class="number">39</span>、A journey of a thousand miles begins <span class="keyword">with</span> a single step</span><br><span class="line">千里之行，始于足下</span><br><span class="line"><span class="number">40</span>、If winter comes，can spring be far behind？</span><br><span class="line">冬天来了，春天还会远吗？</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文章 </tag>
            
            <tag> 英语名言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>8088汇编速查手册</title>
      <link href="/page/753365309/"/>
      <url>/page/753365309/</url>
      
        <content type="html"><![CDATA[<p>汇编语言(assembly language)是一种用于电子计算机、微处理器、微控制器或其他可编程器件的低级语言，亦称为符号语言。在汇编语言中，用助记符(Mnemonics)代替机器指令的操作码，用地址符号(Symbol)或标号(Label)代替指令或操作数的地址。在不同的设备中，汇编语言对应着不同的机器语言指令集，通过汇编过程转换成机器指令。普遍地说，特定的汇编语言和特定的机器语言指令集是一一对应的不同平台之间不可直接移植。下面是汇编指令<br>一、数据传输指令<br>───────────────────────────────────────<br>    它们在存贮器和寄存器、寄存器和输入输出端口之间传送数据.<br>    1. 通用数据传送指令.<br>        MOV    传送字或字节.<br>        MOVSX  先符号扩展,再传送.<br>        MOVZX  先零扩展,再传送.<br>        PUSH    把字压入堆栈.<br>        POP    把字弹出堆栈.<br>        PUSHA  把AX,CX,DX,BX,SP,BP,SI,DI依次压入堆栈.<br>        POPA    把DI,SI,BP,SP,BX,DX,CX,AX依次弹出堆栈.<br>        PUSHAD  把EAX,ECX,EDX,EBX,ESP,EBP,ESI,EDI依次压入堆栈.<br>        POPAD  把EDI,ESI,EBP,ESP,EBX,EDX,ECX,EAX依次弹出堆栈.<br>        BSWAP  交换32位寄存器里字节的顺序<br>        XCHG    交换字或字节.( 至少有一个操作数为寄存器,段寄存器不可作为操作数)<br>        CMPXCHG 比较并交换操作数.( 第二个操作数必须为累加器AL/AX/EAX )<br>        XADD    先交换再累加.( 结果在第一个操作数里 )<br>        XLAT    字节查表转换.<br>                ── BX 指向一张 256 字节的表的起点, AL 为表的索引值 (0-255,即<br>                0-FFH); 返回 AL 为查表结果. ( [BX+AL]-&gt;AL )<br>    2. 输入输出端口传送指令.<br>        IN      I/O端口输入. ( 语法: IN 累加器, {端口号│DX} )<br>        OUT    I/O端口输出. ( 语法: OUT {端口号│DX},累加器 )<br>          输入输出端口由立即方式指定时, 其范围是 0-255; 由寄存器 DX 指定时,<br>          其范围是 0-65535.<br>    3. 目的地址传送指令.<br>        LEA    装入有效地址.<br>          例: LEA DX,string  ;把偏移地址存到DX.<br>        LDS    传送目标指针,把指针内容装入DS.<br>          例: LDS SI,string  ;把段地址:偏移地址存到DS:SI.<br>        LES    传送目标指针,把指针内容装入ES.<br>          例: LES DI,string  ;把段地址:偏移地址存到ES:DI.<br>        LFS    传送目标指针,把指针内容装入FS.<br>          例: LFS DI,string  ;把段地址:偏移地址存到FS:DI.<br>        LGS    传送目标指针,把指针内容装入GS.<br>          例: LGS DI,string  ;把段地址:偏移地址存到GS:DI.<br>        LSS    传送目标指针,把指针内容装入SS.<br>          例: LSS DI,string  ;把段地址:偏移地址存到SS:DI.<br>    4. 标志传送指令.<br>        LAHF    标志寄存器传送,把标志装入AH.<br>        SAHF    标志寄存器传送,把AH内容装入标志寄存器.<br>        PUSHF  标志入栈.<br>        POPF    标志出栈.<br>        PUSHD  32位标志入栈.<br>        POPD    32位标志出栈.<br>二、算术运算指令<br>───────────────────────────────────────<br>        　　ADD    加法.<br>        ADC    带进位加法.<br>        INC    加 1.<br>        AAA    加法的ASCII码调整.<br>        DAA    加法的十进制调整.<br>        SUB    减法.<br>        SBB    带借位减法.<br>        DEC    减 1.<br>        NEC    求反(以 0 减之).<br>        CMP    比较.(两操作数作减法,仅修改标志位,不回送结果).<br>        AAS    减法的ASCII码调整.<br>        DAS    减法的十进制调整.<br>        MUL    无符号乘法.<br>        IMUL    整数乘法.<br>          以上两条,结果回送AH和AL(字节运算),或DX和AX(字运算),<br>        AAM    乘法的ASCII码调整.<br>        DIV    无符号除法.<br>        IDIV    整数除法.<br>          以上两条,结果回送:<br>              商回送AL,余数回送AH, (字节运算);<br>          或  商回送AX,余数回送DX, (字运算).<br>        AAD    除法的ASCII码调整.<br>        CBW    字节转换为字. (把AL中字节的符号扩展到AH中去)<br>        CWD    字转换为双字. (把AX中的字的符号扩展到DX中去)<br>        CWDE    字转换为双字. (把AX中的字符号扩展到EAX中去)<br>        CDQ    双字扩展.    (把EAX中的字的符号扩展到EDX中去)<br>三、逻辑运算指令<br>───────────────────────────────────────<br>        　　AND    与运算.<br>        OR      或运算.<br>        XOR    异或运算.<br>        NOT    取反.<br>        TEST    测试.(两操作数作与运算,仅修改标志位,不回送结果).<br>        SHL    逻辑左移.<br>        SAL    算术左移.(=SHL)<br>        SHR    逻辑右移.<br>        SAR    算术右移.(=SHR)<br>        ROL    循环左移.<br>        ROR    循环右移.<br>        RCL    通过进位的循环左移.<br>        RCR    通过进位的循环右移.<br>          以上八种移位指令,其移位次数可达255次.<br>              移位一次时, 可直接用操作码.  如 SHL AX,1.<br>              移位&gt;1次时, 则由寄存器CL给出移位次数.<br>                如  MOV CL,04<br>                    SHL AX,CL<br>四、串指令<br>───────────────────────────────────────<br>            　DS:SI  源串段寄存器  :源串变址.<br>            ES:DI  目标串段寄存器:目标串变址.<br>            CX      重复次数计数器.<br>            AL/AX  扫描值.<br>            D标志  0表示重复操作中SI和DI应自动增量; 1表示应自动减量.<br>            Z标志  用来控制扫描或比较操作的结束.<br>        MOVS    串传送.<br>            ( MOVSB  传送字符.    MOVSW  传送字.    MOVSD  传送双字. )<br>        CMPS    串比较.<br>            ( CMPSB  比较字符.    CMPSW  比较字. )<br>        SCAS    串扫描.<br>            把AL或AX的内容与目标串作比较,比较结果反映在标志位.<br>        LODS    装入串.<br>            把源串中的元素(字或字节)逐一装入AL或AX中.<br>            ( LODSB  传送字符.    LODSW  传送字.    LODSD  传送双字. )<br>        STOS    保存串.<br>            是LODS的逆过程.<br>        REP            当CX/ECX&lt;&gt;0时重复.<br>        REPE/REPZ      当ZF=1或比较结果相等,且CX/ECX&lt;&gt;0时重复.<br>        REPNE/REPNZ    当ZF=0或比较结果不相等,且CX/ECX&lt;&gt;0时重复.<br>        REPC          当CF=1且CX/ECX&lt;&gt;0时重复.<br>        REPNC          当CF=0且CX/ECX&lt;&gt;0时重复.<br>五、程序转移指令<br>───────────────────────────────────────<br>    　1&gt;无条件转移指令 (长转移)<br>        JMP    无条件转移指令<br>        CALL    过程调用<br>        RET/RETF过程返回.<br>    2&gt;条件转移指令 (短转移,-128到+127的距离内)<br>        ( 当且仅当(SF XOR OF)=1时,OP1&lt;OP2 )<br>        JA/JNBE 不小于或不等于时转移.<br>        JAE/JNB 大于或等于转移.<br>        JB/JNAE 小于转移.<br>        JBE/JNA 小于或等于转移.<br>          以上四条,测试无符号整数运算的结果(标志C和Z).<br>        JG/JNLE 大于转移.<br>        JGE/JNL 大于或等于转移.<br>        JL/JNGE 小于转移.<br>        JLE/JNG 小于或等于转移.<br>          以上四条,测试带符号整数运算的结果(标志S,O和Z).<br>        JE/JZ  等于转移.<br>        JNE/JNZ 不等于时转移.<br>        JC      有进位时转移.<br>        JNC    无进位时转移.<br>        JNO    不溢出时转移.<br>        JNP/JPO 奇偶性为奇数时转移.<br>        JNS    符号位为 “0” 时转移.<br>        JO      溢出转移.<br>        JP/JPE  奇偶性为偶数时转移.<br>        JS      符号位为 “1” 时转移.<br>    3&gt;循环控制指令(短转移)<br>        LOOP            CX不为零时循环.<br>        LOOPE/LOOPZ    CX不为零且标志Z=1时循环.<br>        LOOPNE/LOOPNZ  CX不为零且标志Z=0时循环.<br>        JCXZ            CX为零时转移.<br>        JECXZ          ECX为零时转移.<br>    4&gt;中断指令<br>        INT    中断指令<br>        INTO    溢出中断<br>        IRET    中断返回<br>    5&gt;处理器控制指令<br>        HLT    处理器暂停, 直到出现中断或复位信号才继续.<br>        WAIT    当芯片引线TEST为高电平时使CPU进入等待状态.<br>        ESC    转换到外处理器.<br>        LOCK    封锁总线.<br>        NOP    空操作.<br>        STC    置进位标志位.<br>        CLC    清进位标志位.<br>        CMC    进位标志取反.<br>        STD    置方向标志位.<br>        CLD    清方向标志位.<br>        STI    置中断允许位.<br>        CLI    清中断允许位.<br>六、伪指令<br>───────────────────────────────────────<br>        　　DW      定义字(2字节).<br>        PROC    定义过程.<br>        ENDP    过程结束.<br>        SEGMENT 定义段.<br>        ASSUME  建立段寄存器寻址.<br>        ENDS    段结束.<br>        END    程序结束.</p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 汇编使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dos的debug命令详解</title>
      <link href="/page/2104750721/"/>
      <url>/page/2104750721/</url>
      
        <content type="html"><![CDATA[<p>DEBUG是DOS中的一个外部命令，从DOS 1.0起就带有此命令，因此可见此命令的重要性了。虽然此命令的功能非常强大，可以解决许多问题，可是对许多人来说，尤其是初学者来说，却非常不易掌握。因此，现将DEBUG的命令详细介绍一番，以让大家知道它的使用。<br>Debug:A（汇编）<br>直接将 8086/8087/8088 记忆码合并到内存。<br>该命令从汇编语言语句创建可执行的机器码。所有数值都是十六进制格式，必须按一到四个字符输入这些数值。在引用的操作代码（操作码）前指定前缀记忆码。<br>a [address]<br>参数<br>address<br>指定键入汇编语言指令的位置。对 address 使用十六进制值，并键入不以“h”字符结尾的每个值。如果不指定地址，a 将在它上次停止处开始汇编。<br>有关将数据输入到指定字节中的信息，请单击“相关主题”列表中的 Debug E（键入）。<br>有关反汇编字节的信息，请单击“相关主题”列表中的 Debug U（反汇编）。<br>说明<br>使用记忆码<br>段的替代记忆码为 cs:、ds:、es: 和 ss:。远程返回的记忆码是 retf。字符串处理的记忆码必须明确声明字符串大小。例如，使用 movsw 可以移动 16 位的字串，使用 movsb 可以移动 8 位字节串。<br>汇编跳转和调用<br>汇编程序根据字节替换自动将短、近和远的跳转及调用汇编到目标地址。通过使用 near 或 far 前缀可以替代这样的跳转或调用，如下例所示：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-a0100:<span class="number">0</span>500</span><br><span class="line"><span class="number">0</span>100:<span class="number">0</span>500 jmp <span class="number">502</span> ; a <span class="number">2</span>-<span class="keyword">byte</span> <span class="built_in">short</span> jump</span><br><span class="line"><span class="number">0</span>100:<span class="number">0</span>502 jmp near <span class="number">505</span> ; a <span class="number">3</span>-<span class="keyword">byte</span> near jump</span><br><span class="line"><span class="number">0</span>100:<span class="number">0</span>505 jmp far <span class="number">50</span>a ; a <span class="number">5</span>-<span class="keyword">byte</span> far jump</span><br></pre></td></tr></table></figure><p>可以将 near 前缀缩写为 ne。<br>区分字和字节内存位置<br>当某个操作数可以引用某个字内存位置或者字节内存位置时，必须用前缀 word ptr 或者前缀 byte ptr 指定数据类型。可接受的缩写分别是 wo 和 by。以下范例显示两种格式：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dec wo [si]</span><br><span class="line">neg <span class="keyword">byte</span> ptr [<span class="number">128</span>]</span><br></pre></td></tr></table></figure><p>指定操作数<br>Debug 使用包括在中括号 ([ ]) 的操作数引用内存地址的习惯用法。这是因为另一方面 Debug 不能区分立即操作数和内存地址的操作数。以下范例显示两种格式：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov ax,<span class="number">21</span> ; load AX <span class="keyword">with</span> <span class="number">21</span>h</span><br><span class="line">mov ax,[<span class="number">21</span>] ; load AX <span class="keyword">with</span> the</span><br><span class="line">; contents of</span><br><span class="line">; memory location <span class="number">21</span>h</span><br></pre></td></tr></table></figure><p>使用伪指令<br>使用 a 命令提供两个常用的伪指令：db 操作码，将字节值直接汇编到内存，dw 操作码，将字值直接汇编到内存。以下是两个伪指令的范例：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,”THIS IS AN EXAMPLE”</span><br><span class="line">db ‘THIS IS A QUOTATION MARK:”‘</span><br><span class="line">db “THIS IS A QUOTATION MARK:<span class="string">&#x27;”</span></span><br><span class="line"><span class="string">dw 1000,2000,3000,”BACH”</span></span><br></pre></td></tr></table></figure><p>范例<br>a 命令支持所有形式的间接注册命令，如下例所示：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">add bx,<span class="number">34</span>[bp+<span class="number">2</span>].[si-<span class="number">1</span>]</span><br><span class="line">pop [bp+di]</span><br><span class="line">push [si] )</span><br></pre></td></tr></table></figure><p>还支持所有操作码同义词，如下例所示：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">loopz <span class="number">100</span></span><br><span class="line">loope <span class="number">100</span></span><br><span class="line">ja <span class="number">200</span></span><br><span class="line">jnbe <span class="number">200</span></span><br></pre></td></tr></table></figure><p>对于 8087 操作码，必须指定 wait 或 fwait 前缀，如下例所示：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fwait fadd st,st(<span class="number">3</span>) ; <span class="keyword">this</span> line assembles</span><br><span class="line">; an fwait prefix</span><br></pre></td></tr></table></figure><p>Debug:C（比较）<br>比较内存的两个部分。<br>c range address<br>参数<br>range<br>指定要比较的内存第一个区域的起始和结束地址，或起始地址和长度。有关有效的 range 值的信息，请单击“相关主题”列表中的“Debug 说明”。<br>address<br>指定要比较的第二个内存区域的起始地址。有关有效 address 值的信息，请单击“相关主题”列表中的“Debug 说明”。<br>说明<br>如果 range 和 address 内存区域相同，Debug 将不显示任何内容而直接返回到 Debug 提示符。如果有差异，Debug 将按如下格式显示：<br>address1 byte1 byte2 addess2<br>范例<br>以下命令具有相同效果：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c100,<span class="number">10</span>f <span class="number">300</span></span><br><span class="line">c100l10 <span class="number">300</span></span><br></pre></td></tr></table></figure><p>每个命令都对 100h 到 10Fh 的内存数据块与 300h 到 30Fh 的内存数据块进行比较。<br>Debug 响应前面的命令并显示如下信息（假定 DS = 197F）：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">197</span>F:<span class="number">0</span>100 <span class="number">4</span>D E4 <span class="number">197</span>F:<span class="number">0</span>300</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>101 <span class="number">67</span> <span class="number">99</span> <span class="number">197</span>F:<span class="number">0</span>301</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>102 A3 <span class="number">27</span> <span class="number">197</span>F:<span class="number">0</span>302</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>103 <span class="number">35</span> F3 <span class="number">197</span>F:<span class="number">0</span>303</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>104 <span class="number">97</span> BD <span class="number">197</span>F:<span class="number">0</span>304</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>105 <span class="number">0</span>4 <span class="number">35</span> <span class="number">197</span>F:<span class="number">0</span>305</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>107 <span class="number">76</span> <span class="number">71</span> <span class="number">197</span>F:<span class="number">0</span>307</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>108 E6 <span class="number">11</span> <span class="number">197</span>F:<span class="number">0</span>308</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>109 <span class="number">19</span> <span class="number">2</span>C <span class="number">197</span>F:<span class="number">0</span>309</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>10A <span class="number">80</span> <span class="number">0</span>A <span class="number">197</span>F:<span class="number">0</span>30A</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>10B <span class="number">36</span> <span class="number">7</span>F <span class="number">197</span>F:<span class="number">0</span>30B</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>10C BE <span class="number">22</span> <span class="number">197</span>F:<span class="number">0</span>30C</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>10D <span class="number">83</span> <span class="number">93</span> <span class="number">197</span>F:<span class="number">0</span>30D</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>10E <span class="number">49</span> <span class="number">77</span> <span class="number">197</span>F:<span class="number">0</span>30E</span><br><span class="line"><span class="number">197</span>F:<span class="number">0</span>10F <span class="number">4</span>F <span class="number">8</span>A <span class="number">197</span>F:<span class="number">0</span>30F</span><br></pre></td></tr></table></figure><p>注意列表中缺少地址 197F:0106 和 197F:0306。这表明那些地址中的值是相同的。<br>Debug:D（转储）<br>显示一定范围内存地址的内容。<br>d [range]<br>参数<br>range<br>指定要显示其内容的内存区域的起始和结束地址，或起始地址和长度。有关有效的 range 值的信息，请单击“相关主题”列表中的“Debug 说明”。如果不指定 range，Debug 程序将从以前 d 命令中所指定的地址范围的末尾开始显示 128 个字节的内容。<br>有关显示寄存器内容的信息，请单击“相关主题”列表中的 Debug R（寄存器）。<br>说明<br>当使用 d 命令时，Debug 以两个部分显示内存内容：十六进制部分（每个字节的值都用十六进制格式表示）和 ASCII 码部分（每个字节的值都用 ASCII 码字符表示)。每个非打印字符在显示的 ASCII 部分由句号 (.) 表示。每个显示行显示 16 字节的内容，第 8 字节和第 9 字节之间有一个连字符。每个显示行从 16 字节的边界上开始。<br>范例<br>假定键入以下命令：<br>dcs:100 10f<br>Debug 按以下格式显示范围中的内容：<br>04BA:0100 54 4F 4D 00 53 41 57 59-45 52 00 00 00 00 00 00 TOM.SAWYER……<br>如果在没有参数的情况下键入 d 命令，Debug 按以前范例中所描述的内容来编排显示格式。显示的每行以比前一行的地址大 16 个字节（如果是显示 40 列的屏幕，则为 8 个字节）的地址开头。<br>对于后面键入的每个不带参数的 d 命令，Debug 将紧接在最后显示的命令后立即显示字节内容。<br>如果键入以下命令，Debug 将从 CS:100 开始显示 20h 个字节的内容：<br>dcs:100 l 20<br>如果键入以下命令，Debug 将显示范围从 CS 段的 100h 到 115h 中所有字节的内容：<br>dcs:100 115<br>Debug:E（键入）<br>将数据输入到内存中指定的地址。<br>可以按十六进制或 ASCII 格式键入数据。以前存储在指定位置的任何数据全部丢失。<br>e address<br>参数<br>address<br>指定输入数据的第一个内存位置。<br>list<br>指定要输入到内存的连续字节中的数据。<br>有关集成记忆码的信息，请单击“相关主题”列表中的 Debug A（汇编）。<br>有关显示内存部分内容的信息，请单击“相关主题”列表中的 Debug D （转储）。<br>说明<br>使用 address 参数<br>如果在没有指定可选的 list 参数的值情况下指定 address 的值，Debug 将显示地址和内容，在下一行重复地址，并等待您的输入。此时，您可以执行下列操作之一：<br>替换字节值。为此，请在当前值后键入新值。如果您键入的值不是有效的十六进制值，或该值包含两个以上的数字，则 Debug 不会回显无效或额外的字符。<br>进入下一个字节。为此，请按 SPACEBAR（空格键）。要更改该字节中的值，请在当前值后键入新值。如果按 SPACEBAR（空格键）时，移动超过了 8 位界限，Debug 程序将显示新的一行并在行首显示新地址。<br>返回到前一个字节。为此，请按 HYPHEN 键 (-)。可以反复按 HYPHEN 键 (-) 向后移动超过多个字节。在按 HYPHEN 时，Debug 开始新行并显示当前地址和字节值。<br>停止执行 e 命令。为此，请按 ENTER 键。在任何字节位置都可以按 ENTER。<br>使用 list 参数<br>如果指定 list 参数的值，随后的 e 命令将使用列表中的值替换现有的字节值。如果发生错误，将不更改任何字节值。<br>List 值可以是十六进制字节或字符串。使用空格、逗号或制表符来分隔值。必须将字符串包括在单或双引号中。<br>范例<br>假定键入以下命令：<br>ecs:100<br>Debug 按下面的格式显示第一个字节的内容：<br>04BA:0100 EB.<br>要将该值更改为 41，请在插入点键入 41，如下所示：<br>04BA:0100 EB.41_<br>可以用一个 e 命令键入连续的字节值。在键入新值后按 SPACEBAR（空格键），而不是按 ENTER 键。Debug 显示下一个值。在此范例中，如果按三次 SPACEBAR（空格键），Debug 将显示下面的值：<br>04BA:0100 EB.41 10. 00. BC._<br>要将十六进制值 BC 更改为 42，请在插入点键入 42，如下所示：<br>04BA:0100 EB.41 10. 00. BC.42_<br>假定决定值 10 应该是 6F。要纠正该值，请按 HYPHEN 键两次以返回到地址 0101（值 10）。Debug 显示以下内容：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>100 EB<span class="number">.41</span> <span class="number">10.</span> <span class="number">00.</span> BC<span class="number">.42</span>-</span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>102 <span class="number">00.</span>-</span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>101 <span class="number">10.</span>_</span><br></pre></td></tr></table></figure><p>在插入点键入 6f 更改值，如下所示：<br>04BA:0101 10.6f_<br>按 ENTER 停止 e 命令并返回到 Debug 提示符下。<br>以下是字符串项的范例：<br>eds:100 “This is the text example”<br>该字符串将从 DS:100 开始填充 24 个字节<br>Debug:F（填充）<br>使用指定的值填充指定内存区域中的地址。<br>可以指定十六进制或 ASCII 格式表示的数据。任何以前存储在指定位置的数据将会丢失。<br>参数<br>range<br>指定要填充内存区域的起始和结束地址，或起始地址和长度。关于有效的 range 值的信息，请单击“相关主题”列表中的“Debug 说明”。<br>list<br>指定要输入的数据。List 可以由十六进制数或引号包括起来的字符串组成。<br>说明<br>使用 range 参数<br>如果 range 包含的字节数比 list 中的数值大，Debug 将在 list 中反复指派值，直到 range 中的所有字节全部填充。<br>如果在 range 中的任何内存损坏或不存在，Debug 将显示错误消息并停止 f 命令。<br>使用 list 参数<br>如果 list 包含的数值多于 range 中的字节数，Debug 将忽略 list 中额外的值。<br>范例<br>假定键入以下命令：<br>f04ba:100l100 42 45 52 54 41<br>作为响应，Debug 使用指定的值填充从 04BA:100 到 04BA:1FF 的内存位置。Debug 重复这五个值直到 100h 个字节全部填满为止。<br>Debug:G（转向）<br>运行当前在内存中的程序。<br>g [=address] [breakpoints]<br>参数<br>=address<br>指定当前在内存中要开始执行的程序地址。如果不指定 address，Windows 2000 将从 CS:IP 寄存器中的当前地址开始执行程序。<br>breakpoints<br>指定可以设置为 g 命令的部分的 1 到 10 个临时断点。<br>有关执行循环、重复的字符串指令、软件中断或子程序的信息，请单击“相关主题”列表中的 Debug P（执行）。<br>有关执行指令的信息，请单击“相关主题”列表中的 Debug T（跟踪）。<br>Debug:H（十六进制）<br>对指定的两个参数执行十六进制运算。<br>h value1 value2<br>参数<br>value1<br>代表从 0 到 FFFFh 范围内的任何十六进制数字。<br>value2<br>代表从 0 到 FFFFh 范围内第二个十六进制数字。<br>说明<br>Debug 首先将指定的两个参数相加，然后从第一个参数中减去第二个参数。这些计算的结果显示在一行中：先计算和，然后计算差。<br>范例<br>假定键入以下命令：<br>h19f 10a<br>Debug 执行运算并显示以下结果。<br>02A9 0095<br>Debug:I（输入）<br>从指定的端口读取并显示一个字节值。<br>i port<br>参数<br>port<br>按地址指定输入端口。地址可以是 16 位的值。<br>有关将字节值发送到输出端口的信息，请单击“相关主题”列表中的 Debug O（输出）。<br>范例<br>假定键入以下命令：<br>i2f8<br>同时假定端口的字节值是 42h。Debug 读取该字节，并将其值显示如下：<br>42<br>Debug:L（加载）<br>将某个文件或特定磁盘扇区的内容加载到内存。<br>要从磁盘文件加载 BX:CX 寄存器中指定的字节数内容，请使用以下语法：<br>l [address]<br>要略过 Windows 2000 文件系统并直接加载特定的扇区，请使用以下语法：<br>l address drive start number<br>参数<br>address<br>指定要在其中加载文件或扇区内容的内存位置。如果不指定 address，Debug 将使用 CS 寄存器中的当前地址。<br>drive<br>指定包含读取指定扇区的磁盘的驱动器。该值是数值型：0 = A, 1 = B, 2 = C 等。<br>start<br>指定要加载其内容的第一个扇区的十六进制数。<br>number<br>指定要加载其内容的连续扇区的十六进制数。只有要加载特定扇区的内容而不是加载 debug 命令行或最近的 Debug n（名称）命令中指定的文件时，才能使用 drive、start 和 number 参数。<br>有关指定用于 l 命令的文件的信息，请单击“相关主题”列表中的 Debug n（名称）。<br>有关写入调试到磁盘的文件的信息，请单击“相关主题”列表中的 Debug w（写入）。<br>注意<br>使用不带参数的 l 命令<br>当使用不带参数的 l 命令时，在 debug 命令行上指定的文件将加载到内存中，从地址 CS:100 开始。Debug 同时将 BX 和 CX 寄存器设置为加载的字节数。如果不在 debug 命令行指定文件，所装入的文件将是最近使用 n 命令经常指定的文件。<br>使用具有 address 参数的 1 命令<br>如果使用带 address 参数的 l 命令，Debug 将从内存位置 address 开始加载文件或指定扇区的内容。<br>使用带全部参数的 l 命令<br>如果使用带所有参数的 l 命令，Debug 将加载指定磁盘扇区的内容而不是加载文件。<br>加载特定扇区的内容<br>指定范围内的每个扇区均从 drive 读取。Debug 从 start 开始加载，直到在 number 中指定的扇区数中的内容全部被加载。<br>加载 .exe 文件<br>Debug 忽略 .exe 文件的地址 address 参数。如果指定 .exe 文件，Debug 将文件重新定位到 .exe 文件的标题中指定的加载地址。在 .exe 文件被加载到内存前，标题自身从 .exe 文件脱离，因此磁盘上的 .exe 文件大小与内存中的不同。如果要检查整个 .exe 文件，请使用不同的扩展名重命名文件。<br>打开十六进制文件<br>Debug 将具有 .hex 扩展名的文件认为十六进制格式文件。键入不带参数的 l 命令，可以加载从十六进制文件中指定的地址处开始的十六进制文件。如果键入的 l 命令包含 address 参数，Debug 将把指定的地址加到在十六进制文件中找到的地址上，以确定起始地址。<br>范例<br>假定启动 Debug 并键入以下命令：<br>nfile.com<br>现在可以键入 l 命令以加载 File.com。Debug 将加载文件并显示 Debug 提示符。<br>假定需要从驱动器 C 将起始逻辑扇区为 15 (0Fh) 的 109 (6Dh) 个扇区的内容加载到起始地址为 04BA:0100 的内存中。为此，请键入以下命令：<br>l04ba:100 2 0f 6d<br>Debug:M（移动）<br>将一个内存块中的内容复制到另一个内存块中。<br>m range address<br>参数<br>range<br>指定要复制内容的内存区域的起始和结束地址，或起始地址和长度。<br>address<br>指定要将 range 内容复制到该位置的起始地址。<br>说明<br>复制操作对现有数据的影响<br>如果新数据没有写入正在被复制的数据块中的地址，则源数据将保持不变。但是，如果目标块已经包含数据(就象它在覆盖副本操作中一样)，则将改写该数据。（覆盖复制操作是指那些目标数据块部分内容覆盖原数据块部分内容的操作。）<br>执行覆盖复制操作<br>m 命令执行目标地址的覆盖复制操作，而不丢失数据。将改写的地址内容首先复制。因此，如果将较高位地址的数据复制到较低位地址，则复制操作从原块的最低位地址开始并向最高位地址进行。反之，如果要将数据从低地址复制到高地址，复制操作从原块的最高地址开始，向最低地址进行。<br>范例<br>假定键入以下命令：<br>mcs:100 110 cs:500<br>Debug 首先将 CS:110 地址中的内容复制到地址 CS:510 中，然后将 CS:10F 地址中的内容复制到 CS:50F 中，如此操作直至将 CS:100 地址中的内容复制到地址 CS:500 中。要查看结果，请使用 Debug d（转储）命令，并使用 m 命令指定目标地址<br>Debug:N（名称）<br>指定 Debug l（加载）或 w（写入）命令的可执行文件的名称，或者指定正在调试的可执行文件的参数。<br>n [drive:][path] filename<br>要指定测试的可执行文件的参数，请使用以下语法：<br>n file-parameters<br>参数<br>如果在没有参数的情况下使用，则 n 命令清除当前规范。<br>[drive:][path] filename<br>指定要测试的可执行文件的位置和名称。<br>file-parameters<br>为正在测试的可执行文件指定参数和开关。<br>有关将文件或指定磁盘扇区的内容加载到内存中的信息，请单击“相关主题”列表中的 Debug L（加载）。<br>有关写入调试到磁盘的文件的信息，请单击“相关主题”列表中的 Debug W（写入）。<br>说明<br>n 命令的两个用途<br>可以按两种方式使用 n 命令。首先，您可以使用它以指定后面的 l（加载）或 w（写入）命令所使用的文件。如果在没有命名所调试文件的情况下启动 Debug，必须在使用 l 命令加载文件之前使用命令 nfilename。在 CS:5C 为文件控制块 (FCB) 正确编排文件名的格式。其次，可以使用 n 命令指定被调试文件的命令行参数和开关。<br>内存区域<br>以下四个内存区域都会受到 n 命令的影响：<br>内存位置<br>内容<br>CS:5C<br>文件 1 的文件控制数据块 (FCB)<br>CS:6C<br>文件 2 的文件控制数据块 (FCB)<br>CS:80<br>n 命令行的长度（以字符表示）<br>CS:81<br>n 命令行字符的开头<br>为 n 命令指定的第一个文件名被放在 CS:5C 的 FCB 中。如果指定第二个文件名，此名称将放置到 CS:6C 的 FCB 中。n 命令行上键入的字符数（除第一个字符之外，n）存储在位置 CS:80。n 命令行上的实际字符（再次，除了字母 n 之外）存储在以 CS:81 开头的位置。注意这些字符可以是在 Windows 2000 命令提示符下键入的命令中有效的任何开关和分隔符。<br>范例<br>假定已经启动 Debug，并加载了正在调试的程序 Prog.com。接着您决定为 Prog.com 指定两个参数并运行此程序。以下是此范例的命令序列：<br>debug prog.com<br>nparam1 param2<br>g<br>在这种情况下，Debug g（转向）命令会运行该程序，就好像您已在 Windows 2000 命令提示符后键入了如下命令：<br>prog param1 param2<br>所以，测试和调试反映 Prog.com 通常的运行时间环境。<br>在下面的命令序列中，第一个 n 命令将 File1.exe 指定为后接的 l（加载）命令的文件，该命令将 File1.exe 加载到内存。第二个 n 命令指定 File1.exe 将使用的参数。最后，g 命令将运行 File1.exe 文件，就好像您在 Windows 2000 命令行中键入了 File1 File2.dat File2.dat 一样。<br>nfile1.exe<br>l<br>nfile2.dat file3.dat<br>g<br>注意<br>不要在 n 命令的第二种形式后使用 l 命令。还要注意，如果现在使用 w（写入）命令，Windows 2000 将使用名称 File2.dat 保存正在调试的文件 File1.exe。为避免出现此结果，应该总是在 l 或 w 命令之前立即使用 n 命令的第一种形式。<br>Debug:O（输出）<br>将字节值发送到输出端口。<br>o port byte-value<br>参数<br>port<br>通过地址指定输出端口。端口地址可以是 16 位值。<br>byte-value<br>指定要指向 port 的字节值。<br>有关从输入端口读取字节值的信息，请单击“相关主题”列表中的 Debug I（输入）。<br>范例<br>要将字节值 4Fh 发送到地址为 2F8h 的输出端口，请键入以下命令：<br>o2f8 4f<br>Debug:P（执行）<br>执行循环、重复的字符串指令、软件中断或子例程；或通过任何其他指令跟踪。<br>参数<br>=address<br>指定第一个要执行指令的位置。如果不指定地址，则默认地址是在 CS:IP 寄存器中指定的当前地址。<br>number<br>指定在将控制返回给 Debug 之前要执行的指令数。默认值为 1。<br>有关运行当前在内存中程序的信息，请单击“相关主题”列表中的 Debug G（转向）。<br>有关执行指令的信息，请单击“相关主题”列表中的 Debug T（跟踪）。<br>说明<br>控制传送到要测试的程序<br>当 p 命令将控制从 Debug 传送到要测试的程序时，该程序不间断运行，直到循环、重复字符串指令、软件中断或者完成了指定地址的子例程为止，或者直到执行了指定数量的机器指令为止。控制返回到 Debug。<br>地址参数的限制<br>如果 address 参数没有指定段，Debug 将使用被测试程序的 CS 寄存器。如果省略 address，程序将从 CS:IP 寄存器所指定的地址开始执行。必须在 address 参数之前使用等号 (=) 以便将它与 number 参数区分。如果在指定地址处的指令不是循环、重复的字符串指令、软件中断或子例程，则 p 命令与 Debug t（跟踪）命令的作用相同。<br>使用 p 命令显示的邮件<br>当 p 执行完一段说明后，Debug 显示出程序的寄存器内容、标志的状态以及下一段将要被执行的指令的解码形式。<br>警告<br>不能使用 p 命令跟踪只读内存 (ROM)。<br>范例<br>假定正在测试的程序在地址 CS:143F 处包含一个 call 指令。要运行 call 目标位置的子程序然后将控制返回到 Debug，请键入以下命令：<br>p=143f<br>Debug 按以下格式显示结果：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AX=<span class="number">0</span>000 BX=<span class="number">0</span>000 CX=<span class="number">0</span>000 DX=<span class="number">0</span>000 SP=FFEE BP=<span class="number">0</span>000 SI=<span class="number">0</span>000 DI=<span class="number">0</span>000</span><br><span class="line">DS=<span class="number">2246</span> ES=<span class="number">2246</span> SS=<span class="number">2246</span> CS=<span class="number">2246</span> IP=<span class="number">1443</span> NV UP EI PL NZ AC PO NC</span><br><span class="line"><span class="number">2246</span>:<span class="number">1442</span> <span class="number">7505</span> JNZ <span class="number">144</span>A</span><br><span class="line">Debug:Q（退出）</span><br></pre></td></tr></table></figure><p>停止 Debug 会话，不保存当前测试的文件。<br>当您键入 q 以后，控制返回到 Windows 2000 的命令提示符。<br>q<br>参数<br>该命令不带参数。<br>有关保存文件的信息，请单击“相关主题”列表中的 Debug W（写入）。<br>Debug:R（寄存器）<br>显示或改变一个或多个 CPU 寄存器的内容。<br>r [register-name]<br>参数<br>无<br>如果在没有参数的情况下使用，则 r 命令显示所有寄存器的内容以及寄存器存储区域中的标志。<br>register-name<br>指定要显示其内容的寄存器名。<br>有关显示内存部分内容的信息，请单击“相关主题”列表中的 Debug D（转储）。<br>有关反汇编字节的信息，请单击“相关主题”列表中的 Debug U（反汇编）。<br>说明<br>使用 r 命令<br>如果指定了寄存器名称，Windows 2000 将显示以十六进制标记表示的寄存器的 16 位值，并将冒号显示为提示符。如果要更改包含在寄存器中的值，除非键入新值并按 ENTER 键；否则，请按 ENTER 键返回 Debug 提示符。<br>有效寄存器名<br>以下是 register-name 的有效值：ax、bx、cx、dx、sp、bp、si、di、ds、es、ss、cs、ip、pc 及 f。ip 和 pc 都引用指令指针。<br>如果指定寄存器名称，而不是从前面的列表中指定，Windows 2000 将显示以下消息：<br>br error<br>使用 f 字符而不是寄存器名<br>如果键入 f 字符代替寄存器名，Debug 将每个标记的当前设置显示为两字母代码，然后显示 Debug 提示符。要更改标志的设置，请从下表中键入适当的两字母代码：<br>标志名<br>设置<br>清除<br>溢出<br>ov<br>nv<br>方向<br>dn（减）<br>up（增）<br>中断<br>ei（启用）<br>di（禁用）<br>正负<br>ng（负）<br>pl（正）<br>零<br>zr<br>nz<br>辅助进位<br>ac<br>na<br>奇偶校验<br>pe（偶校验）<br>po（奇校验）<br>进位<br>cy<br>nc<br>可以按任何顺序键入新的标志值。不需要在这些值之间留出空格。要停止 r 命令，请按 ENTER 键。任何没有指定新值的标志保持不变。<br>用 r 命令显示的邮件<br>如果为标记指定了多个值，Debug 将显示以下消息：<br>df error<br>如果指定没有在前面的表中列出的标志代码，Debug 将显示以下消息：<br>bf error<br>在这两种情况下，Debug 将忽略所有在无效项目之后指定的设置。<br>Debug 的默认设置<br>在启动 Debug 时，会将段寄存器设置到空闲内存的低端，指令指针设置为 0100h，清除所有标志，并且将其余寄存器设置为零，除了被设置为 FFEEh 的 sp 之外。<br>Debug:R<br>范例<br>要查看所有寄存器的内容、所有标记的状态和当前位置的指令解码表，请键入以下命令：<br>r<br>如果当前位置是 CS:11A，显示外观将类似于以下内容：<br>AX=0E00 BX=00FF CX=0007 DX=01FF SP=039D BP=0000 SI=005C DI=0000<br>DS=04BA ES=04BA SS=04BA CS=O4BA IP=011A NV UP DI NG NZ AC PE NC<br>04BA:011A CD21 INT 21<br>要只查看标志的状态，请键入以下命令：<br>rf<br>Debug 按以下格式显示信息：<br>NV UP DI NG NZ AC PE NC – _<br>现在，您可以按任意顺序键入一个或多个有效的标志值，其中可以有或没有空格，如下所示：<br>nv up di ng nz ac pe nc – pleicy<br>Debug 结束 r 命令并显示 Debug 提示符。要查看更改，请键入 r 或 rf 命令。Debug 将显示以下内容：<br>NV UP EI PL NZ AC PE CY – _<br>按 ENTER 返回到 Debug 提示符。<br>Debug:S（搜索）<br>在某个地址范围搜索一个或多个字节值的模式。<br>s range list<br>参数<br>range<br>指定要搜索范围的开始和结束地址。有关 range 参数有效值的信息，请单击“相关主题”列表中的 Debug。<br>list<br>指定一个或多个字节值的模式，或要搜索的字符串。用空格或逗号分隔每个字节值和下一个字节值。将字符串值包括在引号中。<br>说明<br>如果 list 参数包含多个字节值，Debug 将只显示出现字节值的第一个地址。如果 list 只包含一个字节值，Debug 将显示指定范围内出现该值的所有地址。<br>范例<br>假定需要查找包含值 41 并且范围从 CS:100 到 CS:110 的所有地址。为此，请键入以下命令：<br>scs:100 110 41<br>Debug 按以下格式显示结果：<br>04BA:0104<br>04BA:010D<br>–<br>以下命令在 CS:100 到 CS:1A0 的范围内搜索字符串“Ph”。<br>scs:100 1a0 “Ph”<br>Debug:U（反汇编）<br>反汇编字节并显示相应的原语句，其中包括地址和字节值。反汇编代码看起来象已汇编文件的列表。<br>u [range]<br>参数<br>无<br>如果在没有参数的情况下使用，则 u 命令分解 20h 字节（默认值），从前面 u 命令所显示地址后的第一个地址开始。<br>range<br>指定要反汇编代码的起始地址和结束地址，或起始地址和长度。有关 range 参数有效值的信息，请单击“相关主题”列表中的 Debug。<br>有关集成记忆码的信息，请单击“相关主题”列表中的 Debug A（汇编）。<br>有关显示内存部分内容的信息，请单击“相关主题”列表中的 Debug D（转储）。<br>范例<br>要反汇编 16 (10h) 字节，从地址 04BA:0100 开始，请键入以下命令：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">u04ba:<span class="number">100</span>l10</span><br><span class="line">Debug 按以下格式显示结果：</span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>100 <span class="number">206472</span> AND [SI+<span class="number">72</span>],AH</span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>103 <span class="number">69</span> DB <span class="number">69</span></span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>104 <span class="number">7665</span> JBE <span class="number">0</span>16B</span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>106 <span class="number">207370</span> AND [BP+DI+<span class="number">70</span>],DH</span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>109 <span class="number">65</span> DB <span class="number">65</span></span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>10A <span class="number">63</span> DB <span class="number">63</span></span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>10B <span class="number">69</span> DB <span class="number">69</span></span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>10C <span class="number">66</span> DB <span class="number">66</span></span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>10D <span class="number">69</span> DB <span class="number">69</span></span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>10E <span class="number">63</span> DB <span class="number">63</span></span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>10F <span class="number">61</span> DB <span class="number">61</span></span><br></pre></td></tr></table></figure><p>如果只显示从 04BA:0100 到 04BA:0108 特定地址的信息，请键入以下命令：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">u04ba:<span class="number">0</span>100 <span class="number">0</span>108</span><br><span class="line">Debug 显示以下内容：</span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>100 <span class="number">206472</span> AND [SI+<span class="number">72</span>],AH</span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>103 <span class="number">69</span> DB <span class="number">69</span></span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>104 <span class="number">7665</span> JBE <span class="number">0</span>16B</span><br><span class="line"><span class="number">0</span>4BA:<span class="number">0</span>106 <span class="number">207370</span> AND [BP+DI+<span class="number">70</span>],DH</span><br><span class="line">Debug:W（写入）</span><br></pre></td></tr></table></figure><p>将文件或特定分区写入磁盘。<br>要将在 BX:CX 寄存器中指定字节数的内容写入磁盘文件，请使用以下语法：<br>w [address]<br>要略过 Windows 2000 文件系统并直接写入特定的扇区，请使用以下语法：<br>w address drive start number<br>参数<br>address<br>指定要写到磁盘文件的文件或部分文件的起始内存地址。如果不指定 address，Debug 程序将从 CS:100 开始。关于 address 参数有效值的信息，请在“相关主题”列表中单击 Debug。<br>drive<br>指定包含目标盘的驱动器。该值是数值型：0 = A, 1 = B, 2 = C,等等。<br>start<br>指定要写入第一个扇区的十六进制数。<br>number<br>指定要写入的扇区数。<br>有关指定用于 w 命令的文件的信息，请单击“相关主题”列表中的 Debug N（名称）。<br>有关将文件或文件扇区内容加载到内存中的信息，请单击“相关主题”列表中的 Debug L（加载）。<br>说明<br>必须在启动 Debug 时或者在最近的 Debug n（名称）命令中指定磁盘文件的名字。这两种方法都可以将地址 CS:5C 处文件控制块的文件名正确地编排格式。<br>在使用不带参数的 w 命令之前重新设置 BX:CX<br>如果使用了 Debug g（转向）、t（跟踪）、p（执行）或 r（寄存器）命令，必须在使用无参数的 w 命令之前，将 BX:CX 寄存器复位。<br>将修改后的文件写入磁盘<br>如果修改文件但不更改文件名、长度或起始地址，Debug 仍然可以正确地将文件写入源磁盘位置。<br>w 命令的限制<br>不能用该命令写入 .exe 或 .hex 文件。<br>警告<br>因为略过 Windows 2000 文件句柄，所以写入特定的分区非常危险。如果键入错误的值，则磁盘文件结构很容易被损坏。<br>范例<br>假定要将起始地址为 CS:100 的内存内容写入到驱动器 B 的磁盘中。需要将数据从磁盘的逻辑扇区号 37h 开始并持续 2Bh 个扇区。为此，键入以下命令：<br>wcs:100 1 37 2b<br>当写操作完成时，Debug 再次显示 Debug 提示符。<br>Debug:XA（分配扩展内存）<br>分配扩展内存的指定页面数。<br>要使用扩展内存，必须安装符合 4.0 版的 Lotus/Intel/Microsoft 扩展内存规范 (LIM EMS) 的扩展内存设备驱动程序。<br>xa [count]<br>参数<br>count<br>指定要分配的扩展内存的 16KB 页数。<br>有关使用扩展内存的其他 Debug 命令的信息，请单击“相关主题”列表中的 XD（释放扩展内存）、XM（映射扩展内存页）或 XS（显示扩展内存状态）。<br>说明<br>如果指定的页面数可用，则 Debug 将显示消息，此消息表明所创建的句柄的十六进制数；否则，Debug 将显示错误消息。<br>Debug:XA<br>范例<br>要分配扩展内存的 8 个页面，请键入以下命令：<br>xa8<br>如果命令成功，Debug 将显示类似的以下消息：<br>Handle created=0003<br>Debug:XD（释放扩展内存）<br>释放指向扩展内存的句柄。<br>要使用扩展内存，必须安装符合 4.0 版的 Lotus/Intel/Microsoft 扩展内存规范 (LIM EMS) 的扩展内存设备驱动程序。<br>xd [handle]<br>参数<br>handle<br>指定要释放的句柄。<br>有关使用扩展内存的其他 Debug 命令的信息，请单击“相关主题”列表中 XA（分配扩展内存）、XM（映射扩展内存页） 或 XS（显示扩展内存状态）。<br>范例<br>要释放句柄 0003，请键入以下命令：<br>xd 0003<br>如果命令成功，Debug 将显示下列消息：<br>Hdle 0003 deallocated<br>Debug:XM（映射扩展内存页）<br>将属于指定句柄的扩展内存逻辑页映射到扩展内存的物理页。<br>要使用扩展内存，必须安装符合 4.0 版的 Lotus/Intel/Microsoft 扩展内存规范 (LIM EMS) 的扩展内存设备驱动程序。<br>xm [lpage] [ppage] [handle]<br>参数<br>lpage<br>指定要映射到物理页 ppage 的扩展内存的逻辑页面号。<br>ppage<br>指定将 lpage 映射到的物理页面号。<br>handle<br>指定句柄。<br>有关使用扩展内存的其他 Debug 命令的信息，请单击“相关主题”列表中的 XA（分配扩展内存）、XD（释放扩展内存）或 XS（显示扩展内存）。<br>范例<br>要将句柄 0003 的逻辑页 5 映射到物理页 2，请键入以下命令：<br>xm 5 2 0003<br>如果命令成功，Debug 将显示下列消息：<br>Logical page 05 mapped to physical page 02<br>Debug:XS（显示扩展内存状态）<br>显示有关扩展内存状态的信息。<br>要使用扩展内存，必须安装符合 4.0 版的 Lotus/Intel/Microsoft 扩展内存规范 (LIM EMS) 的扩展内存设备驱动程序。<br>xs<br>参数<br>该命令不带参数。<br>有关使用扩展内存的其他 Debug 命令的信息，请单击“相关主题”列表中的 XA（分配扩展内存）、XD（释放扩展内存）或 XM（映射扩展内存页）。<br>说明<br>Debug 显示的信息有如下格式：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Handle xx has xx pages allocated</span><br><span class="line">Physical page xx = Frame segment xx</span><br><span class="line">xx of a total xx EMS pages have been allocated</span><br><span class="line">xx of a total xx EMS handles have been allocated</span><br></pre></td></tr></table></figure><p>范例<br>要显示扩展内存信息，请键入以下命令：<br>xs<br>Debug 显示与以下类似的信息：</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Handle <span class="number">0</span>000 has <span class="number">0</span>000 pages allocated</span><br><span class="line">Handle <span class="number">0</span>001 has <span class="number">0</span>002 pages allocated</span><br><span class="line">Physical page <span class="number">0</span>0 = Frame segment C000</span><br><span class="line">Physical page <span class="number">0</span>1 = Frame segment C400</span><br><span class="line">Physical page <span class="number">0</span>2 = Frame segment C800</span><br><span class="line">Physical page <span class="number">0</span>3 = Frame segment CC00</span><br><span class="line"><span class="number">2</span> of a total <span class="number">80</span> EMS pages have been allocated</span><br><span class="line"><span class="number">2</span> of a total FF EMS handles have been allocated</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> debug使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何查看分析蓝屏代码dmp文件?</title>
      <link href="/page/2367243845/"/>
      <url>/page/2367243845/</url>
      
        <content type="html"><![CDATA[<p>当您在运行Microsoft Windows 2000/XP/Server 2003、Microsoft Windows Vista/Server 2008、Microsoft Windows 7操作系统时，Windows可能会突然停止正常运行，并显示一副含有下述字样的蓝色背景错误信息画面：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A problem has been detected and Windows has been shut down to prevent damage to your computer.</span><br><span class="line"></span><br><span class="line">……</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>此蓝色背景错误信息画面一般简称为“蓝屏（Blue Screen）”或“停止屏（Stop Error Screen）”，它可能会长时间停留在显示屏；也可能会在短时间显示之后自动重新启动计算机。windows蓝屏分析的方法是什么，遇到windows蓝屏如何查找原因，下面就进行说明!<br><img src="/images/dump.png"></p><h2 id="一-原因分析："><a href="#一-原因分析：" class="headerlink" title="一.原因分析："></a>一.原因分析：</h2><p>如果Windows因系统设置故障、软件故障、硬件故障、驱动程序故障、网络故障等各种类型的故障产生了严重的错误，引起Windows无法继续维持正常运行，Windows出于避免用户数据丢失及损坏计算机的考虑，将自动停止运行并显示“蓝屏”错误信息。</p><p>在默认的系统设置中，Windows 2000遇到“蓝屏”故障后“蓝屏”错误信息将长时间停留在显示屏，直到您关闭或重新启动计算机；Windows XP及后续版本的Windows遇到“蓝屏”故障后“蓝屏”错误信息将在短时间显示之后自动重新启动计算机。<br>“蓝屏”故障发生后是否自动重新启动计算机取决于“启动与故障恢复”设置。您可以在“控制面板”中打开“系统”属性，切换至“高级”选项卡（如果是Windows Vista及以上版本的Windows请在“系统”属性左上方的工具栏中选择“高级系统设置”，确认用户帐户控制（UAC）安全提示，然后再切换至“高级”选项卡），在“高级”选项卡中打开“启动与故障恢复”。您可以在“启动与故障恢复”的选项中找到“自动重新启动”复选框，如果此复选框没有选中，Windows遇到“蓝屏”故障后“蓝屏”错误信息就将长时间停留在显示屏（Windows 2000的默认设置）；如果此复选框被选中，“蓝屏”错误信息就将在短时间显示之后自动重新启动计算机（Windows XP及后续版本的Windows的默认设置）。<br><img src="/images/0.png" alt=""></p><h2 id="二-蓝屏DMP故障文件在哪儿？"><a href="#二-蓝屏DMP故障文件在哪儿？" class="headerlink" title="二.蓝屏DMP故障文件在哪儿？"></a>二.蓝屏DMP故障文件在哪儿？</h2><p>有盘环境，如上图所示，蓝屏dmp就存放在%SystemRoot%\Minidump 目录中 即 c:\windows\Minidump 如果上图中的设置为%SystemRoot%\Minidump.dmp，那么蓝屏故障dmp文件就在c:\windows中的Minidump.dmp文件.</p><p>无盘环境，dmp文件就在无盘服务端软件的相关目录中！根据无盘系统不同，存放位置不同，一般就在无盘软件的dmp目录中!</p><p><strong>WINdbg是什么，我们需要它做什么？</strong></p><p>windbg是在windows平台下，强大的用户态和内核态调试工具。通过windbg工具的分析，我们可以从复杂的代码中找到蓝屏的驱动，文件，进程等来更准确的分析每次蓝屏背后的真凶。</p><h2 id="三，windbg使用方法和技巧。"><a href="#三，windbg使用方法和技巧。" class="headerlink" title="三，windbg使用方法和技巧。"></a>三，windbg使用方法和技巧。</h2><ol><li>运行WinDbg软件，然后按【Ctrl+S】，在弹出的符号表设置窗里面输入SRV<em>C:\Symbols</em><a href="http://msdl.microsoft.com/download/symbols%EF%BC%8C%E7%84%B6%E5%90%8E%E7%82%B9OK%E5%8D%B3%E5%8F%AF%E3%80%82%E5%A6%82%E4%B8%8B%E5%9B%BE%E6%89%80%E7%A4%BA">http://msdl.microsoft.com/download/symbols，然后点OK即可。如下图所示</a><img src="/images/1.png" alt=""></li><li>按【Ctrl+D】，选择相对应的dmp文件，然后确定。如出下图所示，请选择NO跳过。当想打开第二个dmp文件时，需要先按【Shift+F5】来清除上一个dmp分析记录。<img src="/images/2.png" alt=""></li><li>刚开始加载dmp文件可能较慢，等完全加完完毕后（如下图所示），大家对这些信息可能会眼花缭乱，不过没有关系，我们只需要关注几个重要的信息。<img src="/images/3.png" alt=""></li><li>System Uptime（系统正常运行时间），如图所示，我们可以看出，这个顾客开机后7分15秒钟就蓝屏了，下面我们具体分析下这场蓝屏的因素<img src="/images/4.png" alt=""></li><li>Probably caused by（可能蓝屏的原因），如下图所示，Probably caused by : nv4_disp.dll ( nv4_disp+2cacb )，我们可以这次蓝屏可能是 nv4_disp.dll这个文件引起的，让我们继续深入下去。<img src="/images/5.png" alt=""></li><li>!analyze -v命令解析，在下面的对话框输入!analyze -v或点击!analyze -v命令会出现如下图所示，BUGCHECK_STR:  0x8E是指蓝屏代码为8E，PROCESS_NAME:  mir2.dat，这个是指这次蓝屏引起的应用程序。<img src="/images/6.png" alt=""></li><li>！process命令验证，在下面的对话框输入！process命令，会出现如下图所示，基本上可以确定就是mir2.dat了。<img src="/images/7.png" alt="">通过上面7个步骤我们得知了2个重要的信息分别是是nv4_disp.dll和mir2.dat，那么这这2个文件是哪里的？那我们就要去客户机找相关信息了，最后得知 nv4_disp.dllNvidia显卡驱动的一个文件，mir2.dat是传奇世界的文件，由此我们可以判断此次蓝屏是由于显卡驱动的问题导致顾客在玩传奇世界时出问题了，后来果断更新显卡驱动解决了这次蓝屏的问题。</li></ol><p>最后给大家一些分析dmp文件的建议：</p><p>我们知道，电脑蓝屏的因素很多，比如现在进入夏天了，由于天气过热温度过高等的原因也是很有可能导致机器蓝屏，并不是每次dmp文件都能准确的分析出有用的结论，这个还需要大家通过多分析，多总结而获得这方面的经验来对症下药。如果你网吧有200台机器，每天有接近四分之一的机器蓝屏，你可以通过我们软件获取的dmp文件来观察其代码是不是一致，如果是一样或者大多数都一样的代码，可以使用windbg工具按照上面的步骤来分析一下。</p><p>下面提供windbg下载地址：<br>windbg 10：<a href="https://tool.pediy.com/index-detail-5.htm">https://tool.pediy.com/index-detail-5.htm</a><br>windbg 6汉化版：<a href="https://pan.baidu.com/s/1WAwIVwEhjSnNL0a_fV3pHQ">点击下载</a></p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 电脑蓝屏 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpcms整合hdwiki接口文件使用说明及下载</title>
      <link href="/page/3400538132/"/>
      <url>/page/3400538132/</url>
      
        <content type="html"><![CDATA[<p>HDwiki是专为中文用户设计和开发，程序源代码100%完全开放的一个采用 PHP 和 MySQL 数据库构建的高效的中文百科建站解决方案。官方网站为<a href="http://kaiyuan.hudong.com,下载,演示及使用请查看官方网站./">http://kaiyuan.hudong.com，下载，演示及使用请查看官方网站。</a><br>本接口提供时互动百科系统版本为HDWiki5.1 正式版 发布日期：2011-09-27<br>主域名为<a href="http://www.bnwin.com/">www.bnwin.com</a> hdwiki域名为baike.bnwin.com<br>均采用utf-8编码,phpcms v9域名和hdwiki域名应同属不同的子域名，不能采用不用的域名!因为cookie不允许跨域!</p><p>1.在phpcms v9后台的phpsso中添加应用<br>应用名:hdwiki<br>应用地址:<a href="http://baike.bnwin.com/api/">http://baike.bnwin.com/api/</a><br>通信密钥:(点击自动生成)<br>类型:其他<br>应用IP：(保持为空)<br>通信文件：phpsso.php<br>字符集:utf-8<br>同步登录:是</p><p>添加应用后，查看应用ID号，并且复制自动生成的 通信密钥</p><p>2.打开接口文件中的phpssoconfig.php文件，修改define(‘APPID’, 3);中的3为上一步中查看的应用ID号,修改$ps_api_url的地址为phpsso的web地址，修改$ps_auth_key为上一步中自动生成的通信密钥。</p><p>phpssoconfig.php文件中无中文，如果加入中文，需要保存格式为utf-8无bom编码，不加中文可以使用记事本编辑，加入中文就不能使用记事本编辑，可以使用Notepad++编辑。</p><p>保存后把phpssoconfig.php phpsso.php client.class.php复制到hdwiki的api目录下，这三个文件是新增，没有修改hdwiki任何文件。</p><p>覆盖文件后，进入phpcms v9的应用管理，通信状态应该为通信成功。不成功请检查上面的步骤。</p><p>3.修改hdwiki的wiki_user表(安装时采用的默认前缀wiki)，添加字段phpssouid 类型bigint 长度20 小数点0 不允许空值，默认值为0</p><p>4.登录hdwiki后台 全局-&gt;扩展设置-&gt;通行证设置<br>开启通行证:是<br>通行证类型：phpcms<br>通行证方式：客户端client<br>通行证密钥：点击后面生成一个KEY<br>连接程序地址：写phpcms v9主域名如<a href="http://www.bnwin.com/">http://www.bnwin.com</a><br>会员注册地址：/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1<br>会员登录地址：/index.php?m=member&amp;c=index&amp;a=login&amp;siteid=1<br>会员退出地址：/index.php?m=member&amp;c=index&amp;a=logout&amp;siteid=1</p><p>hdwiki的后台对通行证的整合已经做了预置，只要把hdwiki做为客户端，那么hdwiki中的注册，登录，退出链接都会自动跳到你设置的主域名的注册,登录,退出链接地址。</p><p>因为整合的目的，是让用户认为全部系统是完美结合在一起的一个系统。所以用户注册，用户登录，用户修改，用户退出全部系统都应该指向相同的文件。</p><p>下载地址：<br>链接: <a href="https://pan.baidu.com/s/15ioEadpZ7XpW-5yrnfnZSg">https://pan.baidu.com/s/15ioEadpZ7XpW-5yrnfnZSg</a> 提取码: b954 复制这段内容后打开百度网盘手机App，操作更方便哦</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php源码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpcms整合最土团购接口文件使用说明及下载</title>
      <link href="/page/928002874/"/>
      <url>/page/928002874/</url>
      
        <content type="html"><![CDATA[<p>最土团购系统官方网站<a href="http://www.zuitu.com,使用,下载,演示请到官方网站./">http://www.zuitu.com，使用，下载，演示请到官方网站。</a><br>本接口发布时 最土团购系统 版本编号： ZuituGo_CV2.0_20120502 商业版</p><p>主域名为<a href="http://www.bnwin.com/">www.bnwin.com</a> zuitu团购域名为zuitu.bnwin.com<br>均采用utf-8编码,phpcms v9域名和zuitu团购域名应同属不同的子域名，不能采用不用的域名!因为cookie不允许跨域!</p><p>1.在phpcms v9后台的phpsso中添加应用<br>应用名:最土团购<br>应用地址:<a href="http://zuitu.bnwin.com/account/">http://zuitu.bnwin.com/account/</a><br>通信密钥:(点击自动生成)<br>类型:其他<br>应用IP：(保持为空)<br>通信文件：phpsso.php<br>字符集:utf-8<br>同步登录:是</p><p>添加应用后，查看应用ID号，并且复制自动生成的 通信密钥</p><p>2.打开接口文件中的account/phpssoconfig.php文件，修改define(‘APPID’, 4);中的7为上一步中查看的应用ID号,修改$ps_api_url的地址为phpsso的web地址，修改$ps_auth_key为上一步中自动生成的通信密钥。</p><p>phpssoconfig.php文件中无中文，如果加入中文，需要保存格式为utf-8无bom编码，不加中文可以使用记事本编辑，加入中文就不能使用记事本编辑，可以使用Notepad++编辑。</p><p>保存后把account目录复制到最土团购根目录覆盖。接口文件的login.php logout.php对原系统有所修改，你可以事先对团购系统account目录中的这两个文件进行备份,目录中的其他三个文件是新增的。</p><p>覆盖文件后，进入phpcms v9的应用管理，通信状态应该为通信成功。不成功请检查上面的步骤。</p><p>3.修改团购系统的user表，添加字段phpssouid 类型bigint 长度20 小数点0 不允许空值，默认值为0</p><p>建议去掉直接在团购系统注册，因为团购系统注册的密码不能直接保存在phpcms v9中，会出现以phpcmsv9登录时，不能同步登录团购系统。</p><p>因为整合的目的，是让用户认为全部系统是完美结合在一起的一个系统。所以建议，所有整合系统的用户注册，用户登录，用户修改，用户退出全部系统都指向phpcms v9的文件链接,同时去掉被整合系统模板中的修改密码。</p><p>下载地址：<br>链接: <a href="https://pan.baidu.com/s/1SJHbfEbGUdwf2SSIgs9INQ">https://pan.baidu.com/s/1SJHbfEbGUdwf2SSIgs9INQ</a> 提取码: kbqy 复制这段内容后打开百度网盘手机App，操作更方便哦</p><p>部份代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require_once</span>(dirname(dirname(<span class="keyword">__FILE__</span>)) . <span class="string">&#x27;/app.php&#x27;</span>); <span class="keyword">require</span> (<span class="string">&#x27;phpssoconfig.php&#x27;</span>); </span><br><span class="line"> <span class="variable">$code</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;code&#x27;</span>]; parse_str(<span class="variable">$client</span>-&gt;sys_auth(<span class="variable">$code</span>, <span class="string">&#x27;DECODE&#x27;</span>), <span class="variable">$arr</span>); <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$arr</span>[<span class="string">&#x27;action&#x27;</span>])) &#123; <span class="variable">$action</span> = <span class="variable">$arr</span>[<span class="string">&#x27;action&#x27;</span>]; &#125; <span class="keyword">else</span> &#123; <span class="keyword">exit</span>(<span class="string">&#x27;0&#x27;</span>); &#125; <span class="keyword">switch</span>(<span class="variable">$action</span>) &#123; <span class="keyword">case</span> <span class="string">&#x27;check_status&#x27;</span>: <span class="keyword">exit</span>(<span class="string">&#x27;1&#x27;</span>); <span class="keyword">break</span>; <span class="keyword">case</span> <span class="string">&#x27;member_add&#x27;</span>: <span class="variable">$username</span> = <span class="keyword">isset</span>(<span class="variable">$arr</span>[<span class="string">&#x27;username&#x27;</span>]) ? <span class="variable">$arr</span>[<span class="string">&#x27;username&#x27;</span>] : <span class="keyword">exit</span>(<span class="string">&#x27;0&#x27;</span>); <span class="variable">$password</span> = <span class="keyword">isset</span>(<span class="variable">$arr</span>[<span class="string">&#x27;password&#x27;</span>]) ? <span class="variable">$arr</span>[<span class="string">&#x27;password&#x27;</span>] : <span class="keyword">exit</span>(<span class="string">&#x27;0&#x27;</span>); <span class="variable">$email</span> = <span class="keyword">isset</span>(<span class="variable">$arr</span>[<span class="string">&#x27;email&#x27;</span>]) ? <span class="variable">$arr</span>[<span class="string">&#x27;email&#x27;</span>] : <span class="keyword">exit</span>(<span class="string">&#x27;0&#x27;</span>); <span class="variable">$uid</span> = <span class="keyword">isset</span>(<span class="variable">$arr</span>[<span class="string">&#x27;uid&#x27;</span>]) ? <span class="variable">$arr</span>[<span class="string">&#x27;uid&#x27;</span>] : <span class="keyword">exit</span>(<span class="string">&#x27;0&#x27;</span>); <span class="variable">$u</span> = <span class="keyword">array</span>(); <span class="variable">$u</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="variable">$username</span>; <span class="variable">$u</span>[<span class="string">&#x27;password&#x27;</span>] = <span class="variable">$password</span>; <span class="variable">$u</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="variable">$email</span>; <span class="variable">$u</span>[<span class="string">&#x27;city_id&#x27;</span>]=<span class="number">0</span>; <span class="variable">$u</span>[<span class="string">&#x27;phpssouid&#x27;</span>]=<span class="variable">$uid</span>; <span class="keyword">if</span>(<span class="variable">$user_id</span> = ZUser::Create(<span class="variable">$u</span>))&#123;  ZCredit::Register(<span class="variable">$user_id</span>);  <span class="keyword">exit</span>(<span class="string">&#x27;1&#x27;</span>); &#125; <span class="keyword">else</span> &#123;  <span class="keyword">exit</span>(<span class="string">&#x27;0&#x27;</span>); &#125; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="string">&#x27;member_delete&#x27;</span>: <span class="variable">$uidarr</span> = <span class="variable">$arr</span>[<span class="string">&#x27;uids&#x27;</span>]; <span class="keyword">foreach</span>(<span class="variable">$uidarr</span> <span class="keyword">as</span> <span class="variable">$k</span>=&gt;<span class="variable">$v</span>)&#123; <span class="variable">$uid</span>=<span class="variable">$v</span>; <span class="variable">$ids</span> = Table::Fetch(<span class="string">&#x27;user&#x27;</span>, <span class="variable">$uid</span>,<span class="string">&#x27;phpssouid&#x27;</span>); <span class="variable">$id</span>=<span class="variable">$ids</span>[<span class="string">&#x27;id&#x27;</span>];</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php源码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ae模板-央视级震撼大气纪念胜利片头</title>
      <link href="/page/3610687905/"/>
      <url>/page/3610687905/</url>
      
        <content type="html"><![CDATA[<p>Adobe After Effects简称“AE”是Adobe公司推出的一款图形视频处理软件，适用于从事设计和视频特技的机构，包括电视台、动画制作公司、个人后期制作工作室以及多媒体工作室。属于层类型后期软件。</p><p>模板，是指作图或设计方案的固定格式，有时也指DNA复制或转录时，用来产生互补链的核苷酸序列。模板是将一个事物的结构规律予以固定化、标准化的成果，它体现的是结构形式的标准化。</p><p>此模板为:ae模板-央视级震撼大气纪念片头</p><p>要求软件 :AfterEffects CS 6<br>【模板尺寸】1920*1080【时间长度】32秒<br>【文件大小】239M<br>视频预览:<br><video style="width:100%;" src="http://cloud.video.taobao.com/play/u/716884746/p/1/e/6/t/1/50000874445.mp4" controls="" preload="">您的浏览器不支持HTML5的 video 标签，无法为您播放！</video><br>ae模板-央视级震撼大气纪念片头，片头图片截图如下：<br><img class="islazy alignnone size-full" data-original="https://gsnapshot.alicdn.com/imgextra/imgextra/i4/1800366043/TB2bXvKeKJ8puFjy1XbXXagqVXa_!!1800366043.jpg" src="https://gsnapshot.alicdn.com/imgextra/imgextra/i4/1800366043/TB2bXvKeKJ8puFjy1XbXXagqVXa_!!1800366043.jpg" width="748" height="2116" style="display: block;"></p><p>下载地址:<a href="https://pan.baidu.com/s/1wjdPDQ9SQAlyboVr3CwvPw">https://pan.baidu.com/s/1wjdPDQ9SQAlyboVr3CwvPw</a> 密码：ch3a</p>]]></content>
      
      
      <categories>
          
          <category> 素材 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ae模板 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpcms整合iWebIM接口文件及使用说明</title>
      <link href="/page/2283263265/"/>
      <url>/page/2283263265/</url>
      
        <content type="html"><![CDATA[<p>iWebIM作为一款以解决大型站点高并发高负载问题为主要任务的开源webIM软件，iWebIM功能强大，易于集成。主动易用的可嵌入式设计使他可以方便的和现有所有社区系统集成在一起。演示，下载，使用说明见官方网站<a href="http://www.jooyea.cn/">http://www.jooyea.cn/</a></p><p>PHPCMS V9（后面简称V9）采用PHP5+MYSQL做为技术基础进行开发。V9采用OOP（面向对象）方式进行基础运行框架搭建。模块化开发方式做为功能开发形式。框架易于功能扩展，代码维护，优秀的二次开发能力，可满足所有网站的应用需求。 5年开发经验的优秀团队，在掌握了丰富的WEB开发经验和CMS产品开发经验的同时，勇于创新追求完美的设计理念，为全球多达10万网站提供助力，并被更多的政府机构、教育机构、事业单位、商业企业、个人站长所认可。</p><p>本接口提供时iWebIM版本为 iweb IM v1.0 Beta2，phpcms整合iwebim，让phpcms也有类似于QQ的有在线聊天功能!</p><p>1.下载iWebIM，在phpcms v9的根目录下建立im目录，把iWebIM解压后的全部文件复制到im目录。</p><p>2.在phpcms v9的数据库上执行iWebIM的install.sql，添加iWebIM需要的数据表到phpcm v9的数据库中。</p><p>3.用Notepad++修改接口文件中的iweb_mini_lib/conf/dbconf.php中的数据库名，密码和phpcms v9的数据库名。</p><p>4.用notepad++修改接口文件中的configuration.php文件，$siteDomain值改为你的phpcms v9域名末尾加/</p><p>5.接口文件中的plugins/plugin_for_phpcms.php文件的phpcms_key值为 phpcms v9的\caches\configs\system.php文件中auth_key的值,$cookiepre的值，$cookiepre的值为\caches\configs\system.php文件中cookie_pre的值，注意此文件是两个_ 而不是一个_</p><p>6.把修改好的接口文件全部复制到phpcms v9根目录建的im目录中覆盖。</p><p>7.在需要phpcms v9需要显示iwebim的网页中加入</p><script language=”JavaScript” src=”im/im_for_phpcms_js.php”></script><p>需要注意im/configuration.php文件中设置的域名，才能添加iwebim，其他子域名不能使用iwebim，仍然是cookie不能跨域问题.</p><p>接口文件下载地址:<br>链接: <a href="https://pan.baidu.com/s/1JTiviDgWFu6m8ep4xDWaiA">https://pan.baidu.com/s/1JTiviDgWFu6m8ep4xDWaiA</a> 提取码: 1gnp 复制这段内容后打开百度网盘手机App，操作更方便哦</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php源码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>句柄精灵ViewWizard获得窗口句柄等信息和属性</title>
      <link href="/page/1479143853/"/>
      <url>/page/1479143853/</url>
      
        <content type="html"><![CDATA[<img src="/images/ViewWizard.png" alt="">ViewWizard 3.5句柄精灵是一个窗口辅助工具，用于获得窗口或控件的句柄等各种信息和属性。其中包括窗口类，大小，样式，状态，字体等相关内容。此外，它可以控制一个窗口的状态，比如显示或隐藏，置顶，透明，更改样式等等。具体介绍：窗口样式编辑器：用于修改窗口样式和扩展样式。窗口创建监视器：监视顶层窗口的创建和销毁。系统窗口列表：查看系统所有窗口，其中包括不可见的Message窗口以及内核挂钩的隐藏窗口。自动显示隐藏控件：选择该项后，当前活动窗口中的隐藏的控件（子窗口）会全部显示出来。自动激活无效控件：选择该项后，当前活动窗口中的无效的控件（呈灰色）会变为有效。取色器：功能强大的屏幕取色器。屏幕抓图工具：可抓取桌面、窗口和区域图像。软件设置：搜索隐藏窗口：搜索隐藏的控件，不包括顶层窗口。搜索透明窗口：搜索穿透的窗口，这种窗口不接受鼠标点击。搜索挂起窗口：搜索被挂起线程的窗口，容易死锁，除非特殊情况，否则不要选择。暴力搜索窗口：强制遍历系统所有窗口透视搜索窗口：搜索前先把自己设为穿透，以便能够看到下面的窗口。Shift键搜索：按下Shift键自动捕获窗口。搜索模式：精确搜索将搜索最内层的可见的子窗口，标准Z序搜索将搜索最上层的窗口。其它选项：鼠标链接：关系一栏所列出的相关窗口以及文件路径栏，单击以便快速捕获窗口或定位文件。附加栏：列出基本控件的专项信息。窗口文本查看功能：该项会列出窗口的标题或控件的文字内容，对于特殊类型的窗口，比如ListView，则会列出它的列表项数据。窗口菜单查看功能：列出窗口包含的菜单内容。*内容：代表该项不可用或者获取失败。终极模式：拖动搜索屏幕上能看到的所有窗口3.5增加搜索挂起窗口增加暴力搜索窗口及暴力模式密码框判断不对加强总在最前问题通过数值编辑窗口样式3.4.8总在最前后不再被Win+D最小化3.4.6加强总在最前时右键菜单无法弹出3.4.5增加设置还原密码框字符增加加强总在最前密码掩码有时获取不对3.4：窗口列表图标换掉增加进程部分信息增加设置窗口视界修正系统窗口列表功能增加窗口最大化坐标/最小最大尺寸增加窗口透明度显示修正设置窗口透明/穿透功能光标和画刷描述3.3：增加ListView修改器，可编辑任意ListView控件内容增加部分热键样式窗口选定项高亮显示3.2：增加查看进程窗口功能win8以上无法获取消息窗口问题菜单布局等其它问题3.1.1：控件显示状态不正确问题，不再随父窗口的状态而改变3.1更新：1.增加窗口坐标功能2.修复窗口坐标显示不准确问题3.修复编辑窗口坐标窗口4.增加智能调整窗口大小5.增加直接复制句柄6.非标准类不能保存问题<p>下载地址：<br>链接: <a href="https://pan.baidu.com/s/1ChWSUHr-rAljhOR4cnXH0Q">https://pan.baidu.com/s/1ChWSUHr-rAljhOR4cnXH0Q</a> 提取码: hnkn 复制这段内容后打开百度网盘手机App，操作更方便哦</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 精品软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ikeeper爱克吧上网卡磁条信息算法分析</title>
      <link href="/page/1725108992/"/>
      <url>/page/1725108992/</url>
      
        <content type="html"><![CDATA[<p>ikeeper爱克吧上网卡现在早已退出了历史舞台，不过对于学习，把当时分析的爱克吧上网卡磁条信息算法归纳整理一下，算做温故而知新吧!本文属原创，百脑问bnwin.com首发!</p><p>ikeeper爱克吧是什么?<br>【Ikeeper计费管理系统】是重庆智多信息发展有限公司继【实名上网管理系统】后全新开发的计费管理版本。主要用于网吧，学校及各种收费机房的管理，是一款真正全方位从各网吧老板及各种营业性收费机房业主经营管理角度出发，设计体贴入微的经营管理软件。经过我公司不断的升级完善，目前已经得到了广大用户广泛认可。在重庆地区拥有百分之九十以上的市场占有率，目前公司正在积极拓展四川、海南、内蒙等市场并取得了巨大的成就，充分显示了【Ikeeper计费管理系统】与其他同类产品比较所具备的明显技术优势。<br>简而言之爱克吧就是公安网监强制要求网吧安装的网吧安全及计费实名管理系统!</p><p>上网卡是什么？<br>上网卡是爱克吧系统为实现实名制而采用的一种磁卡，上网卡根据身份证信息注册后使用，和银行的磁卡形状及使用方法一样！上网卡有10位数字（如0231466248)，但磁条信息并不是只记录了10位数字，而是这种;200329902314662482=500999000113801? 记录了相关信息。<br>看看上网卡的实物<br><img src="/images/swcard.jpg" alt=""><br>上网卡磁条信息算法解析</p><p>本文本着学习的思想，当前已经不能使用上网卡，所以发布上网卡磁条信息算法，仅供学习使用，费话不多说，下面入正题，正式分析上网卡磁条信息内容：</p><p>先设置一个常量</p><p>常量表<br>493806291608186256487098521453479841593425669412557213331214712906201512413249919383758208612080780228491236189833979289217766495864839471398976449709001708631663736696479153718969090756731903064662430102993165969185690184619921373013471</p><p>然后我们举一个例，如上网卡号 7474747474<br>磁条信息为<br>;200391774747474742=500999000151993?</p><p>分解为<br>;200 3917 7474747474 2 =5009990001 51993 ?<br>1234 5 67890 算法及分析此1-10位的算法<br>而;200 =5009990001和末尾的?为常量，无需要计算。中间为卡号也无需计算，需要计算的就是上图标识的1-10位的数的由来</p><p>以下是上网卡磁条信息的delphi的源代码</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getnumtotal</span><span class="params">(firstnum:Integer;jsstring:<span class="keyword">string</span>;ys:Boolean)</span>:</span>Integer; <span class="comment">//字符串acsii相加减</span></span><br><span class="line"> <span class="keyword">var</span></span><br><span class="line"> ls,x:integer;</span><br><span class="line"> ls1:<span class="keyword">string</span>;</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> x:=firstnum;</span><br><span class="line"> <span class="keyword">for</span> ls:=<span class="number">1</span> <span class="keyword">to</span> Length(jsstring) <span class="keyword">do</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">if</span> ys <span class="keyword">then</span></span><br><span class="line"> x:=x+ord(jsstring[ls])</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> x:=x-ord(jsstring[ls]);</span><br><span class="line"> ls1:=<span class="string">&#x27;$&#x27;</span>+inttohex(x,<span class="number">2</span>);</span><br><span class="line"> <span class="keyword">if</span> Length(ls1)&gt;<span class="number">3</span> <span class="keyword">then</span></span><br><span class="line"> x:=strtoint(<span class="string">&#x27;$&#x27;</span>+rightstr(ls1,<span class="number">2</span>));</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> result:=x;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fullcard</span><span class="params">(numcard:<span class="keyword">string</span>)</span>:</span><span class="keyword">string</span>; <span class="comment">//取得完整磁卡编码</span></span><br><span class="line"> <span class="keyword">var</span></span><br><span class="line"> mycont,mycont1,mycont2,mycont3,mycont4,mycont5:<span class="keyword">string</span>;</span><br><span class="line"> mystr1,mystr2,lsstring:<span class="keyword">string</span>;</span><br><span class="line"> a1,a2,a3,a4,a5,a6,a7,a8,a9,a10:integer;</span><br><span class="line"> b1,b2,b3,b4,b5,b6,b7,b8,b9,b10:<span class="keyword">string</span>;</span><br><span class="line"> ls1,ls2:integer;</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> <span class="comment">//常量表</span></span><br><span class="line"> mycont:=<span class="string">&#x27;493806291608186256487098521453479841593425669412557213331214712906201512413249919383758208612080780228491236189833979289217766495864839471398976449709001708631663736696479153718969090756731903064662430102993165969185690184619921373013471&#x27;</span>;</span><br><span class="line"> mystr1:=Trim(numcard); <span class="comment">//上网卡号</span></span><br><span class="line"> mystr2:=<span class="string">&#x27;5009990001&#x27;</span>; <span class="comment">//常数</span></span><br><span class="line"> mycont1:=mystr1+mystr2; <span class="comment">//形成 74747474745009990001</span></span><br><span class="line"> mycont2:=LeftStr(mystr1,<span class="number">5</span>)+rightstr(mystr2,<span class="number">5</span>); <span class="comment">//形成7474790001</span></span><br><span class="line"> mycont3:=RightStr(mystr1,<span class="number">5</span>)+leftstr(mystr2,<span class="number">5</span>); <span class="comment">//形成4747450099</span></span><br><span class="line"> <span class="comment">//第一位</span></span><br><span class="line"> a1:=getnumtotal(<span class="number">$35</span>,mycont1,true)*getnumtotal(<span class="number">$0C</span>,mycont1,false);</span><br><span class="line"> a1:=a1 <span class="keyword">mod</span> <span class="number">$D7</span>;</span><br><span class="line"> b1:=mycont[a1+<span class="number">1</span>];</span><br><span class="line"> <span class="comment">//第二位</span></span><br><span class="line"> a2:=(a1 <span class="keyword">shl</span> <span class="number">2</span>)*<span class="number">3</span> ;</span><br><span class="line"> a2:=a2 <span class="keyword">mod</span> <span class="number">$93</span>;</span><br><span class="line"> b2:=mycont[a2+<span class="number">1</span>];</span><br><span class="line"> <span class="comment">//第四位</span></span><br><span class="line"> a4:=(a2+a1) <span class="keyword">shl</span> <span class="number">3</span>;</span><br><span class="line"> a4:=a4 <span class="keyword">mod</span> <span class="number">$DA</span>;</span><br><span class="line"> b4:=mycont[a4+<span class="number">1</span>];</span><br><span class="line"> <span class="comment">//第七位</span></span><br><span class="line"> a7:=(a1 <span class="keyword">shl</span> <span class="number">5</span>)+a4;</span><br><span class="line"> a7:=a7*<span class="number">$20</span> <span class="keyword">mod</span> <span class="number">$DA</span>;</span><br><span class="line"> b7:=mycont[a7+<span class="number">1</span>];</span><br><span class="line"> <span class="comment">//第八位</span></span><br><span class="line"> a8:=((a1 <span class="keyword">shl</span> <span class="number">5</span>)+a1+a7)*<span class="number">$21</span>;</span><br><span class="line"> a8:=a8 <span class="keyword">mod</span> <span class="number">$DA</span>;</span><br><span class="line"> b8:=mycont[a8+<span class="number">1</span>];</span><br><span class="line"> <span class="comment">//第九位</span></span><br><span class="line"> a9:=((a1 <span class="keyword">shl</span> <span class="number">5</span>)+a1+a1+a8)*<span class="number">$22</span>;</span><br><span class="line"> a9:=a9 <span class="keyword">mod</span> <span class="number">$DA</span>;</span><br><span class="line"> b9:=mycont[a9+<span class="number">1</span>];</span><br><span class="line"> <span class="comment">//第三位</span></span><br><span class="line"> a3:=getnumtotal(<span class="number">$7</span>,mycont2,True)+a1;</span><br><span class="line"> a3:=(a3 <span class="keyword">shl</span> <span class="number">3</span>)-getnumtotal(<span class="number">$7</span>,mycont2,True)-a1;</span><br><span class="line"> a3:=a3 <span class="keyword">mod</span> <span class="number">$93</span>;</span><br><span class="line"> b3:=mycont[a3+<span class="number">1</span>];</span><br><span class="line"> <span class="comment">//第十位</span></span><br><span class="line"> a10:=getnumtotal(<span class="number">$11</span>,mycont3,false)+a1;</span><br><span class="line"> a10:=(a10 <span class="keyword">shl</span> <span class="number">3</span>)-getnumtotal(<span class="number">$11</span>,mycont3,false)-a1;</span><br><span class="line"> a10:=a10+(a10 <span class="keyword">shl</span> <span class="number">2</span>);</span><br><span class="line"> a10:=a10 <span class="keyword">mod</span> <span class="number">$93</span>;</span><br><span class="line"> b10:=mycont[a10+<span class="number">1</span>];</span><br><span class="line"> <span class="comment">//第五位</span></span><br><span class="line"> mycont4:=<span class="string">&#x27;;=200&#x27;</span>+b1+b2+b3+b4+mystr1; <span class="comment">//;=20039177474747474</span></span><br><span class="line"> ls1:=getnumtotal(a1,mycont4,False);</span><br><span class="line"> lsstring:=<span class="string">&#x27;=&#x27;</span>+mystr2;</span><br><span class="line"> ls2:=getnumtotal(ls1,lsstring,True);</span><br><span class="line"> a5:=getnumtotal(ls2,b7+b8+b9+b10,False)+a1;</span><br><span class="line"> a5:=a5+(a5+(a5 <span class="keyword">shl</span> <span class="number">3</span>))*<span class="number">2</span>;</span><br><span class="line"> a5:=a5 <span class="keyword">mod</span> <span class="number">$93</span>;</span><br><span class="line"> b5:=mycont[a5+<span class="number">1</span>];</span><br><span class="line"> <span class="comment">//第六位</span></span><br><span class="line"> mycont5:=mycont4+b5+<span class="string">&#x27;=&#x27;</span>+mystr2;</span><br><span class="line"> a6:=getnumtotal(getnumtotal(a1,mycont5,True),b7+b8+b9+b10,False)+a1;</span><br><span class="line"> a6:=(a6 <span class="keyword">shl</span> <span class="number">5</span>)-a6;</span><br><span class="line"> a6:=a6 <span class="keyword">mod</span> <span class="number">$93</span>;</span><br><span class="line"> b6:=mycont[a6+<span class="number">1</span>];</span><br><span class="line"> result:=<span class="string">&#x27;200&#x27;</span>+b1+b2+b3+b4+mystr1+b5+<span class="string">&#x27;=&#x27;</span>+mystr2+b6+b7+b8+b9+b10;</span><br><span class="line"> <span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">0058C14B . 8D55 9C lea edx, [ebp-64]</span><br><span class="line"> 0058C14E . 8B86 00030000 mov eax, [esi+300]</span><br><span class="line"> 0058C154 . E8 F7DCEDFF call 00469E50</span><br><span class="line"> 0058C159 . 8B55 9C mov edx, [ebp-64] ;输入的卡号</span><br><span class="line"> 0058C15C . A1 64355900 mov eax, [593564]</span><br><span class="line"> 0058C161 . 8B00 mov eax, [eax]</span><br><span class="line"> 0058C163 . 59 pop ecx</span><br><span class="line"> 0058C164 . E8 7360FFFF call 005821DC ;磁条完整信息生成函数</span><br><span class="line"> 0058C169 . A1 64645900 mov eax, [596464]</span><br><span class="line"> 0058C16E . 50 push eax</span><br><span class="line"> 0058C16F . 8B45 FC mov eax, [ebp-4] ;完整的磁条信息</span><br></pre></td></tr></table></figure><p> 15=200 0847 A 5=5009990001 89124</p><p>常量表<br>493806291608186256487098521453479841593425669412557213331214712906201512413249919383758208612080780228491236189833979289217766495864839471398976449709001708631663736696479153718969090756731903064662430102993165969185690184619921373013471</p><p>例 ;200 3917 7474747474 2 =5009990001 51993?<br>1234 5 67890<br>;200</p><ol><li><p>(35+74747474745009990001)<em>(0C-74747474745009990001) MOD D7=4D</em>F4 mod d7=18788 mod D7=53——-[ebp-$68]——-&gt;3</p></li><li><p>53 shl 2=14C (14c+14c*2) MOD 93=3E4 MOD 93=72—————————————-[ebp-$6C]———–&gt;9</p></li></ol><p>4 (72+53)=C5 shl 3=628 MOD DA=32———————————————————-[ebp-$70]————&gt;7</p><p>7 53 shl 5=A60 (A60+32)*20(常量) MOD DA=2E———————————————-[ebp-$74]————-&gt;1</p><p>8 53 shl 5=A60 ((A60+53)+2E)*21(常量) mod DA=7F—————————————–[ebp-$78]————-&gt;9</p><p>9 ((53 shl 5)+53+53+7F)*22(常量) MOD Da=CC ————————————————[ebp-$7C]——————-&gt;9</p><ol start="3"><li>(7+7474790001)=0E+53=61左移三位 (308-0E-53=2A7) mod 93=5B——————————[ebp-$80]————–&gt;1</li></ol><p>10 (11-4747450099)=00+53=53左移三位 (298-00-53=245+(245左移两位914))=B59 mod 93=70——-[ebp+$FFFFFF7C]——-&gt;3</p><p>5 (53-;=20039177474747474=5E)+(=5009990001)=9C-(最后四位即7+8+9+10位)1993=C6+53=119左移三位 8C8+119=9E1 9E1+9E1+119=14DB MOD 93=2F—&gt;2</p><p>开始拼凑前面的部分 [ebp+$FFFFFF78]</p><p>6 [(53+;=200391774747474742=5009990001=B8)-(最后四位即7+8+9+10位)1993]=E2+53=135左移5位 26A0-135=256B Mod 93=18—-[ebp+$FFFFFF74]–&gt;5</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi源码 </tag>
            
            <tag> 爱克吧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpcms整合DESTOONB2B接口文件及使用说明</title>
      <link href="/page/415747762/"/>
      <url>/page/415747762/</url>
      
        <content type="html"><![CDATA[<p>DESTOON B2B是一套基于PHP+MySQL的开源B2B电子商务行业门户网站解决方案。<br>官方网站为<a href="http://www.destoon.com,下载,演示及使用请查看官方网站.实际就是仿阿里巴巴的php系统.—本接口提供时destoon版本为/">http://www.destoon.com，下载，演示及使用请查看官方网站。实际就是仿阿里巴巴的php系统。—本接口提供时destoon版本为</a> 最新版本：V4.0 更新时间：2012-04-28</p><p>phpcms如何整合destoon？destoon如何整合phpcms呢？本文就会介绍具体方法和提供接口文件!</p><p>至于为什么phpcms需要整合destoon,因为phpcms的黄页功能不全，destoon功能全！</p><p>主域名为<a href="http://www.bnwin.com/">www.bnwin.com</a> destoon域名为b2b.bnwin.com<br>均采用utf-8编码,phpcms v9域名和destoon域名应同属不同的子域名，不能采用不用的域名!因为cookie不允许跨域!</p><p>1.在phpcms v9后台的phpsso中添加应用<br>应用名:destoonB2B<br>应用地址:<a href="http://b2b.bnwin.com/member/">http://b2b.bnwin.com/member/</a><br>通信密钥:(点击自动生成)<br>类型:其他<br>应用IP：(保持为空)<br>通信文件：phpsso.php<br>字符集:utf-8<br>同步登录:是</p><p>添加应用后，查看应用ID号，并且复制自动生成的 通信密钥</p><p>2.打开接口文件中的memeber/phpssoconfig.php文件，修改define(‘APPID’, 2);中的2为上一步中查看的应用ID号,修改$ps_api_url的地址为phpsso的web地址，修改$ps_auth_key为上一步中自动生成的通信密钥。</p><p>phpssoconfig.php文件中无中文，如果加入中文，需要保存格式为utf-8无bom编码，不加中文可以使用记事本编辑，加入中文就不能使用记事本编辑，可以使用Notepad++编辑。</p><p>保存后把member和module两个目录复制到destoon根目录覆盖。接口文件的member目录中的三个文件是新增的，module\member目录的文件是修改的destoon文件，作用是destoon登录或退出和phpcms v9同步。你可以事先对destoon的module\member中的相应的文件进行备份。</p><p>覆盖文件后，进入phpcms v9的应用管理，通信状态应该为通信成功。不成功请检查上面的步骤。</p><p>3.修改destoon的destoon_member表(安装时采用的默认前缀destoon)，添加字段phpssouid 类型bigint 长度20 小数点0 不允许空值，默认值为0</p><ol start="4"><li>接口文件phpcms v9和destoon双向同步登录，同步退出，注册以phpcms v9为注册口，注册后自动同步到destoon。由于两个系统对密码的加密不一致，在destoon注册也能同步到phpcms v9，但在destoon注册的用户就达不到同步登录和登录退出，因为密码加密不致。这也是一些系统整合后，需要激活的原因。本接口不需要激活过程，但不能双向注册。</li></ol><p>建议去掉直接在destoon注册，因为destoon注册的密码不能直接保存在phpcms v9中，会出现以phpcmsv9登录时，不能同步登录destoon，去掉destoon同步注册修改方法为：把member目录下的register.php文件内容改为(把<a href="http://www.bnwin.com改为你自己的域名siteid的值改为你的站点的id/">www.bnwin.com改为你自己的域名siteid的值改为你的站点的id</a>)</p><?phpheader(“HTTP/1.1 301 Moved Permanently”);header(“Location: http://www.bnwin.com/index.php?m=member&c=index&a=register&siteid=1”);exit();?><p>因为整合的目的，是让用户认为全部系统是完美结合在一起的一个系统。所以建议，用户注册，用户登录，用户修改，用户退出全部系统都指向相同的文件。</p><p>接口文件及整合视频下载地址:<br>链接: <a href="https://pan.baidu.com/s/1bpJFPVL">https://pan.baidu.com/s/1bpJFPVL</a> 密码: uq4d</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php源码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>“春宵一刻值千金”古代的优美情诗</title>
      <link href="/page/2134220563/"/>
      <url>/page/2134220563/</url>
      
        <content type="html"><![CDATA[<p>——《江城子》 苏轼<br>十年生死两茫茫，不思量，自难忘。<br>千里孤坟，无处话凄凉。<br>纵使相逢应不识，尘满面，鬓如霜。<br>夜来幽梦忽还乡，小轩窗，正梳妆。<br>相顾无言，惟有泪千行。<br>料得年年肠断处，明月夜，短松冈。</p><p>——纳兰性德《木兰词·拟古决绝词柬友》</p><p>人生若只如初见，何事秋风悲画扇；</p><p>等闲变却故人心，却道故人心易变。</p><p>骊山语罢清宵半，泪雨霖铃终不怨；</p><p>何如薄幸锦衣郎，比翼连枝当日愿。<br><img src="/images/40330003082f7a5dd55a.jpg"></p><p>——《花月痕》</p><p>多情自古空余恨，好梦由来最易醒。</p><p>岂是拈花难解脱，可怜飞絮太飘零。</p><p>——元稹《遣悲怀•其二》</p><p>昔日戏言身后事，今朝都到眼前来。</p><p>衣裳已施行看尽，针线犹存未忍开。</p><p>尚想旧情怜婢仆，也曾因梦送钱财。</p><p>诚知此恨人人有，贫贱夫妻百事哀。</p><p>——黄増《集杭州俗语诗》</p><p>色不迷人人自迷，情人眼里出西施。</p><p>有缘千里来相会，三笑徒然当一痴。</p><p>——李贺《金铜仙人辞汉歌》</p><p>茂陵刘郎秋风客，夜闻马嘶晓无迹。</p><p>画栏桂树悬秋香，三十六宫土花碧。</p><p>魏官牵车指千里，东关酸风射眸子。</p><p>空将汉月出宫门，忆君清泪如铅水。</p><p>衰兰送客咸阳道，天若有情天亦老。</p><p>携盘独出月荒凉，渭城已远波声小。</p><p>——杜甫《前出塞·其六》</p><p>挽弓当挽强，用箭当用长。</p><p>射人先射马，擒贼先擒王。</p><p>杀人亦有限，列国自有疆。</p><p>苟能制侵陵，岂在多杀伤。</p><p>——黄景仁《杂感》</p><p>仙佛茫茫两未成，只知独夜不平鸣。</p><p>风蓬飘尽悲歌气，泥絮沾来薄幸名。</p><p>十有九人堪白眼，百无一用是书生。</p><p>莫因诗卷愁成谶，春鸟秋虫自作声。</p><p>——龚自珍《夜作》</p><p>沉沉心事北南东，一睨人材海内空。</p><p>壮岁始参周史席，髫年惜堕晋贤风。</p><p>功高拜将成仙外，才尽回肠荡气中。</p><p>万一禅关砉然破，美人如玉剑如虹。</p><p>——罗隐《自遣》</p><p>得即高歌失即休，多愁多恨亦悠悠。</p><p>今朝有酒今朝醉，明日愁来明日愁。</p><p>——夏元鼎《绝句》</p><p>崆峒访道至湘湖，万卷诗书看转愚。</p><p>踏破铁鞋无觅处，得来全不费工夫。</p><p>——苏轼《戏张先》</p><p>十八新娘八十郎，苍苍白发对红妆。</p><p>鸳鸯被里成双夜，一树梨花压海棠。</p><p>——黄蘖禅师《上堂开示颂》</p><p>尘劳回脱事非常，紧把绳头做一场。</p><p>不经一番寒彻骨，那得梅花扑鼻香。</p><p>——陈于之《题桃花扇》</p><p>玉树歌残声已陈，南朝宫殿柳条新；</p><p>福王少小风流惯，不爱江山爱美人。</p><p>——俞文豹《清夜录》</p><p>近水楼台先得月，向阳花木易为春。</p><p>——苏轼《蝶恋花·春景》</p><p>花褪残红青杏小。燕子飞时，绿水人家绕。</p><p>枝上柳绵吹又少。天涯何处无芳草。</p><p>墙里秋千墙外道。墙外行人，墙里佳人笑。</p><p>笑渐不闻声渐悄，多情却被无情恼。</p><p>——白居易《长恨歌》</p><p>临别殷勤重寄词，词中有誓两心知。</p><p>七月七日长生殿，夜半无人私语时。</p><p>在天愿作比翼鸟，在地愿为连理枝。</p><p>天长地久有时尽，此恨绵绵无绝期。</p><p>——曹松《己亥岁》</p><p>泽国江山入战图，生民何计乐樵苏。</p><p>凭君莫话封侯事，一将功成万骨枯。</p><p>——苏轼《春宵》</p><p>春宵一刻值千金，花有清香月有阴。</p><p>歌管楼台声细细，秋千院落夜沉沉。</p>]]></content>
      
      
      <categories>
          
          <category> 杂集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文章 </tag>
            
            <tag> 情诗 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ikeeper爱克吧去广告方法</title>
      <link href="/page/2202525941/"/>
      <url>/page/2202525941/</url>
      
        <content type="html"><![CDATA[<p>ikeeper爱克吧为网吧实名管理系统 官网<a href="http://www.echina110.com/">http://www.echina110.com</a><br>如何去掉ikeeper爱克吧的桌面广告呢？这儿介绍两种方种，虽然ikeeper爱克吧已经开始下线，开始使用ikeeper 8圈管理系统，在这儿仍然记录一下如何去掉ikeeper爱克吧广告的方法，至于ikeeper 8圈去广告方法，后续我们会放上相应的文章，8圈去广告已经没有爱克吧简单了!<br>方法一<br>自定义广告使用说明</p><p>爱克吧的广告地址为</p><p><a href="http://activedesktop.echina110.com/advertises/desktopx.asp?id=5001030050">http://activedesktop.echina110.com/advertises/desktopx.asp?id=5001030050</a></p><p>desktopx.asp的内容为:</p><p>Http://你的站点的IP/advertises/adv/ad.cab  123</p><p>只要把activedesktop.echina110.com域名屏蔽，就可以去广告，只要把这个域名重定向，然后自定义cab的内容就可以显示自定义的广告!至于怎么屏蔽，可以使用路由器中的域名过滤和重定向就ＯＫ了。</p><p>其中desktopx.asp的内容说明如下：<br>第一项指向你的站点中的ad.cab（文件可以为任何，但必须是cab压缩包，不能是zip或rar或7z等其他压缩包，制作cab压缩包，可以使用xp自带的IEXPRESS.EXE)</p><p>路径不一定是在advertises/adv可以改为其他路径,但该路径下必须有ad.cab,这个文件名不能变</p><p>其后的123可以为任意数字!</p><p>同时请注意desktopx.asp的路径不能变,只能在http://你的站点IP/advertises/desktopx.asp确保打开此 asp页面在浏览器中返回的应该为Http://你的ad.cab路径/ad.cab 123</p><p>方法二</p><p>1.用UltraEdit等编辑二进制工具打开C:\Program Files (x86)\Client\entry.exe(如果是xp是C:\Program Files\Client\entry.exe)，点击编辑中查找.lib。<br><img src="/images/ikb-1.png" /><br>2.把.lib修改为.sib或其他的字符（其实就是修改cab广告包中的可执行文件的数据扩展名，修改后ikeeper爱克吧就不会执行cab广告包中广告文件，客户机也就不会有随机文件运行了，但桌面锁屏广告是存在的，其实去广告的最终目的是不能让广告影响到客户机性能或影响到用户的体验！）<br><img src="/images/ikb-2.png" /></p>]]></content>
      
      
      <categories>
          
          <category> 文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 去广告方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关闭8圈桌面侧边栏工具-怎样关闭八圈侧边栏</title>
      <link href="/page/3211467574/"/>
      <url>/page/3211467574/</url>
      
        <content type="html"><![CDATA[<h3 id="关闭8圈桌面侧边栏工具-适用于八圈9-5以下版本"><a href="#关闭8圈桌面侧边栏工具-适用于八圈9-5以下版本" class="headerlink" title="关闭8圈桌面侧边栏工具-适用于八圈9.5以下版本"></a>关闭8圈桌面侧边栏工具-适用于八圈9.5以下版本</h3><p>此页面工具仅适用于八圈9.5以下版本，不适用于八圈9.5及以上版本，9.5版本请查看本站其他页面</p><p>8圈网管平台(8圈计费系统)是专门针对新型网吧网咖会所开发的一款全新网管服务软件!官方网站:<a href="http://www.8quan.com/">http://www.8quan.com</a></p><p>网吧计费系统8圈，会在桌面右侧显示一个窗口，无法修改，无法控制是否显示！如何关闭8圈计费系统桌面上的窗口呢？本工具可以自由控制显示或隐藏，或销毁，还你桌面一个自由!<br>本程序可以加参数运行 加 1 隐藏 加 0 显示 加 2 销毁</p><p>销毁就是彻底关闭，窗体是不存在了，隐藏只是不显示出来，实际是存在的!</p><p>如何添加参数，请参照这儿  <a href="https://goodhelp.gitee.io/page/576111441/">https://goodhelp.gitee.io/page/576111441/</a></p><img src="/images/8quan.png" alt=""><p>下载地址：</p><p>关闭八圈9.5版工具下载地址</p><p><a href="https://goodhelp.gitee.io/page/3043345977/">https://goodhelp.gitee.io/page/3043345977/</a></p><p>此版本只适用于八圈9.5以下</p><p>V0.33版本 链接: <a href="https://pan.baidu.com/s/1gbsO1id1CM3obMiGRVUXNw">https://pan.baidu.com/s/1gbsO1id1CM3obMiGRVUXNw</a> 提取码: 5qyk</p><p>V0.32版本 链接: <a href="https://pan.baidu.com/s/1Im3iRntYOLnMgg-9yfM_MQ">https://pan.baidu.com/s/1Im3iRntYOLnMgg-9yfM_MQ</a> 提取码: aaax</p><p>V0.31版本 链接：<a href="https://pan.baidu.com/s/1kVSqDtd">https://pan.baidu.com/s/1kVSqDtd</a> 密码：nxxq</p><p>V0.3版本 链接: <a href="https://pan.baidu.com/s/1kV7WTMZ">https://pan.baidu.com/s/1kV7WTMZ</a> 密码: 3m1t 解压密码 bnwin.com</p><p>2018 09-22 V0.33<br>修改判断8圈侧边栏是否存在的方法，更具有通用性!</p><p>2018 09-21 V0.32<br>修改了9.4.4.15022版本发现不了侧边栏的问题，新版隐藏方式三即参数5 经测是可以使用在9.4.4.15510版本上的</p><p>2018 01-03 V0.31<br>使用命令行参数运行时，在没有发现8圈侧边栏时，会一直等待，8圈侧边栏出现，隐藏后，本程序自动退出!这样就可以开机直接运行本工具，而不用怕本工具启动时8圈侧边栏没出来，而隐藏不了侧边栏的问题!</p><p>运动方式</p><p>直接运行，手工操作界面<br>参数运行<br>0 旧版显示8圈侧边栏<br>1 旧版关闭8圈侧边栏<br>2 旧版销毁8圈侧边栏<br>3 新版隐藏方式一<br>4 新版隐藏方式二<br>5 新版隐藏方式三(适用于9.4.4版本)</p><p>自己先手工测试哪种方式能用，就选择哪种方式！<br>旧版指8圈9.4.3以前，新版指8圈9.4.3及以后版本</p><p>什么是运行参数？比如解压文件c8.exe在C盘根目录，那么直接运行<br>命令就是<br>c:\c8.exe<br>参数运行就是这样<br>c:\c8.exe 5<br>后面的数字5就是参数，参数和前面的执行程序之前加一个空格，如果<br>你的执行程序解压到有空格的目录，那么前面的运行程序要加引号如<br>“c:\空格 目录\c8.exe” 5</p><p>控制的就是桌面这一块<br><img src="/images/1516264932-1.gif" alt=""><br>当前版本V0.32 查看8圈相关软件 独立的8圈挂机锁 <a href="https://goodhelp.gitee.io/page/576111441/">https://goodhelp.gitee.io/page/576111441/</a></p><p>如果你觉得关闭8圈侧边栏对你的操作系统稳定性有影响，你可以查看自定义8圈桌面侧边栏的软件<a href="http://www.bnwin.com/page/1077583104/">http://www.bnwin.com/page/1077583104/</a></p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 八圈 </tag>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>中止非驱动保护进程的工具</title>
      <link href="/page/1213995227/"/>
      <url>/page/1213995227/</url>
      
        <content type="html"><![CDATA[<p>本程序可以中止非驱动保护（驱动保护的进程无法结束）的绝大部份进程,对于一些广告进程无法通过任务管理器结束的，本工具可以结束，以及删除一些非驱动保护的文件。本程序设置好配置文件后运行就可以自动结束，完全自动化!</p><p>需要中止的进程和删除的文件以及需要隐藏的文件添加到setup.ini中，格式如下</p><p>[中止进程]<br>;结束任务管理器中无法结束的进程<br>;名称=进程的完整路径<br>wwbizsrv=C:\Program Files (x86)\Alibaba\wwbizsrv\wwbizsrv.exe</p><p>[删除文件]<br>;删除普通无法删除的文件<br>;名称=文件完整路径<br>删无权限文件=C:\Users\Administrator\Desktop\删无权限文件.txt</p><p>[隐藏文件]<br>;不删除，仅隐藏文件<br>;名称=文件完整路径<br>1=C:\Users\Administrator\Desktop\0.url<br>本程序运行会自动结束setup.ini配置中的进程，结束后自动退出程序，无运行界面!可以先用任务管理器试一下无法结束的进程，然后把此进程配置在setup.ini，即可结束，可以测试csrss.exe或winlogin.exe，不过结束这些系统核心进程会蓝屏!</p><ol><li>中止任务管理器无法中止的进程<img src="/images/taskkill.gif" alt=""></li><li>删除普通无法删除的文件<img src="/images/1516718596-1.gif" alt=""></li><li>删除没有权限的文件<img src="/images/1516803894-2.gif" alt=""></li></ol><p>下载地址：</p><p>链接: <a href="https://pan.baidu.com/s/1OY8tgGx5D8puJ8mPHAgjkw">https://pan.baidu.com/s/1OY8tgGx5D8puJ8mPHAgjkw</a> 提取码: vrjx 复制这段内容后打开百度网盘手机App，操作更方便哦</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 八圈 </tag>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>根据标题关键字禁止窗口的工具</title>
      <link href="/page/3617424847/"/>
      <url>/page/3617424847/</url>
      
        <content type="html"><![CDATA[<p>很多维护工具中都带有这个功能，本工具就是单一的功能，根据设置的关键字，自动关闭窗口，也许有些地方只需要这单一功能，比如给家里的孩子电脑中安装这个工具反黄!</p><p>下载地址</p><p>链接: <a href="https://pan.baidu.com/s/1i5rISLJ">https://pan.baidu.com/s/1i5rISLJ</a> 密码: wad7</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>显示器亮度调节工具</title>
      <link href="/page/1271703987/"/>
      <url>/page/1271703987/</url>
      
        <content type="html"><![CDATA[<p>显示器亮度调节工具，虽然有其他的，但我写的这个软件，包括显示器亮度调节，声音调节，鼠标调节和自定义程序启动，也许可以为你带来方便!<br><img src="/images/screen-300x261.png" alt=""><br>看看效果<br><img src="/images/tool.gif" alt=""></p><p>下载地址</p><p>链接: <a href="https://pan.baidu.com/s/1nuUAioT">https://pan.baidu.com/s/1nuUAioT</a> 密码: 1mx2</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单的聊天菜单</title>
      <link href="/page/2499358455/"/>
      <url>/page/2499358455/</url>
      
        <content type="html"><![CDATA[<p>这是一个分类菜单，比如显示聊天菜单等几个程序的工具，此菜单可以定义命令行参数</p><p>第一个参数是每一行显示几个图标<br>第二个参数是标题名称<br>第三个参数是配置文件名<br>第四个参数是背景图片</p><p>比如参数写为</p><p>4 办公软件 bgmenu.ini skin.jpg</p><p>那么这表示使用bgmenu.ini配置文件，skin.jpg做为背景图片，每行显示4个图标，标题为 办公软件 的菜单</p><p>效果看一下，仿QQ界面，是很漂亮的<br><img src="/images/1-259x300.png" alt=""></p><img src="/images/2-284x300.png" alt=""><img src="/images/3-259x300.png" alt=""><p>下载地址：</p><p>链接: <a href="https://pan.baidu.com/s/1bY8gEHz2-k2I7DskKW1eJQ">https://pan.baidu.com/s/1bY8gEHz2-k2I7DskKW1eJQ</a> 提取码: yrtq 复制这段内容后打开百度网盘手机App，操作更方便哦</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 原创软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>锐起CGO2043服务端出盘源码</title>
      <link href="/page/2734958200/"/>
      <url>/page/2734958200/</url>
      
        <content type="html"><![CDATA[<p>曾经的锐起CGO2043是以IMG包的形式存放游戏的，但服务端又不能自动出盘进行更新，当时就写了这个工具，开机可以自动开IMG包，达到自动更新游戏的目的!<br>源码为delphi，如果需要的可以下载!</p><p>下载地址</p><p>链接: <a href="https://pan.baidu.com/s/1nuNi8hr">https://pan.baidu.com/s/1nuNi8hr</a> 密码: r7g6</p><p>解压密码 bnwin.com</p><p>其中部份源码</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">s3:^Integer;</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> GSGW32_LoadDriver;</span><br><span class="line"> s1:=dname;</span><br><span class="line"> s2:=(dsize*<span class="number">1024</span>)*<span class="number">1024</span>;</span><br><span class="line"> s2:=s2*<span class="number">1024</span>;</span><br><span class="line"> <span class="keyword">asm</span></span><br><span class="line"> lea eax,s2;</span><br><span class="line"> mov edx,s1;</span><br><span class="line"> mov al,[edx];</span><br><span class="line"> mov s3,eax;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> GSGW32_Mount(sn,s3,@s2,PChar(dimg));</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">TService1</span>.<span class="title">diskgo</span><span class="params">(diskname:<span class="keyword">string</span>)</span>:</span>Boolean;</span><br><span class="line"> <span class="keyword">var</span></span><br><span class="line"> d2:<span class="keyword">string</span>;</span><br><span class="line"> n,i:Integer;</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> d2:=UpperCase(Trim(diskname));</span><br><span class="line"> <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> Length(d2) <span class="keyword">do</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> n:=Ord(d2[i]);</span><br><span class="line"> GSGW32_Umount(n);</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> GSGW32_UnloadDriver;</span><br><span class="line"> <span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi源码 </tag>
            
            <tag> 锐起使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>370safe安全管理软件</title>
      <link href="/page/278292559/"/>
      <url>/page/278292559/</url>
      
        <content type="html"><![CDATA[<p>网吧经常出现很多人投诉网吧，老是自动弹出广告，以前还只是游戏结束自动弹出游戏网页，现在直接小窗口带声音了。打开网页多了还要慢慢找。我想知道怎么屏蔽这一类的广告，因为现在已经有很多人投诉了，但是我们上面的合作公司竟然无力解决!</p><p>进程里面结束网吧系统的游戏管理软件就不会出现广告！网吧为了管理游戏方便，不可避免的需要这种管理软件，所以广告不可避免，这也是网吧系统管理方赚钱的一种手段。</p><p>这就是现在网吧广告的现状，网吧现在绝大部份采用无盘系统，无盘系统比如网维大师等，会不断投放广告，网吧采用实名制系统，比如pubwin等公安实名制系统，也会不断投放广告，文化监管软件，比如任子行等，也会不断投放广告!网吧使用的营销软件，比如网吧营销大师、领航等，同时会不断投放广告,只要看到网吧市场的，都会投放广告，广告这么多，网吧客户机不成了垃圾系统了吗？拖慢系统，游戏中弹出桌面，烦人的弹窗，还有烦人的挖矿，不断的消耗客户机软硬件资源，网吧体验怎么办？370safe等类软件应运而生，还你网吧桌面自由！</p><p>370Safe只是个安全防御工具, 提供防御功能, 不提供任何内置规则 . 在默认情况下, 软件安装后 , 不会拦截任何软件的任何操作.<br>用户应合理,合法,灵活使用软件提供的一切功能 . 因用户自行配置的规则导致的一切问题,用户自行承担相应的责任.<br>用户应仅将本工具用于防御病毒木马,不得破坏其他软件正常功能.</p><p>370服务端运行界面<br><img src="/images/370.png" alt=""><br>此下载地址包括370safe 2.0内网版和以前的370safe 1.02版 370safe 1.03版升级补丁等!</p><p>370safe 2.0内网版及1.02 1.03下载地址</p><p>链接: <a href="https://pan.baidu.com/s/1i4QE2TR">https://pan.baidu.com/s/1i4QE2TR</a> 密码: 6jvb</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 去广告方法 </tag>
            
            <tag> 精品软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>锐起CGO2043客户端绿色出盘源码</title>
      <link href="/page/589247647/"/>
      <url>/page/589247647/</url>
      
        <content type="html"><![CDATA[<p>锐起CGO2043客户端绿色出盘源码,可以在服务端查看到客户端的状态</p><p>源码为delphi,如果需要源码可以下载 </p><p>下载地址<br>链接: <a href="https://pan.baidu.com/s/1i5gn1i9">https://pan.baidu.com/s/1i5gn1i9</a> 密码: nnhu </p><p>解压密码 bnwin.com</p><p>其中部份源码</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">MutexHandle: Longword;</span><br><span class="line"> mainip,subip,mystr,syspath:<span class="keyword">string</span>;</span><br><span class="line"> reg:TRegistry;</span><br><span class="line"> thand:THandle;</span><br><span class="line"> RTGSGLogonEvent:TPluginName;</span><br><span class="line"> myini:TIniFile;</span><br><span class="line"> myname,cgoip:<span class="keyword">string</span>;</span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> syspath:=gtsyspath;</span><br><span class="line"> <span class="keyword">if</span> <span class="keyword">not</span> fileexists(syspath+<span class="string">&#x27;\system32\drivers\GAMESGXP.sys&#x27;</span>) <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> ExtractRes(<span class="string">&#x27;exefile&#x27;</span>,<span class="string">&#x27;RNDINTER&#x27;</span>,syspath+<span class="string">&#x27;\system32\RNDINTER.dll&#x27;</span>);</span><br><span class="line"> ExtractRes(<span class="string">&#x27;exefile&#x27;</span>,<span class="string">&#x27;RTGSGENG&#x27;</span>,syspath+<span class="string">&#x27;\system32\RTGSGENG.dll&#x27;</span>);</span><br><span class="line"> ExtractRes(<span class="string">&#x27;exefile&#x27;</span>,<span class="string">&#x27;udt&#x27;</span>,syspath+<span class="string">&#x27;\system32\udt.dll&#x27;</span>);</span><br><span class="line"> ExtractRes(<span class="string">&#x27;exefile&#x27;</span>,<span class="string">&#x27;GAMESGXP&#x27;</span>,syspath+<span class="string">&#x27;\system32\drivers\GAMESGXP.sys&#x27;</span>);</span><br><span class="line"> ExtractRes(<span class="string">&#x27;exefile&#x27;</span>,<span class="string">&#x27;RTFLTDSK&#x27;</span>,syspath+<span class="string">&#x27;\system32\drivers\RTFLTDSK.sys&#x27;</span>);</span><br><span class="line"> ExtractRes(<span class="string">&#x27;exefile&#x27;</span>,<span class="string">&#x27;RTWRESXP&#x27;</span>,syspath+<span class="string">&#x27;\system32\drivers\RTWRESXP.sys&#x27;</span>);</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> myini:=TIniFile.Create(ExtractFilePath(ParamStr(<span class="number">0</span>))+<span class="string">&#x27;setup.ini&#x27;</span>);</span><br><span class="line"> mainip:= myini.ReadString(<span class="string">&#x27;配置&#x27;</span>,<span class="string">&#x27;主服务器&#x27;</span>,<span class="string">&#x27;&#x27;</span>);<span class="comment">//主服务器IP</span></span><br><span class="line"> subip:= myini.ReadString(<span class="string">&#x27;配置&#x27;</span>,<span class="string">&#x27;副服务器&#x27;</span>,<span class="string">&#x27;&#x27;</span>);<span class="comment">//副服务器IP</span></span><br><span class="line"> <span class="keyword">if</span> subip=<span class="string">&#x27;&#x27;</span> <span class="keyword">then</span> subip:=mainip;</span><br><span class="line"> mystr:= uppercase(myini.ReadString(<span class="string">&#x27;配置&#x27;</span>,<span class="string">&#x27;副分流机器&#x27;</span>,<span class="string">&#x27;&#x27;</span>));<span class="comment">//副服务器分流机器名</span></span><br><span class="line"> myini.Free;</span><br><span class="line"> myname:=gtcomputername;</span><br><span class="line"> <span class="keyword">if</span> Pos(myname,mystr)&gt;<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">if</span> ScanTCPPort(subip,<span class="number">7499</span>) <span class="keyword">then</span></span><br><span class="line"> cgoip:=subip</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> cgoip:=mainip;</span><br><span class="line"> <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">if</span> ScanTCPPort(mainip,<span class="number">7499</span>) <span class="keyword">then</span></span><br><span class="line"> cgoip:=mainip</span><br><span class="line"> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">if</span> ScanTCPPort(subip,<span class="number">7499</span>) <span class="keyword">then</span></span><br><span class="line"> cgoip:=subip</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> cgoip:=mainip;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> <span class="keyword">if</span> cgoip&lt;&gt;<span class="string">&#x27;&#x27;</span> <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> reg:=TRegistry.Create;</span><br><span class="line"> reg.RootKey:=HKEY_LOCAL_MACHINE;</span><br><span class="line"> <span class="keyword">if</span> reg.OpenKey(<span class="string">&#x27;SOFTWARE\Richtech\Cgo&#x27;</span>,true) <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> reg.WriteInteger(<span class="string">&#x27;Version&#x27;</span>,<span class="number">$000007fb</span>);</span><br><span class="line"> reg.WriteString(<span class="string">&#x27;ServerIp&#x27;</span>,cgoip);</span><br><span class="line"> reg.WriteInteger(<span class="string">&#x27;NormalSD&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"> reg.WriteInteger(<span class="string">&#x27;UserId&#x27;</span>,<span class="number">5821298</span>);</span><br><span class="line"> reg.WriteInteger(<span class="string">&#x27;KeyId&#x27;</span>,<span class="number">0</span>);</span><br><span class="line"> reg.WriteInteger(<span class="string">&#x27;RegDrive&#x27;</span>,<span class="number">81</span>);</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> reg.CloseKey;</span><br><span class="line"> reg.Destroy;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> <span class="keyword">if</span> OpenMutex(MUTEX_ALL_ACCESS, FALSE, <span class="string">&#x27;RTGSGLogonEvent&#x27;</span>)&lt;&gt;<span class="number">0</span> <span class="keyword">then</span> <span class="keyword">Exit</span>;</span><br><span class="line"> MutexHandle := CreateMutex(<span class="keyword">nil</span>,TRUE,<span class="string">&#x27;RTGSGLogonEvent&#x27;</span>); <span class="comment">//.........BEGIN........//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//寻找进程</span></span><br><span class="line"> Explorer_PID := FindProcess(<span class="string">&#x27;winlogon.exe&#x27;</span>);</span><br><span class="line"> <span class="keyword">if</span> (Explorer_PID=<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"> MessageBox(<span class="number">0</span>, <span class="string">&#x27;寻找winlogon进程出错 &#x27;</span>, <span class="keyword">nil</span>, <span class="number">0</span>); <span class="keyword">Exit</span>;</span><br><span class="line"> <span class="keyword">end</span>;</span><br><span class="line"> <span class="comment">//创建内存映射文件</span></span><br><span class="line"> FileMapH := CreateFileMapping(<span class="number">$FFFFFFFF</span>,<span class="keyword">nil</span>,PAGE_READWRITE,<span class="number">0</span>,SizeOf(node),<span class="string">&#x27;RTGSGLogonEventRich&#x27;</span>);</span><br><span class="line"> <span class="keyword">if</span> (FileMapH=<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">begin</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> delphi源码 </tag>
            
            <tag> 锐起使用方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vip电影浏览器一款可以免费看全网会员视频的软件</title>
      <link href="/page/4159720203/"/>
      <url>/page/4159720203/</url>
      
        <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>电影VIP浏览器，免费看VIP电影的神器，不会买电影网站会员，直接看会员影视剧。不用买电影网站特权，直接看<br>会员电影!最重要的是本软件无广告，界面美好!注：本软件仅收集解析接口，并不提供，存储视频！本软件提供优酷VIP解析,爱奇艺VIP解析,腾讯VIP解析,乐视VIP解析,芒果VIP解析，让你省去购买视频VIP的费用,支持全网VIP会员视频电影解析免费看!<br><img src="/images/20171112175224.png" alt="免费看全网影视"><br>免费观看vip视频电视软件,看各种会员视频软件,免vip追剧软件。</p><h1 id="特色功能介绍"><a href="#特色功能介绍" class="headerlink" title="特色功能介绍"></a>特色功能介绍</h1><ol><li>地址栏可直接复制视频播放页地址，点击右侧播放按钮进行解析播放!</li><li>支持直接嵌入页面播放，即直接替换原播放页面，和原网站完美合为一体!（可测试华数视频的播放）</li><li>多解析接口自由切换，一个解析接口失效，方便自主切换!</li><li>自动取得剧集，并可自由选择播放!</li><li>可一键切换到原网页播放！</li><li>可模拟为手机播放！</li><li>支持小窗口置顶播放!</li><li>可自定义软件界面皮肤！</li><li>可做为浏览器使用!</li><li>全网影视自动识别解析!</li></ol><p>下载地址</p><p>百度网盘链接: <a href="https://pan.baidu.com/s/12N9v1wgxSrX4wFbdvpyzKA">https://pan.baidu.com/s/12N9v1wgxSrX4wFbdvpyzKA</a> 提取码: ywyg</p><p>微云链接：链接：<a href="https://share.weiyun.com/KxVztnK4">https://share.weiyun.com/KxVztnK4</a> 密码：gz4wbu</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 原创软件 </tag>
            
            <tag> 免费影视会员 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
