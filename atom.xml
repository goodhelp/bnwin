<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>百脑问+ BnWin 知止而后有定</title>
  
  <subtitle>BnWin.com_人非草木,可语于冰。春可种,夏可耕,秋可收,冬可享。四季就是前路，理该上下而求索!</subtitle>
  <link href="https://www.bnwin.com/atom.xml" rel="self"/>
  
  <link href="https://www.bnwin.com/"/>
  <updated>2021-09-24T04:31:46.307Z</updated>
  <id>https://www.bnwin.com/</id>
  
  <author>
    <name>百脑问</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>修改你的显卡和CPU为最新型号，让你的硬件与时俱进！</title>
    <link href="https://www.bnwin.com/page/2207378725/"/>
    <id>https://www.bnwin.com/page/2207378725/</id>
    <published>2021-09-24T04:05:40.000Z</published>
    <updated>2021-09-24T04:31:46.307Z</updated>
    
    <content type="html"><![CDATA[<p>查看一台电脑的硬件配置，一般通过设备管理器<img src="/images/20210924120849.png" alt="设备管理器">,也可以通过dxdiag查看!<br>决定电脑配置性能的最主要零件，应属CPU和显卡了，有没有办法让设备管理器中显示的CPU和显卡名字，修改为我自己想显示的呢？<br>本软件就具有此功能，软件名一叶障目，就是自己骗自己的意思，硬件没变，只是名字变了，把750 Ti的显卡瞬间变成3060显卡，把I3的cpu瞬间显示为I7的cpu</p><h3 id="下图演示了，配置好原显卡或cpu名称，再配置好需要显示的显卡或cpu名字，运行一下本软件，设备管理器和dxdiag中显示的硬件名字就修改成功了"><a href="#下图演示了，配置好原显卡或cpu名称，再配置好需要显示的显卡或cpu名字，运行一下本软件，设备管理器和dxdiag中显示的硬件名字就修改成功了" class="headerlink" title="下图演示了，配置好原显卡或cpu名称，再配置好需要显示的显卡或cpu名字，运行一下本软件，设备管理器和dxdiag中显示的硬件名字就修改成功了!"></a>下图演示了，配置好原显卡或cpu名称，再配置好需要显示的显卡或cpu名字，运行一下本软件，设备管理器和dxdiag中显示的硬件名字就修改成功了!</h3><p><img src="/images/614d4ab1404c9_614d4ab152792.gif" alt="修改CPU显卡型号的软件"><br>本软件只需要运行一次就修改成功了(家用电脑)，如果有还原，只需开机运行一次就修改成功！(网吧电脑)<br>（暂时只持intel的cpu和n卡，AMD和A卡不能修改，没测试环境）</p><p>本软件就是你寻找的修改显卡型号软件，修改CPU型号软件，软件并未真正修改显卡信息，cpu信息，硬件没变，只是修改了显卡显示信息和CPU显示信息！</p><p>在win7和win10下测试正常，win11未测试</p><p><a href="https://item.taobao.com/item.htm?spm=a21dvs.23580594.0.0.621e645ePYo7kP&ft=t&id=656303890511">下载地址</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;查看一台电脑的硬件配置，一般通过设备管理器&lt;img src=&quot;/images/20210924120849.png&quot; alt=&quot;设备管理器&quot;&gt;,也可以通过dxdiag查看!&lt;br&gt;决定电脑配置性能的最主要零件，应属CPU和显卡了，有没有办法让设备管理器中显示的CPU和显卡名字，修改为我自己想显示的呢？&lt;br&gt;本软件就具有此功能，软件名一叶障目，就是自己骗自己的意思，硬件没变，只是名字变了，把750 Ti的显卡瞬间变成3060显卡，把I3的cpu瞬间显示为I7的cpu&lt;/p&gt;
&lt;h3 id=&quot;下图演示了，配置好原显卡或cpu名称，再配置好需要显示的显卡或cpu名字，运行一下本软件，设备管理器和dxdiag中显示的硬件名字就修改成功了&quot;&gt;&lt;a href=&quot;#下图演示了，配置好原显卡或cpu名称，再配置好需要显示的显卡或cpu名字，运行一下本软件，设备管理器和dxdiag中显示的硬件名字就修改成功了&quot; class=&quot;headerlink&quot; title=&quot;下图演示了，配置好原显卡或cpu名称，再配置好需要显示的显卡或cpu名字，运行一下本软件，设备管理器和dxdiag中显示的硬件名字就修改成功了!&quot;&gt;&lt;/a&gt;下图演示了，配置好原显卡或cpu名称，再配置好需要显示的显卡或cpu名字，运行一下本软件，设备管理器和dxdiag中显示的硬件名字就修改成功了!&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/614d4ab1404c9_614d4ab152792.gif&quot; alt=&quot;修改CPU显卡型号的软件&quot;&gt;&lt;br&gt;本软件只需要运行一次就修改成功了(家用电脑)，如果有还原，只需开机运行一次就修改成功！(网吧电脑)&lt;br&gt;（暂时只持intel的cpu和n卡，AMD和A卡不能修改，没测试环境）&lt;/p&gt;
&lt;p&gt;本软件就是你寻找的修改显卡型号软件，修改CPU型号软件，软件并未真正修改显卡信息，cpu信息，硬件没变，只是修改了显卡显示信息和CPU显示信息！&lt;/p&gt;
&lt;p&gt;在win7和win10下测试正常，win11未测试&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://item.taobao.com/item.htm?spm=a21dvs.23580594.0.0.621e645ePYo7kP&amp;ft=t&amp;id=656303890511&quot;&gt;下载地址&lt;/a&gt;&lt;/p&gt;
</summary>
    
    
    
    <category term="软件" scheme="https://www.bnwin.com/categories/soft/"/>
    
    
    <category term="原创软件" scheme="https://www.bnwin.com/tags/%E5%8E%9F%E5%88%9B%E8%BD%AF%E4%BB%B6/"/>
    
    <category term="修改显卡" scheme="https://www.bnwin.com/tags/%E4%BF%AE%E6%94%B9%E6%98%BE%E5%8D%A1/"/>
    
    <category term="修改CPU" scheme="https://www.bnwin.com/tags/%E4%BF%AE%E6%94%B9CPU/"/>
    
  </entry>
  
  <entry>
    <title>局域网文件多播，局域网拷贝文件，大文件批量传输</title>
    <link href="https://www.bnwin.com/page/3832108924/"/>
    <id>https://www.bnwin.com/page/3832108924/</id>
    <published>2021-09-23T01:44:58.000Z</published>
    <updated>2021-09-23T02:25:58.590Z</updated>
    
    <content type="html"><![CDATA[<h1 id="功能简介"><a href="#功能简介" class="headerlink" title="功能简介"></a>功能简介</h1><p>　　HOU文件多播 是用于局域网文件“一对多”批量传输的软件。它是基于UDP的可靠传输，<br>能有效提高传输速度，并减轻服务器负载。</p><p>　　多播(组播)的优点：可以真正同时的进行文件传送，客户机越多，总体速度就越快。<br>因为 总体速度 = 传送速度 X 客户机数目 。特别适合大文件的批量传输！</p><h1 id="使用功能说明"><a href="#使用功能说明" class="headerlink" title="使用功能说明"></a>使用功能说明</h1><p>选项:<br>　　1.“循环启动”，和“自动开始”配合使用可实现无人值守。<br>　　2.“自动开始”，根据设置的条件自动开始传输，<br>如:当有3个接收端连接时 或 当有一个接收端连接且达到“最大等待”时间。<br>　　3.“传输速率”，这个对在高负载网络上传输时较实用，可限制传输的带宽占用，减轻网络负载。<br>如果接收端性能较差可以适当限制传输速率，以提高整体速度。<br>　　4.“传输接口”，一般最好选择固定接口，特别是在发送端上存在ADSL拨号时需要选择接口,<br>软件会自动添加组播路由，以正常传输。<br>　　5.“开启流模式”，强制以组播方式传输，就算只有一个接收端（正常情况下只有一个接收端时会使用点对点传输）。<br>此功能开启后允许接收端加入一个正在传输的会话进行接收（但之前已经传输的数据将无法收到，所以一般不要中途加入）。</p><p>高级选项：<br>　　6.“初始片块数”，相当于TCP中的窗口大小，就是一次连续发送的块(UDP包)数。0为默认，一般不要修改。<br>　　7.“动态调整片块数”，根据重传情况自动调整连续发送的块数，以适应波动较大的网络(如无线)。<br>　　8.“超时重试次”，在发送完一片后请求接收端确认时，重试次数，以确定是否要放弃无响应的接收端。<br>如果经常出现接收端被断开，可适当加大重试次数。</p><h1 id="文件说明"><a href="#文件说明" class="headerlink" title="文件说明:"></a>文件说明:</h1><p>　　“DMCSender.exe” 发送端</p><p>　　“DMCReceiver.exe” 接收端<br>　　使用：<br>　　　　开始 -&gt; 运行 -&gt; DMCReceiver.exe D:\</p><h1 id="图文使用说明"><a href="#图文使用说明" class="headerlink" title="图文使用说明"></a>图文使用说明</h1><ol><li>接收端<br>首先接收端加接收目录参数，运行，如下图<br><img src="/images/20210923095321.png" alt="局域网传输文件接收端"></li><li>发送端</li></ol><ul><li>选择文件或文件夹</li><li>点击开始 会自动发现同局域网所有运行了接收端的客户机</li><li>点击传输 会同时向运行了接收端的机器传输文件或文件夹<br><img src="/images/20210923095841.png" alt="局域网接收文件发送端"><h1 id="应用案例"><a href="#应用案例" class="headerlink" title="应用案例"></a>应用案例</h1>局域网中，比如网吧，从客户端拷文件（游戏）到服务器，因为使用共享，服务器就不安全，如果安装ftp，一是麻烦，二是容易有利用漏洞。所以一般的操作就是U盘从客户机拷贝后再插到服务端拷贝，这样服务器容易中毒。使用此局域网拷贝软件，大大方便了操作！</li></ul><h1 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h1><p><a href="https://share.weiyun.com/ea2izq81">局域网传输文件工具</a> 密码：z2djzf</p><h1 id="使用感受"><a href="#使用感受" class="headerlink" title="使用感受"></a>使用感受</h1><p>  此软件使用delphi编写,对特殊文件名或目录，识别转换偶尔存在问题，即编码问题!如果你的文件或文件夹包括乱码，则可能传输会中断!<br>  如果使用此软件传输文件夹内容不成功,可以使用<a href="/page/1934957637/">croc</a>进行传输!</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;功能简介&quot;&gt;&lt;a href=&quot;#功能简介&quot; class=&quot;headerlink&quot; title=&quot;功能简介&quot;&gt;&lt;/a&gt;功能简介&lt;/h1&gt;&lt;p&gt;　　HOU文件多播 是用于局域网文件“一对多”批量传输的软件。它是基于UDP的可靠传输，&lt;br&gt;能有效提高传输速度，并减轻服务器负载。&lt;/p&gt;
&lt;p&gt;　　多播(组播)的优点：可以真正同时的进行文件传送，客户机越多，总体速度就越快。&lt;br&gt;因为 总体速度 = 传送速度 X 客户机数目 。特别适合大文件的批量传输！&lt;/p&gt;
&lt;h1 id=&quot;使用功能说明&quot;&gt;&lt;a href=&quot;#使用功能说明&quot; class=&quot;headerlink&quot; title=&quot;使用功能说明&quot;&gt;&lt;/a&gt;使用功能说明&lt;/h1&gt;&lt;p&gt;选项:&lt;br&gt;　　1.“循环启动”，和“自动开始”配合使用可实现无人值守。&lt;br&gt;　　2.“自动开始”，根据设置的条件自动开始传输，&lt;br&gt;如:当有3个接收端连接时 或 当有一个接收端连接且达到“最大等待”时间。&lt;br&gt;　　3.“传输速率”，这个对在高负载网络上传输时较实用，可限制传输的带宽占用，减轻网络负载。&lt;br&gt;如果接收端性能较差可以适当限制传输速率，以提高整体速度。&lt;br&gt;　　4.“传输接口”，一般最好选择固定接口，特别是在发送端上存在ADSL拨号时需要选择接口,&lt;br&gt;软件会自动添加组播路由，以正常传输。&lt;br&gt;　　5.“开启流模式”，强制以组播方式传输，就算只有一个接收端（正常情况下只有一个接收端时会使用点对点传输）。&lt;br&gt;此功能开启后允许接收端加入一个正在传输的会话进行接收（但之前已经传输的数据将无法收到，所以一般不要中途加入）。&lt;/p&gt;
&lt;p&gt;高级选项：&lt;br&gt;　　6.“初始片块数”，相当于TCP中的窗口大小，就是一次连续发送的块(UDP包)数。0为默认，一般不要修改。&lt;br&gt;　　7.“动态调整片块数”，根据重传情况自动调整连续发送的块数，以适应波动较大的网络(如无线)。&lt;br&gt;　　8.“超时重试次”，在发送完一片后请求接收端确认时，重试次数，以确定是否要放弃无响应的接收端。&lt;br&gt;如果经常出现接收端被断开，可适当加大重试次数。&lt;/p&gt;
&lt;h1 id=&quot;文件说明&quot;&gt;&lt;a href=&quot;#文件说明&quot; class=&quot;headerlink&quot; title=&quot;文件说明:&quot;&gt;&lt;/a&gt;文件说明:&lt;/h1&gt;&lt;p&gt;　　“DMCSender.exe” 发送端&lt;/p&gt;
&lt;p&gt;　　“DMCReceiver.exe” 接收端&lt;br&gt;　　使用：&lt;br&gt;　　　　开始 -&amp;gt; 运行 -&amp;gt; DMCReceiver.exe D:\&lt;/p&gt;
&lt;h1 id=&quot;图文使用说明&quot;&gt;&lt;a href=&quot;#图文使用说明&quot; class=&quot;headerlink&quot; title=&quot;图文使用说明&quot;&gt;&lt;/a&gt;图文使用说明&lt;/h1&gt;</summary>
    
    
    
    <category term="软件" scheme="https://www.bnwin.com/categories/soft/"/>
    
    
    <category term="局域网" scheme="https://www.bnwin.com/tags/%E5%B1%80%E5%9F%9F%E7%BD%91/"/>
    
    <category term="精品软件" scheme="https://www.bnwin.com/tags/%E7%B2%BE%E5%93%81%E8%BD%AF%E4%BB%B6/"/>
    
    <category term="文件传输" scheme="https://www.bnwin.com/tags/%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93/"/>
    
  </entry>
  
  <entry>
    <title>系统无法启动-电脑蓝屏等怎么办？使用Win10系统内置的万能工具解决此类问题!</title>
    <link href="https://www.bnwin.com/page/3944557397/"/>
    <id>https://www.bnwin.com/page/3944557397/</id>
    <published>2021-09-21T15:54:06.000Z</published>
    <updated>2021-09-22T01:36:22.128Z</updated>
    
    <content type="html"><![CDATA[<p>Windows无法正常工作，一般情况下很多人的做法就是重装系统，但对于电脑小白来说，重装系统就像是一个难题。并且系统中的数据最为重要，重装不是最好的选择。如果系统出现了问题，大家可利用该工具修复系统问题，实在没辙了再重装也为时未晚!</p><p><img src="/images/2021092201.jpg" alt="win re界面"></p><iframe frameborder="0"  width="100%" height="600px" src="https://v.douyin.com/df7xUFn/" allowFullScreen="true"></iframe> <p>由于磁盘损坏、系统文件损坏或缺少 或安装更新时挂起的操作，系统可能无法启动，依次执行</p><ol><li>BCDEdit (查看系统盘符)</li><li>CHKDSK /f 系统盘符: (修复磁盘错误)</li><li>SFC /scannow /offbootdir=系统盘符:\ /offwindir=系统盘符:\windows (检查修复系统文件)</li></ol><p>这是微软官方给出的解决windows常见启动问题的方法!蓝屏或启动不了系统，可以试试这样操作，不能保证百分百成功，至少离恢复正常工作环境又近了一步!注册表造成的蓝屏可以使用上个蓝屏视频试试!</p><p>执行sfc的相关提供信息如下：</p><p><img src="/images/fc1f4134970a304e444acafffb9c6b80c9175c21.jpeg"></p><p><a href="https://www.douyin.com/user/MS4wLjABAAAAQwn54Jes0qMk4oDljDNC_4zWQCZrhpoMQIe7aPmU4ueHtUmGvSuqmXY6BJRncREG">欢迎关注百脑问抖音：杰叔说电脑 抖音号：jscomp</a></p><p><a href="https://www.douyin.com/user/MS4wLjABAAAAMa9WqR28kXFhmkObqEzCq0HvOphSyHJaVMKrPHEia54">欢迎关注百脑问抖音：表情包零动画 抖音号：bqbao</a></p><p><a href="https://www.xiaohongshu.com/user/profile/5e495bbe0000000001005d53">欢迎关注百脑问小红书：电脑百科知识</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Windows无法正常工作，一般情况下很多人的做法就是重装系统，但对于电脑小白来说，重装系统就像是一个难题。并且系统中的数据最为重要，重装不是最好的选择。如果系统出现了问题，大家可利用该工具修复系统问题，实在没辙了再重装也为时未晚!&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/2021092201.jpg&quot; alt=&quot;win re界面&quot;&gt;&lt;/p&gt;
&lt;iframe frameborder=&quot;0&quot; width=&quot;100%&quot; height=&quot;600px&quot; src=&quot;https://v.douyin.com/df7xUFn/&quot; allowfullscreen=&quot;true&quot;&gt;&lt;/iframe&gt; 

&lt;p&gt;由于磁盘损坏、系统文件损坏或缺少 或安装更新时挂起的操作，系统可能无法启动，依次执行&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;BCDEdit (查看系统盘符)&lt;/li&gt;
&lt;li&gt;CHKDSK /f 系统盘符: (修复磁盘错误)&lt;/li&gt;
&lt;li&gt;SFC /scannow /offbootdir=系统盘符:\ /offwindir=系统盘符:\windows (检查修复系统文件)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这是微软官方给出的解决windows常见启动问题的方法!蓝屏或启动不了系统，可以试试这样操作，不能保证百分百成功，至少离恢复正常工作环境又近了一步!注册表造成的蓝屏可以使用上个蓝屏视频试试!&lt;/p&gt;
&lt;p&gt;执行sfc的相关提供信息如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/fc1f4134970a304e444acafffb9c6b80c9175c21.jpeg&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.douyin.com/user/MS4wLjABAAAAQwn54Jes0qMk4oDljDNC_4zWQCZrhpoMQIe7aPmU4ueHtUmGvSuqmXY6BJRncREG&quot;&gt;欢迎关注百脑问抖音：杰叔说电脑 抖音号：jscomp&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.douyin.com/user/MS4wLjABAAAAMa9WqR28kXFhmkObqEzCq0HvOphSyHJaVMKrPHEia54&quot;&gt;欢迎关注百脑问抖音：表情包零动画 抖音号：bqbao&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="抖音" scheme="https://www.bnwin.com/categories/douyin/"/>
    
    
    <category term="电脑蓝屏" scheme="https://www.bnwin.com/tags/%E7%94%B5%E8%84%91%E8%93%9D%E5%B1%8F/"/>
    
  </entry>
  
  <entry>
    <title>解决在hexo上github推送连接失败的问题</title>
    <link href="https://www.bnwin.com/page/1758950243/"/>
    <id>https://www.bnwin.com/page/1758950243/</id>
    <published>2021-09-20T04:21:38.000Z</published>
    <updated>2021-09-20T04:29:21.824Z</updated>
    
    <content type="html"><![CDATA[<p>在国内，有时候使用 git clone 的速度实在太慢而让人难以承受，或者 git pull/git push 一点反应都没有，这里整理了一下解决方法，亲测有效。<br>总的来说，这是因为 github.global.ssl.fastly.net 域名被限制了。只要找到这个域名对应的 ip 地址，然后在 hosts 文件中加上 ip–&gt;域名 的映射，刷新 DNS 缓存便可。<br><img src="/images/12b1a07f8ae753b1d1ee27e14e19f97.png"><br>1.查找域名对应的 ip 地址</p><ul><li><p>在网站 <a href="https://www.ipaddress.com/">https://www.ipaddress.com/</a> 分别搜索 github.global.ssl.fastly.net 和 github.com</p></li><li><p>或者在本地的终端中如下键入：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ nslookup github.global.ssl.fastly.<span class="built_in">Net</span></span><br><span class="line"><span class="function">Server:  127.0.0.53</span></span><br><span class="line"><span class="function"><span class="title">Address</span>: 127.0.0.53#53</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Non</span>-<span class="title">authoritative</span> <span class="title">answer</span>:</span></span><br><span class="line"><span class="function"><span class="title">Name</span>: <span class="title">github.global.ssl.fastly.Net</span></span></span><br><span class="line"><span class="function"><span class="title">Address</span>: 151.101.229.194</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">$ <span class="title">nslookup</span> <span class="title">github.com</span></span></span><br><span class="line"><span class="function"><span class="title">Server</span>:  127.0.0.53</span></span><br><span class="line"><span class="function"><span class="title">Address</span>: 127.0.0.53#53</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Non</span>-<span class="title">authoritative</span> <span class="title">answer</span>:</span></span><br><span class="line"><span class="function"><span class="title">Name</span>: <span class="title">github.com</span></span></span><br><span class="line"><span class="function"><span class="title">Address</span>: 13.229.188.59</span></span><br></pre></td></tr></table></figure></li></ul><ol start="2"><li>修改 hosts 文件</li></ol><ul><li>Windows 上的 hosts 文件路径在: C:\Windows\System32\drivers\etc\hosts<br>在 hosts 文件末尾添加两行<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># Copyright (c) <span class="number">1993</span>-<span class="number">2009</span> Microsoft Corp.</span><br><span class="line">#</span><br><span class="line"># This is a sample HOSTS file used by Microsoft TCP/IP <span class="keyword">for</span> Windows.</span><br><span class="line">#</span><br><span class="line"># This file contains the mappings of IP addresses to host names. Each</span><br><span class="line"># entry should be kept on an individual line. The IP address should</span><br><span class="line"># be placed <span class="keyword">in</span> the first column followed by the corresponding host name.</span><br><span class="line"># The IP address and the host name should be separated by <span class="built_in">at</span> least one</span><br><span class="line"># space.</span><br><span class="line">#</span><br><span class="line"># Additionally, comments (such as these) may be inserted on individual</span><br><span class="line"># lines or following the machine name denoted by a &#x27;#&#x27; symbol.</span><br><span class="line">#</span><br><span class="line"># <span class="keyword">For</span> example:</span><br><span class="line">#</span><br><span class="line">#      <span class="number">102</span>.<span class="number">54</span>.<span class="number">94</span>.<span class="number">97</span>     rhino.acme.com          # source server</span><br><span class="line">#       <span class="number">38</span>.<span class="number">25</span>.<span class="number">63</span>.<span class="number">10</span>     x.acme.com              # x client host</span><br><span class="line"></span><br><span class="line"># localhost name resolution is handled within DNS itself.</span><br><span class="line">#<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>       localhost</span><br><span class="line">#::<span class="number">1</span>             localhost</span><br><span class="line"></span><br><span class="line"><span class="number">199</span>.<span class="number">232</span>.<span class="number">69</span>.<span class="number">194</span> github.global.ssl.fastly.<span class="built_in">net</span></span><br></pre></td></tr></table></figure></li><li>Linux 的 hosts 文件路径在 /etc/hosts 中:<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/hosts</span><br></pre></td></tr></table></figure></li></ul><ol start="3"><li>刷新 DNS 缓存</li></ol><ul><li>windows<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ipconfig</span> /flushdns</span><br></pre></td></tr></table></figure></li><li>linux<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo /etc/init.d/networking restart</span><br></pre></td></tr></table></figure></li></ul><ol start="4"><li>参考文献<br><a href="https://blog.csdn.net/xiaolong_4_2/article/details/105389128">解决linux上git clone速度慢的问题</a><br><a href="https://www.jianshu.com/p/3f6477049ece">git clone速度太慢的解决办法</a></li><li>本文转载自<br><a href="https://iphysresearch.github.io/blog/post/programing/linux_shell/hosts/">解决 GitHub 的 host 域名被限制的问题</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;在国内，有时候使用 git clone 的速度实在太慢而让人难以承受，或者 git pull/git push 一点反应都没有，这里整理了一下解决方法，亲测有效。&lt;br&gt;总的来说，这是因为 github.global.ssl.fastly.net 域名被限制了。只要找到这个域名对应的 ip 地址，然后在 hosts 文件中加上 ip–&amp;gt;域名 的映射，刷新 DNS 缓存便可。&lt;br&gt;&lt;img src=&quot;/images/12b1a07f8ae753b1d1ee27e14e19f97.png&quot;&gt;&lt;br&gt;1.查找域名对应的 ip 地址&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;在网站 &lt;a href=&quot;https://www.ipaddress.com/&quot;&gt;https://www.ipaddress.com/&lt;/a&gt; 分别搜索 github.global.ssl.fastly.net 和 github.com&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;或者在本地的终端中如下键入：&lt;/p&gt;
&lt;figure class=&quot;highlight dos&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ nslookup github.global.ssl.fastly.&lt;span class=&quot;built_in&quot;&gt;Net&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;Server:  127.0.0.53&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Address&lt;/span&gt;: 127.0.0.53#53&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Non&lt;/span&gt;-&lt;span class=&quot;title&quot;&gt;authoritative&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;answer&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Name&lt;/span&gt;: &lt;span class=&quot;title&quot;&gt;github.global.ssl.fastly.Net&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Address&lt;/span&gt;: 151.101.229.194&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;$ &lt;span class=&quot;title&quot;&gt;nslookup&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;github.com&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Server&lt;/span&gt;:  127.0.0.53&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Address&lt;/span&gt;: 127.0.0.53#53&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Non&lt;/span&gt;-&lt;span class=&quot;title&quot;&gt;authoritative&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;answer&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Name&lt;/span&gt;: &lt;span class=&quot;title&quot;&gt;github.com&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Address&lt;/span&gt;: 13.229.188.59&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;修改 hosts 文件&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Windows 上的 hosts 文件路径在: C:\Windows\System32\drivers\etc\hosts&lt;br&gt;在 hosts 文件末尾添加两行&lt;figure class=&quot;highlight dos&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# Copyright (c) &lt;span class=&quot;number&quot;&gt;1993&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;2009&lt;/span&gt; Microsoft Corp.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# This is a sample HOSTS file used by Microsoft TCP/IP &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; Windows.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# This file contains the mappings of IP addresses to host names. Each&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# entry should be kept on an individual line. The IP address should&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# be placed &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; the first column followed by the corresponding host name.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# The IP address and the host name should be separated by &lt;span class=&quot;built_in&quot;&gt;at&lt;/span&gt; least one&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# space.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# Additionally, comments (such as these) may be inserted on individual&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# lines or following the machine name denoted by a &amp;#x27;#&amp;#x27; symbol.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# &lt;span class=&quot;keyword&quot;&gt;For&lt;/span&gt; example:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#      &lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;     rhino.acme.com          # source server&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#       &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;     x.acme.com              # x client host&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# localhost name resolution is handled within DNS itself.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#	&lt;span class=&quot;number&quot;&gt;127&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;       localhost&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#	::&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;             localhost&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;199&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;69&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;194&lt;/span&gt; github.global.ssl.fastly.&lt;span class=&quot;built_in&quot;&gt;net&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;Linux 的 hosts 文件路径在 /etc/hosts 中:&lt;figure class=&quot;highlight dos&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ sudo vim /etc/hosts&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;刷新 DNS 缓存&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;windows&lt;figure class=&quot;highlight dos&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;ipconfig&lt;/span&gt; /flushdns&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;linux&lt;figure class=&quot;highlight dos&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ sudo /etc/init.d/networking restart&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;参考文献&lt;br&gt;&lt;a href=&quot;https://blog.csdn.net/xiaolong_4_2/article/details/105389128&quot;&gt;解决linux上git clone速度慢的问题&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.jianshu.com/p/3f6477049ece&quot;&gt;git clone速度太慢的解决办法&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;本文转载自&lt;br&gt;&lt;a href=&quot;https://iphysresearch.github.io/blog/post/programing/linux_shell/hosts/&quot;&gt;解决 GitHub 的 host 域名被限制的问题&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</summary>
    
    
    
    <category term="杂集" scheme="https://www.bnwin.com/categories/other/"/>
    
    
    <category term="开源项目" scheme="https://www.bnwin.com/tags/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>看完世界上最诡异的图片，你还会相信你的眼睛吗？</title>
    <link href="https://www.bnwin.com/page/3381448577/"/>
    <id>https://www.bnwin.com/page/3381448577/</id>
    <published>2021-09-20T02:00:47.000Z</published>
    <updated>2021-09-20T02:10:51.274Z</updated>
    
    <content type="html"><![CDATA[<p>如果你看见这个舞女是顺时针转，说明你用的是右脑；­<br>如果是逆时针转，说明你用的左脑。­<br>据说，14%的美国人可以两个方向都能看见。­<br>可以和别人一起看，测试下，一般不同人同时看这张图的感觉都会不太一样的，真的很神奇。<br><img src="/images/2021092001.gif"><br>照片的本身由34张图片组成的gif图，在photoshop中，一张一张的看，是从左向右转动，如果你看到的图片一会左转，一会儿右转，并不是图片本身是多方向变动的，这一点你可以下载图片自己用photoshop查看! <img src="/images/20210920100945.png"></p><p>下面这张图片:柱子到底是圆的还是方的,别着急慢慢看<br><img src="/images/2021092002.jpg"></p><p>看着黑点身体前后移动</p><p><img src="/images/2021092003.jpg"></p><p>这些图片到底是静的还是动的（看则静，不看则动）</p><p><img src="/images/2021092004.jpg"><br><img src="/images/2021092005.jpg"><br><img src="/images/2021092006.jpg"><br><img src="/images/2021092007.jpg"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;如果你看见这个舞女是顺时针转，说明你用的是右脑；­&lt;br&gt;如果是逆时针转，说明你用的左脑。­&lt;br&gt;据说，14%的美国人可以两个方向都能看见。­&lt;br&gt;可以和别人一起看，测试下，一般不同人同时看这张图的感觉都会不太一样的，真的很神奇。&lt;br&gt;&lt;img src=&quot;/images/2021092001.gif&quot;&gt;&lt;br&gt;照片的本身由34张图片组成的gif图，在photoshop中，一张一张的看，是从左向右转动，如果你看到的图片一会左转，一会儿右转，并不是图片本身是多方向变动的，这一点你可以下载图片自己用photoshop查看! &lt;img src=&quot;/images/20210920100945.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;下面这张图片:柱子到底是圆的还是方的,别着急慢慢看&lt;br&gt;&lt;img src=&quot;/images/2021092002.jpg&quot;&gt;&lt;/p&gt;
&lt;p&gt;看着黑点身体前后移动&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/2021092003.jpg&quot;&gt;&lt;/p&gt;
&lt;p&gt;这些图片到底是静的还是动的（看则静，不看则动）&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/2021092004.jpg&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/2021092005.jpg&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/2021092006.jpg&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/2021092007.jpg&quot;&gt;&lt;/p&gt;
</summary>
    
    
    
    <category term="素材" scheme="https://www.bnwin.com/categories/material/"/>
    
    
    <category term="图片" scheme="https://www.bnwin.com/tags/%E5%9B%BE%E7%89%87/"/>
    
  </entry>
  
  <entry>
    <title>编程实现关闭显示器等的python源代码-等同于按显示器的电源键</title>
    <link href="https://www.bnwin.com/page/93934963/"/>
    <id>https://www.bnwin.com/page/93934963/</id>
    <published>2021-09-19T08:21:43.000Z</published>
    <updated>2021-09-19T13:20:52.667Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/1440056844.jpg"></p><h1 id="可实现功能"><a href="#可实现功能" class="headerlink" title="可实现功能"></a>可实现功能</h1><p>通过显示器的 DDC/CI 来直接操作显示器，拯救可怜的显示器按键。</p><p>支持的操作：</p><ul><li><p>调整亮度</p></li><li><p>调整对比度</p></li><li><p>设置色温 / 颜色预设</p></li><li><p>设置RGB颜色的比例</p></li><li><p>OSD语言</p></li><li><p>开关机</p></li><li><p>切换输入源</p></li><li><p>自动调整图像 (VGA输入需要)</p></li><li><p>恢复出厂设置</p><h1 id="系统需求"><a href="#系统需求" class="headerlink" title="系统需求"></a>系统需求</h1><p>Windows Vista +<br>Python3 (建议安装时选上Python Launcher)<br>支持DDC/CI的外接显示器，不支持笔记本内置显示器<br><img src="/images/2021091901.jpg"></p><h1 id="使用参考"><a href="#使用参考" class="headerlink" title="使用参考"></a>使用参考</h1><p>GUI 模式<br>不附加参数启动 monitor_ctrl.py 即可启动GUI，直接拖动滑条设置显示器的参数。</p></li></ul><p>由于显示器应用VCP指令可能需要一定时间，为避免出错，GUI模式将忽略命令行指定的操作。</p><p>GUI中显示的配置不会自动刷新，要查看新的配置目前需要重启应用程序。</p><p>将文件后缀修改为 .pyw, 直接双击打开，可以避免显示conhost黑窗口</p><p>命令行模式<br>当指定 -c 选项或者 tkinter import失败就会使用CLI模式。</p><p>py monitor_ctrl.py [-h] [-m Model_string] [-s Settings_string] [-r] [-t] [-c] [-l] [-v]<br>  -h          显示帮助<br>  -m          指定要应用到的Monitor Model，不指定则应用到所有可操作的显示器<br>  -s          property1=value1:property2=”value 2” 应用多项设置<br>  -r          将显示器恢复出厂设置<br>  -t          对输入执行自动调整（仅VGA输入需要）<br>  -c          不启用GUI<br>  -l          显示可操作的显示器model<br>  -v          Verbose logging</p><p>example：</p><p>列出可操作的显示器<br>monitor_ctrl.py -c -l</p><p>降低显示器的亮度和蓝色亮度：<br>monitor_ctrl.py -c -s brightness=10:rgb_gain=”(100, 100, 80)”</p><p>设置显示器颜色预设为 sRGB ：<br>monitor_ctrl.py -c -s color_preset=sRGB</p><p>恢复出厂设置：<br>monitor_ctrl.py -c -r</p><p>VGA输入自动调整<br>monitor_ctrl.py -c -t</p><p>仅设置某个特定型号的显示器：<br>monitor_ctrl.py -c -m p2401 -s power_mode=on</p><p>-s 接受的属性<br>参见后面 PhyMonitor() 类的常用属性。</p><p>python实现的主代码如下:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding = utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> wintypes</span><br><span class="line"><span class="keyword">import</span> vcp_code</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Tuple</span></span><br><span class="line"></span><br><span class="line">_LOGGER = logging.getLogger(__name__)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Reference</span></span><br><span class="line"><span class="string">[High-Level Monitor API](https://msdn.microsoft.com/en-us/library/vs/alm/dd692964(v=vs.85).aspx)</span></span><br><span class="line"><span class="string">[Low-Level Monitor Configuration](https://msdn.microsoft.com/en-us/library/windows/desktop/dd692982(v=vs.85).aspx)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Monitor Control Command Set](https://en.wikipedia.org/wiki/Monitor_Control_Command_Set)</span></span><br><span class="line"><span class="string">https://milek7.pl/ddcbacklight/mccs.pdf</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># #################################### Use Windows API to enumerate monitors</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_physical_monitors_from_hmonitor</span>(<span class="params">hmonitor: wintypes.HMONITOR</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Retrieves the physical monitors associated with an HMONITOR monitor handle</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    https://msdn.microsoft.com/en-us/library/vs/alm/dd692950(v=vs.85).aspx</span></span><br><span class="line"><span class="string">    BOOL GetPhysicalMonitorsFromHMONITOR(</span></span><br><span class="line"><span class="string">        _In_   HMONITOR hMonitor,</span></span><br><span class="line"><span class="string">        _In_   DWORD dwPhysicalMonitorArraySize,</span></span><br><span class="line"><span class="string">        _Out_  LPPHYSICAL_MONITOR pPhysicalMonitorArray</span></span><br><span class="line"><span class="string">    );</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Retrieves the number of physical monitors associated with an HMONITOR monitor handle.</span></span><br><span class="line"><span class="string">    Call this function before calling GetPhysicalMonitorsFromHMONITOR.</span></span><br><span class="line"><span class="string">    https://msdn.microsoft.com/en-us/library/dd692948(v=vs.85).aspx</span></span><br><span class="line"><span class="string">    BOOL GetNumberOfPhysicalMonitorsFromHMONITOR(</span></span><br><span class="line"><span class="string">        _In_   HMONITOR hMonitor,</span></span><br><span class="line"><span class="string">        _Out_  LPDWORD pdwNumberOfPhysicalMonitors</span></span><br><span class="line"><span class="string">    );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :param hmonitor:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">_PhysicalMonitorStructure</span>(<span class="params">ctypes.Structure</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        PHYSICAL_MONITOR Structure.</span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/vs/alm/dd692967(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        typedef struct _PHYSICAL_MONITOR &#123;</span></span><br><span class="line"><span class="string">            HANDLE hPhysicalMonitor;</span></span><br><span class="line"><span class="string">            WCHAR  szPhysicalMonitorDescription[PHYSICAL_MONITOR_DESCRIPTION_SIZE];</span></span><br><span class="line"><span class="string">        &#125; PHYSICAL_MONITOR, *LPPHYSICAL_MONITOR;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        PHYSICAL_MONITOR_DESCRIPTION_SIZE = 128</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        _fields_ = [</span><br><span class="line">            (<span class="string">&quot;hPhysicalMonitor&quot;</span>, wintypes.HANDLE),</span><br><span class="line">            (<span class="string">&quot;szPhysicalMonitorDescription&quot;</span>, wintypes.WCHAR * <span class="number">128</span>)</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Retrieves the number of physical monitors</span></span><br><span class="line">    phy_monitor_number = wintypes.DWORD()</span><br><span class="line">    api_call_get_number = ctypes.windll.Dxva2.GetNumberOfPhysicalMonitorsFromHMONITOR</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> api_call_get_number(hmonitor, ctypes.byref(phy_monitor_number)):</span><br><span class="line">        _LOGGER.error(ctypes.WinError())</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Retrieves the physical monitors</span></span><br><span class="line">    api_call_get_monitor = ctypes.windll.Dxva2.GetPhysicalMonitorsFromHMONITOR</span><br><span class="line">    <span class="comment"># create array</span></span><br><span class="line">    phy_monitor_array = (_PhysicalMonitorStructure * phy_monitor_number.value)()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> api_call_get_monitor(hmonitor, phy_monitor_number, phy_monitor_array):</span><br><span class="line">        _LOGGER.error(ctypes.WinError())</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(phy_monitor_array)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enumerate_monitors</span>() -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    enumerate all physical monitor.</span></span><br><span class="line"><span class="string">    ** 请注意防止返回的 Handle 对象被GC!</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    https://msdn.microsoft.com/en-us/library/dd162610(v=vs.85).aspx</span></span><br><span class="line"><span class="string">    BOOL EnumDisplayMonitors(</span></span><br><span class="line"><span class="string">        _In_ HDC             hdc,</span></span><br><span class="line"><span class="string">        _In_ LPCRECT         lprcClip,</span></span><br><span class="line"><span class="string">        _In_ MONITORENUMPROC lpfnEnum,</span></span><br><span class="line"><span class="string">        _In_ LPARAM          dwData</span></span><br><span class="line"><span class="string">    );</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    :return: list contains physical monitor handles</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    all_hmonitor = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Factory function of EnumDisplayMonitors callback.</span></span><br><span class="line">    <span class="comment"># 保持引用以防止被GC !</span></span><br><span class="line">    <span class="comment"># https://msdn.microsoft.com/en-us/library/dd145061(v=vs.85).aspx</span></span><br><span class="line">    _MONITOR_ENUM_PROC = ctypes.WINFUNCTYPE(wintypes.BOOL,</span><br><span class="line">                                            wintypes.HMONITOR,</span><br><span class="line">                                            wintypes.HDC,</span><br><span class="line">                                            ctypes.POINTER(wintypes.LPRECT),</span><br><span class="line">                                            wintypes.LPARAM)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__monitor_enum_proc_callback</span>(<span class="params">hmonitor_: wintypes.HMONITOR, hdc, lprect, lparam</span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        EnumDisplayMonitors callback, append HMONITOR to all_hmonitor list.</span></span><br><span class="line"><span class="string">        :param hmonitor_:</span></span><br><span class="line"><span class="string">        :param hdc:</span></span><br><span class="line"><span class="string">        :param lprect:</span></span><br><span class="line"><span class="string">        :param lparam:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        all_hmonitor.append(hmonitor_)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ctypes.windll.user32.EnumDisplayMonitors(<span class="literal">None</span>, <span class="literal">None</span>,</span><br><span class="line">                                                    _MONITOR_ENUM_PROC(__monitor_enum_proc_callback), <span class="literal">None</span>):</span><br><span class="line">            <span class="keyword">raise</span> ctypes.WinError()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># get physical monitor handle</span></span><br><span class="line">    handles = []</span><br><span class="line">    <span class="keyword">for</span> hmonitor <span class="keyword">in</span> all_hmonitor:</span><br><span class="line">        handles.extend(_get_physical_monitors_from_hmonitor(hmonitor))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> handles</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PhyMonitor</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    一个物理显示器的VCP控制class，封装常用操作.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, phy_monitor</span>):</span></span><br><span class="line">        self._phy_monitor = phy_monitor</span><br><span class="line">        self._phy_monitor_handle = self._phy_monitor.hPhysicalMonitor</span><br><span class="line">        <span class="comment"># VCP Capabilities String</span></span><br><span class="line">        self._caps_string = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># Monitor model name</span></span><br><span class="line">        self.model = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        self.info_display_type = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        </span><br><span class="line">        self._get_monitor_caps()</span><br><span class="line">        <span class="keyword">if</span> self._caps_string != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            self._get_model_info()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_monitor_caps</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/windows/desktop/dd692938(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        BOOL GetCapabilitiesStringLength(</span></span><br><span class="line"><span class="string">            _In_   HANDLE hMonitor,</span></span><br><span class="line"><span class="string">            _Out_  LPDWORD pdwCapabilitiesStringLengthInCharacters</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/windows/desktop/dd692934(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        BOOL CapabilitiesRequestAndCapabilitiesReply(</span></span><br><span class="line"><span class="string">            _In_   HANDLE hMonitor,</span></span><br><span class="line"><span class="string">            _Out_  LPSTR pszASCIICapabilitiesString,</span></span><br><span class="line"><span class="string">            _In_   DWORD dwCapabilitiesStringLengthInCharacters</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        caps_string_length = wintypes.DWORD()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ctypes.windll.Dxva2.GetCapabilitiesStringLength(self._phy_monitor_handle,</span><br><span class="line">                                                               ctypes.byref(caps_string_length)):</span><br><span class="line">            _LOGGER.error(ctypes.WinError())</span><br><span class="line">            <span class="keyword">raise</span> ctypes.WinError()</span><br><span class="line">        </span><br><span class="line">        caps_string = (ctypes.c_char * caps_string_length.value)()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ctypes.windll.Dxva2.CapabilitiesRequestAndCapabilitiesReply(</span><br><span class="line">                self._phy_monitor_handle, caps_string, caps_string_length):</span><br><span class="line">                _LOGGER.error(ctypes.WinError())</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        self._caps_string = caps_string.value.decode(<span class="string">&#x27;ASCII&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_model_info</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        analyze caps string</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">find_</span>(<span class="params">src: <span class="built_in">str</span>, start_: <span class="built_in">str</span>, end_: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            查找 start_ 和 end_ 之间包围的内容</span></span><br><span class="line"><span class="string">            :param src: 待寻找的支付串</span></span><br><span class="line"><span class="string">            :param start_:</span></span><br><span class="line"><span class="string">            :param end_:</span></span><br><span class="line"><span class="string">            :return:</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">            start_index = src.find(start_)</span><br><span class="line">            <span class="keyword">if</span> start_index == -<span class="number">1</span>:</span><br><span class="line">                <span class="comment"># not found</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">            start_index = start_index + <span class="built_in">len</span>(start_)</span><br><span class="line">            </span><br><span class="line">            end_index = src.find(end_, start_index)</span><br><span class="line">            <span class="keyword">if</span> end_index == -<span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> src[start_index:end_index]</span><br><span class="line">        </span><br><span class="line">        model = find_(self._caps_string, <span class="string">&#x27;model(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> model == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;unable to find model info in vcp caps string: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(self._caps_string))</span><br><span class="line">        self.model = model</span><br><span class="line"></span><br><span class="line">        info_display_type = find_(self._caps_string, <span class="string">&#x27;type(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> info_display_type == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;unable to find display type info in vcp caps string: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(self._caps_string))</span><br><span class="line">        self.info_display_type = info_display_type</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Close WinAPI Handle.</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/windows/desktop/dd692936(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        BOOL DestroyPhysicalMonitor(</span></span><br><span class="line"><span class="string">            _In_  HANDLE hMonitor</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">import</span> ctypes</span><br><span class="line">        api_call = ctypes.windll.Dxva2.DestroyPhysicalMonitor</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> api_call(self._phy_monitor_handle):</span><br><span class="line">            _LOGGER.error(ctypes.WinError())</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ########################## 发送/读取 VCP 设置的函数</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send_vcp_code</span>(<span class="params">self, code: <span class="built_in">int</span>, value: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        send vcp code to monitor.</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/dd692979(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        BOOL SetVCPFeature(</span></span><br><span class="line"><span class="string">            _In_  HANDLE hMonitor,</span></span><br><span class="line"><span class="string">            _In_  BYTE bVCPCode,</span></span><br><span class="line"><span class="string">            _In_  DWORD dwNewValue</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        :param code: VCP Code</span></span><br><span class="line"><span class="string">        :param value: Data</span></span><br><span class="line"><span class="string">        :return: Win32 API return</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> code <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            _LOGGER.error(<span class="string">&#x27;vcp code to send is None. ignored.&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        api_call = ctypes.windll.Dxva2.SetVCPFeature</span><br><span class="line">        code = wintypes.BYTE(code)</span><br><span class="line">        new_value = wintypes.DWORD(value)</span><br><span class="line">        api_call.restype = ctypes.c_bool</span><br><span class="line">        ret_ = api_call(self._phy_monitor_handle, code, new_value)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ret_:</span><br><span class="line">            _LOGGER.error(<span class="string">&#x27;send vcp command failed: &#x27;</span> + <span class="built_in">hex</span>(code))</span><br><span class="line">            _LOGGER.error(ctypes.WinError())</span><br><span class="line">        <span class="keyword">return</span> ret_</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_vcp_code</span>(<span class="params">self, code: <span class="built_in">int</span></span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        send vcp code to monitor, get current value and max value.</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        https://msdn.microsoft.com/en-us/library/dd692953(v=vs.85).aspx</span></span><br><span class="line"><span class="string">        BOOL GetVCPFeatureAndVCPFeatureReply(</span></span><br><span class="line"><span class="string">            _In_   HANDLE hMonitor,</span></span><br><span class="line"><span class="string">            _In_   BYTE bVCPCode,</span></span><br><span class="line"><span class="string">            _Out_  LPMC_VCP_CODE_TYPE pvct,</span></span><br><span class="line"><span class="string">            _Out_  LPDWORD pdwCurrentValue,</span></span><br><span class="line"><span class="string">            _Out_  LPDWORD pdwMaximumValue</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        :param code: VCP Code</span></span><br><span class="line"><span class="string">        :return: current_value, max_value</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> code <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            _LOGGER.error(<span class="string">&#x27;vcp code to send is None. ignored.&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        api_call = ctypes.windll.Dxva2.GetVCPFeatureAndVCPFeatureReply</span><br><span class="line">        api_in_vcp_code = wintypes.BYTE(code)</span><br><span class="line">        api_out_current_value = wintypes.DWORD()</span><br><span class="line">        api_out_max_value = wintypes.DWORD()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> api_call(self._phy_monitor_handle, api_in_vcp_code, <span class="literal">None</span>,</span><br><span class="line">                        ctypes.byref(api_out_current_value), ctypes.byref(api_out_max_value)):</span><br><span class="line">            _LOGGER.error(<span class="string">&#x27;get vcp command failed: &#x27;</span> + <span class="built_in">hex</span>(code))</span><br><span class="line">            _LOGGER.error(ctypes.WinError())</span><br><span class="line">        <span class="keyword">return</span> api_out_current_value.value, api_out_max_value.value</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_vcp_value_by_name</span>(<span class="params">self, vcp_code_key: <span class="built_in">str</span>, value: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        根据功能名称发送vcp code和数据</span></span><br><span class="line"><span class="string">        :param vcp_code_key: key name of vcp_code.VCP_CODE dict</span></span><br><span class="line"><span class="string">        :param value: new value</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.send_vcp_code(vcp_code.VCP_CODE.get(vcp_code_key), value)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_vcp_value_by_name</span>(<span class="params">self, vcp_code_key: <span class="built_in">str</span></span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        根据功能名称读取vcp code的值和最大值</span></span><br><span class="line"><span class="string">        :param vcp_code_key: key name of vcp_code.VCP_CODE dict</span></span><br><span class="line"><span class="string">        :return: current_value, max_value</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.read_vcp_code(vcp_code.VCP_CODE.get(vcp_code_key))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ########################### 经过包装后方便调用的属性/方法</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reset_factory</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Reset monitor to factory defaults</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Restore Factory Defaults&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">color_temperature</span>(<span class="params">self</span>):</span></span><br><span class="line">        increment = self.get_vcp_value_by_name(<span class="string">&#x27;User Color Temperature Increment&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        current = self.get_vcp_value_by_name(<span class="string">&#x27;User Color Temperature&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3000</span> + current * increment</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @color_temperature.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">color_temperature</span>(<span class="params">self, value: <span class="built_in">int</span></span>):</span></span><br><span class="line">        increment = self.get_vcp_value_by_name(<span class="string">&#x27;User Color Temperature Increment&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        new_value = (value - <span class="number">3000</span>) // increment</span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;User Color Temperature&#x27;</span>, new_value)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">brightness_max</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Luminance&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">brightness</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Luminance&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @brightness.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">brightness</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        设置亮度</span></span><br><span class="line"><span class="string">        :param value:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        brightness_max = self.brightness_max</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; brightness_max:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid brightness level: &#123;&#125;, allowed: 0-&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                value, brightness_max))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Luminance&#x27;</span>, value)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">contrast_max</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Contrast&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">contrast</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Contrast&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @contrast.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">contrast</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        contrast_max = self.contrast_max</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; contrast_max:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid contrast level: &#123;&#125;, allowed: 0-&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                value, contrast_max))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Contrast&#x27;</span>, value)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">color_preset_list</span>(<span class="params">self</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        可用的color preset, 显示器不一定全部支持</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(vcp_code.COLOR_PRESET_CODE.keys())</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">color_preset</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        当前的color preset</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        preset = self.get_vcp_value_by_name(<span class="string">&#x27;Select Color Preset&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(vcp_code.COLOR_PRESET_CODE.keys()):</span><br><span class="line">            <span class="keyword">if</span> vcp_code.COLOR_PRESET_CODE[i] == preset:</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @color_preset.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">color_preset</span>(<span class="params">self, preset: <span class="built_in">str</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> preset <span class="keyword">not</span> <span class="keyword">in</span> self.color_preset_list:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid color preset: &#123;&#125;, available:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                preset, self.color_preset_list))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Select Color Preset&#x27;</span>, vcp_code.COLOR_PRESET_CODE.get(preset))</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rgb_gain_max</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        最大允许设置的RGB值</span></span><br><span class="line"><span class="string">        ! 只取红色的RGB最大值作为3个颜色的参考</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Video Gain Red&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rgb_gain</span>(<span class="params">self</span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>]:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        :return:  Red, Green, Blue</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        rg = self.get_vcp_value_by_name(<span class="string">&#x27;Video Gain Red&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        gg = self.get_vcp_value_by_name(<span class="string">&#x27;Video Gain Green&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        bg = self.get_vcp_value_by_name(<span class="string">&#x27;Video Gain Blue&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> rg, gg, bg</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @rgb_gain.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rgb_gain</span>(<span class="params">self, value_pack</span>):</span></span><br><span class="line">        max_ = self.rgb_gain_max</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 检查传入参数</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">check_input</span>(<span class="params">value</span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            检查传入的RGB gain</span></span><br><span class="line"><span class="string">            :param value:</span></span><br><span class="line"><span class="string">            :return:</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">            <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; max_:</span><br><span class="line">                _LOGGER.warning(<span class="string">&#x27;invalid RGB value: &#123;&#125;, allowed: 0-&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                    value, max_))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            rg = value_pack[<span class="number">0</span>]</span><br><span class="line">            gg = value_pack[<span class="number">1</span>]</span><br><span class="line">            bg = value_pack[<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">            _LOGGER.error(err)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (check_input(rg) <span class="keyword">and</span> check_input(gg) <span class="keyword">and</span> check_input(bg)):</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="comment"># 设置 RGB Gain</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Video Gain Red&#x27;</span>, rg)</span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Video Gain Green&#x27;</span>, gg)</span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Video Gain Blue&#x27;</span>, bg)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">auto_setup_perform</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        执行自动调整</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Auto Setup&#x27;</span>, vcp_code.AUTO_SETUP_CODE.get(<span class="string">&#x27;Manual Perform&#x27;</span>))</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">info_poweron_hours</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        返回显示器的开机时间 (Hours)</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.get_vcp_value_by_name(<span class="string">&#x27;Display Usage Time&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">osd_languages_list</span>(<span class="params">self</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        VCP 中指定的语言列表</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(vcp_code.OSD_LANG_CODE.keys())</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">osd_language</span>(<span class="params">self</span>):</span></span><br><span class="line">        language = self.get_vcp_value_by_name(<span class="string">&#x27;OSD Language&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(vcp_code.OSD_LANG_CODE.keys()):</span><br><span class="line">            <span class="keyword">if</span> vcp_code.OSD_LANG_CODE[i] == language:</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @osd_language.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">osd_language</span>(<span class="params">self, language: <span class="built_in">str</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> language <span class="keyword">not</span> <span class="keyword">in</span> self.osd_languages_list:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid OSD Language: &#123;&#125;, available:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                language, self.osd_languages_list))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;OSD Language&#x27;</span>, vcp_code.OSD_LANG_CODE.get(language))</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">power_mode_list</span>(<span class="params">self</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        VCP 中指定的电源状态</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(vcp_code.POWER_MODE_CODE.keys())</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">power_mode</span>(<span class="params">self</span>):</span></span><br><span class="line">        power_ = self.get_vcp_value_by_name(<span class="string">&#x27;Power Mode&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(vcp_code.POWER_MODE_CODE.keys()):</span><br><span class="line">            <span class="keyword">if</span> vcp_code.POWER_MODE_CODE[i] == power_:</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">        <span class="comment"># return &#x27;off&#x27; to fix quirky, example: when power-off, it return 0x02</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;off&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @power_mode.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">power_mode</span>(<span class="params">self, mode: <span class="built_in">str</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> mode <span class="keyword">not</span> <span class="keyword">in</span> self.power_mode_list:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid power mode: &#123;&#125;, available:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                mode, self.power_mode_list))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Power Mode&#x27;</span>, vcp_code.POWER_MODE_CODE.get(mode))</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">input_src_list</span>(<span class="params">self</span>) -&gt; <span class="built_in">list</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        VCP 中指定的输入源</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(vcp_code.INPUT_SRC_CODE.keys())</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">input_src</span>(<span class="params">self</span>):</span></span><br><span class="line">        input_ = self.get_vcp_value_by_name(<span class="string">&#x27;Input Source&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(vcp_code.INPUT_SRC_CODE.keys()):</span><br><span class="line">            <span class="keyword">if</span> vcp_code.INPUT_SRC_CODE[i] == input_:</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @input_src.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">input_src</span>(<span class="params">self, src: <span class="built_in">str</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> src <span class="keyword">not</span> <span class="keyword">in</span> self.input_src_list:</span><br><span class="line">            _LOGGER.warning(<span class="string">&#x27;invalid input source: &#123;&#125;, available:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                src, self.input_src_list))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.set_vcp_value_by_name(<span class="string">&#x27;Input Source&#x27;</span>, vcp_code.INPUT_SRC_CODE.get(src))</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">info_pannel_type</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">        pannel_type = self.get_vcp_value_by_name(<span class="string">&#x27;Flat Panel Sub-Pixel Layout&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> vcp_code.FLAT_PANEL_SUB_PIXEL_LAYOUT_CODE.get(pannel_type, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># test code</span></span><br><span class="line">    </span><br><span class="line">    logging.basicConfig(level=logging.INFO)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 检查是否在支持的平台上工作</span></span><br><span class="line">    <span class="comment"># os.popen(&#x27;ver.exe&#x27;).read()</span></span><br><span class="line">    <span class="keyword">if</span> sys.platform != <span class="string">&#x27;win32&#x27;</span> <span class="keyword">or</span> sys.version_info.major != <span class="number">3</span>:</span><br><span class="line">        _LOGGER.error(<span class="string">&#x27;不支持的平台，需要 Windows Vista+, Python 3&#x27;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        monitors = enumerate_monitors()</span><br><span class="line">    <span class="keyword">except</span> OSError:</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    phy_monitors = []</span><br><span class="line">    <span class="keyword">for</span> h_monitor <span class="keyword">in</span> monitors:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            monitor = PhyMonitor(h_monitor)</span><br><span class="line">        <span class="keyword">except</span> OSError <span class="keyword">as</span> os_err:</span><br><span class="line">            _LOGGER.error(os_err)</span><br><span class="line">            <span class="comment"># 忽略这个显示器并继续</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        _LOGGER.info(<span class="string">&#x27;found &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(monitor.model))</span><br><span class="line">        phy_monitors.append(monitor)</span><br><span class="line"></span><br><span class="line">    test_monitor = phy_monitors[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h1 id="python完整源码"><a href="#python完整源码" class="headerlink" title="python完整源码"></a>python完整源码</h1><p><a href="https://github.com/cillthrive/monitor_ctrl">github开源地址</a></p><p><a href="/page/365528154/">同功能autoit 3实现</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/1440056844.jpg&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;可实现功能&quot;&gt;&lt;a href=&quot;#可实现功能&quot; class=&quot;headerlink&quot; title=&quot;可实现功能&quot;&gt;&lt;/a&gt;可实现功能&lt;/h1&gt;&lt;p&gt;通过显示器的 DDC/CI 来直接操作显示器，拯救可怜的显示器按键。&lt;/p&gt;
&lt;p&gt;支持的操作：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;调整亮度&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;调整对比度&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;设置色温 / 颜色预设&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;设置RGB颜色的比例&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;OSD语言&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;开关机&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;切换输入源&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;自动调整图像 (VGA输入需要)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;恢复出厂设置&lt;/p&gt;
&lt;h1 id=&quot;系统需求&quot;&gt;&lt;a href=&quot;#系统需求&quot; class=&quot;headerlink&quot; title=&quot;系统需求&quot;&gt;&lt;/a&gt;系统需求&lt;/h1&gt;&lt;p&gt;Windows Vista +&lt;br&gt;Python3 (建议安装时选上Python Launcher)&lt;br&gt;支持DDC/CI的外接显示器，不支持笔记本内置显示器&lt;br&gt;&lt;img src=&quot;/images/2021091901.jpg&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;使用参考&quot;&gt;&lt;a href=&quot;#使用参考&quot; class=&quot;headerlink&quot; title=&quot;使用参考&quot;&gt;&lt;/a&gt;使用参考&lt;/h1&gt;&lt;p&gt;GUI 模式&lt;br&gt;不附加参数启动 monitor_ctrl.py 即可启动GUI，直接拖动滑条设置显示器的参数。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;由于显示器应用VCP指令可能需要一定时间，为避免出错，GUI模式将忽略命令行指定的操作。&lt;/p&gt;
&lt;p&gt;GUI中显示的配置不会自动刷新，要查看新的配置目前需要重启应用程序。&lt;/p&gt;
&lt;p&gt;将文件后缀修改为 .pyw, 直接双击打开，可以避免显示conhost黑窗口&lt;/p&gt;
&lt;p&gt;命令行模式&lt;br&gt;当指定 -c 选项或者 tkinter import失败就会使用CLI模式。&lt;/p&gt;
&lt;p&gt;py monitor_ctrl.py [-h] [-m Model_string] [-s Settings_string] [-r] [-t] [-c] [-l] [-v]&lt;br&gt;  -h          显示帮助&lt;br&gt;  -m          指定要应用到的Monitor Model，不指定则应用到所有可操作的显示器&lt;br&gt;  -s          property1=value1:property2=”value 2” 应用多项设置&lt;br&gt;  -r          将显示器恢复出厂设置&lt;br&gt;  -t          对输入执行自动调整（仅VGA输入需要）&lt;br&gt;  -c          不启用GUI&lt;br&gt;  -l          显示可操作的显示器model&lt;br&gt;  -v          Verbose logging&lt;/p&gt;</summary>
    
    
    
    <category term="源码" scheme="https://www.bnwin.com/categories/code/"/>
    
    
    <category term="python源码" scheme="https://www.bnwin.com/tags/python%E6%BA%90%E7%A0%81/"/>
    
    <category term="dxva2" scheme="https://www.bnwin.com/tags/dxva2/"/>
    
    <category term="显示器设置" scheme="https://www.bnwin.com/tags/%E6%98%BE%E7%A4%BA%E5%99%A8%E8%AE%BE%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>实现GiteePages自动部署的aardio源码</title>
    <link href="https://www.bnwin.com/page/1586529761/"/>
    <id>https://www.bnwin.com/page/1586529761/</id>
    <published>2021-09-18T00:23:50.000Z</published>
    <updated>2021-09-22T14:03:39.980Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题的由来"><a href="#问题的由来" class="headerlink" title="问题的由来"></a>问题的由来</h1><p>github提供开源项目管理，同时提供静态网站github page，但国内访问速度很慢，经常打不开，gitee码云在国内，提供和github一样的功能，但gitee page每次推送文件后，不会自动刷新（免费版），必须手动刷新!网上已有提供python自动刷新Gitee Pages的源码!</p><h1 id="python自动部署Gitee-Pages源码"><a href="#python自动部署Gitee-Pages源码" class="headerlink" title="python自动部署Gitee Pages源码"></a>python自动部署Gitee Pages源码</h1><ol><li>python环境要求<br>python3 + selenium + chromedrive.exe。</li></ol><ul><li>先安装好python3(最好设置好国内镜像源，不然安装库，因墙的缘故可能失败)</li><li>再安装好selenium库<br>pip install selenium<br>pip install Alert</li><li>下载chrome对应的chromedriver</li></ul><p>2.python源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.alert <span class="keyword">import</span> Alert</span><br><span class="line">option = webdriver.ChromeOptions()</span><br><span class="line"><span class="comment">#指定chrome浏览器</span></span><br><span class="line">option.binary_location=<span class="string">r&#x27;D:\Program Files\CentBrowser64\chrome.exe&#x27;</span></span><br><span class="line"><span class="comment">#指定chromedriver和chrome版本要匹配</span></span><br><span class="line">driver = webdriver.Chrome(<span class="string">r&#x27;D:\Program Files\CentBrowser64\chromedriver.exe&#x27;</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;https://gitee.com/login&#x27;</span>)</span><br><span class="line">driver.maximize_window()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">user_login = driver.find_element_by_id(<span class="string">&#x27;user_login&#x27;</span>)</span><br><span class="line">user_login.send_keys(<span class="string">&quot;gitee的用户名&quot;</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;user_password&#x27;</span>).send_keys(<span class="string">&quot;gitee的登录密码&quot;</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;/html/body/div[2]/div[2]/div/div[1]/div[2]/div[1]/form[1]/div/div/div/div[4]/input&#x27;</span>).click()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;https://gitee.com/此处改为you_gitee_id/此处改为you_gitee_id/pages&#x27;</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;/html/body/div[3]/div[2]/div/div[2]/div/form/div[6]&#x27;</span>).click()</span><br><span class="line">Alert(driver).accept()</span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;成功&quot;</span>)</span><br><span class="line">driver.quit()</span><br><span class="line">fp = <span class="built_in">open</span>(<span class="string">&quot;D:\log.txt&quot;</span>, <span class="string">&quot;a+&quot;</span>)</span><br><span class="line">now_time = time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, time.localtime())</span><br><span class="line">fp.write(<span class="string">&quot;部署时间:&#123;0&#125;\n&quot;</span>.<span class="built_in">format</span>(now_time))</span><br><span class="line">fp.close()</span><br></pre></td></tr></table></figure><p><img src="/images/2021092202.png" alt="gitee page python自动部署"><br>提供此代码的开源项目地址：<a href="https://github.com/witmy/my-giteepages">https://github.com/witmy/my-giteepages</a><br>上面的代码修改了一下，指定了chrome浏览器地址和chromedriver的地址，这样就不会运行不了!特别适合小白!</p><h1 id="aardio自动部署Gitee-Pages的源码"><a href="#aardio自动部署Gitee-Pages的源码" class="headerlink" title="aardio自动部署Gitee Pages的源码"></a>aardio自动部署Gitee Pages的源码</h1><p>python的代码，如果是新手，安装python，然后直接运行上面的源码，成功的机率很小，因为Chrome driver是需要浏览器和driver版本匹配的!上面的python源码，如果你不熟悉python，基本上调试不会成功!<br>不过不要紧，下面我讲的，小白也会的aardio教程，一步一步复杂粘贴就能实现，你不需要会python，不需要会aardio，一样可以编译一个自动更新gitee pages的执行文件!</p><ol><li>查看chrome内核的浏览器版本<br>只要是使用chrome为内核的浏览器，都可以，比如qq浏览器，360极速浏览器，搜狗浏览器或chrome谷歌浏览器!第一步打开浏览器，第二步，在地址栏输入  chrome://version 查看版本号，正常应该显示为这样<br><img src="/images/20210918090344.png"><br>查看版本号，上图版本号为86.0.4240.112，并且知道浏览器的路径为 D:\Program Files (x86)\360Chrome\Chrome\Application\360chrome.exe</li><li>打开chromedriver的镜像网站<a href="https://npm.taobao.org/mirrors/chromedriver">https://npm.taobao.org/mirrors/chromedriver</a> 下载相应的chromedriver<br><img src="/images/20210918090709.png"><br>对应上面的chrome，应该下载86.0.4240.22，最后的版本号112，选择最接近的就行！<br>进入86.0.4240.22目录，<img src="/images/20210918091136.png">下载 chromedriver_win32.zip，并解压到本地目录，如d:\temp\</li><li>aardio部署gitee pages的源码<figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> chrome.driver;</span><br><span class="line">var driver = chrome.driver(<span class="string">&quot;D:\Program Files\CentBrowser64\chrome.exe&quot;</span>,<span class="string">&quot;d:\temp\chromedriver.exe&quot;</span>);</span><br><span class="line"><span class="comment">//driver.addArguments(&quot;--headless&quot;,&quot;--disable-gpu&quot;,&quot;--remote-debugging-port=9222&quot;); //无头模式</span></span><br><span class="line">var browser = driver.startBrowser( &#123;</span><br><span class="line">    loggingPrefs  = &#123; browser = <span class="string">&#x27;ALL&#x27;</span>, performance = <span class="string">&#x27;ALL&#x27;</span>, &#125;;</span><br><span class="line">perfLoggingPrefs = &#123;</span><br><span class="line">    enableNetwork = <span class="literal">true</span>,</span><br><span class="line">    enablePage= <span class="literal">false</span>,</span><br><span class="line">    enableTimeline = <span class="literal">false</span></span><br><span class="line">&#125; </span><br><span class="line">&#125;);</span><br><span class="line">browser.go(<span class="string">&quot;https://gitee.com/login&quot;</span>)</span><br><span class="line">var ele = browser.querySelector(<span class="string">&quot;body&quot;</span>).querySelector(<span class="string">&quot;#user_login&quot;</span>); </span><br><span class="line">ele.setValue( <span class="string">&quot;gitee的用户名&quot;</span> );<span class="comment">//改为你的gitee用户名</span></span><br><span class="line">ele = browser.querySelector(<span class="string">&quot;body&quot;</span>).querySelector(<span class="string">&quot;#user_password&quot;</span>);</span><br><span class="line">ele.setValue( <span class="string">&quot;gitee的登录密码&quot;</span> ); <span class="comment">//改为你的gitee密码</span></span><br><span class="line">var searchButton = browser.doScript(<span class="string">` </span></span><br><span class="line"><span class="string">return arguments[0].querySelector(&quot;#new_user &gt; div &gt; div &gt; div &gt; div:nth-child(4) &gt; input&quot;);</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line">,browser.querySelector(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">)</span><br><span class="line"><span class="comment">//也可以直接使用query查询，以及使用xpath取值，如 searchButton = browser.query([&quot;xpath&quot;] = &#x27;/html/body/div[1]/div[1]/div[5]/div[2]/div/form/span[2]/input&#x27;);</span></span><br><span class="line">searchButton.click();</span><br><span class="line">win.delay(<span class="number">2000</span>)</span><br><span class="line">browser.go(<span class="string">&quot;https://gitee.com/此处改为you_gitee_id/此处改为you_gitee_id/pages&quot;</span>); <span class="comment">//改为你的gitee项目地址</span></span><br><span class="line">var gxButton=browser.doScript(<span class="string">`</span></span><br><span class="line"><span class="string">   return arguments[0].querySelector(&quot;#pages-branch &gt; div.button.orange.redeploy-button.ui.update_deploy&quot;);</span></span><br><span class="line"><span class="string">`</span>,browser.querySelector(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">)</span><br><span class="line">win.delay(<span class="number">5000</span>)</span><br><span class="line">gxButton.click();</span><br><span class="line">browser.alert.accept();</span><br><span class="line">win.delay(<span class="number">2000</span>)</span><br><span class="line">browser.closeAll();</span><br></pre></td></tr></table></figure>其中，代码的第二行的参数，第一个改为你的浏览器路径（其中第一步上面已查看到），第二个参数改为你下载的chromedriver的路径<br>，然后在<a href="http://www.aardio.com/">http://www.aardio.com</a> 下载aardio，新建文件，复制上面代码，直接编译就可运行(如果没有chrome.divver库，aardio会自动下载)</li></ol><h1 id="后期可能失效说明"><a href="#后期可能失效说明" class="headerlink" title="后期可能失效说明"></a>后期可能失效说明</h1><p>登录按钮的css selector，现在为 #new_user &gt; div &gt; div &gt; div &gt; div:nth-child(4) &gt; input<br>更新按钮的css selector, 现在为 #pages-branch &gt; div.button.orange.redeploy-button.ui.update_deploy<br>如何查看这两个按钮的css selector<br>比如更新按钮的css selector<br>手动打开gitee pages更新页面，对着更新按钮，右键审查元素，<img src="/images/20210918092106.png"><br>在弹出的devtool的Elements界面，自动选中的地方右键，点击选择copy selector，<img src="/images/20210918092554.png">把上面的代码中修改即可!</p><p>其实就是一个模拟手动按键的过程!不过无头模式，似乎有点问题，有时不点击更新，也可能是延时问题，但非无头模式是正常的，不点击就加大延时!</p><h1 id="题外话-Headless-Chrome"><a href="#题外话-Headless-Chrome" class="headerlink" title="题外话:-Headless Chrome"></a>题外话:-Headless Chrome</h1><p>Headless Chrome 是 Chrome 浏览器的无界面形态，可以在不打开浏览器的前提下，使用所有 Chrome 支持的特性运行你的程序。相比于现代浏览器，Headless Chrome 更加方便测试 web 应用，获得网站的截图，做爬虫抓取信息等。相比于出道较早的 PhantomJS，SlimerJS 等，Headless Chrome 则更加贴近浏览器环境。<br>启动无头模式</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome.exe --headless --disable-gpu --remote-debugging-port=<span class="number">9222</span>  https://github.com</span><br></pre></td></tr></table></figure><p>获取屏幕截图</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome.exe --headless --disable-gpu --screenshot --window-size=<span class="number">1280</span>,<span class="number">1696</span> https://github.com</span><br></pre></td></tr></table></figure><p>获取页面为PDF</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome.exe --headless --disable-gpu --<span class="built_in">print</span>-to-pdf https://github.com</span><br></pre></td></tr></table></figure><p>打印页面DOM</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome.exe --headless --disable-gpu --dump-dom https://github.com/</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;问题的由来&quot;&gt;&lt;a href=&quot;#问题的由来&quot; class=&quot;headerlink&quot; title=&quot;问题的由来&quot;&gt;&lt;/a&gt;问题的由来&lt;/h1&gt;&lt;p&gt;github提供开源项目管理，同时提供静态网站github page，但国内访问速度很慢，经常打不开，gitee码云在国内，提供和github一样的功能，但gitee page每次推送文件后，不会自动刷新（免费版），必须手动刷新!网上已有提供python自动刷新Gitee Pages的源码!&lt;/p&gt;
&lt;h1 id=&quot;python自动部署Gitee-Pages源码&quot;&gt;&lt;a href=&quot;#python自动部署Gitee-Pages源码&quot; class=&quot;headerlink&quot; title=&quot;python自动部署Gitee Pages源码&quot;&gt;&lt;/a&gt;python自动部署Gitee Pages源码&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;python环境要求&lt;br&gt;python3 + selenium + chromedrive.exe。&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;先安装好python3(最好设置好国内镜像源，不然安装库，因墙的缘故可能失败)&lt;/li&gt;
&lt;li&gt;再安装好selenium库&lt;br&gt;pip install selenium&lt;br&gt;pip install Alert&lt;/li&gt;
&lt;li&gt;下载chrome对应的chromedriver&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2.python源码&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; time&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; selenium &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; webdriver&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; selenium.webdriver.common.alert &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Alert&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;option = webdriver.ChromeOptions()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#指定chrome浏览器&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;option.binary_location=&lt;span class=&quot;string&quot;&gt;r&amp;#x27;D:\Program Files\CentBrowser64\chrome.exe&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#指定chromedriver和chrome版本要匹配&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;driver = webdriver.Chrome(&lt;span class=&quot;string&quot;&gt;r&amp;#x27;D:\Program Files\CentBrowser64\chromedriver.exe&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;driver.get(&lt;span class=&quot;string&quot;&gt;&amp;#x27;https://gitee.com/login&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;driver.maximize_window()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time.sleep(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;user_login = driver.find_element_by_id(&lt;span class=&quot;string&quot;&gt;&amp;#x27;user_login&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;user_login.send_keys(&lt;span class=&quot;string&quot;&gt;&amp;quot;gitee的用户名&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;driver.find_element_by_id(&lt;span class=&quot;string&quot;&gt;&amp;#x27;user_password&amp;#x27;&lt;/span&gt;).send_keys(&lt;span class=&quot;string&quot;&gt;&amp;quot;gitee的登录密码&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;driver.find_element_by_xpath(&lt;span class=&quot;string&quot;&gt;&amp;#x27;/html/body/div[2]/div[2]/div/div[1]/div[2]/div[1]/form[1]/div/div/div/div[4]/input&amp;#x27;&lt;/span&gt;).click()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time.sleep(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;driver.get(&lt;span class=&quot;string&quot;&gt;&amp;#x27;https://gitee.com/此处改为you_gitee_id/此处改为you_gitee_id/pages&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;driver.find_element_by_xpath(&lt;span class=&quot;string&quot;&gt;&amp;#x27;/html/body/div[3]/div[2]/div/div[2]/div/form/div[6]&amp;#x27;&lt;/span&gt;).click()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Alert(driver).accept()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time.sleep(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;成功&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;driver.quit()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fp = &lt;span class=&quot;built_in&quot;&gt;open&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;D:\log.txt&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;a+&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;now_time = time.strftime(&lt;span class=&quot;string&quot;&gt;&amp;quot;%Y-%m-%d %H:%M:%S&amp;quot;&lt;/span&gt;, time.localtime())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fp.write(&lt;span class=&quot;string&quot;&gt;&amp;quot;部署时间:&amp;#123;0&amp;#125;\n&amp;quot;&lt;/span&gt;.&lt;span class=&quot;built_in&quot;&gt;format&lt;/span&gt;(now_time))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fp.close()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;/images/2021092202.png&quot; alt=&quot;gitee page python自动部署&quot;&gt;&lt;br&gt;提供此代码的开源项目地址：&lt;a href=&quot;https://github.com/witmy/my-giteepages&quot;&gt;https://github.com/witmy/my-giteepages&lt;/a&gt;&lt;br&gt;上面的代码修改了一下，指定了chrome浏览器地址和chromedriver的地址，这样就不会运行不了!特别适合小白!&lt;/p&gt;
&lt;h1 id=&quot;aardio自动部署Gitee-Pages的源码&quot;&gt;&lt;a href=&quot;#aardio自动部署Gitee-Pages的源码&quot; class=&quot;headerlink&quot; title=&quot;aardio自动部署Gitee Pages的源码&quot;&gt;&lt;/a&gt;aardio自动部署Gitee Pages的源码&lt;/h1&gt;&lt;p&gt;python的代码，如果是新手，安装python，然后直接运行上面的源码，成功的机率很小，因为Chrome driver是需要浏览器和driver版本匹配的!上面的python源码，如果你不熟悉python，基本上调试不会成功!&lt;br&gt;不过不要紧，下面我讲的，小白也会的aardio教程，一步一步复杂粘贴就能实现，你不需要会python，不需要会aardio，一样可以编译一个自动更新gitee pages的执行文件!&lt;/p&gt;</summary>
    
    
    
    <category term="源码" scheme="https://www.bnwin.com/categories/code/"/>
    
    
    <category term="aardio源码" scheme="https://www.bnwin.com/tags/aardio%E6%BA%90%E7%A0%81/"/>
    
    <category term="python源码" scheme="https://www.bnwin.com/tags/python%E6%BA%90%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>发现网卡变百兆自动发送邮件通知的AutoIt源码</title>
    <link href="https://www.bnwin.com/page/4125339080/"/>
    <id>https://www.bnwin.com/page/4125339080/</id>
    <published>2021-09-17T02:34:19.000Z</published>
    <updated>2021-09-17T03:20:16.161Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题的出现"><a href="#问题的出现" class="headerlink" title="问题的出现"></a>问题的出现</h1><p>网吧维护中，由于交换机或水晶机或工艺上的问题，有些机器网卡正常的千兆会变成百兆，在无盘系统中启动机器或启动游戏变得很慢，用户体验相当不好!出现这个问题时，网管或维护却很难第一时间发现1000M变成100M的问题机器。<br>以下是使用autoit3写的，发现任意网卡是100M，就会按mail.ini配置文件中指定的邮件发送邮件通知，让你第一时间发现这种网卡变100M的问题机器，及时进行处理！</p><p>把以下代码保存为au3脚本或编译为可执行文件后，需要在同目录下建一个mail.ini文件，内容如下<br>[setup]<br>FromAddress=发件人@qq.com<br>toaddress=收件人@qq.com<br>username=qq号<br>password=QQ的smtp服务器提供的邮件授权码<br>body=邮件正文内容</p><p>其中password内容，应该进入你的QQ邮箱开通smtp和取得授权码<br><img src="/images/EWOCA8IZXGRZQCPD.png" alt="qq邮箱授权码"></p><h1 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h1><p>设置好mainl.ini中的qq的smtp服务器的用户名及授权码等一切信息后，开机执行一次此代码就行，检测完成自动退出程序</p><h1 id="autoit源码如下"><a href="#autoit源码如下" class="headerlink" title="autoit源码如下"></a>autoit源码如下</h1><p>以下为autoit3实现发现任意一网卡是100M，自动根据设置的邮件发送邮件通知!</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ButtonConstants.au3&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GUIConstantsEx.au3&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ListViewConstants.au3&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WindowsConstants.au3&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GuiListView.au3&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">Include</span><span class="meta-string">&lt;file.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">NoTrayIcon</span></span></span><br><span class="line">$badlan=<span class="literal">false</span></span><br><span class="line">$a = _GetAdaptersInfo() </span><br><span class="line"><span class="keyword">For</span> $i = <span class="number">1</span> <span class="keyword">To</span> $a[0][0] </span><br><span class="line">$lSpeed=GetIfEntry($a[$i][3])</span><br><span class="line"><span class="keyword">if</span> $lSpeed=<span class="number">100</span> <span class="keyword">then</span></span><br><span class="line">  $badlan=<span class="literal">true</span></span><br><span class="line">  <span class="keyword">ExitLoop</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> $badlan=<span class="literal">true</span> <span class="keyword">then</span>    </span><br><span class="line">$SmtpServer = <span class="string">&quot;smtp.qq.com&quot;</span>              <span class="comment">; address for the smtp-server to use - REQUIRED</span></span><br><span class="line">$FromName = <span class="string">&quot;发送人&quot;</span>                      <span class="comment">; name from who the email was sent</span></span><br><span class="line">$FromAddress = <span class="built_in">IniRead</span>(<span class="symbol">@WorkingDir</span>&amp;<span class="string">&quot;\mail.ini&quot;</span>,<span class="string">&quot;setup&quot;</span>,<span class="string">&quot;FromAddress&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">$ToAddress = <span class="built_in">IniRead</span>(<span class="symbol">@WorkingDir</span>&amp;<span class="string">&quot;\mail.ini&quot;</span>,<span class="string">&quot;setup&quot;</span>,<span class="string">&quot;toaddress&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">$Subject = <span class="symbol">@ComputerName</span>&amp;<span class="string">&quot;号机器网卡为100M，请检查!&quot;</span>                    <span class="comment">; subject from the email - can be anything you want it to be</span></span><br><span class="line"><span class="comment">;$Body = &quot;邮件正文&quot;                                ; the messagebody from the mail - can be left blank but then you get a blank mail</span></span><br><span class="line">$Body = <span class="built_in">IniRead</span>(<span class="symbol">@WorkingDir</span>&amp;<span class="string">&quot;\mail.ini&quot;</span>,<span class="string">&quot;setup&quot;</span>,<span class="string">&quot;body&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">$AttachFiles = <span class="string">&quot;&quot;</span>                        <span class="comment">; the file you want to attach- leave blank if not needed</span></span><br><span class="line">$CcAddress = <span class="string">&quot;&quot;</span>        <span class="comment">; address for cc - leave blank if not needed</span></span><br><span class="line">$BccAddress = <span class="string">&quot;&quot;</span>      <span class="comment">; address for bcc - leave blank if not needed</span></span><br><span class="line">$Importance = <span class="string">&quot;Normal&quot;</span>                  <span class="comment">; Send message priority: &quot;High&quot;, &quot;Normal&quot;, &quot;Low&quot;</span></span><br><span class="line">$Username = <span class="built_in">IniRead</span>(<span class="symbol">@WorkingDir</span>&amp;<span class="string">&quot;\mail.ini&quot;</span>,<span class="string">&quot;setup&quot;</span>,<span class="string">&quot;Username&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">$Password = <span class="built_in">IniRead</span>(<span class="symbol">@WorkingDir</span>&amp;<span class="string">&quot;\mail.ini&quot;</span>,<span class="string">&quot;setup&quot;</span>,<span class="string">&quot;Password&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">$IPPort = <span class="number">465</span>                            <span class="comment">; port used for sending the mail</span></span><br><span class="line">$ssl = <span class="number">1</span>    </span><br><span class="line">$rc = _INetSmtpMailCom ( $SmtpServer, $FromName, $FromAddress, $ToAddress, $Subject, $Body, $AttachFiles, $CcAddress, $BccAddress, $Importance, $Username, $Password, $IPPort, $ssl )</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="comment">;msgbox(0,&quot;&quot;,$ToAddress)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">SetListView</span><span class="params">()</span> </span></span><br><span class="line">$a = _GetAdaptersInfo() </span><br><span class="line">$index = ($a[1][3]) </span><br><span class="line"><span class="keyword">For</span> $i = <span class="number">1</span> <span class="keyword">To</span> $a[0][0] </span><br><span class="line"><span class="built_in">GUICtrlCreateListViewItem</span>($a[$i][1] &amp; <span class="string">&#x27;|&#x27;</span> &amp; _ </span><br><span class="line"><span class="built_in">StringLeft</span>(<span class="built_in">Hex</span>($a[$i][2]), <span class="number">12</span>) &amp; <span class="string">&#x27;|&#x27;</span> &amp; _ </span><br><span class="line">$a[$i][6] &amp; <span class="string">&#x27;|&#x27;</span> &amp; _ </span><br><span class="line">GetIfEntry($a[$i][3]) &amp; <span class="string">&#x27; MB&#x27;</span>, $ListView1) </span><br><span class="line"><span class="keyword">Next</span> </span><br><span class="line"><span class="keyword">EndFunc</span> <span class="comment">;==&gt;SetListView </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">GetIfEntry</span><span class="params">($ifIndex)</span> </span></span><br><span class="line"><span class="keyword">Local</span> $tagBuffer, $tBuffer, $pBuffer, $iResult, $iSpeed, $sDescr </span><br><span class="line"></span><br><span class="line">$tagBuffer = <span class="string">&quot;wchar[256];dword[5];byte[8];dword[16];char[256]&quot;</span> </span><br><span class="line">$tBuffer = <span class="built_in">DllStructCreate</span>($tagBuffer) </span><br><span class="line">$pBuffer = <span class="built_in">DllStructGetPtr</span>($tBuffer) </span><br><span class="line"><span class="built_in">DllStructSetData</span>($tBuffer, <span class="number">2</span>, $ifIndex, <span class="number">1</span>) </span><br><span class="line"></span><br><span class="line">$iResult = <span class="built_in">DllCall</span>(<span class="string">&quot;iphlpapi.dll&quot;</span>, <span class="string">&quot;long&quot;</span>, <span class="string">&quot;GetIfEntry&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $pBuffer) </span><br><span class="line">$iSpeed = <span class="built_in">DllStructGetData</span>($tBuffer, <span class="number">2</span>, <span class="number">4</span>) / <span class="number">1000</span> / <span class="number">1000</span> </span><br><span class="line">$sDescr = <span class="built_in">DllStructGetData</span>($tBuffer, <span class="number">5</span>) </span><br><span class="line">$tBuffer = <span class="number">0</span> </span><br><span class="line"><span class="keyword">Return</span> <span class="built_in">SetError</span>($iResult[0], $iSpeed, $iSpeed) </span><br><span class="line"><span class="keyword">EndFunc</span> <span class="comment">;==&gt;GetIfEntry </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_GetAdaptersInfo</span><span class="params">()</span> </span></span><br><span class="line"><span class="keyword">Local</span> $iResult, $tBuffer, $pBuffer, $aResult[1][9], $tagADPTINFO, $tAdpt </span><br><span class="line"></span><br><span class="line"><span class="comment">; 第一次调用传递空值，pOutBufLen ( $iResult[2] ) 设为结构所需大小，单位byte。 </span></span><br><span class="line">$iResult = <span class="built_in">DllCall</span>(<span class="string">&quot;iphlpapi.dll&quot;</span>, <span class="string">&quot;dword&quot;</span>, <span class="string">&quot;GetAdaptersInfo&quot;</span>, <span class="string">&quot;ptr&quot;</span>, <span class="number">0</span>, <span class="string">&quot;ulong*&quot;</span>, <span class="number">0</span>) </span><br><span class="line">$tBuffer = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;byte[&quot;</span> &amp; $iResult[2] &amp; <span class="string">&quot;]&quot;</span>) <span class="comment">; 定义$iResult[2] 字节的缓存区域 (分配内存空间)。 </span></span><br><span class="line">$pBuffer = <span class="built_in">DllStructGetPtr</span>($tBuffer) <span class="comment">; 获取内存指针。 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">; 第二次调用，GetAdaptersInfo把网卡信息复制到指定的内存空间 ($tBuffer) 中。 </span></span><br><span class="line">$iResult = <span class="built_in">DllCall</span>(<span class="string">&quot;iphlpapi.dll&quot;</span>, <span class="string">&quot;dword&quot;</span>, <span class="string">&quot;GetAdaptersInfo&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $pBuffer, <span class="string">&quot;ulong*&quot;</span>, $iResult[2]) </span><br><span class="line"><span class="comment">; $iResult[0]值为0则调用成功，否则为系统错误号。 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">; 数据转换， byte --&gt; IP_ADAPTER_INFO </span></span><br><span class="line">$tagADPTINFO = <span class="string">&quot;ptr NextAdpt; dword ComboIndex; char AdptName[260]; char AdptDescr[132];uint AddrLength;byte MacAddr[8];dword Index;uint Type; uint DhcpEnabled;ptr CurrentIpAddr;ptr NextIpAddr; char IpAddr[16];char IpAddrMask[16]; dword IpAddrCxt; ptr NextGateway; char GatewayAddr[16]; char GatewayAddrMask[16];dword GatewayCxt; ptr NextDhcp; char DhcpAddr[16]; char DhcpAddrMask[16];dword DhcpCxt; int HaveWins; ptr NextPriWinsServer; char PriWinsServerAddr[16]; char PriWinsServerAddrMask[16]; dword PriWinsServerCxt; ptr NextSecWinsServer; char SecWinsServerAddr[16]; char SecWinsServerAddrMask[16]; dword LeaseObtained; dword LeaseExpires&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">While</span> $pBuffer </span><br><span class="line">$tAdpt = <span class="built_in">DllStructCreate</span>($tagADPTINFO, $pBuffer) </span><br><span class="line">$aResult[0][0] += <span class="number">1</span> </span><br><span class="line"><span class="keyword">ReDim</span> $aResult[$aResult[0][0] + <span class="number">1</span>][<span class="number">9</span>] </span><br><span class="line">$aResult[$aResult[0][0]][0] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;AdptName&quot;</span>) <span class="comment">; 网卡名称 </span></span><br><span class="line">$aResult[$aResult[0][0]][1] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;AdptDescr&quot;</span>) <span class="comment">; 网卡描述 </span></span><br><span class="line">$aResult[$aResult[0][0]][2] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;MacAddr&quot;</span>) <span class="comment">; 网卡MAC </span></span><br><span class="line">$aResult[$aResult[0][0]][3] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;Index&quot;</span>) <span class="comment">; 网卡索引号 </span></span><br><span class="line">$aResult[$aResult[0][0]][4] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;Type&quot;</span>) <span class="comment">; 类型 </span></span><br><span class="line">$aResult[$aResult[0][0]][5] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;DhcpEnabled&quot;</span>) <span class="comment">; DHCP是否启用 true = 启用， false = 禁用 </span></span><br><span class="line">$aResult[$aResult[0][0]][6] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;IpAddr&quot;</span>) <span class="comment">; IP 地址 </span></span><br><span class="line">$aResult[$aResult[0][0]][7] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;GatewayAddr&quot;</span>) <span class="comment">; 网关地址 </span></span><br><span class="line">$aResult[$aResult[0][0]][8] = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;DhcpAddr&quot;</span>) <span class="comment">; DHCP地址, 只有DhcpEnabled为true时，此值才有效。 </span></span><br><span class="line">$pBuffer = <span class="built_in">DllStructGetData</span>($tAdpt, <span class="string">&quot;NextAdpt&quot;</span>) <span class="comment">; [下一张网卡信息的内存地址。] </span></span><br><span class="line">$tAdpt = <span class="number">0</span> </span><br><span class="line"><span class="keyword">WEnd</span> </span><br><span class="line">$tBuffer = <span class="number">0</span> </span><br><span class="line"><span class="keyword">Return</span> <span class="built_in">SetError</span>($iResult[0], <span class="number">0</span>, $aResult) </span><br><span class="line"><span class="keyword">EndFunc</span> <span class="comment">;==&gt;_GetAdaptersInfo</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; The UDF</span></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_INetSmtpMailCom</span> <span class="params">( $s_SmtpServer, $s_FromName, $s_FromAddress, $s_ToAddress, $s_Subject = <span class="string">&quot;&quot;</span>, $as_Body = <span class="string">&quot;&quot;</span>, $s_AttachFiles = <span class="string">&quot;&quot;</span>, $s_CcAddress = <span class="string">&quot;&quot;</span>, $s_BccAddress = <span class="string">&quot;&quot;</span>, $s_Importance= <span class="string">&quot;Normal&quot;</span>, $s_Username = <span class="string">&quot;&quot;</span>, $s_Password = <span class="string">&quot;&quot;</span>, $IPPort = <span class="number">25</span>, $ssl = <span class="number">0</span> )</span></span></span><br><span class="line">    <span class="keyword">Local</span> $objEmail = <span class="built_in">ObjCreate</span> ( <span class="string">&quot;CDO.Message&quot;</span> )</span><br><span class="line">    $objEmail.From = <span class="string">&#x27;&quot;&#x27;</span> &amp; $s_FromName &amp; <span class="string">&#x27;&quot; &lt;&#x27;</span> &amp; $s_FromAddress &amp; <span class="string">&#x27;&gt;&#x27;</span></span><br><span class="line">    $objEmail.<span class="keyword">To</span> = $s_ToAddress</span><br><span class="line">    <span class="keyword">Local</span> $i_Error = <span class="number">0</span></span><br><span class="line">    <span class="keyword">Local</span> $i_Error_desciption = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">If</span> $s_CcAddress &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> $objEmail.Cc = $s_CcAddress</span><br><span class="line">    <span class="keyword">If</span> $s_BccAddress &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> $objEmail.Bcc = $s_BccAddress</span><br><span class="line">    $objEmail.Subject = $s_Subject</span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">StringInStr</span> ( $as_Body, <span class="string">&quot;&lt;&quot;</span> ) <span class="literal">And</span> <span class="built_in">StringInStr</span> ( $as_Body, <span class="string">&quot;&gt;&quot;</span> ) <span class="keyword">Then</span></span><br><span class="line">        $objEmail.HTMLBody = $as_Body</span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        $objEmail.Textbody = $as_Body &amp; <span class="symbol">@CRLF</span></span><br><span class="line">    <span class="keyword">EndIf</span></span><br><span class="line">    <span class="keyword">If</span> $s_AttachFiles &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">        <span class="keyword">Local</span> $S_Files2Attach = <span class="built_in">StringSplit</span> ( $s_AttachFiles, <span class="string">&quot;;&quot;</span> )</span><br><span class="line">        <span class="keyword">For</span> $x = <span class="number">1</span> <span class="keyword">To</span> $S_Files2Attach [ <span class="number">0</span> ]</span><br><span class="line">            $S_Files2Attach [ $x ] = _PathFull ( $S_Files2Attach [ $x ] )</span><br><span class="line">            <span class="built_in">ConsoleWrite</span> ( <span class="string">&#x27;@@ Debug(62) : $S_Files2Attach = &#x27;</span> &amp; $S_Files2Attach &amp; <span class="symbol">@LF</span> &amp; <span class="string">&#x27;&gt;Error code: &#x27;</span> &amp; <span class="symbol">@error</span> &amp; <span class="symbol">@LF</span> ) <span class="comment">;### Debug Console</span></span><br><span class="line">            <span class="keyword">If</span> <span class="built_in">FileExists</span> ( $S_Files2Attach [ $x ] ) <span class="keyword">Then</span></span><br><span class="line">                $objEmail.AddAttachment ( $S_Files2Attach [ $x ] )</span><br><span class="line">            <span class="keyword">Else</span></span><br><span class="line">                <span class="built_in">ConsoleWrite</span> ( <span class="string">&#x27;!&gt; File not found to attach: &#x27;</span> &amp; $S_Files2Attach [ $x ] &amp; <span class="symbol">@LF</span> )</span><br><span class="line">                <span class="built_in">SetError</span> ( <span class="number">1</span> )</span><br><span class="line">                <span class="keyword">Return</span> <span class="number">0</span></span><br><span class="line">            <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">    <span class="keyword">EndIf</span></span><br><span class="line">    $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/sendusing&quot;</span> ) = <span class="number">2</span></span><br><span class="line">    $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpserver&quot;</span> ) = $s_SmtpServer</span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Number</span> ( $IPPort ) = <span class="number">0</span> <span class="keyword">then</span> $IPPort = <span class="number">25</span></span><br><span class="line">    $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpserverport&quot;</span> ) = $IPPort</span><br><span class="line">    <span class="comment">;Authenticated SMTP</span></span><br><span class="line">    <span class="keyword">If</span> $s_Username &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">        $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpauthenticate&quot;</span> ) = <span class="number">1</span></span><br><span class="line">        $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/sendusername&quot;</span> ) = $s_Username</span><br><span class="line">        $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/sendpassword&quot;</span> ) = $s_Password</span><br><span class="line">    <span class="keyword">EndIf</span></span><br><span class="line">    <span class="keyword">If</span> $ssl <span class="keyword">Then</span></span><br><span class="line">        $objEmail.Configuration.Fields.Item ( <span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpusessl&quot;</span> ) = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">EndIf</span></span><br><span class="line">    <span class="comment">;Update settings</span></span><br><span class="line">    $objEmail.Configuration.Fields.Update</span><br><span class="line">    <span class="comment">; Set Email Importance</span></span><br><span class="line">    <span class="keyword">Switch</span> $s_Importance</span><br><span class="line">        <span class="keyword">Case</span> <span class="string">&quot;High&quot;</span></span><br><span class="line">            $objEmail.Fields.Item ( <span class="string">&quot;urn:schemas:mailheader:Importance&quot;</span> ) = <span class="string">&quot;High&quot;</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="string">&quot;Normal&quot;</span></span><br><span class="line">            $objEmail.Fields.Item ( <span class="string">&quot;urn:schemas:mailheader:Importance&quot;</span> ) = <span class="string">&quot;Normal&quot;</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="string">&quot;Low&quot;</span></span><br><span class="line">            $objEmail.Fields.Item ( <span class="string">&quot;urn:schemas:mailheader:Importance&quot;</span> ) = <span class="string">&quot;Low&quot;</span></span><br><span class="line">    <span class="keyword">EndSwitch</span></span><br><span class="line">    $objEmail.Fields.Update</span><br><span class="line">    <span class="comment">; Sent the Message</span></span><br><span class="line">    $objEmail.<span class="built_in">Send</span></span><br><span class="line">    <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span></span><br><span class="line">        <span class="built_in">SetError</span> ( <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">Return</span> $oMyRet [ <span class="number">1</span> ]</span><br><span class="line">    <span class="keyword">EndIf</span></span><br><span class="line">    $objEmail= <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">EndFunc</span>    <span class="comment">;==&gt;_INetSmtpMailCom</span></span><br><span class="line"><span class="comment">;</span></span><br></pre></td></tr></table></figure><h1 id="成品下载地址"><a href="#成品下载地址" class="headerlink" title="成品下载地址"></a>成品下载地址</h1><p>已编译为可执行文件下载</p><p><a href="https://share.weiyun.com/NGw8l6mT">下载地址</a> 密码：3xw7di</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;问题的出现&quot;&gt;&lt;a href=&quot;#问题的出现&quot; class=&quot;headerlink&quot; title=&quot;问题的出现&quot;&gt;&lt;/a&gt;问题的出现&lt;/h1&gt;&lt;p&gt;网吧维护中，由于交换机或水晶机或工艺上的问题，有些机器网卡正常的千兆会变成百兆，在无盘系统中启动机器或启动游戏变得很慢，用户体验相当不好!出现这个问题时，网管或维护却很难第一时间发现1000M变成100M的问题机器。&lt;br&gt;以下是使用autoit3写的，发现任意网卡是100M，就会按mail.ini配置文件中指定的邮件发送邮件通知，让你第一时间发现这种网卡变100M的问题机器，及时进行处理！&lt;/p&gt;
&lt;p&gt;把以下代码保存为au3脚本或编译为可执行文件后，需要在同目录下建一个mail.ini文件，内容如下&lt;br&gt;[setup]&lt;br&gt;FromAddress=发件人@qq.com&lt;br&gt;toaddress=收件人@qq.com&lt;br&gt;username=qq号&lt;br&gt;password=QQ的smtp服务器提供的邮件授权码&lt;br&gt;body=邮件正文内容&lt;/p&gt;
&lt;p&gt;其中password内容，应该进入你的QQ邮箱开通smtp和取得授权码&lt;br&gt;&lt;img src=&quot;/images/EWOCA8IZXGRZQCPD.png&quot; alt=&quot;qq邮箱授权码&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;使用方法&quot;&gt;&lt;a href=&quot;#使用方法&quot; class=&quot;headerlink&quot; title=&quot;使用方法&quot;&gt;&lt;/a&gt;使用方法&lt;/h1&gt;&lt;p&gt;设置好mainl.ini中的qq的smtp服务器的用户名及授权码等一切信息后，开机执行一次此代码就行，检测完成自动退出程序&lt;/p&gt;
&lt;h1 id=&quot;autoit源码如下&quot;&gt;&lt;a href=&quot;#autoit源码如下&quot; class=&quot;headerlink&quot; title=&quot;autoit源码如下&quot;&gt;&lt;/a&gt;autoit源码如下&lt;/h1&gt;&lt;p&gt;以下为autoit3实现发现任意一网卡是100M，自动根据设置的邮件发送邮件通知!&lt;/p&gt;
&lt;figure class=&quot;highlight autoit&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;ButtonConstants.au3&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;GUIConstantsEx.au3&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;ListViewConstants.au3&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;WindowsConstants.au3&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;GuiListView.au3&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;Include&lt;/span&gt;&lt;span class=&quot;meta-string&quot;&gt;&amp;lt;file.au3&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;NoTrayIcon&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$badlan=&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$a = _GetAdaptersInfo() &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;For&lt;/span&gt; $i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;To&lt;/span&gt; $a[0][0] &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$lSpeed=GetIfEntry($a[$i][3])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; $lSpeed=&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  $badlan=&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;ExitLoop&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;endif&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Next&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; $badlan=&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$SmtpServer = &lt;span class=&quot;string&quot;&gt;&amp;quot;smtp.qq.com&amp;quot;&lt;/span&gt;              &lt;span class=&quot;comment&quot;&gt;; address for the smtp-server to use - REQUIRED&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$FromName = &lt;span class=&quot;string&quot;&gt;&amp;quot;发送人&amp;quot;&lt;/span&gt;                      &lt;span class=&quot;comment&quot;&gt;; name from who the email was sent&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$FromAddress = &lt;span class=&quot;built_in&quot;&gt;IniRead&lt;/span&gt;(&lt;span class=&quot;symbol&quot;&gt;@WorkingDir&lt;/span&gt;&amp;amp;&lt;span class=&quot;string&quot;&gt;&amp;quot;\mail.ini&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;setup&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;FromAddress&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$ToAddress = &lt;span class=&quot;built_in&quot;&gt;IniRead&lt;/span&gt;(&lt;span class=&quot;symbol&quot;&gt;@WorkingDir&lt;/span&gt;&amp;amp;&lt;span class=&quot;string&quot;&gt;&amp;quot;\mail.ini&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;setup&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;toaddress&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$Subject = &lt;span class=&quot;symbol&quot;&gt;@ComputerName&lt;/span&gt;&amp;amp;&lt;span class=&quot;string&quot;&gt;&amp;quot;号机器网卡为100M，请检查!&amp;quot;&lt;/span&gt;                    &lt;span class=&quot;comment&quot;&gt;; subject from the email - can be anything you want it to be&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;;$Body = &amp;quot;邮件正文&amp;quot;                                ; the messagebody from the mail - can be left blank but then you get a blank mail&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$Body = &lt;span class=&quot;built_in&quot;&gt;IniRead&lt;/span&gt;(&lt;span class=&quot;symbol&quot;&gt;@WorkingDir&lt;/span&gt;&amp;amp;&lt;span class=&quot;string&quot;&gt;&amp;quot;\mail.ini&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;setup&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$AttachFiles = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;                        &lt;span class=&quot;comment&quot;&gt;; the file you want to attach- leave blank if not needed&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$CcAddress = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;        &lt;span class=&quot;comment&quot;&gt;; address for cc - leave blank if not needed&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$BccAddress = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;      &lt;span class=&quot;comment&quot;&gt;; address for bcc - leave blank if not needed&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$Importance = &lt;span class=&quot;string&quot;&gt;&amp;quot;Normal&amp;quot;&lt;/span&gt;                  &lt;span class=&quot;comment&quot;&gt;; Send message priority: &amp;quot;High&amp;quot;, &amp;quot;Normal&amp;quot;, &amp;quot;Low&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$Username = &lt;span class=&quot;built_in&quot;&gt;IniRead&lt;/span&gt;(&lt;span class=&quot;symbol&quot;&gt;@WorkingDir&lt;/span&gt;&amp;amp;&lt;span class=&quot;string&quot;&gt;&amp;quot;\mail.ini&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;setup&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;Username&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$Password = &lt;span class=&quot;built_in&quot;&gt;IniRead&lt;/span&gt;(&lt;span class=&quot;symbol&quot;&gt;@WorkingDir&lt;/span&gt;&amp;amp;&lt;span class=&quot;string&quot;&gt;&amp;quot;\mail.ini&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;setup&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;Password&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$IPPort = &lt;span class=&quot;number&quot;&gt;465&lt;/span&gt;                            &lt;span class=&quot;comment&quot;&gt;; port used for sending the mail&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$ssl = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	$rc = _INetSmtpMailCom ( $SmtpServer, $FromName, $FromAddress, $ToAddress, $Subject, $Body, $AttachFiles, $CcAddress, $BccAddress, $Importance, $Username, $Password, $IPPort, $ssl )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;endif&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;;msgbox(0,&amp;quot;&amp;quot;,$ToAddress)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;SetListView&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$a = _GetAdaptersInfo() &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$index = ($a[1][3]) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;For&lt;/span&gt; $i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;To&lt;/span&gt; $a[0][0] &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;GUICtrlCreateListViewItem&lt;/span&gt;($a[$i][1] &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;#x27;|&amp;#x27;&lt;/span&gt; &amp;amp; _ &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;StringLeft&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;Hex&lt;/span&gt;($a[$i][2]), &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;) &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;#x27;|&amp;#x27;&lt;/span&gt; &amp;amp; _ &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$a[$i][6] &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;#x27;|&amp;#x27;&lt;/span&gt; &amp;amp; _ &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;GetIfEntry($a[$i][3]) &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;#x27; MB&amp;#x27;&lt;/span&gt;, $ListView1) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Next&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;SetListView &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;GetIfEntry&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;($ifIndex)&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $tagBuffer, $tBuffer, $pBuffer, $iResult, $iSpeed, $sDescr &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$tagBuffer = &lt;span class=&quot;string&quot;&gt;&amp;quot;wchar[256];dword[5];byte[8];dword[16];char[256]&amp;quot;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$tBuffer = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;($tagBuffer) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$pBuffer = &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($tBuffer) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;DllStructSetData&lt;/span&gt;($tBuffer, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, $ifIndex, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$iResult = &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;iphlpapi.dll&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;long&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;GetIfEntry&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, $pBuffer) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$iSpeed = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tBuffer, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) / &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt; / &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$sDescr = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tBuffer, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$tBuffer = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;($iResult[0], $iSpeed, $iSpeed) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;GetIfEntry &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_GetAdaptersInfo&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $iResult, $tBuffer, $pBuffer, $aResult[1][9], $tagADPTINFO, $tAdpt &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;; 第一次调用传递空值，pOutBufLen ( $iResult[2] ) 设为结构所需大小，单位byte。 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$iResult = &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;iphlpapi.dll&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;dword&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;GetAdaptersInfo&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;ulong*&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$tBuffer = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;byte[&amp;quot;&lt;/span&gt; &amp;amp; $iResult[2] &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;quot;]&amp;quot;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;; 定义$iResult[2] 字节的缓存区域 (分配内存空间)。 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$pBuffer = &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($tBuffer) &lt;span class=&quot;comment&quot;&gt;; 获取内存指针。 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;; 第二次调用，GetAdaptersInfo把网卡信息复制到指定的内存空间 ($tBuffer) 中。 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$iResult = &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;iphlpapi.dll&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;dword&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;GetAdaptersInfo&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, $pBuffer, &lt;span class=&quot;string&quot;&gt;&amp;quot;ulong*&amp;quot;&lt;/span&gt;, $iResult[2]) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;; $iResult[0]值为0则调用成功，否则为系统错误号。 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;; 数据转换， byte --&amp;gt; IP_ADAPTER_INFO &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$tagADPTINFO = &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr NextAdpt; dword ComboIndex; char AdptName[260]; char AdptDescr[132];uint AddrLength;byte MacAddr[8];dword Index;uint Type; uint DhcpEnabled;ptr CurrentIpAddr;ptr NextIpAddr; char IpAddr[16];char IpAddrMask[16]; dword IpAddrCxt; ptr NextGateway; char GatewayAddr[16]; char GatewayAddrMask[16];dword GatewayCxt; ptr NextDhcp; char DhcpAddr[16]; char DhcpAddrMask[16];dword DhcpCxt; int HaveWins; ptr NextPriWinsServer; char PriWinsServerAddr[16]; char PriWinsServerAddrMask[16]; dword PriWinsServerCxt; ptr NextSecWinsServer; char SecWinsServerAddr[16]; char SecWinsServerAddrMask[16]; dword LeaseObtained; dword LeaseExpires&amp;quot;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;While&lt;/span&gt; $pBuffer &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$tAdpt = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;($tagADPTINFO, $pBuffer) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$aResult[0][0] += &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ReDim&lt;/span&gt; $aResult[$aResult[0][0] + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;] &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$aResult[$aResult[0][0]][0] = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tAdpt, &lt;span class=&quot;string&quot;&gt;&amp;quot;AdptName&amp;quot;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;; 网卡名称 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$aResult[$aResult[0][0]][1] = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tAdpt, &lt;span class=&quot;string&quot;&gt;&amp;quot;AdptDescr&amp;quot;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;; 网卡描述 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$aResult[$aResult[0][0]][2] = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tAdpt, &lt;span class=&quot;string&quot;&gt;&amp;quot;MacAddr&amp;quot;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;; 网卡MAC &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$aResult[$aResult[0][0]][3] = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tAdpt, &lt;span class=&quot;string&quot;&gt;&amp;quot;Index&amp;quot;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;; 网卡索引号 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$aResult[$aResult[0][0]][4] = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tAdpt, &lt;span class=&quot;string&quot;&gt;&amp;quot;Type&amp;quot;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;; 类型 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$aResult[$aResult[0][0]][5] = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tAdpt, &lt;span class=&quot;string&quot;&gt;&amp;quot;DhcpEnabled&amp;quot;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;; DHCP是否启用 true = 启用， false = 禁用 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$aResult[$aResult[0][0]][6] = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tAdpt, &lt;span class=&quot;string&quot;&gt;&amp;quot;IpAddr&amp;quot;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;; IP 地址 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$aResult[$aResult[0][0]][7] = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tAdpt, &lt;span class=&quot;string&quot;&gt;&amp;quot;GatewayAddr&amp;quot;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;; 网关地址 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$aResult[$aResult[0][0]][8] = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tAdpt, &lt;span class=&quot;string&quot;&gt;&amp;quot;DhcpAddr&amp;quot;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;; DHCP地址, 只有DhcpEnabled为true时，此值才有效。 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$pBuffer = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tAdpt, &lt;span class=&quot;string&quot;&gt;&amp;quot;NextAdpt&amp;quot;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;; [下一张网卡信息的内存地址。] &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$tAdpt = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WEnd&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$tBuffer = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;($iResult[0], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, $aResult) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_GetAdaptersInfo&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;; The UDF&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_INetSmtpMailCom&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;( $s_SmtpServer, $s_FromName, $s_FromAddress, $s_ToAddress, $s_Subject = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, $as_Body = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, $s_AttachFiles = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, $s_CcAddress = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, $s_BccAddress = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, $s_Importance= &lt;span class=&quot;string&quot;&gt;&amp;quot;Normal&amp;quot;&lt;/span&gt;, $s_Username = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, $s_Password = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, $IPPort = &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, $ssl = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; )&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $objEmail = &lt;span class=&quot;built_in&quot;&gt;ObjCreate&lt;/span&gt; ( &lt;span class=&quot;string&quot;&gt;&amp;quot;CDO.Message&amp;quot;&lt;/span&gt; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $objEmail.From = &lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;quot;&amp;#x27;&lt;/span&gt; &amp;amp; $s_FromName &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;quot; &amp;lt;&amp;#x27;&lt;/span&gt; &amp;amp; $s_FromAddress &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;gt;&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $objEmail.&lt;span class=&quot;keyword&quot;&gt;To&lt;/span&gt; = $s_ToAddress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $i_Error = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $i_Error_desciption = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $s_CcAddress &amp;lt;&amp;gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; $objEmail.Cc = $s_CcAddress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $s_BccAddress &amp;lt;&amp;gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; $objEmail.Bcc = $s_BccAddress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $objEmail.Subject = $s_Subject&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;StringInStr&lt;/span&gt; ( $as_Body, &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;lt;&amp;quot;&lt;/span&gt; ) &lt;span class=&quot;literal&quot;&gt;And&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;StringInStr&lt;/span&gt; ( $as_Body, &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;gt;&amp;quot;&lt;/span&gt; ) &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $objEmail.HTMLBody = $as_Body&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;Else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $objEmail.Textbody = $as_Body &amp;amp; &lt;span class=&quot;symbol&quot;&gt;@CRLF&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $s_AttachFiles &amp;lt;&amp;gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $S_Files2Attach = &lt;span class=&quot;built_in&quot;&gt;StringSplit&lt;/span&gt; ( $s_AttachFiles, &lt;span class=&quot;string&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;For&lt;/span&gt; $x = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;To&lt;/span&gt; $S_Files2Attach [ &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            $S_Files2Attach [ $x ] = _PathFull ( $S_Files2Attach [ $x ] )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;ConsoleWrite&lt;/span&gt; ( &lt;span class=&quot;string&quot;&gt;&amp;#x27;@@ Debug(62) : $S_Files2Attach = &amp;#x27;&lt;/span&gt; &amp;amp; $S_Files2Attach &amp;amp; &lt;span class=&quot;symbol&quot;&gt;@LF&lt;/span&gt; &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;gt;Error code: &amp;#x27;&lt;/span&gt; &amp;amp; &lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt; &amp;amp; &lt;span class=&quot;symbol&quot;&gt;@LF&lt;/span&gt; ) &lt;span class=&quot;comment&quot;&gt;;### Debug Console&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;FileExists&lt;/span&gt; ( $S_Files2Attach [ $x ] ) &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                $objEmail.AddAttachment ( $S_Files2Attach [ $x ] )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;Else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;ConsoleWrite&lt;/span&gt; ( &lt;span class=&quot;string&quot;&gt;&amp;#x27;!&amp;gt; File not found to attach: &amp;#x27;&lt;/span&gt; &amp;amp; $S_Files2Attach [ $x ] &amp;amp; &lt;span class=&quot;symbol&quot;&gt;@LF&lt;/span&gt; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt; ( &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Next&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $objEmail.Configuration.Fields.Item ( &lt;span class=&quot;string&quot;&gt;&amp;quot;http://schemas.microsoft.com/cdo/configuration/sendusing&amp;quot;&lt;/span&gt; ) = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $objEmail.Configuration.Fields.Item ( &lt;span class=&quot;string&quot;&gt;&amp;quot;http://schemas.microsoft.com/cdo/configuration/smtpserver&amp;quot;&lt;/span&gt; ) = $s_SmtpServer&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Number&lt;/span&gt; ( $IPPort ) = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt; $IPPort = &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $objEmail.Configuration.Fields.Item ( &lt;span class=&quot;string&quot;&gt;&amp;quot;http://schemas.microsoft.com/cdo/configuration/smtpserverport&amp;quot;&lt;/span&gt; ) = $IPPort&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;;Authenticated SMTP&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $s_Username &amp;lt;&amp;gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $objEmail.Configuration.Fields.Item ( &lt;span class=&quot;string&quot;&gt;&amp;quot;http://schemas.microsoft.com/cdo/configuration/smtpauthenticate&amp;quot;&lt;/span&gt; ) = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $objEmail.Configuration.Fields.Item ( &lt;span class=&quot;string&quot;&gt;&amp;quot;http://schemas.microsoft.com/cdo/configuration/sendusername&amp;quot;&lt;/span&gt; ) = $s_Username&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $objEmail.Configuration.Fields.Item ( &lt;span class=&quot;string&quot;&gt;&amp;quot;http://schemas.microsoft.com/cdo/configuration/sendpassword&amp;quot;&lt;/span&gt; ) = $s_Password&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $ssl &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $objEmail.Configuration.Fields.Item ( &lt;span class=&quot;string&quot;&gt;&amp;quot;http://schemas.microsoft.com/cdo/configuration/smtpusessl&amp;quot;&lt;/span&gt; ) = &lt;span class=&quot;literal&quot;&gt;True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;;Update settings&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $objEmail.Configuration.Fields.Update&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;; Set Email Importance&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;Switch&lt;/span&gt; $s_Importance&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;High&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            $objEmail.Fields.Item ( &lt;span class=&quot;string&quot;&gt;&amp;quot;urn:schemas:mailheader:Importance&amp;quot;&lt;/span&gt; ) = &lt;span class=&quot;string&quot;&gt;&amp;quot;High&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;Normal&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            $objEmail.Fields.Item ( &lt;span class=&quot;string&quot;&gt;&amp;quot;urn:schemas:mailheader:Importance&amp;quot;&lt;/span&gt; ) = &lt;span class=&quot;string&quot;&gt;&amp;quot;Normal&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;Low&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            $objEmail.Fields.Item ( &lt;span class=&quot;string&quot;&gt;&amp;quot;urn:schemas:mailheader:Importance&amp;quot;&lt;/span&gt; ) = &lt;span class=&quot;string&quot;&gt;&amp;quot;Low&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;EndSwitch&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $objEmail.Fields.Update&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;; Sent the Message&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $objEmail.&lt;span class=&quot;built_in&quot;&gt;Send&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt; ( &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; $oMyRet [ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $objEmail= &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;    &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_INetSmtpMailCom&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;成品下载地址&quot;&gt;&lt;a href=&quot;#成品下载地址&quot; class=&quot;headerlink&quot; title=&quot;成品下载地址&quot;&gt;&lt;/a&gt;成品下载地址&lt;/h1&gt;</summary>
    
    
    
    <category term="源码" scheme="https://www.bnwin.com/categories/code/"/>
    
    
    <category term="autoit源码" scheme="https://www.bnwin.com/tags/autoit%E6%BA%90%E7%A0%81/"/>
    
    <category term="原创软件" scheme="https://www.bnwin.com/tags/%E5%8E%9F%E5%88%9B%E8%BD%AF%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>使用croc两网吧之间同步互传文件</title>
    <link href="https://www.bnwin.com/page/1934957637/"/>
    <id>https://www.bnwin.com/page/1934957637/</id>
    <published>2021-09-15T04:15:29.000Z</published>
    <updated>2021-09-23T02:26:15.331Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/46709024-9b23ad00-cbf6-11e8-9fb2-ca8b20b7dbec.jpg" alt=""><h1 id="故事背景"><a href="#故事背景" class="headerlink" title="故事背景"></a>故事背景</h1><p>网吧A和网吧B之间经常有这样的事情发生:网吧A更新游戏，如pubg，更新量很大，比如40G，网吧A速度很快，已经更新完成，但网吧B速度慢，到游戏开服也只更新了20G。如果把网吧A的游戏同步更新到网吧B呢？一般的做法是用U盘从网吧A拷到网吧B<br>但网吧使用无盘服务器，需要在服务器上插U盘，风险较高！并且比较麻烦，从网吧A拷了游戏还要跑网吧B操作。如果在网吧A开通ftp，再从网吧B下载，速度不敢保证，并且还得映射端口，各种复杂的操作!普通小白做不到！<br>其中直接同步，可以采用syncthing实现两网吧P2P文件同步，syncthing需要双方安装，总之操作不够简单！<br>croc是使用golang 编写的工具，允许任何两台计算机简单和安全地传输文件和文件夹。据我所知，croc 是唯一的 CLI 文件传输工具。<br>对，你没听错，只需要一个文件croc.exe，分别拷到网吧A和网吧B的游戏目录，同时运行就可以互传文件或文件夹!<br>如果网吧A和网吧B的带宽均不高，网吧间互传文件很慢，那么你也可以从网吧A用U盘拷游戏到网吧B，从客户机使用croc和网吧B的服务器同步文件，局域网传文件相当快，比在服务器插U盘相比，中毒风险直接排除！</p><h1 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h1><p>　　croc 的特性：允许任意两台计算机传输数据（使用一个中继）<br>　　提供端到端加密（使用 PAKE）<br>　　支持方便的跨平台传输，支持 Windows、Linux、Mac<br>　　允许多文件传输<br>　　允许恢复被中断的传输<br>　　不需要本地服务器或端口转发<br>　　通过压缩和多路复用比虫洞、rsync、scp 更快（加速 1.5x 到 4x）<br>　　支持IPv6和IPv4；<br>　　支持使用Tor之类的代理；</p><h1 id="简单使用方法"><a href="#简单使用方法" class="headerlink" title="简单使用方法"></a>简单使用方法</h1><img src="/images/16f5fa106ffe738b_600_0.gif" alt="">如需发送文件，可以直接运行下列命令：<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ croc send [file(s)-or-folder]</span><br><span class="line">Sending &#x27;file-or-folder&#x27; (X MB)</span><br><span class="line">Code is: code-phrase</span><br></pre></td></tr></table></figure>接下来，在另一台电脑上使用下列命令来进行文件或目录接收：<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ croc code-phrase</span><br></pre></td></tr></table></figure>这里的code-phrase即密码短语，用于建立密码认证密钥协议（PAKE），该协议将生成一个密钥供发送方和接收方用于端到端加密。<p>自定义密码短语<br>我们可以使用下列方式来配置自己的密码短语，必须是4个字符以上：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ croc send --code [code-phrase] [file(s)-or-folder]</span><br></pre></td></tr></table></figure><p>使用管道-stdin和stdout<br>我们可以通过管道来向Croc传递文件：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat [filename] | croc send</span><br></pre></td></tr></table></figure><p>此时，Croc将会自动使用stdin数据，并发送和分配一个类似“croc-stdin-123456789”的文件名。如需接收stdout，可以直接使用–yes选项来自动接收文件：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ croc --yes [code-phrase] &gt; out</span><br></pre></td></tr></table></figure><p>发送文字消息<br>有些时候，我们可能只需要发送URL地址或简短的文字消息，此时可以通过下列命令实现发送：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ croc send --text &quot;hello world&quot;</span><br></pre></td></tr></table></figure><p>使用代理<br>我们还可以使用代理链接来进行传输中继，比如说，我们可以使用下列命令来将Tor作为代理中继：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ croc --socks5 &quot;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">9050</span>&quot; send SOMEFILE</span><br></pre></td></tr></table></figure><h1 id="网吧同步文件的使用"><a href="#网吧同步文件的使用" class="headerlink" title="网吧同步文件的使用"></a>网吧同步文件的使用</h1><ol><li>网吧A与网吧B直接传文件，如要拷贝的目录为pubg，则先把croc.exe拷到pubg同级目录（不是拷在pubg目录，如pubg完整目录为g:\steam\pubg,那croc.exe应拷到g:\steam目录，同步完就可以把croc.exe删除）然后执行<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">croc send --code mysendname pubg</span><br></pre></td></tr></table></figure>在网吧B也把croc.exe拷到pubg同级目录，执行<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">croc mysendname</span><br></pre></td></tr></table></figure>即实现了把网吧A的pubg文件夹完全拷到网吧B的pubg</li><li>网吧客户机拷到网吧服务器。比如用U盘从网吧A拷了游戏，在网吧B任意一台机器拷到网吧B的服务器，同样在要拷贝的同级分别拷贝croc.exe<br>在客户机执行<br>发送端执行<br>先建服务(中转服务器直接在客户机，拷贝速度就看你内网的速度，下面的192.168.10.8的IP就是执行此命令的机器的IP)<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">croc replay</span><br></pre></td></tr></table></figure>再传文件夹(IP换成你当前中转服务机器的IP，一般就在当前机器)<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">croc --relay <span class="number">192</span>.<span class="number">168</span>.<span class="number">10</span>.<span class="number">8</span>:<span class="number">9009</span> send --code mysendtask pubg</span><br></pre></td></tr></table></figure>接收端执行(IP换成你当前中转服务机器的IP)<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">croc --relay <span class="number">192</span>.<span class="number">168</span>.<span class="number">10</span>.<span class="number">8</span>:<span class="number">9009</span> mysendtask</span><br></pre></td></tr></table></figure></li></ol><h1 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h1><p><a href="https://github.com/schollz/croc/releases">github下载地址</a><br><a href="https://github.com/schollz/croc">github开源</a><br>如果github的下载速度太慢，你也可以尝试搜索国内的下载地址</p>]]></content>
    
    
    <summary type="html">&lt;img src=&quot;/images/46709024-9b23ad00-cbf6-11e8-9fb2-ca8b20b7dbec.jpg&quot; alt&gt;

&lt;h1 id=&quot;故事背景&quot;&gt;&lt;a href=&quot;#故事背景&quot; class=&quot;headerlink&quot; title=&quot;故事背景&quot;&gt;&lt;/a&gt;故事背景&lt;/h1&gt;&lt;p&gt;网吧A和网吧B之间经常有这样的事情发生:网吧A更新游戏，如pubg，更新量很大，比如40G，网吧A速度很快，已经更新完成，但网吧B速度慢，到游戏开服也只更新了20G。如果把网吧A的游戏同步更新到网吧B呢？一般的做法是用U盘从网吧A拷到网吧B&lt;br&gt;但网吧使用无盘服务器，需要在服务器上插U盘，风险较高！并且比较麻烦，从网吧A拷了游戏还要跑网吧B操作。如果在网吧A开通ftp，再从网吧B下载，速度不敢保证，并且还得映射端口，各种复杂的操作!普通小白做不到！&lt;br&gt;其中直接同步，可以采用syncthing实现两网吧P2P文件同步，syncthing需要双方安装，总之操作不够简单！&lt;br&gt;croc是使用golang 编写的工具，允许任何两台计算机简单和安全地传输文件和文件夹。据我所知，croc 是唯一的 CLI 文件传输工具。&lt;br&gt;对，你没听错，只需要一个文件croc.exe，分别拷到网吧A和网吧B的游戏目录，同时运行就可以互传文件或文件夹!&lt;br&gt;如果网吧A和网吧B的带宽均不高，网吧间互传文件很慢，那么你也可以从网吧A用U盘拷游戏到网吧B，从客户机使用croc和网吧B的服务器同步文件，局域网传文件相当快，比在服务器插U盘相比，中毒风险直接排除！&lt;/p&gt;
&lt;h1 id=&quot;功能介绍&quot;&gt;&lt;a href=&quot;#功能介绍&quot; class=&quot;headerlink&quot; title=&quot;功能介绍&quot;&gt;&lt;/a&gt;功能介绍&lt;/h1&gt;&lt;p&gt;　　croc 的特性：允许任意两台计算机传输数据（使用一个中继）&lt;br&gt;　　提供端到端加密（使用 PAKE）&lt;br&gt;　　支持方便的跨平台传输，支持 Windows、Linux、Mac&lt;br&gt;　　允许多文件传输&lt;br&gt;　　允许恢复被中断的传输&lt;br&gt;　　不需要本地服务器或端口转发&lt;br&gt;　　通过压缩和多路复用比虫洞、rsync、scp 更快（加速 1.5x 到 4x）&lt;br&gt;　　支持IPv6和IPv4；&lt;br&gt;　　支持使用Tor之类的代理；&lt;/p&gt;
&lt;h1 id=&quot;简单使用方法&quot;&gt;&lt;a href=&quot;#简单使用方法&quot; class=&quot;headerlink&quot; title=&quot;简单使用方法&quot;&gt;&lt;/a&gt;简单使用方法&lt;/h1&gt;&lt;img src=&quot;/images/16f5fa106ffe738b_600_0.gif&quot; alt&gt;
如需发送文件，可以直接运行下列命令：
&lt;figure class=&quot;highlight dos&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ croc send [file(s)-or-folder]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Sending &amp;#x27;file-or-folder&amp;#x27; (X MB)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Code is: code-phrase&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
接下来，在另一台电脑上使用下列命令来进行文件或目录接收：
&lt;figure class=&quot;highlight dos&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ croc code-phrase&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
这里的code-phrase即密码短语，用于建立密码认证密钥协议（PAKE），该协议将生成一个密钥供发送方和接收方用于端到端加密。

&lt;p&gt;自定义密码短语&lt;br&gt;我们可以使用下列方式来配置自己的密码短语，必须是4个字符以上：&lt;/p&gt;</summary>
    
    
    
    <category term="软件" scheme="https://www.bnwin.com/categories/soft/"/>
    
    
    <category term="局域网" scheme="https://www.bnwin.com/tags/%E5%B1%80%E5%9F%9F%E7%BD%91/"/>
    
    <category term="精品软件" scheme="https://www.bnwin.com/tags/%E7%B2%BE%E5%93%81%E8%BD%AF%E4%BB%B6/"/>
    
    <category term="文件传输" scheme="https://www.bnwin.com/tags/%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93/"/>
    
  </entry>
  
  <entry>
    <title>Delphi实现类似Android锁屏的密码锁控件</title>
    <link href="https://www.bnwin.com/page/2745266982/"/>
    <id>https://www.bnwin.com/page/2745266982/</id>
    <published>2021-09-14T04:07:15.000Z</published>
    <updated>2021-09-16T23:41:43.689Z</updated>
    
    <content type="html"><![CDATA[<p>手机锁屏之后，开屏的时候，要求咱们输入密码的那个滑动效果输入的控件。<br>  Android的那个锁屏的效果，用过的人应该都知道是个什么效果，也就是横竖各3行，排列成九宫格的效果，然后由用户在上面滑动以此来达到密码输入进而进行解锁和加密的效果。那么首先，俺们可以分析一下，他的具体形成思路，实际上是很简单的，就是一个排列，然后根据滑动产生的内容形成密码来达到解密的目的，那么最主要的就是这个密码和他本身的密码是如何对应解密的，实际上很简单，咱们给他排列的九宫格，都固定好位置</p><p>1 2 3<br>4 5 6<br>7 8 9 </p><p>就像这样，排列的给他的位置固定好，然后每一个格子表示一个字符或者说字符串，进而用户滑动的时候，将对应的位置序列进入到一个列表中去保存，然后鼠标放开的时候，那么入队的选择位置进行组合，那么就是对应的密码了，比如<img src="/images/2012072314370919.png" alt=""></p><p>这样的输入就是表示123，如此顺序记录，就可以形成密码了，然后用户进行滑屏录入之后和以前的进行比较就可以知道密码是否正确了，当然我这个组合是相当简单的，如果想要整的复杂，可以给每个顺序位置给定复杂的字符串，这样形成的密码就足够的复杂了！给一般人去看，也是看不明白的。</p><p>那么分析清楚了，思路也就简单了，鼠标按下的时候，开始可以滑动形成密码，鼠标按下的第一个点，作为队列的第一个，然后再滑过的就顺序的一一的记录到队列中，鼠标放开的时候，从队列中获取各个顺序位置，组合形成密码然后和原密码比对，判断密码是否正确！源码如下：</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  Delphi实现的类似Android鼠标锁屏效果的控件</span></span><br><span class="line"><span class="comment">  作者：不得闲</span></span><br><span class="line"><span class="comment">  2012-7-23</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="keyword">unit</span> AndroidLockControl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span></span><br><span class="line"><span class="keyword">uses</span> Windows,Classes,SysUtils,Graphics,Controls;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span></span><br><span class="line">  TDxLockItem = <span class="keyword">class</span></span><br><span class="line">  <span class="keyword">private</span></span><br><span class="line">    r: TRect;</span><br><span class="line">    IsEnter: Boolean;</span><br><span class="line">    IsChecked: Boolean;</span><br><span class="line">    Value: AnsiChar;</span><br><span class="line">    FRadio: TPoint;</span><br><span class="line">  <span class="keyword">public</span></span><br><span class="line">    <span class="function"><span class="keyword">constructor</span> <span class="title">Create</span>;</span></span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">  TInPutPwdEvent = <span class="function"><span class="keyword">procedure</span><span class="params">(Sender: TObject;InputPwd: <span class="keyword">string</span>)</span> <span class="title">of</span> <span class="title">object</span>;</span></span><br><span class="line">  <span class="title">TDxAndroidLock</span> = <span class="keyword">class</span>(TGraphicControl)</span><br><span class="line">  <span class="keyword">private</span></span><br><span class="line">    FItemSpace: Integer;</span><br><span class="line">    FRowCount: Integer;</span><br><span class="line">    FColCount: Integer;</span><br><span class="line">    FItemRaidio: Integer;</span><br><span class="line">    Items: TList;</span><br><span class="line">    FUseNum: Boolean;</span><br><span class="line">    FPassword: <span class="keyword">string</span>;</span><br><span class="line">    IsDown: Boolean;</span><br><span class="line">    LastInItem: TDxLockItem;</span><br><span class="line">    PwdItems: TList;</span><br><span class="line">    FOnInputPwd: TInPutPwdEvent;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">SetItemSpace</span><span class="params">(<span class="keyword">const</span> Value: Integer)</span>;</span></span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">SetItemRaidio</span><span class="params">(<span class="keyword">const</span> Value: Integer)</span>;</span></span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">SetUseNum</span><span class="params">(<span class="keyword">const</span> Value: Boolean)</span>;</span></span><br><span class="line">  <span class="keyword">protected</span></span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">paint</span>;</span><span class="keyword">override</span>;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">MouseDown</span><span class="params">(Button: TMouseButton; Shift: TShiftState;</span></span></span><br><span class="line"><span class="params"><span class="function">      X, Y: Integer)</span>;</span> <span class="keyword">override</span>;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">MouseMove</span><span class="params">(Shift: TShiftState; X, Y: Integer)</span>;</span> <span class="keyword">override</span>;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">MouseUp</span><span class="params">(Button: TMouseButton; Shift: TShiftState;</span></span></span><br><span class="line"><span class="params"><span class="function">      X, Y: Integer)</span>;</span> <span class="keyword">override</span>;</span><br><span class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">CalcItemRects</span>;</span></span><br><span class="line">  <span class="keyword">public</span></span><br><span class="line">    <span class="function"><span class="keyword">constructor</span> <span class="title">Create</span><span class="params">(AOwner: TComponent)</span>;</span><span class="keyword">override</span>;</span><br><span class="line">    <span class="function"><span class="keyword">destructor</span> <span class="title">Destroy</span>;</span><span class="keyword">override</span>;</span><br><span class="line">    <span class="keyword">property</span> Password: <span class="keyword">string</span> <span class="keyword">read</span> FPassword <span class="keyword">write</span> FPassWord;</span><br><span class="line">  <span class="keyword">published</span></span><br><span class="line">    <span class="keyword">property</span> ItemSpace: Integer <span class="keyword">read</span> FItemSpace <span class="keyword">write</span> SetItemSpace <span class="keyword">default</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">property</span> OnInputPwd: TInPutPwdEvent <span class="keyword">read</span> FOnInputPwd <span class="keyword">write</span> FOnInputPwd;</span><br><span class="line">    <span class="keyword">property</span> ItemRaidio: Integer <span class="keyword">read</span> FItemRaidio <span class="keyword">write</span> SetItemRaidio <span class="keyword">default</span> <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">property</span> UseNum: Boolean <span class="keyword">read</span> FUseNum <span class="keyword">write</span> SetUseNum;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">implementation</span></span><br><span class="line"><span class="keyword">uses</span> pngimage;</span><br><span class="line"><span class="meta">&#123;$R LockRc.RES&#125;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  PngIn,PngOut: TPngImage;</span><br><span class="line"><span class="comment">&#123; TDxAndroidLock &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">CalcItemRects</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i,j: Integer;</span><br><span class="line">  p: TPoint;</span><br><span class="line">  r: TRect;</span><br><span class="line">  item: TDxLockItem;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  p.Y := FItemRaidio;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">1</span> <span class="keyword">to</span> <span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    p.X := FItemRaidio;</span><br><span class="line">    r.Left := p.X - FItemRaidio;r.Top := p.Y - FItemRaidio;</span><br><span class="line">    r.Right := p.x + FItemRaidio;r.Bottom := p.Y + FItemRaidio;</span><br><span class="line">    <span class="keyword">for</span> j := <span class="number">1</span> <span class="keyword">to</span> <span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      item := Items[<span class="number">3</span>*(i-<span class="number">1</span>)+j - <span class="number">1</span>];</span><br><span class="line">      item.Value := AnsiChar(<span class="number">3</span>*(i-<span class="number">1</span>)+j+<span class="number">48</span>);</span><br><span class="line">      item.FRadio := p;</span><br><span class="line">      item.r := r;</span><br><span class="line">      p.X := p.X + FItemRaidio * <span class="number">2</span> + FItemSpace;</span><br><span class="line">      r.Left := p.X - FItemRaidio;r.Right := p.X + FItemRaidio;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">    p.Y := p.Y + FItemRaidio * <span class="number">2</span> + FItemSpace;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">constructor</span> <span class="title">TDxAndroidLock</span>.<span class="title">create</span><span class="params">(AOwner: TComponent)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i: Integer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">inherited</span>;</span><br><span class="line">  LastInItem := <span class="keyword">nil</span>;</span><br><span class="line">  PwdItems := TList.Create;</span><br><span class="line">  FPassWord := <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  Items := TList.Create;</span><br><span class="line">  FItemSpace := <span class="number">10</span>;</span><br><span class="line">  FRowCount := <span class="number">3</span>;</span><br><span class="line">  FColCount := <span class="number">3</span>;</span><br><span class="line">  FItemRaidio := <span class="number">20</span>;</span><br><span class="line">  Width := FItemRaidio * <span class="number">2</span> * <span class="number">3</span> + FItemSpace * <span class="number">2</span>;</span><br><span class="line">  Height := FItemRaidio * <span class="number">2</span> * <span class="number">3</span> + FItemSpace * <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> <span class="number">8</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    Items.Add(TDxLockItem.Create);</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  CalcItemRects;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">destructor</span> <span class="title">TDxAndroidLock</span>.<span class="title">Destroy</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">while</span> Items.Count &gt; <span class="number">0</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    TDxLockItem(Items[Items.Count - <span class="number">1</span>]).Free;</span><br><span class="line">    Items.Delete(Items.Count - <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  PwdItems.Free;</span><br><span class="line">  <span class="keyword">inherited</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">MouseDown</span><span class="params">(Button: TMouseButton; Shift: TShiftState; X,</span></span></span><br><span class="line"><span class="params"><span class="function">  Y: Integer)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  IsDown := Button = mbLeft;</span><br><span class="line">  <span class="keyword">if</span> IsDown <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> LastInItem &lt;&gt; <span class="keyword">nil</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      LastInItem.IsChecked := IsDown;</span><br><span class="line">      PwdItems.Add(LastInItem);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">    Invalidate;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">MouseMove</span><span class="params">(Shift: TShiftState; X, Y: Integer)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i: Integer;</span><br><span class="line">  p: TPoint;</span><br><span class="line">  OldInItem,Item: TDxLockItem;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  OldInItem := LastInItem;</span><br><span class="line">  p := Point(x,y);</span><br><span class="line">  LastInItem := <span class="keyword">nil</span>;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> items.Count - <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    item := Items[i];</span><br><span class="line">    <span class="keyword">if</span> PtInRect(Item.r,p) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      LastInItem := Item;</span><br><span class="line">      LastInItem.IsEnter := True;</span><br><span class="line">      LastInItem.IsChecked := IsDown;</span><br><span class="line">      <span class="keyword">Break</span>;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">if</span> LastInItem &lt;&gt; OldInItem <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> OldInItem &lt;&gt; <span class="keyword">nil</span> <span class="keyword">then</span></span><br><span class="line">      OldInItem.IsEnter := False;</span><br><span class="line">    <span class="keyword">if</span> IsDown <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      <span class="keyword">if</span> LastInItem &lt;&gt; <span class="keyword">nil</span> <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        PwdItems.Add(LastInItem);</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line">      Invalidate;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">MouseUp</span><span class="params">(Button: TMouseButton; Shift: TShiftState; X,</span></span></span><br><span class="line"><span class="params"><span class="function">  Y: Integer)</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i: Integer;</span><br><span class="line">  item: TDxLockItem;</span><br><span class="line">  Np: <span class="keyword">string</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  IsDown := False;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> items.Count - <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    item := Items[i];</span><br><span class="line">    item.IsChecked := False;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> PwdItems.Count - <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">    Np := Np + TDxLockItem(PwdItems[i]).Value;</span><br><span class="line">  PwdItems.Clear;</span><br><span class="line">  Invalidate;</span><br><span class="line">  <span class="keyword">if</span> Assigned(FOnInputPwd) <span class="keyword">then</span></span><br><span class="line">    FOnInputPwd(self,Np);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">DrawLineArrow</span><span class="params">(canvas: TCanvas; p1, p2: TPoint)</span>;</span></span><br><span class="line"><span class="keyword">const</span></span><br><span class="line">  l = <span class="number">6</span>; <span class="comment">//箭头长度</span></span><br><span class="line">  w = <span class="number">4</span>; <span class="comment">//箭头宽度</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  slope, angle: Double;</span><br><span class="line">  points: <span class="keyword">array</span>[<span class="number">0</span>..<span class="number">2</span>] <span class="keyword">of</span> TPoint;</span><br><span class="line">  Xl,b: Single;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  canvas.Brush.Color := canvas.Pen.Color;</span><br><span class="line">  canvas.Brush.Style := bsSolid;</span><br><span class="line">  canvas.MoveTo(p1.X,p1.Y);</span><br><span class="line">  canvas.LineTo(p2.X,p2.Y);</span><br><span class="line">  <span class="keyword">if</span> (p2.Y &lt;&gt; p1.Y) <span class="keyword">and</span> (P2.X &lt;&gt; p1.X) <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    xl := (P2.Y - p1.Y) / (P2.X - p1.X);</span><br><span class="line">    b := p2.Y - xl * p2.X;</span><br><span class="line">    p2.X := (p2.X - p1.X) <span class="keyword">div</span> <span class="number">2</span> + p1.X;</span><br><span class="line">    p2.Y := Trunc(p2.X * xl + b);</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> p2.Y = p1.Y <span class="keyword">then</span></span><br><span class="line">    p2.X := (p2.X - p1.X) <span class="keyword">div</span> <span class="number">2</span> + p1.X</span><br><span class="line">  <span class="keyword">else</span> P2.Y := (p2.Y - p1.Y) <span class="keyword">div</span> <span class="number">2</span> + p1.Y;</span><br><span class="line"><span class="comment">//画箭头</span></span><br><span class="line">  points[<span class="number">0</span>] := Point(p2.x, p2.y);<span class="comment">//箭头顶点</span></span><br><span class="line">  <span class="keyword">if</span> (p2.x - p1.x = <span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span> <span class="comment">//垂直</span></span><br><span class="line">    <span class="keyword">if</span> (p2.y - p1.y &gt; <span class="number">0</span>) <span class="keyword">then</span> slope := -<span class="number">1</span> <span class="keyword">else</span> slope := <span class="number">1</span>;</span><br><span class="line">    points[<span class="number">1</span>] := Point(p2.x - w, p2.y + Trunc(l * slope));</span><br><span class="line">    points[<span class="number">2</span>] := Point(p2.x + w, p2.y + Trunc(l * slope));</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">else</span></span><br><span class="line">  <span class="keyword">begin</span> <span class="comment">//倾斜</span></span><br><span class="line">    slope := (p2.y - p1.y) / (p2.x - p1.x);</span><br><span class="line">    angle := ArcTan(slope);</span><br><span class="line">    <span class="keyword">if</span> (p2.x - p1.x &gt; <span class="number">0</span>) <span class="keyword">then</span> angle := angle - PI;</span><br><span class="line">    points[<span class="number">1</span>] := Point(p2.x + trunc(l * cos(angle) - w * sin(angle)),</span><br><span class="line">      p2.y + trunc(l * sin(angle) + w * cos(angle)));</span><br><span class="line">    points[<span class="number">2</span>] := Point(p2.x + Trunc(l * cos(angle) + w * sin(angle)),</span><br><span class="line">      p2.y + Trunc(l * sin(angle) - w * cos(angle)));</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line">  canvas.Polygon(points);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">paint</span>;</span></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">  i: Integer;</span><br><span class="line">  item,item1: TDxLockItem;</span><br><span class="line">  r: TRect;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> IsDown <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> Items.Count - <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      item := items[i];</span><br><span class="line">      r.Left := item.FRadio.X - <span class="number">5</span>;r.Right := item.FRadio.X + <span class="number">5</span>;</span><br><span class="line">      r.Top := item.FRadio.Y - <span class="number">5</span>;r.Bottom := item.FRadio.Y + <span class="number">5</span>;</span><br><span class="line">      Canvas.Draw(r.Left,r.Top,pngIn);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    <span class="comment">//绘制指向线条</span></span><br><span class="line">    Canvas.Pen.Width := <span class="number">2</span>;</span><br><span class="line">    Canvas.Pen.Color := clGreen;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> PwdItems.Count - <span class="number">2</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      item := PwdItems[i];</span><br><span class="line">      item1 := PwdItems[i + <span class="number">1</span>];</span><br><span class="line">      Canvas.MoveTo(item.FRadio.X,item.FRadio.Y);</span><br><span class="line">      Canvas.LineTo(item1.FRadio.X,item1.FRadio.Y);</span><br><span class="line">      DrawLineArrow(Canvas,item.FRadio,item1.FRadio);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span> <span class="keyword">to</span> Items.Count - <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">      item := items[i];</span><br><span class="line">      <span class="keyword">if</span> item.IsChecked <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        Canvas.Draw(item.r.Left,item.r.Top,pngOut);</span><br><span class="line">      <span class="keyword">end</span>;</span><br><span class="line">      r.Left := item.FRadio.X - <span class="number">5</span>;r.Right := item.FRadio.X + <span class="number">5</span>;</span><br><span class="line">      r.Top := item.FRadio.Y - <span class="number">5</span>;r.Bottom := item.FRadio.Y + <span class="number">5</span>;</span><br><span class="line">      Canvas.Draw(r.Left,r.Top,pngIn);</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">  <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">SetItemRaidio</span><span class="params">(<span class="keyword">const</span> Value: Integer)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  FItemRaidio := Value;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">SetItemSpace</span><span class="params">(<span class="keyword">const</span> Value: Integer)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  FItemSpace := Value;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">TDxAndroidLock</span>.<span class="title">SetUseNum</span><span class="params">(<span class="keyword">const</span> Value: Boolean)</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  FUseNum := Value;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">&#123; TDxLockItem &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">constructor</span> <span class="title">TDxLockItem</span>.<span class="title">Create</span>;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  r := Rect(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">  IsEnter := False;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">initialization</span></span><br><span class="line"> PngIn := TPngImage.Create;</span><br><span class="line"> PngIn.LoadFromResourceName(Hinstance,<span class="string">&#x27;InnerGra&#x27;</span>);</span><br><span class="line"> PngOut := TPngImage.Create;</span><br><span class="line"> PngOut.LoadFromResourceName(Hinstance,<span class="string">&#x27;Outer&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">finalization</span></span><br><span class="line">  PngIn.Free;</span><br><span class="line">  PngOut.Free;</span><br><span class="line"><span class="keyword">end</span>.</span><br></pre></td></tr></table></figure><p>运行之后的效果就是<br><img src="/images/2012072314434974.jpg" alt=""><br>转载自: <a href="https://www.cnblogs.com/DxSoft/archive/2012/07/23/2604941.html">https://www.cnblogs.com/DxSoft/archive/2012/07/23/2604941.html</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;手机锁屏之后，开屏的时候，要求咱们输入密码的那个滑动效果输入的控件。&lt;br&gt;  Android的那个锁屏的效果，用过的人应该都知道是个什么效果，也就是横竖各3行，排列成九宫格的效果，然后由用户在上面滑动以此来达到密码输入进而进行解锁和加密的效果。那么首先，俺们可以分析一下，他的具体形成思路，实际上是很简单的，就是一个排列，然后根据滑动产生的内容形成密码来达到解密的目的，那么最主要的就是这个密码和他本身的密码是如何对应解密的，实际上很简单，咱们给他排列的九宫格，都固定好位置&lt;/p&gt;
&lt;p&gt;1 2 3&lt;br&gt;4 5 6&lt;br&gt;7 8 9 &lt;/p&gt;
&lt;p&gt;就像这样，排列的给他的位置固定好，然后每一个格子表示一个字符或者说字符串，进而用户滑动的时候，将对应的位置序列进入到一个列表中去保存，然后鼠标放开的时候，那么入队的选择位置进行组合，那么就是对应的密码了，比如&lt;img src=&quot;/images/2012072314370919.png&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;这样的输入就是表示123，如此顺序记录，就可以形成密码了，然后用户进行滑屏录入之后和以前的进行比较就可以知道密码是否正确了，当然我这个组合是相当简单的，如果想要整的复杂，可以给每个顺序位置给定复杂的字符串，这样形成的密码就足够的复杂了！给一般人去看，也是看不明白的。&lt;/p&gt;
&lt;p&gt;那么分析清楚了，思路也就简单了，鼠标按下的时候，开始可以滑动形成密码，鼠标按下的第一个点，作为队列的第一个，然后再滑过的就顺序的一一的记录到队列中，鼠标放开的时候，从队列中获取各个顺序位置，组合形成密码然后和原密码比对，判断密码是否正确！源码如下：&lt;/p&gt;
&lt;figure class=&quot;highlight delphi&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;190&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;191&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;193&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;194&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;195&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;196&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;197&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;198&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;199&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;200&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;201&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;202&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;203&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;204&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;205&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;206&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;207&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;208&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;210&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;211&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;212&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;213&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;214&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;215&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;216&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;217&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;218&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;219&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;220&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;221&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;222&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;223&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;224&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;225&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;226&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;227&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;228&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;229&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;230&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;231&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;232&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;233&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;234&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;235&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;236&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;237&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;238&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;239&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;240&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;241&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;242&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;243&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;244&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;245&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;246&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;247&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;248&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;249&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;250&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;251&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;252&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;253&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;254&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;255&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;256&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;257&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;258&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;259&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;260&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;261&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;262&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;263&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;264&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;265&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;266&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;267&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;268&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;269&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;270&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;271&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;272&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;273&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;274&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;275&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;276&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;277&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;278&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;279&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;280&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;281&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;282&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;283&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;284&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;285&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;286&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;287&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;289&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;290&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;291&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;292&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;293&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;294&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;295&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;296&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;297&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;298&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;299&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;300&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;301&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;302&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;303&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;304&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;305&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;306&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;307&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;308&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;309&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;310&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;311&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;312&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;313&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;  Delphi实现的类似Android鼠标锁屏效果的控件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;  作者：不得闲&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;  2012-7-23&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;unit&lt;/span&gt; AndroidLockControl;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;interface&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;uses&lt;/span&gt; Windows,Classes,SysUtils,Graphics,Controls;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;type&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  TDxLockItem = &lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    r: TRect;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    IsEnter: Boolean;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    IsChecked: Boolean;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Value: AnsiChar;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    FRadio: TPoint;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Create&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  TInPutPwdEvent = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Sender: TObject;InputPwd: &lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;)&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;object&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;title&quot;&gt;TDxAndroidLock&lt;/span&gt; = &lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt;(TGraphicControl)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    FItemSpace: Integer;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    FRowCount: Integer;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    FColCount: Integer;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    FItemRaidio: Integer;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Items: TList;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    FUseNum: Boolean;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    FPassword: &lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    IsDown: Boolean;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    LastInItem: TDxLockItem;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    PwdItems: TList;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    FOnInputPwd: TInPutPwdEvent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;SetItemSpace&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Value: Integer)&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;SetItemRaidio&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Value: Integer)&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;SetUseNum&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Value: Boolean)&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;paint&lt;/span&gt;;&lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;override&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MouseDown&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Button: TMouseButton; Shift: TShiftState;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;&lt;span class=&quot;function&quot;&gt;      X, Y: Integer)&lt;/span&gt;;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;override&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MouseMove&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Shift: TShiftState; X, Y: Integer)&lt;/span&gt;;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;override&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MouseUp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Button: TMouseButton; Shift: TShiftState;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;&lt;span class=&quot;function&quot;&gt;      X, Y: Integer)&lt;/span&gt;;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;override&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CalcItemRects&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Create&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(AOwner: TComponent)&lt;/span&gt;;&lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;override&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;destructor&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Destroy&lt;/span&gt;;&lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;override&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;property&lt;/span&gt; Password: &lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;read&lt;/span&gt; FPassword &lt;span class=&quot;keyword&quot;&gt;write&lt;/span&gt; FPassWord;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;published&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;property&lt;/span&gt; ItemSpace: Integer &lt;span class=&quot;keyword&quot;&gt;read&lt;/span&gt; FItemSpace &lt;span class=&quot;keyword&quot;&gt;write&lt;/span&gt; SetItemSpace &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;property&lt;/span&gt; OnInputPwd: TInPutPwdEvent &lt;span class=&quot;keyword&quot;&gt;read&lt;/span&gt; FOnInputPwd &lt;span class=&quot;keyword&quot;&gt;write&lt;/span&gt; FOnInputPwd;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;property&lt;/span&gt; ItemRaidio: Integer &lt;span class=&quot;keyword&quot;&gt;read&lt;/span&gt; FItemRaidio &lt;span class=&quot;keyword&quot;&gt;write&lt;/span&gt; SetItemRaidio &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;property&lt;/span&gt; UseNum: Boolean &lt;span class=&quot;keyword&quot;&gt;read&lt;/span&gt; FUseNum &lt;span class=&quot;keyword&quot;&gt;write&lt;/span&gt; SetUseNum;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;implementation&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;uses&lt;/span&gt; pngimage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;#123;$R LockRc.RES&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  PngIn,PngOut: TPngImage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;#123; TDxAndroidLock &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TDxAndroidLock&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;CalcItemRects&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  i,j: Integer;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  p: TPoint;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  r: TRect;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  item: TDxLockItem;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  p.Y := FItemRaidio;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i := &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p.X := FItemRaidio;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    r.Left := p.X - FItemRaidio;r.Top := p.Y - FItemRaidio;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    r.Right := p.x + FItemRaidio;r.Bottom := p.Y + FItemRaidio;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; j := &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      item := Items[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;*(i-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)+j - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      item.Value := AnsiChar(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;*(i-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)+j+&lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      item.FRadio := p;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      item.r := r;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      p.X := p.X + FItemRaidio * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + FItemSpace;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      r.Left := p.X - FItemRaidio;r.Right := p.X + FItemRaidio;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p.Y := p.Y + FItemRaidio * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + FItemSpace;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TDxAndroidLock&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(AOwner: TComponent)&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  i: Integer;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;inherited&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  LastInItem := &lt;span class=&quot;keyword&quot;&gt;nil&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  PwdItems := TList.Create;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  FPassWord := &lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Items := TList.Create;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  FItemSpace := &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  FRowCount := &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  FColCount := &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  FItemRaidio := &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Width := FItemRaidio * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; + FItemSpace * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Height := FItemRaidio * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; + FItemSpace * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i := &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Items.Add(TDxLockItem.Create);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  CalcItemRects;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;destructor&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TDxAndroidLock&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;Destroy&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; Items.Count &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    TDxLockItem(Items[Items.Count - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]).Free;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Items.Delete(Items.Count - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  PwdItems.Free;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;inherited&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TDxAndroidLock&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;MouseDown&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Button: TMouseButton; Shift: TShiftState; X,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;&lt;span class=&quot;function&quot;&gt;  Y: Integer)&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  IsDown := Button = mbLeft;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; IsDown &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; LastInItem &amp;lt;&amp;gt; &lt;span class=&quot;keyword&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      LastInItem.IsChecked := IsDown;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      PwdItems.Add(LastInItem);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Invalidate;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TDxAndroidLock&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;MouseMove&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Shift: TShiftState; X, Y: Integer)&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  i: Integer;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  p: TPoint;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  OldInItem,Item: TDxLockItem;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  OldInItem := LastInItem;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  p := Point(x,y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  LastInItem := &lt;span class=&quot;keyword&quot;&gt;nil&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i := &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; items.Count - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    item := Items[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; PtInRect(Item.r,p) &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      LastInItem := Item;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      LastInItem.IsEnter := True;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      LastInItem.IsChecked := IsDown;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;Break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; LastInItem &amp;lt;&amp;gt; OldInItem &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; OldInItem &amp;lt;&amp;gt; &lt;span class=&quot;keyword&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      OldInItem.IsEnter := False;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; IsDown &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; LastInItem &amp;lt;&amp;gt; &lt;span class=&quot;keyword&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        PwdItems.Add(LastInItem);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Invalidate;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TDxAndroidLock&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;MouseUp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Button: TMouseButton; Shift: TShiftState; X,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;&lt;span class=&quot;function&quot;&gt;  Y: Integer)&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  i: Integer;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  item: TDxLockItem;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Np: &lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  IsDown := False;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i := &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; items.Count - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    item := Items[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    item.IsChecked := False;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i := &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; PwdItems.Count - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Np := Np + TDxLockItem(PwdItems[i]).Value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  PwdItems.Clear;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Invalidate;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; Assigned(FOnInputPwd) &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    FOnInputPwd(self,Np);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;DrawLineArrow&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(canvas: TCanvas; p1, p2: TPoint)&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  l = &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;//箭头长度&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  w = &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;//箭头宽度&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  slope, angle: Double;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  points: &lt;span class=&quot;keyword&quot;&gt;array&lt;/span&gt;[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;..&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; TPoint;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Xl,b: Single;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  canvas.Brush.Color := canvas.Pen.Color;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  canvas.Brush.Style := bsSolid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  canvas.MoveTo(p1.X,p1.Y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  canvas.LineTo(p2.X,p2.Y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (p2.Y &amp;lt;&amp;gt; p1.Y) &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; (P2.X &amp;lt;&amp;gt; p1.X) &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    xl := (P2.Y - p1.Y) / (P2.X - p1.X);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    b := p2.Y - xl * p2.X;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p2.X := (p2.X - p1.X) &lt;span class=&quot;keyword&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + p1.X;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p2.Y := Trunc(p2.X * xl + b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; p2.Y = p1.Y &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p2.X := (p2.X - p1.X) &lt;span class=&quot;keyword&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + p1.X&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; P2.Y := (p2.Y - p1.Y) &lt;span class=&quot;keyword&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; + p1.Y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//画箭头&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  points[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] := Point(p2.x, p2.y);&lt;span class=&quot;comment&quot;&gt;//箭头顶点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (p2.x - p1.x = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;//垂直&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (p2.y - p1.y &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt; slope := -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; slope := &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    points[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] := Point(p2.x - w, p2.y + Trunc(l * slope));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    points[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] := Point(p2.x + w, p2.y + Trunc(l * slope));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;//倾斜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    slope := (p2.y - p1.y) / (p2.x - p1.x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    angle := ArcTan(slope);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (p2.x - p1.x &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt; angle := angle - PI;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    points[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] := Point(p2.x + trunc(l * cos(angle) - w * sin(angle)),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      p2.y + trunc(l * sin(angle) + w * cos(angle)));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    points[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] := Point(p2.x + Trunc(l * cos(angle) + w * sin(angle)),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      p2.y + Trunc(l * sin(angle) - w * cos(angle)));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  canvas.Polygon(points);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TDxAndroidLock&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;paint&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  i: Integer;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  item,item1: TDxLockItem;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  r: TRect;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; IsDown &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i := &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; Items.Count - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      item := items[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      r.Left := item.FRadio.X - &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;r.Right := item.FRadio.X + &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      r.Top := item.FRadio.Y - &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;r.Bottom := item.FRadio.Y + &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Canvas.Draw(r.Left,r.Top,pngIn);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//绘制指向线条&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Canvas.Pen.Width := &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Canvas.Pen.Color := clGreen;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i := &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; PwdItems.Count - &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      item := PwdItems[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      item1 := PwdItems[i + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Canvas.MoveTo(item.FRadio.X,item.FRadio.Y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Canvas.LineTo(item1.FRadio.X,item1.FRadio.Y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      DrawLineArrow(Canvas,item.FRadio,item1.FRadio);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i := &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; Items.Count - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      item := items[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; item.IsChecked &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Canvas.Draw(item.r.Left,item.r.Top,pngOut);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      r.Left := item.FRadio.X - &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;r.Right := item.FRadio.X + &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      r.Top := item.FRadio.Y - &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;r.Bottom := item.FRadio.Y + &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Canvas.Draw(r.Left,r.Top,pngIn);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TDxAndroidLock&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;SetItemRaidio&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Value: Integer)&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  FItemRaidio := Value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TDxAndroidLock&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;SetItemSpace&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Value: Integer)&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  FItemSpace := Value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TDxAndroidLock&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;SetUseNum&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Value: Boolean)&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  FUseNum := Value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;#123; TDxLockItem &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TDxLockItem&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;Create&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  r := Rect(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  IsEnter := False;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;initialization&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; PngIn := TPngImage.Create;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; PngIn.LoadFromResourceName(Hinstance,&lt;span class=&quot;string&quot;&gt;&amp;#x27;InnerGra&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; PngOut := TPngImage.Create;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; PngOut.LoadFromResourceName(Hinstance,&lt;span class=&quot;string&quot;&gt;&amp;#x27;Outer&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;finalization&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  PngIn.Free;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  PngOut.Free;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;运行之后的效果就是&lt;br&gt;&lt;img src=&quot;/images/2012072314434974.jpg&quot; alt&gt;&lt;br&gt;转载自: &lt;a href=&quot;https://www.cnblogs.com/DxSoft/archive/2012/07/23/2604941.html&quot;&gt;https://www.cnblogs.com/DxSoft/archive/2012/07/23/2604941.html&lt;/a&gt;&lt;/p&gt;
</summary>
    
    
    
    <category term="文章" scheme="https://www.bnwin.com/categories/article/"/>
    
    
    <category term="delphi技巧" scheme="https://www.bnwin.com/tags/delphi%E6%8A%80%E5%B7%A7/"/>
    
    <category term="密码锁" scheme="https://www.bnwin.com/tags/%E5%AF%86%E7%A0%81%E9%94%81/"/>
    
  </entry>
  
  <entry>
    <title>多个局域网如何组建成一个局域网互相访问_softether的安装及使用</title>
    <link href="https://www.bnwin.com/page/1999908472/"/>
    <id>https://www.bnwin.com/page/1999908472/</id>
    <published>2021-09-14T03:05:04.000Z</published>
    <updated>2021-09-23T02:25:46.128Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="e5a1177b3224f03e969aa19e75f6908786c986162e3fd067f5a682ea594de56e">1af2aaa64b94522a0556bd1ec5c327926c3e53ccd8a5cce18e30a1a06212345c39a0594ac69cb5f1cd1efdccf8f8c467cb00d5665bf4b7596eee3bea313b472f73605f819af6268411d9122ba6b7631c6c3dc2b3288d760da6593fc3ab568204a1c2a685d9c713821606443c4ec7fe09e5a0afca762525fd133d75ebfc1cec126cb3355c673cfa1a780e5f0d79ffbe7845ac5b634edbea8b3255789a2228f6ea620d97584378534e4299ad0a04028479cee9636724a1f0113c8c4cc72eaa794aa31ca5c2b77e3078b297045e2910b55be686d71cf8566edf5abeeda8b26c5c0347bf6c0ecd90d18f311ed2edd963bc0d7fb79adc1da87bd419ca2b7abc12c25db43d1b59860cb53cec064e6eb60931e72f4f14ed8a0a765ca25d8229d2284074bc9556b3fd53a98926df74eee856b77f23c0e3ee43bccde4390666e5441263e5724eae7d3b4b7f140184c12e89fe18190ce2b752abe43c2469a35e5ad8506e7a99f1d2a69fb4b55a24b98391c12261e6c7406deb92827bb78a68346541f90d73efda46e6270535c935fcbd2c76f1c40b554b64f04565f78cb8a55c9f69dc291465a637971e4f95656a6c0a3181ee0316d04d315f76281fc79c7723865fd60eb70bf5184f182af89f09f42c2a4e6a3da4ee7e16b483798559e3c4a8d609038f5b1cc57b17b02f718e6e935878cbf3ec488982e5b2797a8087364539789754217147399a2aae33dac303c263b870118197d583fa1bfa944ed19ff5c66dd758a232d5da51af3c8c19420617d130680793f4988a580f14365b26b680b2d40c78dbfb6e32814ee2d8b4224a9cd773e7281dd89cfec49e33cecf0b547b34cea9135f4f09c3e66549c42f5766a1af954e32673e3f1a123efa57dc909e65e5ded61069d07f2275b5cb9222d8bd560163f40788f558c5b619c1d303c5725bfc5cf3a229932ce353d0b1f4ffce92491e291173a9929d47471260e7eae3ce64be6a645fca513c8a7d5873620fdd3ab74f9529602749ffa068ff7a1302947964d04f13e7a66fdd0e17dda486ef9bde17f0f34a05f26a2918de2b2b847c716fc4aa365ea75b67f836775e442ad03335dc011c46304d480b4f7d66afecf21b947539e6dbbaef8f5995a196dda323c1c2bfa45d2c802683dcbe1e4d1fffb7876241f9b67feca9014c1b3a8183b13dc5ed776b67c2c97d260e6c34155097692f23adecc0cde13ba9f3017c12ace5519cfb9d200f1182e8e6417b6f9f23030aee6f719f72929c6f0aad7f556cad29ef9986fc43b03376137255b7c660cd840609d435e8da6c8ca8e3192c5910b051a08bb04500be85180234b010030d59b1c9d718a571da10647bd6ca327f10df82a1fddfbdf1a485237db8d1d0d7b67b5563eb051fdc6e2ad655165fbd67a075722633d0e4d41458b5ce489cec91dab3b2ed3ba2acd0d9085241fdd9d81268afbc5b2b88e81e6b980081dc108b1759d393bc3742cfa9a6e09c1367e84c4d572b89265de8136a3daf9a8c55967466d74add7f0f39a362f98913c8afd7074da07a6934b98b5d689ab62167aa8f518fdc262dc661a0b49c0d8e7075533af52774b4cbba149008d01ff968ad5817b6499c38f6e726ae9fbbe3655ef9ae25fbc0a0eaa1df45995196275c1a69b657a9e028f5224919e67ed43ba86f77e40b1e94513b1fd31d0059915fe382d06c9fc4836cc69bcb0ec81ee634b757bd2de56d69b386448edfc8ad4b1b2675b31dd3896f5bbdd4df5baf7ac93b2adbead6a7b2e9f99d6f9c496501cafc2cafc5323ed50628e32b9ff2e7adad5c30de93e229e80e8f8fab425d0e76d333e9b0cf6d692ed3db10b79ade834bbe05b9f15e1a75d2bcd8e911a0e484ee5ba8fae2df5a4c4da537c51fbbcf4d767cbfc9b28d7ec0c27b8bc7dffd4e0486a3de69816bda7e08d4c16f5707defc7d67f7ee8f60967be3d282995a1dc9ac80c2167d648344bd4fef7191a3b7396d3be96e8bfa33b79e3149d29e3f2eb7c8288e92257204c198ca0541e578e08c5b61c5123c6d07fd6ba221972a1065c09996d90400cf1a76279e8dbdc9d7a6411ebd303371e714777ba8d7716dda16ee9148a3cc807929585dec72f5a4327f72467214fb637fd82e9877c8c100e106ba731a0937a05a6b7dd3fc431605e1bceff2d00592fa82e912680779a46b583a71b5e50fcc5c856c258e7ba8f45eb9c9cedbd45db959c1dcdc2760bdde45b5c0c7acafaafb30a0d6c624de80b4258d4eb0d9a3eeeebbbe966dbe23e9d23c1ae7499ee4e1f6676961f2e5816a1eaa1fefeef98aaee77b6592fe9d2e4eef0de3019d82bb22abededff90da990749ee279876195991dd5c2132ac6fcd943d95650a72014ba49ff554b67d15885652569162e0278254809de8f14e7e84b55d80f09b351abb454e3d71509f697929ecda17bce4df04874de1316a1a142f07fa0183e7c873577fb985a278e40b7e65fc0d3d6dc20860d50d17a69c56b34b20cfb6e48f214df582c4b4470ecc96e37fc005b138c793012d1a3d4bffce75ada3bfd0d0972d2faa7592405c92bcd5df3477c4b3612cb150d0b88e4fcece0792bdea716f848cd6d0bb587c32267f2eaba9f60172274457c6da177e8e946cc9e873f4dd6a281b4a82e2a90a301fb6bc4d7ac7f618c845b0c705203bd0766681e618c2e39d5bcf344f6d0656bc1e56572fadb50a4aceb9feb9cdba91b2d53a29a93d9a976343bfd9da9a46e768bc12c859207388ce439d98b5dbe488e0104e25844c1a61176d6c1d3d85715fdcf7815fa32097b73d728b1db818de8d14c64128367ce53f4172c4a006e6e335f7d70c1103414843d6c8c157b202b827dd9bd96d86025a95173405816ffac516614ac78399688f172a9dfad10bdf65c929805e7d67f54fb53f416b26bec9baee37798e7966140c6167e8968a0d6dd8d414f99567f9ebf33a7f2daa2cef091d389d97a11113fad0b3ad8dc0aa074a0a6f79f06b33af3638a09c8449544565f83dd733452c3258c1c3668b2b89d0328c740a570f1332db01b85d41bb1452ef947bbe85d0962e3341e9c3771d6205b446628198630092f09daf1c7a44d52c167af42e601070604d92d52c073284c21008d853559a244977fec4ab5e1fb613812a98f1491622bda05726a32ff915a4de22074fb0fbf22a0b324e16a78984eed987ab94cd9ca7493b9873b05152f47058bfc71d9839e58296e3f3fd0cdd456e32eeee26906850654d50b654cfbd1d3d8846099771dc65d8ff0e7cd804a6b55687d15a0195fc79768760b84ffacd89bd95baa4e1e218f10f19acbe27050637cf01f2d8cb635b9a4403260edbacc437af32c387a67a2a2cd772c5e7567d878ec194b1984d559854aed8b133c0bf435f2f906c3f30c9cfa84412f1c8f97ae3b770f2011b6b28662d0c4282d088dffde036a9ad2dae174727a33d21caa06e5caca1ab0346ba4ae336ca7c18b637f2ecb2236d83ebeb1b8e134d112a3da1ed51a42da9032b9805652e6db679acc56b665868378beda2f17766c7a13165283c093ec81fb9cc2f1647940a4850c466fd347f370c43c6c97bbd31483172dfa9998e76124943584603ffcb1c63d151e260a1a36f64e57bb0b5061c0762c3e360b01bd02668d37b793cfdf0413e3148533c6ee3e0120ed4d09596f57b7d94f9a2f2d0e958f7f6348898a47648e36fbacd81844a3c37581d97fec904adee4b79ad20670cad59da21fa60c7dc5cfd9215567761f3984db39bf62814db8649f5574e5b4fbc124892c86cafed6e833ee520a762629fec745d03d838b41f56d97c19da09d5594e278141015e1844b2eef4d4b1c5e2f62b241aa68e391391ebb7d91e82b3a52ec2e421734d029efc368133f4a10a2201198743276ee03a19229be581970683a9d4817f028a72c64bbd7176e9bc389303341ddb352f8fffa277077bd9e47cd818e27128fac0a57be928343490eccd0051a08797e0b57b97443dfaf466c08ef6bccc6db980a4b5926cac219ec6b30d7175f6f21cb97c1827028c10934f1dfcf2b4e2098870b30b1226d178f3e246e0d23ff5a91e294ddce262326cc55ec2b33fb0e9d22ff03f034e60fb6f771a7732ad59e8a63907af1a55492c8b55aa96892fd3c7ff7a67b4030945fdfcf2e3ad13ba0aac112272d1bab54327dee1b158e14f5d2a8195055021a2e3ed64716ca624ca4fd7c17289815c6512f421746ccc760b1f06886120c3d3d601b425b9f3aa97306e7927d73f1cbd41491813a98d0f29691997d72906a94a558d9f05acb0b4ef1b65cb002330826659536b5262a61b4bb920eeaff82d4464705a8682e92964f4782718030034de61829ad8736e2907b4376f2e33ece18dcd9e75fdedb5868afa64b840ca90f74f384335557d87a93421a6cf0fd65c755fa8195e7ec38eae344fc5ce33d6a1eeabe3d30a8969de3c3859ebfe23bf7d749eda08a028c49f6817cc7c9093c430b1c5f41bb66147fceca9dbbd93567ebd30d4eef4dbaab170ffcf942db181b496d8f0a1d0e00c658b6328e99046d503ef65caf2815a40bfd116fe8eb218febe2d6aa9f9d8be8498267325f02913d7d236667ca80b09a2ccd78bed8c061d9d4ef6d3e8610774bf403535728eaa1904570beb963788ee3f8c21fac3835b39a6a7dc6b66137d003f1b2538c0aeb74d8587676e53d125de75db5de1064c35afb1e468a480d418691435f2ad452d735101b6f93c5790a4ac98302e6727548414bdbc36cbb4a737fd5f435f26eed05779419939e4882fdbcfb2ae20f3d70247bfc32847eae5dd71cbddd0198aadecf21e5f7a72a47cd09cc289b8ab70475476af38261920f7085b3ebb4ca3ea40d71809215d5c7096f462db7de4be9fd384a5c4b6612a31c5364263ca6060840e54e3ca29a3438e8d6beef8cf5f44d9b4327a9b57f020cdc480a211d7127731ee128f11d6231758c56aa44c12fb793dead5bd0f9912908b9c0d9dcbb01d1392edb486cec36b6d2a24f2eb1a7cbe7805e0e29081071da7611ee163476c446bf1d79ef16cbbcdba2add10421ecf8bce71e5e0f43e443a4a3b0f2e7d187856fea53eb64292b990fa0d21f8cea79812071b19fd1ff70419a25037e3b63a86edf7e8e39b557842863fa31954d8d8d92a26a21b62e5247a941a9f635781638cf3bdcc2b5f6b3557471d2279dfe96c19a230de7d0eeb6dd7085ebd59d4904b20310c06103106bcfa0ba8c44ebe4fe79ffe3bd8807b556195bfdf63ebb25722ff99e47e7686d2ba82e27997b4f31cf0bbb760e8c97fd6bd8712c829fe44b5a772c4e737a73ef1bfa1446a87351a1e62259226c03b2387b66ac77a59ebbb2ce676a720b23978bc1629700d50f06687fa60d36e9da6d22d1ef3ff10d463e13eb9ee296a11450eceba00da5b31d7c871cb5a98ced52dab57fd7bb1b4eda8142b9593a37d77200df52f9e786dbb3b4cbe87f3c4ba3ee516892c3c92a23d076d02f65e2f171ea0d8b7557358533a84f03478f1eccf91163a8322f6ab9b495eebc23804e95e1027f7758eb68f9cd34b6c1be795d0b4b7d5c1a36a0f8e304af40f740c8820a41a1f9063dce2d02def17b9a68308bd1b9f281e28a06b34e1eecac7acf5a7c50caf39bcd44c3af5e242630e761ece89dc6892ee17802ad56e161f06aafeb08e3fec5030212357d2b5e5ef2ebc36efa9801f5eb19036dbf7a8b5fb911ada0391e41e65c22218eeaf27bd4b783c935d4d2b1699df5ba0bf5ff2a4d792b57b0f0980a37bb37ca0d1fd37c3c7dab30d2ca1994943b2c7a2820adad706693e4791ac0cd500ddf55235c47dd21d6bb60eb557fc21e82fd0b5f635fbda00dc11dd430af293f124452a5f6f1f394e0b6c9c50c935bff6c91da6d3df8d15ac044f71c560a363da8157b1f06b2c26240cd65b1cff50b3a6545fbd59b37d8268c0777534705c29215cf262ddf4a37bad2ccd5fe715be78f34c6126b1e2468827fc2c1a74b113a751f96cd8107f143d514aeb81aa7f54a72ceba9a328afe2f054b2c7100813dbd7865e538cf5074bc3db2f530b5d0d97af080ee1c43186359ef78757f5bea7a5201357a5da09f3aba6cb8330fa6ad4cb6838530ae5aa3df4595c7fa1d0e5d425edf69153815f93a1ab4ad3ddc558c2139cb47585c4824ca4fd5e4f4b396eb4597dce2a5d80bfffef89b7a6524c120d9a433424400d4fa8990f4b4a1a3f09934adb80567b9cf181e83b2080f86c67907e335324d43f51d97e02955e92488f93086edbbb9ef98254fddb9830bbb4f099aa39de590d7c9a9372a4df7989963a38164ff920703f2ba5d142dea9a9041fd066e86a7e65405bc0c7345b3e22edb2854e3c31e4622e2d60baa1bdf19ff072ac279804240458977aa076cb1348c87e2406c12e18da65c12e74dc9396c289c341197181f986c3c089920ee767f6e3638c4c680cbca71c5af1947a7eb385120dccf568cb7bf7a984cf63aa4defd4ac3e850241598ce2b1dad30495d296b7db732cf88b4e2a59be02e36385a97fcbdb6d422b97cd55f82c7a9c285b2212b617939e49ccb5f39d7fe1e220ce4213c7a3a4ade4387e44e6b076ba14e3fcb9ac0cab36c34e99bd97fdd5e5d5659ce056f91f71eb7436d6aa5ec0779d1691f53a61d977da835209b699836f61669eeb33788dda4af3592b406e5b885c178c2769c45d9dc87cfa34e277b659952c1da75dad3a0ff6d912d7dc074a66ef9b9b3161c4cca0c5971e0be41d800c7b314e3c363a293fc71eced3f8f9d43b18b6d6ad7588368fd79f88a1ff77ae619b4ce37f051ecd22637f9557edf5f10bdf2ad33f3c1712a20715b2bb5be04195cc6a7311ad888b975809d20fe98aca88a23cd38be4aea88ae04d912ed426da83c90941862523ea7ab565cc61627f648b57964c56d162a8ef32bee955198ea8476d25273a6a9b3ccf67b088c006e007b8a896629a3a81097f0521a0feef2e22c04372e22bd9c86490b073c6cc5a49c7215828aa480aacd2c0ca07a459eabc8514dcebfe05c5c2a6e8dc7e21e540cef55c3800a217f2faf12caa615f96fc24949e70f41702f90122f91a8a7da3a0f1d4bff7dadaff9f9c66f9ba3d1b970212c214099dd00647cf4539759d540c9a15a534c39c6d1b55c147eac41e5b6962ec866815f36e60749e1fb4197d15a39bf3b1a676863bffebd06a5a31a91fa71a90c86c3a26b4892edfdf5952fb344677e30f2b3f26994dde5b819a5a52e4df435df37a2858394452c19230a3ae6577a76c5aa00904bf78d8c427935050234d8ea1208d0dcdb59b676e982c6a8919cdac76dcaadb5d5de54b4e3f0519786974816ea25c48e256f9d9713a60079fbcfaf8367528d209c8dc73a076af693b2476c02acb2bfdfa563132b97e9dbf72b6d87da445d20007ad8f112d57cc4b13447ba9baf41a4cda397fa167a1788ec103b4ef014e555b4e7fc008a212fccaf24f6c54a6a5b211b8a40d2fc87bb08adc9eefff1e87bb240864e99e685cdf10393ae01cb3ea34cce58cb2fb3f04a742b9aac854c08879212c55c2f9e3041725f921c1e5016ba32c493cfdb0914dc6e2427c9331953178dc03c9b4ec16ab9bffdddd436bdc0fb65c8f9f391ad33a4381cd4b379a10c85eaf49fd1b5d38427273971a1749cd6976eaa00c50c4db83761089b8d30deb8a97375f39cc9f739eeca7380ae41adac7046c3fc3d53d8461c609c4e8dbc53c0df90ba0366b72ba2fa0f4030d7710c6d242f6012e4d6f6bcfce43aa2fe2064f928b27ba2b0875fa924b98b5f6261867d2ffc06b1a58508183a1e4f0fb56d45baaa4fd65bdca6bade63a692a9c1ed39b4ecbfcf31027da5ac7afcdd4461ac4084c81ab72f4edd150c6a3b33932590c7321f3926a5aac81e73f76d1bddc550082626e114d79ce768b37b0c4eafd6b8e20c51508d43212d1aed1ae8d28168b499d51d364e550000575a756bf8650136f8b07bda5bb040d78b60bd7e7e823fad0b0b0cff5fcaa2520b0334f48bd0b6e9d62b0f90b8bc68795fbfb99a97ccaabc51f36bf2b90c513b4a55d883bef12ba44bfc17431e9abde52afd2cf30e9a4f098d39d85d5632592b690324f8e257f59e880b687cb7782bc7aabd3fa038becdc6af066f56985f427d87ba539696e558ad99aecad76bfbf35df4271e9c4ef01bdab8fbdc0200ff9523795627310c89898e80af964d3c47acfa033a3579b4b550170eed3605fc13c3229d3aa04fedf360bf5e60456adc5b2af1043a65615a7ad4268d9342de95762017b7341da38f8983abe731332a737917893d3290fb362b1f5634d2fa4725281ad06341a3a93fa8c5e736e66a5fed01454301a96c335fac3e648a9d8b1e58a750e4191c83dfe4f0972f43564493620143f088d72c1abc6434ee26bf8ec8ed1c0234627047dccb399bcf2e4a378a831067689f2436778512f3c10bda7be51c3d4a486efda20e2554589e3054822ccf8fc141ff1d10df36cd390287963424c47daa5fc7971b257cbce3b0a781ba1d5c91dd89c3ce926ec01f23131f91af0a4e2ab7ef4f461b501ea128565b7867ce7d1909f67c9fcc95dd690ffcbc1fb99546285f2d9249498203fe14d52a0f4c57af41194e98ec60d02cfe8dea508da0741b5f0441880a6d51191a23ae2357874721781c592b2957434bcee304d125dc241c90d9ef25410c782a686a83f2d3a7d8d303f30ac08e265098678846ee6faa2c74c2e9cafbcf850eda106d2648e7690d06f0d5c406f725f1df8cfa5d43bfe2b3a3fe5f2f8d9aa37555af66a09e81847e5c564b2ae07a15a229bd68522c31e15e178cb47469e7f7e0ed8fe1ff24dbcfb1977f12a618fdee7a1c1db4f868e5508f4ec0bd91a246c2bbb3a0de596da98d348d02abea4e98e23c15cad8602872370c3548d7fbe1362af6b874f3a392622b87d7d192513135ffa6fa521034a093ddb7d1ea94bbfa6d09798b49a7abd6751afdf29443d019fb65cb963547a6d231a58f67bf9b45834c24c54eb94313dc803fbcfe27c746e0f6d26e5753cb1dd8352ea211f3008e8244f326cad6411a69df58bef7f5d63cbcf51595da6434a55bd06bd919c4b053b8172cdb80a310e0f8a4f1d7a2b2f1af8f37407152198e6e822b4fe2d963c32d7f2ed6c505fb2d7270842a54fe2491638f2049a06224fd79184e084e9b07fe8a2677328c50f625d2375a29d21d67f98c125e5776109b40a71d0849352f6569c48c159459d0b428ee66f403185b5c9dbdfff77f269cb99401a0323c697628fc8afe808a9fd5010b8646af89b8c0f210965923b94706fded156a2aabd2b359378b96754fbfb44cf5eef66ddc5afe34c848fc35d97ee1cafb19c96a1d405b6917b4f878ad0375e9a675ddd4367dc5dd8e14e7378186ca244e02a3635e2cc58b0bcdd4758796b3e628d77dbef68b701056040321214682251255bc9593672ff2e7d56b2193a771373aa74f32161fa07e78a63a97d827449a8a7ca468e8180f2faa937aa554c49d468a8afef660a094a0d27d8d8f7b63278889ff04d6f011d0983c5c2fc638d5824025e85fcfd585618e616e83cbd5e06298ea7a4186e14ce9b0526dd3958e250bb9cb1d3c158541f7c11e77de71f780496d51dd2c80e7cd9ff607b4db4434c77cff79d7498787816f98831ab480447320f3b51d7064b8d04e5be8e7ff438c512c347b4096b7fe6f8201d61ba224867fc9cea3454b6a9d2bb3db796fa6379d27d3292e09bbf10019c5d224dc3d9910261e477e371ef85cdf27cb5dcdefd516426ab7f3aab281aca444b98e194</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-wave">      <input class="hbe hbe-input-field hbe-input-field-wave" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-wave" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-wave">输入密码查看内容</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-wave" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">&lt;div class=&quot;hbe hbe-container&quot; id=&quot;hexo-blog-encrypt&quot; data-wpm=&quot;抱歉, 这个密码看着不太对, 请再试试.&quot; data-whm=&quot;抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.&quot;&gt;
  &lt;script id=&quot;hbeData&quot; type=&quot;hbeData&quot; data-hmacdigest=&quot;e5a1177b3224f03e969aa19e75f6908786c986162e3fd067f5a682ea594de56e&quot;&gt;1af2aaa64b94522a0556bd1ec5c327926c3e53ccd8a5cce18e30a1a06212345c39a0594ac69cb5f1cd1efdccf8f8c467cb00d5665bf4b7596eee3bea313b472f73605f819af6268411d9122ba6b7631c6c3dc2b3288d760da6593fc3ab568204a1c2a685d9c713821606443c4ec7fe09e5a0afca762525fd133d75ebfc1cec126cb3355c673cfa1a780e5f0d79ffbe7845ac5b634edbea8b3255789a2228f6ea620d97584378534e4299ad0a04028479cee9636724a1f0113c8c4cc72eaa794aa31ca5c2b77e3078b297045e2910b55be686d71cf8566edf5abeeda8b26c5c0347bf6c0ecd90d18f311ed2edd963bc0d7fb79adc1da87bd419ca2b7abc12c25db43d1b59860cb53cec064e6eb60931e72f4f14ed8a0a765ca25d8229d2284074bc9556b3fd53a98926df74eee856b77f23c0e3ee43bccde4390666e5441263e5724eae7d3b4b7f140184c12e89fe18190ce2b752abe43c2469a35e5ad8506e7a99f1d2a69fb4b55a24b98391c12261e6c7406deb92827bb78a68346541f90d73efda46e6270535c935fcbd2c76f1c40b554b64f04565f78cb8a55c9f69dc291465a637971e4f95656a6c0a3181ee0316d04d315f76281fc79c7723865fd60eb70bf5184f182af89f09f42c2a4e6a3da4ee7e16b483798559e3c4a8d609038f5b1cc57b17b02f718e6e935878cbf3ec488982e5b2797a8087364539789754217147399a2aae33dac303c263b870118197d583fa1bfa944ed19ff5c66dd758a232d5da51af3c8c19420617d130680793f4988a580f14365b26b680b2d40c78dbfb6e32814ee2d8b4224a9cd773e7281dd89cfec49e33cecf0b547b34cea9135f4f09c3e66549c42f5766a1af954e32673e3f1a123efa57dc909e65e5ded61069d07f2275b5cb9222d8bd560163f40788f558c5b619c1d303c5725bfc5cf3a229932ce353d0b1f4ffce92491e291173a9929d47471260e7eae3ce64be6a645fca513c8a7d5873620fdd3ab74f9529602749ffa068ff7a1302947964d04f13e7a66fdd0e17dda486ef9bde17f0f34a05f26a2918de2b2b847c716fc4aa365ea75b67f836775e442ad03335dc011c46304d480b4f7d66afecf21b947539e6dbbaef8f5995a196dda323c1c2bfa45d2c802683dcbe1e4d1fffb7876241f9b67feca9014c1b3a8183b13dc5ed776b67c2c97d260e6c34155097692f23adecc0cde13ba9f3017c12ace5519cfb9d200f1182e8e6417b6f9f23030aee6f719f72929c6f0aad7f556cad29ef9986fc43b03376137255b7c660cd840609d435e8da6c8ca8e3192c5910b051a08bb04500be85180234b010030d59b1c9d718a571da10647bd6ca327f10df82a1fddfbdf1a485237db8d1d0d7b67b5563eb051fdc6e2ad655165fbd67a075722633d0e4d41458b5ce489cec91dab3b2ed3ba2acd0d9085241fdd9d81268afbc5b2b88e81e6b980081dc108b1759d393bc3742cfa9a6e09c1367e84c4d572b89265de8136a3daf9a8c55967466d74add7f0f39a362f98913c8afd7074da07a6934b98b5d689ab62167aa8f518fdc262dc661a0b49c0d8e7075533af52774b4cbba149008d01ff968ad5817b6499c38f6e726ae9fbbe3655ef9ae25fbc0a0eaa1df45995196275c1a69b657a9e028f5224919e67ed43ba86f77e40b1e94513b1fd31d0059915fe382d06c9fc4836cc69bcb0ec81ee634b757bd2de56d69b386448edfc8ad4b1b2675b31dd3896f5bbdd4df5baf7ac93b2adbead6a7b2e9f99d6f9c496501cafc2cafc5323ed50628e32b9ff2e7adad5c30de93e229e80e8f8fab425d0e76d333e9b0cf6d692ed3db10b79ade834bbe05b9f15e1a75d2bcd8e911a0e484ee5ba8fae2df5a4c4da537c51fbbcf4d767cbfc9b28d7ec0c27b8bc7dffd4e0486a3de69816bda7e08d4c16f5707defc7d67f7ee8f60967be3d282995a1dc9ac80c2167d648344bd4fef7191a3b7396d3be96e8bfa33b79e3149d29e3f2eb7c8288e92257204c198ca0541e578e08c5b61c5123c6d07fd6ba221972a1065c09996d90400cf1a76279e8dbdc9d7a6411ebd303371e714777ba8d7716dda16ee9148a3cc807929585dec72f5a4327f72467214fb637fd82e9877c8c100e106ba731a0937a05a6b7dd3fc431605e1bceff2d00592fa82e912680779a46b583a71b5e50fcc5c856c258e7ba8f45eb9c9cedbd45db959c1dcdc2760bdde45b5c0c7acafaafb30a0d6c624de80b4258d4eb0d9a3eeeebbbe966dbe23e9d23c1ae7499ee4e1f6676961f2e5816a1eaa1fefeef98aaee77b6592fe9d2e4eef0de3019d82bb22abededff90da990749ee279876195991dd5c2132ac6fcd943d95650a72014ba49ff554b67d15885652569162e0278254809de8f14e7e84b55d80f09b351abb454e3d71509f697929ecda17bce4df04874de1316a1a142f07fa0183e7c873577fb985a278e40b7e65fc0d3d6dc20860d50d17a69c56b34b20cfb6e48f214df582c4b4470ecc96e37fc005b138c793012d1a3d4bffce75ada3bfd0d0972d2faa7592405c92bcd5df3477c4b3612cb150d0b88e4fcece0792bdea716f848cd6d0bb587c32267f2eaba9f60172274457c6da177e8e946cc9e873f4dd6a281b4a82e2a90a301fb6bc4d7ac7f618c845b0c705203bd0766681e618c2e39d5bcf344f6d0656bc1e56572fadb50a4aceb9feb9cdba91b2d53a29a93d9a976343bfd9da9a46e768bc12c859207388ce439d98b5dbe488e0104e25844c1a61176d6c1d3d85715fdcf7815fa32097b73d728b1db818de8d14c64128367ce53f4172c4a006e6e335f7d70c1103414843d6c8c157b202b827dd9bd96d86025a95173405816ffac516614ac78399688f172a9dfad10bdf65c929805e7d67f54fb53f416b26bec9baee37798e7966140c6167e8968a0d6dd8d414f99567f9ebf33a7f2daa2cef091d389d97a11113fad0b3ad8dc0aa074a0a6f79f06b33af3638a09c8449544565f83dd733452c3258c1c3668b2b89d0328c740a570f1332db01b85d41bb1452ef947bbe85d0962e3341e9c3771d6205b446628198630092f09daf1c7a44d52c167af42e601070604d92d52c073284c21008d853559a244977fec4ab5e1fb613812a98f1491622bda05726a32ff915a4de22074fb0fbf22a0b324e16a78984eed987ab94cd9ca7493b9873b05152f47058bfc71d9839e58296e3f3fd0cdd456e32eeee26906850654d50b654cfbd1d3d8846099771dc65d8ff0e7cd804a6b55687d15a0195fc79768760b84ffacd89bd95baa4e1e218f10f19acbe27050637cf01f2d8cb635b9a4403260edbacc437af32c387a67a2a2cd772c5e7567d878ec194b1984d559854aed8b133c0bf435f2f906c3f30c9cfa84412f1c8f97ae3b770f2011b6b28662d0c4282d088dffde036a9ad2dae174727a33d21caa06e5caca1ab0346ba4ae336ca7c18b637f2ecb2236d83ebeb1b8e134d112a3da1ed51a42da9032b9805652e6db679acc56b665868378beda2f17766c7a13165283c093ec81fb9cc2f1647940a4850c466fd347f370c43c6c97bbd31483172dfa9998e76124943584603ffcb1c63d151e260a1a36f64e57bb0b5061c0762c3e360b01bd02668d37b793cfdf0413e3148533c6ee3e0120ed4d09596f57b7d94f9a2f2d0e958f7f6348898a47648e36fbacd81844a3c37581d97fec904adee4b79ad20670cad59da21fa60c7dc5cfd9215567761f3984db39bf62814db8649f5574e5b4fbc124892c86cafed6e833ee520a762629fec745d03d838b41f56d97c19da09d5594e278141015e1844b2eef4d4b1c5e2f62b241aa68e391391ebb7d91e82b3a52ec2e421734d029efc368133f4a10a2201198743276ee03a19229be581970683a9d4817f028a72c64bbd7176e9bc389303341ddb352f8fffa277077bd9e47cd818e27128fac0a57be928343490eccd0051a08797e0b57b97443dfaf466c08ef6bccc6db980a4b5926cac219ec6b30d7175f6f21cb97c1827028c10934f1dfcf2b4e2098870b30b1226d178f3e246e0d23ff5a91e294ddce262326cc55ec2b33fb0e9d22ff03f034e60fb6f771a7732ad59e8a63907af1a55492c8b55aa96892fd3c7ff7a67b4030945fdfcf2e3ad13ba0aac112272d1bab54327dee1b158e14f5d2a8195055021a2e3ed64716ca624ca4fd7c17289815c6512f421746ccc760b1f06886120c3d3d601b425b9f3aa97306e7927d73f1cbd41491813a98d0f29691997d72906a94a558d9f05acb0b4ef1b65cb002330826659536b5262a61b4bb920eeaff82d4464705a8682e92964f4782718030034de61829ad8736e2907b4376f2e33ece18dcd9e75fdedb5868afa64b840ca90f74f384335557d87a93421a6cf0fd65c755fa8195e7ec38eae344fc5ce33d6a1eeabe3d30a8969de3c3859ebfe23bf7d749eda08a028c49f6817cc7c9093c430b1c5f41bb66147fceca9dbbd93567ebd30d4eef4dbaab170ffcf942db181b496d8f0a1d0e00c658b6328e99046d503ef65caf2815a40bfd116fe8eb218febe2d6aa9f9d8be8498267325f02913d7d236667ca80b09a2ccd78bed8c061d9d4ef6d3e8610774bf403535728eaa1904570beb963788ee3f8c21fac3835b39a6a7dc6b66137d003f1b2538c0aeb74d8587676e53d125de75db5de1064c35afb1e468a480d418691435f2ad452d735101b6f93c5790a4ac98302e6727548414bdbc36cbb4a737fd5f435f26eed05779419939e4882fdbcfb2ae20f3d70247bfc32847eae5dd71cbddd0198aadecf21e5f7a72a47cd09cc289b8ab70475476af38261920f7085b3ebb4ca3ea40d71809215d5c7096f462db7de4be9fd384a5c4b6612a31c5364263ca6060840e54e3ca29a3438e8d6beef8cf5f44d9b4327a9b57f020cdc480a211d7127731ee128f11d6231758c56aa44c12fb793dead5bd0f9912908b9c0d9dcbb01d1392edb486cec36b6d2a24f2eb1a7cbe7805e0e29081071da7611ee163476c446bf1d79ef16cbbcdba2add10421ecf8bce71e5e0f43e443a4a3b0f2e7d187856fea53eb64292b990fa0d21f8cea79812071b19fd1ff70419a25037e3b63a86edf7e8e39b557842863fa31954d8d8d92a26a21b62e5247a941a9f635781638cf3bdcc2b5f6b3557471d2279dfe96c19a230de7d0eeb6dd7085ebd59d4904b20310c06103106bcfa0ba8c44ebe4fe79ffe3bd8807b556195bfdf63ebb25722ff99e47e7686d2ba82e27997b4f31cf0bbb760e8c97fd6bd8712c829fe44b5a772c4e737a73ef1bfa1446a87351a1e62259226c03b2387b66ac77a59ebbb2ce676a720b23978bc1629700d50f06687fa60d36e9da6d22d1ef3ff10d463e13eb9ee296a11450eceba00da5b31d7c871cb5a98ced52dab57fd7bb1b4eda8142b9593a37d77200df52f9e786dbb3b4cbe87f3c4ba3ee516892c3c92a23d076d02f65e2f171ea0d8b7557358533a84f03478f1eccf91163a8322f6ab9b495eebc23804e95e1027f7758eb68f9cd34b6c1be795d0b4b7d5c1a36a0f8e304af40f740c8820a41a1f9063dce2d02def17b9a68308bd1b9f281e28a06b34e1eecac7acf5a7c50caf39bcd44c3af5e242630e761ece89dc6892ee17802ad56e161f06aafeb08e3fec5030212357d2b5e5ef2ebc36efa9801f5eb19036dbf7a8b5fb911ada0391e41e65c22218eeaf27bd4b783c935d4d2b1699df5ba0bf5ff2a4d792b57b0f0980a37bb37ca0d1fd37c3c7dab30d2ca1994943b2c7a2820adad706693e4791ac0cd500ddf55235c47dd21d6bb60eb557fc21e82fd0b5f635fbda00dc11dd430af293f124452a5f6f1f394e0b6c9c50c935bff6c91da6d3df8d15ac044f71c560a363da8157b1f06b2c26240cd65b1cff50b3a6545fbd59b37d8268c0777534705c29215cf262ddf4a37bad2ccd5fe715be78f34c6126b1e2468827fc2c1a74b113a751f96cd8107f143d514aeb81aa7f54a72ceba9a328afe2f054b2c7100813dbd7865e538cf5074bc3db2f530b5d0d97af080ee1c43186359ef78757f5bea7a5201357a5da09f3aba6cb8330fa6ad4cb6838530ae5aa3df4595c7fa1d0e5d425edf69153815f93a1ab4ad3ddc558c2139cb47585c4824ca4fd5e4f4b396eb4597dce2a5d80bfffef89b7a6524c120d9a433424400d4fa8990f4b4a1a3f09934adb80567b9cf181e83b2080f86c67907e335324d43f51d97e02955e92488f93086edbbb9ef98254fddb9830bbb4f099aa39de590d7c9a9372a4df7989963a38164ff920703f2ba5d142dea9a9041fd066e86a7e65405bc0c7345b3e22edb2854e3c31e4622e2d60baa1bdf19ff072ac279804240458977aa076cb1348c87e2406c12e18da65c12e74dc9396c289c341197181f986c3c089920ee767f6e3638c4c680cbca71c5af1947a7eb385120dccf568cb7bf7a984cf63aa4defd4ac3e850241598ce2b1dad30495d296b7db732cf88b4e2a59be02e36385a97fcbdb6d422b97cd55f82c7a9c285b2212b617939e49ccb5f39d7fe1e220ce4213c7a3a4ade4387e44e6b076ba14e3fcb9ac0cab36c34e99bd97fdd5e5d5659ce056f91f71eb7436d6aa5ec0779d1691f53a61d977da835209b699836f61669eeb33788dda4af3592b406e5b885c178c2769c45d9dc87cfa34e277b659952c1da75dad3a0ff6d912d7dc074a66ef9b9b3161c4cca0c5971e0be41d800c7b314e3c363a293fc71eced3f8f9d43b18b6d6ad7588368fd79f88a1ff77ae619b4ce37f051ecd22637f9557edf5f10bdf2ad33f3c1712a20715b2bb5be04195cc6a7311ad888b975809d20fe98aca88a23cd38be4aea88ae04d912ed426da83c90941862523ea7ab565cc61627f648b57964c56d162a8ef32bee955198ea8476d25273a6a9b3ccf67b088c006e007b8a896629a3a81097f0521a0feef2e22c04372e22bd9c86490b073c6cc5a49c7215828aa480aacd2c0ca07a459eabc8514dcebfe05c5c2a6e8dc7e21e540cef55c3800a217f2faf12caa615f96fc24949e70f41702f90122f91a8a7da3a0f1d4bff7dadaff9f9c66f9ba3d1b970212c214099dd00647cf4539759d540c9a15a534c39c6d1b55c147eac41e5b6962ec866815f36e60749e1fb4197d15a39bf3b1a676863bffebd06a5a31a91fa71a90c86c3a26b4892edfdf5952fb344677e30f2b3f26994dde5b819a5a52e4df435df37a2858394452c19230a3ae6577a76c5aa00904bf78d8c427935050234d8ea1208d0dcdb59b676e982c6a8919cdac76dcaadb5d5de54b4e3f0519786974816ea25c48e256f9d9713a60079fbcfaf8367528d209c8dc73a076af693b2476c02acb2bfdfa563132b97e9dbf72b6d87da445d20007ad8f112d57cc4b13447ba9baf41a4cda397fa167a1788ec103b4ef014e555b4e7fc008a212fccaf24f6c54a6a5b211b8a40d2fc87bb08adc9eefff1e87bb240864e99e685cdf10393ae01cb3ea34cce58cb2fb3f04a742b9aac854c08879212c55c2f9e3041725f921c1e5016ba32c493cfdb0914dc6e2427c9331953178dc03c9b4ec16ab9bffdddd436bdc0fb65c8f9f391ad33a4381cd4b379a10c85eaf49fd1b5d38427273971a1749cd6976eaa00c50c4db83761089b8d30deb8a97375f39cc9f739eeca7380ae41adac7046c3fc3d53d8461c609c4e8dbc53c0df90ba0366b72ba2fa0f4030d7710c6d242f6012e4d6f6bcfce43aa2fe2064f928b27ba2b0875fa924b98b5f6261867d2ffc06b1a58508183a1e4f0fb56d45baaa4fd65bdca6bade63a692a9c1ed39b4ecbfcf31027da5ac7afcdd4461ac4084c81ab72f4edd150c6a3b33932590c7321f3926a5aac81e73f76d1bddc550082626e114d79ce768b37b0c4eafd6b8e20c51508d43212d1aed1ae8d28168b499d51d364e550000575a756bf8650136f8b07bda5bb040d78b60bd7e7e823fad0b0b0cff5fcaa2520b0334f48bd0b6e9d62b0f90b8bc68795fbfb99a97ccaabc51f36bf2b90c513b4a55d883bef12ba44bfc17431e9abde52afd2cf30e9a4f098d39d85d5632592b690324f8e257f59e880b687cb7782bc7aabd3fa038becdc6af066f56985f427d87ba539696e558ad99aecad76bfbf35df4271e9c4ef01bdab8fbdc0200ff9523795627310c89898e80af964d3c47acfa033a3579b4b550170eed3605fc13c3229d3aa04fedf360bf5e60456adc5b2af1043a65615a7ad4268d9342de95762017b7341da38f8983abe731332a737917893d3290fb362b1f5634d2fa4725281ad06341a3a93fa8c5e736e66a5fed01454301a96c335fac3e648a9d8b1e58a750e4191c83dfe4f0972f43564493620143f088d72c1abc6434ee26bf8ec8ed1c0234627047dccb399bcf2e4a378a831067689f2436778512f3c10bda7be51c3d4a486efda20e2554589e3054822ccf8fc141ff1d10df36cd390287963424c47daa5fc7971b257cbce3b0a781ba1d5c91dd89c3ce926ec01f23131f91af0a4e2ab7ef4f461b501ea128565b7867ce7d1909f67c9fcc95dd690ffcbc1fb99546285f2d9249498203fe14d52a0f4c57af41194e98ec60d02cfe8dea508da0741b5f0441880a6d51191a23ae2357874721781c592b2957434bcee304d125dc241c90d9ef25410c782a686a83f2d3a7d8d303f30ac08e265098678846ee6faa2c74c2e9cafbcf850eda106d2648e7690d06f0d5c406f725f1df8cfa5d43bfe2b3a3fe5f2f8d9aa37555af66a09e81847e5c564b2ae07a15a229bd68522c31e15e178cb47469e7f7e0ed8fe1ff24dbcfb1977f12a618fdee7a1c1db4f868e5508f4ec0bd91a246c2bbb3a0de596da98d348d02abea4e98e23c15cad8602872370c3548d7fbe1362af6b874f3a392622b87d7d192513135ffa6fa521034a093ddb7d1ea94bbfa6d09798b49a7abd6751afdf29443d019fb65cb963547a6d231a58f67bf9b45834c24c54eb94313dc803fbcfe27c746e0f6d26e5753cb1dd8352ea211f3008e8244f326cad6411a69df58bef7f5d63cbcf51595da6434a55bd06bd919c4b053b8172cdb80a310e0f8a4f1d7a2b2f1af8f37407152198e6e822b4fe2d963c32d7f2ed6c505fb2d7270842a54fe2491638f2049a06224fd79184e084e9b07fe8a2677328c50f625d2375a29d21d67f98c125e5776109b40a71d0849352f6569c48c159459d0b428ee66f403185b5c9dbdfff77f269cb99401a0323c697628fc8afe808a9fd5010b8646af89b8c0f210965923b94706fded156a2aabd2b359378b96754fbfb44cf5eef66ddc5afe34c848fc35d97ee1cafb19c96a1d405b6917b4f878ad0375e9a675ddd4367dc5dd8e14e7378186ca244e02a3635e2cc58b0bcdd4758796b3e628d77dbef68b701056040321214682251255bc9593672ff2e7d56b2193a771373aa74f32161fa07e78a63a97d827449a8a7ca468e8180f2faa937aa554c49d468a8afef660a094a0d27d8d8f7b63278889ff04d6f011d0983c5c2fc638d5824025e85fcfd585618e616e83cbd5e06298ea7a4186e14ce9b0526dd3958e250bb9cb1d3c158541f7c11e77de71f780496d51dd2c80e7cd9ff607b4db4434c77cff79d7498787816f98831ab480447320f3b51d7064b8d04e5be8e7ff438c512c347b4096b7fe6f8201d61ba224867fc9cea3454b6a9d2bb3db796fa6379d27d3292e09bbf10019c5d224dc3d9910261e477e371ef85cdf27cb5dcdefd516426ab7f3aab281aca444b98e194&lt;/script&gt;
  &lt;div class=&quot;hbe hbe-content&quot;&gt;
    &lt;div class=&quot;hbe hbe-input hbe-input-wave&quot;&gt;
      &lt;input class=&quot;hbe hbe-input-field hbe-input-field-wave&quot; type=&quot;password&quot; id=&quot;hbePass&quot;&gt;
      &lt;label class=&quot;hbe hbe-input-label hbe-input-label-wave&quot; for=&quot;hbePass&quot;&gt;
        &lt;span class=&quot;hbe hbe-input-label-content hbe-input-label-content-wave&quot;&gt;输入密码查看内容&lt;/span&gt;
      &lt;/label&gt;
      &lt;svg class=&quot;hbe hbe-graphic hbe-graphic-wave&quot; width=&quot;300%&quot; height=&quot;100%&quot; viewBox=&quot;0 0 1200 60&quot; preserveAspectRatio=&quot;none&quot;&gt;
        &lt;path d=&quot;M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0&quot;/&gt;
      &lt;/svg&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;script data-pjax src=&quot;/lib/hbe.js&quot;&gt;&lt;/script&gt;&lt;link href=&quot;/css/hbe.style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;</summary>
    
    
    
    <category term="文章" scheme="https://www.bnwin.com/categories/article/"/>
    
    
    <category term="softether使用方法" scheme="https://www.bnwin.com/tags/softether%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    
    <category term="局域网" scheme="https://www.bnwin.com/tags/%E5%B1%80%E5%9F%9F%E7%BD%91/"/>
    
  </entry>
  
  <entry>
    <title>实现进程被结束就蓝屏的函数</title>
    <link href="https://www.bnwin.com/page/2848625591/"/>
    <id>https://www.bnwin.com/page/2848625591/</id>
    <published>2021-09-14T03:04:04.000Z</published>
    <updated>2021-09-21T15:55:55.427Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-保护进程，结束就蓝屏"><a href="#1-保护进程，结束就蓝屏" class="headerlink" title="1. 保护进程，结束就蓝屏"></a>1. 保护进程，结束就蓝屏</h1><p>RtlSetProcessIsCritical函数可以启用或关闭开启之后变得和系统进程一样被杀系统直接蓝屏系统进程也是此函数实现的上图可以用于进程保护<br>设置自己为保护进程，这样结束掉就会蓝屏，蓝屏信息翻译就是 重点保护进程。</p><p>设置为保护进程：RtlSetProcessIsCritical(True,Null(或Nothing),False)</p><p>取消（关闭时记得加上去。）：RtlSetProcessIsCritical(False,Null,False)<br>把进程做crss中止就蓝屏，防止进程被杀<br><img src="/images/182944wc66ia5wz61ce6ap.jpg" alt="保护进程"><br><img src="/images/202842lhbqbh192doloq1z.png" alt="smss中的保护方式"><br>这是最不占用CPU的方式了</p><p>以下为C代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> (NTAPI*Rtl)(ULONG,BOOL,BOOL,PBOOL);</span><br><span class="line"><span class="keyword">typedef</span> (NTAPI*PT1)(BOOL, PBOOLEAN, BOOL);</span><br><span class="line"><span class="keyword">typedef</span> (NTAPI*PT2)(BOOL,PBOOLEAN,BOOL);</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Protect</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">BOOL B;</span><br><span class="line">ULONG SE_DEBUG_PRIVILEGE = <span class="number">20</span>;</span><br><span class="line">Rtl RtlAdjustPrivilege=(Rtl)GetProcAddress(GetModuleHandleW(<span class="string">L&quot;ntdll&quot;</span>),<span class="string">&quot;RtlAdjustPrivilege&quot;</span>);</span><br><span class="line">PT1 RtlSetProcessIsCritical=(PT1)GetProcAddress(GetModuleHandleW(<span class="string">L&quot;ntdll&quot;</span>), <span class="string">&quot;RtlSetProcessIsCritical&quot;</span>);</span><br><span class="line">PT2 RtlSetThreadIsCritical=(PT2)GetProcAddress(GetModuleHandleW(<span class="string">L&quot;ntdll&quot;</span>), <span class="string">&quot;RtlSetThreadIsCritical&quot;</span>);</span><br><span class="line">RtlAdjustPrivilege(SE_DEBUG_PRIVILEGE,TRUE,FALSE,&amp;B);</span><br><span class="line">RtlSetProcessIsCritical(TRUE,<span class="literal">NULL</span>,FALSE);</span><br><span class="line">RtlSetThreadIsCritical(TRUE, <span class="literal">NULL</span>, FALSE);</span><br><span class="line"><span class="comment">//BY 1361784102</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Protect();</span><br><span class="line">getchar();</span><br><span class="line"><span class="comment">//BY 1361784102</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>vb代码如下：</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Public</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> RtlAdjustPrivilege <span class="keyword">Lib</span> <span class="string">&quot;ntdll.dll&quot;</span> (<span class="keyword">ByVal</span> Privilege <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByVal</span> Enable <span class="keyword">As</span> <span class="type">Boolean</span>, <span class="keyword">ByVal</span> Client <span class="keyword">As</span> <span class="type">Boolean</span>, WasEnabled <span class="keyword">As</span> <span class="type">Long</span>) <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Public</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> RtlSetProcessIsCritical <span class="keyword">Lib</span> <span class="string">&quot;ntdll&quot;</span> (<span class="keyword">Optional</span> <span class="keyword">ByVal</span> NewValue <span class="keyword">As</span> <span class="type">Boolean</span>, <span class="keyword">Optional</span> <span class="keyword">ByVal</span> Value <span class="keyword">As</span> <span class="type">Boolean</span>, <span class="keyword">Optional</span> <span class="keyword">ByVal</span> WinLogon <span class="keyword">As</span> <span class="type">Boolean</span> = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Main()</span><br><span class="line">    RtlAdjustPrivilege <span class="number">20</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="number">0</span></span><br><span class="line">    RtlSetProcessIsCritical <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span></span><br><span class="line">    <span class="keyword">End</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><h1 id="2-RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏"><a href="#2-RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏" class="headerlink" title="2. RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏"></a>2. RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏</h1><p>VB代码如下：</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Public</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> NtRaiseHardError <span class="keyword">Lib</span> <span class="string">&quot;ntdll.dll&quot;</span> (<span class="keyword">ByVal</span> ErrorStatus <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByVal</span> NumberOfParameters <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByVal</span> UnicodeStringParameterMask <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByRef</span> Parameters <span class="keyword">As</span> Any, <span class="keyword">ByVal</span> ValidResponseOptions <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByRef</span> Response <span class="keyword">As</span> <span class="type">Long</span>) <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Public</span> <span class="keyword">Declare</span> <span class="keyword">Function</span> RtlAdjustPrivilege <span class="keyword">Lib</span> <span class="string">&quot;ntdll.dll&quot;</span> (<span class="keyword">ByVal</span> Privilege <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByVal</span> Enable <span class="keyword">As</span> <span class="type">Boolean</span>, <span class="keyword">ByVal</span> Client <span class="keyword">As</span> <span class="type">Boolean</span>, WasEnabled <span class="keyword">As</span> <span class="type">Long</span>) <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Public</span> <span class="keyword">Declare</span> <span class="keyword">Sub</span> RtlInitUnicodeString <span class="keyword">Lib</span> <span class="string">&quot;ntdll.dll&quot;</span> (DestinationString <span class="keyword">As</span> UNICODE_STRING, <span class="keyword">ByVal</span> SourceString <span class="keyword">As</span> <span class="type">Long</span>)</span><br><span class="line"><span class="keyword">Public</span> Type UNICODE_STRING</span><br><span class="line">    Length                <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">    MaximumLength         <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">    Buffer                <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">End</span> Type</span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Main()</span><br><span class="line">    <span class="keyword">Dim</span> u <span class="keyword">As</span> UNICODE_STRING, p(<span class="number">3</span>) <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">    RtlAdjustPrivilege <span class="number">19</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="number">0</span></span><br><span class="line">    RtlInitUnicodeString u, StrPtr(<span class="string">&quot;Session Manager&quot;</span>)</span><br><span class="line">    p(<span class="number">0</span>) = VarPtr(u)</span><br><span class="line">    p(<span class="number">1</span>) = u.Length</span><br><span class="line">    p(<span class="number">2</span>) = VarPtr(u)</span><br><span class="line">    p(<span class="number">3</span>) = VarPtr(u)</span><br><span class="line">    NtRaiseHardError <span class="number">&amp;HC000021A</span>, <span class="number">4</span>, <span class="number">1</span>, p(<span class="number">0</span>), <span class="number">6</span>, <span class="number">0</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><p>vc代码</p><blockquote><p>函数原型<br>NTSTATUS RtlAdjustPrivilege<br>(<br>    ULONG    Privilege,<br>    BOOLEAN Enable,<br>    BOOLEAN CurrentThread,<br>    PBOOLEAN Enabled<br>);<br>NTSYSAPI NTSTATUS NTAPI NtRaiseHardError<br>(<br>  IN NTSTATUS             ErrorStatus,<br>  IN ULONG                NumberOfParameters,<br>  IN PUNICODE_STRING      UnicodeStringParameterMask OPTIONAL,<br>  IN PVOID                *Parameters,<br>  IN HARDERROR_RESPONSE_OPTION ResponseOption,<br>  OUT PHARDERROR_RESPONSE Response<br>);</p></blockquote><p>NTHeaders.h（声明相关结构与变量）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">//======================================================================</span><br><span class="line">//By TiKEY!</span><br><span class="line">//E-mail:tyk5555@hotmail.com</span><br><span class="line">//QQ:574436201</span><br><span class="line">//======================================================================</span><br><span class="line">#ifndef _NT_HDRS_</span><br><span class="line">#define _NT_HDRS_</span><br><span class="line">#include &lt;windows.h&gt;</span><br><span class="line"></span><br><span class="line">typedef /*__success(return &gt;= 0)*/ LONG NTSTATUS; </span><br><span class="line">typedef NTSTATUS *PNTSTATUS; </span><br><span class="line"></span><br><span class="line">#define STATUS_SUCCESS  ((NTSTATUS)0x00000000L)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">typedef struct _LSA_UNICODE_STRING &#123;</span><br><span class="line">  USHORT Length;</span><br><span class="line">  USHORT MaximumLength;</span><br><span class="line">  PWSTR  Buffer;</span><br><span class="line">&#125; LSA_UNICODE_STRING, *PLSA_UNICODE_STRING, UNICODE_STRING, *PUNICODE_STRING;</span><br><span class="line"></span><br><span class="line">typedef enum _HARDERROR_RESPONSE_OPTION &#123;</span><br><span class="line">    OptionAbortRetryIgnore,</span><br><span class="line">    OptionOk,</span><br><span class="line">    OptionOkCancel,</span><br><span class="line">    OptionRetryCancel,</span><br><span class="line">    OptionYesNo,</span><br><span class="line">    OptionYesNoCancel,</span><br><span class="line">    OptionShutdownSystem</span><br><span class="line">&#125; HARDERROR_RESPONSE_OPTION, *PHARDERROR_RESPONSE_OPTION;</span><br><span class="line"></span><br><span class="line">typedef enum _HARDERROR_RESPONSE &#123;</span><br><span class="line">    ResponseReturnToCaller,</span><br><span class="line">    ResponseNotHandled,</span><br><span class="line">    ResponseAbort,</span><br><span class="line">    ResponseCancel,</span><br><span class="line">    ResponseIgnore,</span><br><span class="line">    ResponseNo,</span><br><span class="line">    ResponseOk,</span><br><span class="line">    ResponseRetry,</span><br><span class="line">    ResponseYes</span><br><span class="line">&#125; HARDERROR_RESPONSE, *PHARDERROR_RESPONSE;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p>BlueScreen.cpp:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">//======================================================================</span><br><span class="line">//By TiKEY!</span><br><span class="line">//E-mail:tyk5555@hotmail.com</span><br><span class="line">//QQ:574436201</span><br><span class="line">//======================================================================</span><br><span class="line">#include &lt;Windows.h&gt;</span><br><span class="line">#include &quot;NTHeaders.h&quot;</span><br><span class="line"></span><br><span class="line">HINSTANCE hInst;// 当前实例</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">typedef UINT (CALLBACK* NTRAISEHARDERROR)(NTSTATUS, ULONG, PUNICODE_STRING, PVOID,HARDERROR_RESPONSE_OPTION, PHARDERROR_RESPONSE);</span><br><span class="line">typedef UINT (CALLBACK* RTLADJUSTPRIVILEGE)(ULONG, BOOL, BOOL, PINT);</span><br><span class="line"></span><br><span class="line">int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)</span><br><span class="line">&#123;</span><br><span class="line">HINSTANCE hDLL = LoadLibrary(TEXT(&quot;ntdll.dll&quot;));</span><br><span class="line">NTRAISEHARDERROR NtRaiseHardError;</span><br><span class="line">RTLADJUSTPRIVILEGE RtlAdjustPrivilege;</span><br><span class="line">int nEn = 0;</span><br><span class="line">HARDERROR_RESPONSE reResponse;</span><br><span class="line">if (hDLL != NULL)</span><br><span class="line">&#123;</span><br><span class="line">NtRaiseHardError = (NTRAISEHARDERROR)GetProcAddress(hDLL, &quot;NtRaiseHardError&quot;);</span><br><span class="line">RtlAdjustPrivilege = (RTLADJUSTPRIVILEGE)GetProcAddress(hDLL, &quot;RtlAdjustPrivilege&quot;);</span><br><span class="line">if (!NtRaiseHardError)</span><br><span class="line">&#123;</span><br><span class="line">// handle the error</span><br><span class="line">FreeLibrary(hDLL);</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br><span class="line">if (!RtlAdjustPrivilege)</span><br><span class="line">&#123;</span><br><span class="line">// handle the error</span><br><span class="line">FreeLibrary(hDLL);</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br><span class="line">RtlAdjustPrivilege(0x13, TRUE, FALSE, &amp;nEn);//0x13 = SeShutdownPrivilege</span><br><span class="line">NtRaiseHardError(0xC000021A,0,0,0,OptionShutdownSystem,&amp;reResponse);</span><br><span class="line">&#125;</span><br><span class="line">return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>vc代码在VS2010 SP1编译通过， Win7 SP1测试有效。</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;1-保护进程，结束就蓝屏&quot;&gt;&lt;a href=&quot;#1-保护进程，结束就蓝屏&quot; class=&quot;headerlink&quot; title=&quot;1. 保护进程，结束就蓝屏&quot;&gt;&lt;/a&gt;1. 保护进程，结束就蓝屏&lt;/h1&gt;&lt;p&gt;RtlSetProcessIsCritical函数可以启用或关闭开启之后变得和系统进程一样被杀系统直接蓝屏系统进程也是此函数实现的上图可以用于进程保护&lt;br&gt;设置自己为保护进程，这样结束掉就会蓝屏，蓝屏信息翻译就是 重点保护进程。&lt;/p&gt;
&lt;p&gt;设置为保护进程：RtlSetProcessIsCritical(True,Null(或Nothing),False)&lt;/p&gt;
&lt;p&gt;取消（关闭时记得加上去。）：RtlSetProcessIsCritical(False,Null,False)&lt;br&gt;把进程做crss中止就蓝屏，防止进程被杀&lt;br&gt;&lt;img src=&quot;/images/182944wc66ia5wz61ce6ap.jpg&quot; alt=&quot;保护进程&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/202842lhbqbh192doloq1z.png&quot; alt=&quot;smss中的保护方式&quot;&gt;&lt;br&gt;这是最不占用CPU的方式了&lt;/p&gt;
&lt;p&gt;以下为C代码&lt;/p&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;meta-string&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;meta-string&quot;&gt;&amp;lt;Windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; (NTAPI*Rtl)(ULONG,BOOL,BOOL,PBOOL);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; (NTAPI*PT1)(BOOL, PBOOLEAN, BOOL);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typedef&lt;/span&gt; (NTAPI*PT2)(BOOL,PBOOLEAN,BOOL);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Protect&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	BOOL B;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	ULONG SE_DEBUG_PRIVILEGE = &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Rtl RtlAdjustPrivilege=(Rtl)GetProcAddress(GetModuleHandleW(&lt;span class=&quot;string&quot;&gt;L&amp;quot;ntdll&amp;quot;&lt;/span&gt;),&lt;span class=&quot;string&quot;&gt;&amp;quot;RtlAdjustPrivilege&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	PT1 RtlSetProcessIsCritical=(PT1)GetProcAddress(GetModuleHandleW(&lt;span class=&quot;string&quot;&gt;L&amp;quot;ntdll&amp;quot;&lt;/span&gt;), &lt;span class=&quot;string&quot;&gt;&amp;quot;RtlSetProcessIsCritical&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	PT2 RtlSetThreadIsCritical=(PT2)GetProcAddress(GetModuleHandleW(&lt;span class=&quot;string&quot;&gt;L&amp;quot;ntdll&amp;quot;&lt;/span&gt;), &lt;span class=&quot;string&quot;&gt;&amp;quot;RtlSetThreadIsCritical&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	RtlAdjustPrivilege(SE_DEBUG_PRIVILEGE,TRUE,FALSE,&amp;amp;B);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	RtlSetProcessIsCritical(TRUE,&lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;,FALSE);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	RtlSetThreadIsCritical(TRUE, &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;, FALSE);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//BY 1361784102&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Protect();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	getchar();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;//BY 1361784102&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;vb代码如下：&lt;/p&gt;
&lt;figure class=&quot;highlight vb&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Option&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Explicit&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Declare&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Function&lt;/span&gt; RtlAdjustPrivilege &lt;span class=&quot;keyword&quot;&gt;Lib&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;ntdll.dll&amp;quot;&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;ByVal&lt;/span&gt; Privilege &lt;span class=&quot;keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Long&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;ByVal&lt;/span&gt; Enable &lt;span class=&quot;keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Boolean&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;ByVal&lt;/span&gt; Client &lt;span class=&quot;keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Boolean&lt;/span&gt;, WasEnabled &lt;span class=&quot;keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Long&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Long&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Declare&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Function&lt;/span&gt; RtlSetProcessIsCritical &lt;span class=&quot;keyword&quot;&gt;Lib&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;ntdll&amp;quot;&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;Optional&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;ByVal&lt;/span&gt; NewValue &lt;span class=&quot;keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Boolean&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;Optional&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;ByVal&lt;/span&gt; Value &lt;span class=&quot;keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Boolean&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;Optional&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;ByVal&lt;/span&gt; WinLogon &lt;span class=&quot;keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;Boolean&lt;/span&gt; = &lt;span class=&quot;literal&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Sub&lt;/span&gt; Main()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    RtlAdjustPrivilege &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;True&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    RtlSetProcessIsCritical &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;End&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Sub&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;2-RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏&quot;&gt;&lt;a href=&quot;#2-RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏&quot; class=&quot;headerlink&quot; title=&quot;2. RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏&quot;&gt;&lt;/a&gt;2. RtlAdjustPrivilege提权后NtRaiseHardError制造系统蓝屏&lt;/h1&gt;&lt;p&gt;VB代码如下：&lt;/p&gt;</summary>
    
    
    
    <category term="文章" scheme="https://www.bnwin.com/categories/article/"/>
    
    
    <category term="电脑蓝屏" scheme="https://www.bnwin.com/tags/%E7%94%B5%E8%84%91%E8%93%9D%E5%B1%8F/"/>
    
    <category term="c++源码" scheme="https://www.bnwin.com/tags/c-%E6%BA%90%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>可实现维护通道的vbs脚本类</title>
    <link href="https://www.bnwin.com/page/2434381964/"/>
    <id>https://www.bnwin.com/page/2434381964/</id>
    <published>2021-09-11T14:19:22.000Z</published>
    <updated>2021-09-11T16:45:18.627Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/2354883490,3989130937.jpg" alt=""><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>闲来无事，为了方便，用vbs写了一个类！ 别瞧不上vbs脚本语言，其实当你学习的语言越多，发现所有编程语言都是那么一回事，最终的目的都是完成某项功能，vbs的 好处就是可以使用系统的计事本直接编辑，不需要任何语言安装环境，python开源库是多，但却必须安装python的语言环境， c++等语言生成的程序功能是可以足够强大，但要立即增加修改功能却很麻烦(因为需要安装编程环境)！ vbs特别适合拿来即用，代码不对随时可以修改！就好比批处理虽然功能不强，windows却一直保留到现在！也许windows的激活 slmgr.vbs和office的激活ospp.vbs一直保留到现在的原因可能就是说明vbs还是有存在的道理的!如果你仔细看了这个vbs自定义 类，你就会发现vbs也可以实现很多功能！比如这个vbs类中的中止线程函数，所有语言实现，都是取得线程ID，然后发送中止线 程的消息，其实此自定义类就用了三句代码，这就是其他软件中的根据窗口关闭网吧广告的功能，也可以中止那些在任务管理器 中无法结束的进程！</p><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>vbs常用函数代码，包括一些特色函数，杀毒软件可能会报毒，使用notepad++等软件可直接查看源代码，未进行任何加密 最大的特色，可以让vbs使用windows api函数，api能办到的功能，vbs也能做到! 自定义vbs类的函数，见demo\demo.vbs文件</p><h2 id="软件架构"><a href="#软件架构" class="headerlink" title="软件架构"></a>软件架构</h2><p>lib目录的MyVbsClass.vbs和dynwrapx.dll为核心文件，即vbs自定义类</p><p>demo为示例代码， 维护通道是使用vbs自定义类写的网吧开机维护通道</p><p>虽然是明文方式写的vbs脚本，一样能实现如深蓝维护通道等类软件中的绝大部份功能，一样可以关闭网吧的广告及广告窗口!</p><h2 id="安装教程"><a href="#安装教程" class="headerlink" title="安装教程"></a>安装教程</h2><p>把lib目录复制一份<br>新建一目录，引用lib中的MyVbsClass.vbs即可使用其全部函数，引用方法见demo\demo.vbs<br>仅适用于64位系统</p><h2 id="当前实现功能"><a href="#当前实现功能" class="headerlink" title="当前实现功能"></a>当前实现功能</h2><p>‘call myfun.MakeLink(“罗技鼠标设置”,”G:\常用软件\罗技鼠标游戏驱动\Rungame.exe”,””,”G:\常用软件\罗技鼠标游戏驱动\48731.ico”) ‘创建桌面快捷方式<br>‘call myfun.MakeUrl(“<a href="http://www.bnwin.com&quot;,&quot;百脑问&quot;,true/">http://www.bnwin.com&quot;,&quot;百脑问&quot;,true</a>) ‘收藏夹栏添加网址<br>‘call myfun.SetHomepage(“<a href="https://www.baidu.com&quot;/">https://www.baidu.com&quot;</a>) ‘设置ie主页<br>‘msgbox myfun.GetExePath(“C:\Program Files\Internet Explorer\iexplore.exe”) ‘根据路径取目录<br>‘msgbox myfun.IsExitFile(“c:\abc.txt”) ‘判断文件是否存在<br>‘msgbox myfun.IsExitDir(“c:\abc”,true) ‘判断目录是否存在<br>‘call myfun.MyCreateFolder(“c:\abc\1233\dd”)  ‘创建目录可多级<br>‘call myfun.XCopy(“D:\dump”,”d:\456”,true) ‘拷目录 多级<br>‘call myfun.CopyFile(“C:\Windows\win.ini”,”d:\323\aaa.txt”,true)  ‘拷贝文件<br>‘call myfun.DelFile(“c:\abd\123.txt”)  ‘删除文件<br>‘call myfun.DelDir(“c:\abd&quot;)  ‘删除目录<br>‘Call myfun.Run(“””C:\Program Files (x86)\Internet Explorer\iexplore.exe””  <a href="http://www.bnwin.com&quot;,false/">http://www.bnwin.com&quot;,false</a>)  ‘路径带有空格，要用引号把空格路径括起，会检测文件是否存在，不能用于执行dos命令<br>‘msgbox myfun.ping(“192.168.0.1”)  ‘ping是否在线<br>‘MsgBox myfun.GetMac   ‘取得网卡mac地址<br>‘MsgBox myfun.GetIP   ‘取得本机ip地址<br>‘MsgBox myfun.GetComputerName   ‘取得机器名<br>‘MsgBox myfun.GetOS  ‘取得操作系统是win7还是win10<br>‘MsgBox myfun.X86orX64  ‘系统是64位还是32位<br>‘call myfun.ReadBinary(“c:\windows\notepad.exe”,”d:\123.txt”) ‘把文件生成16进制字符串文本文件<br>‘call myfun.WriteBinary(“d:\123.exe”,”d:\123.txt”,true)  ‘把16进制文本文件还原为可执行文件<br>‘call myfun.Sleep(5)  ‘延时5秒<br>‘call myfun.ImportReg(“.\reg.reg”)  ‘导入注册表<br>‘call myfun.RunBat(“.\test.bat”)  ‘运行批处理文件<br>‘myfun.Runcmd “dir c:\ &gt;c:\1.txt” ‘运行dos命令<br>‘call myfun.import(“d:\abc.vbs”)  ‘导入vbs文件<br>‘call myfun.CloseProcess(“SunloginRemote.exe”)  ‘关闭指定进程<br>‘call myfun.IsProcess(“qq.exe”)     ‘检查指定进程是否存在<br>‘call myfun.IsProcessEx(“qq.exe|notepad.exe”)  ‘指定指定列表进程是否存在<br>‘call myfun.CloseProcessEx(“qq.exe|wechat.exe”)  ‘结束进程列表<br>‘call myfun.RegExpTest(“sdf|456”,”123456789”)  ‘正则判断是否存在指定内容<br>‘call myfun.KillWindow(“”,”计算机”)  ‘关闭指定类名或标题的窗口<br>‘call myfun.WriteReg(“HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\MAIN\Start Page”,”<a href="https://www.baidu.com&quot;,&quot;&quot;/">https://www.baidu.com&quot;,&quot;&quot;</a>)  ‘写注册表值<br>‘MsgBox myfun.ReadReg(“HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\MAIN\Start Page”) ‘读注册表值<br>‘call myfun.HideWindow(“Notepad”,””) ‘按类名或标题隐藏窗口 未关闭<br>‘call myfun.KillThread(“Notepad”,””)  ‘按类名或标题中止显示此窗口的线程 如果是单线程，程序则会退出 可用于关闭广告窗口<br>‘call myfun.DownFile(“<a href="http://gh.api.99988866.xyz/github.com/Chuyu-Team/Dism-Multi-language/releases/download/v10.1.1001.10/Dism++10.1.1001.10_d4ba4eb035254b3326d6adc6638bc9c8daea7018.zip&quot;,&quot;d:/dism.zip&quot;">http://gh.api.99988866.xyz/github.com/Chuyu-Team/Dism-Multi-language/releases/download/v10.1.1001.10/Dism++10.1.1001.10_d4ba4eb035254b3326d6adc6638bc9c8daea7018.zip&quot;,&quot;d:\dism.zip&quot;</a>)  ‘下载远程文件<br>‘call myfun.SyncTime  ‘同步时间<br>‘MsgBox myfun.GetSysRunTime() ‘取得系统开机时间 关机时间 返回时间较长，可用于学习查询系统日志<br>‘call myfun.log(“测试”)   ‘写日志文件 日志文件在当前脚本下，以日期命名<br>‘MsgBox myfun.IsSuperAdmin() ‘判断无盘是否有超级用户<br>‘MsgBox myfun.FromUnixTime(“1630211522”,8) ‘unix时间转北京时间<br>‘msgbox myfun.ToUnixTime(now, 8)  ‘把当前时间转成unix时间<br>‘myfun.WriteIni “节点”,”键名”,”值”,”d:\123.ini”   ‘写INI文件<br>‘msgbox myfun.ReadIni(“节点”,”键名”,”默认值”,”d:\123.ini”) ‘读ini文件<br>‘call myfun.CreatLink(“d:\pg”,”C:\Program Files (x86)”)  ‘’把C盘程序目录映射到D盘pg目录,访问D:\pg相当于访问C:\Program Files (x86)内容<br>‘msgbox “系统运行了：”&amp;myfun.GetOsRunTime&amp;”分钟”<br>‘call myfun.SysVolme  ‘把系统音量调到最大<br>‘call myfun.Depolicy(“禁止常用端口”)  ‘创建本机安全策略禁止135 137 139 445 3389端口<br>‘call myfun.CloseMonitor(2) ‘2关闭显示 -1打开显示器<br>‘call myfun.RunAu3(“E:\软件工程\vbs\demo\monitor.au3”,false) ‘恢复显示器所有设置<br>‘call myfun.RestMonitor() ‘恢复显示器所有设置</p><h2 id="开源地址：https-gitee-com-goodhelp-vbs-code"><a href="#开源地址：https-gitee-com-goodhelp-vbs-code" class="headerlink" title="开源地址：https://gitee.com/goodhelp/vbs-code"></a>开源地址：<a href="https://gitee.com/goodhelp/vbs-code">https://gitee.com/goodhelp/vbs-code</a></h2>]]></content>
    
    
    <summary type="html">&lt;img src=&quot;/images/2354883490,3989130937.jpg&quot; alt&gt;

&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;闲来无事，为了方便，用vbs写了一个类！ 别瞧不上vbs脚本语言，其实当你学习的语言越多，发现所有编程语言都是那么一回事，最终的目的都是完成某项功能，vbs的 好处就是可以使用系统的计事本直接编辑，不需要任何语言安装环境，python开源库是多，但却必须安装python的语言环境， c++等语言生成的程序功能是可以足够强大，但要立即增加修改功能却很麻烦(因为需要安装编程环境)！ vbs特别适合拿来即用，代码不对随时可以修改！就好比批处理虽然功能不强，windows却一直保留到现在！也许windows的激活 slmgr.vbs和office的激活ospp.vbs一直保留到现在的原因可能就是说明vbs还是有存在的道理的!如果你仔细看了这个vbs自定义 类，你就会发现vbs也可以实现很多功能！比如这个vbs类中的中止线程函数，所有语言实现，都是取得线程ID，然后发送中止线 程的消息，其实此自定义类就用了三句代码，这就是其他软件中的根据窗口关闭网吧广告的功能，也可以中止那些在任务管理器 中无法结束的进程！&lt;/p&gt;
&lt;h2 id=&quot;介绍&quot;&gt;&lt;a href=&quot;#介绍&quot; class=&quot;headerlink&quot; title=&quot;介绍&quot;&gt;&lt;/a&gt;介绍&lt;/h2&gt;&lt;p&gt;vbs常用函数代码，包括一些特色函数，杀毒软件可能会报毒，使用notepad++等软件可直接查看源代码，未进行任何加密 最大的特色，可以让vbs使用windows api函数，api能办到的功能，vbs也能做到! 自定义vbs类的函数，见demo\demo.vbs文件&lt;/p&gt;
&lt;h2 id=&quot;软件架构&quot;&gt;&lt;a href=&quot;#软件架构&quot; class=&quot;headerlink&quot; title=&quot;软件架构&quot;&gt;&lt;/a&gt;软件架构&lt;/h2&gt;&lt;p&gt;lib目录的MyVbsClass.vbs和dynwrapx.dll为核心文件，即vbs自定义类&lt;/p&gt;
&lt;p&gt;demo为示例代码， 维护通道是使用vbs自定义类写的网吧开机维护通道&lt;/p&gt;
&lt;p&gt;虽然是明文方式写的vbs脚本，一样能实现如深蓝维护通道等类软件中的绝大部份功能，一样可以关闭网吧的广告及广告窗口!&lt;/p&gt;
&lt;h2 id=&quot;安装教程&quot;&gt;&lt;a href=&quot;#安装教程&quot; class=&quot;headerlink&quot; title=&quot;安装教程&quot;&gt;&lt;/a&gt;安装教程&lt;/h2&gt;</summary>
    
    
    
    <category term="软件" scheme="https://www.bnwin.com/categories/soft/"/>
    
    
    <category term="开源项目" scheme="https://www.bnwin.com/tags/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"/>
    
    <category term="原创软件" scheme="https://www.bnwin.com/tags/%E5%8E%9F%E5%88%9B%E8%BD%AF%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>让电源键关机变重启</title>
    <link href="https://www.bnwin.com/page/1082310208/"/>
    <id>https://www.bnwin.com/page/1082310208/</id>
    <published>2021-05-18T13:37:03.000Z</published>
    <updated>2021-09-17T13:01:48.408Z</updated>
    
    <content type="html"><![CDATA[<h2 id="让电源键关机变重启-使用说明"><a href="#让电源键关机变重启-使用说明" class="headerlink" title="让电源键关机变重启　使用说明"></a>让电源键关机变重启　使用说明</h2><img src="/images/1621350706-111.jpg" /><p>注意：需要关闭无盘的闪电关机，开启闪电关机，本软件无效！</p><p>功能：运行本工具，按电源键，或系统中点关机，会执行重启！总之就是不关机，关机就是重启，关机直接重启，关机会重启，说三遍!</p><p>适用范围：息屏挖矿，按电源键会关机，本软件作用就显现了!机器正在挖矿，显示器黑屏，总有顾客以为机器是关了的，去按电源键开机，这时机器就会关机。顾客就会以为这台机器有问题，明明按了开关键，结果机器没开起，有些会立马换一台机器，重复上面的操作。使用了本软件，按了电源键不会关机，直接变成重启，顾客不会置疑了，呼叫网管的次数少了!</p><p><a href="https://item.taobao.com/item.htm?spm=a1z10.1-c.w4023-488448694.4.62d67cacz2wvxZ&id=655303638168">下载地址</a></p>]]></content>
    
    
    <summary type="html">需要关闭无盘的闪电关机，开启闪电关机，本软件无效！</summary>
    
    
    
    <category term="软件" scheme="https://www.bnwin.com/categories/soft/"/>
    
    
    <category term="原创软件" scheme="https://www.bnwin.com/tags/%E5%8E%9F%E5%88%9B%E8%BD%AF%E4%BB%B6/"/>
    
    <category term="关机重启" scheme="https://www.bnwin.com/tags/%E5%85%B3%E6%9C%BA%E9%87%8D%E5%90%AF/"/>
    
    <category term="电源键" scheme="https://www.bnwin.com/tags/%E7%94%B5%E6%BA%90%E9%94%AE/"/>
    
  </entry>
  
  <entry>
    <title>八圈9.5版关闭侧边栏工具-怎样关闭8圈侧边栏</title>
    <link href="https://www.bnwin.com/page/3043345977/"/>
    <id>https://www.bnwin.com/page/3043345977/</id>
    <published>2019-10-12T13:58:27.000Z</published>
    <updated>2021-09-18T04:37:56.160Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/8qu-img2.png" alt="">如果说8圈智能场所管理平台等，提高了网吧运营管理的效率，让整个管理流程更加便捷；那么8圈机器人，就是让整个运营管理更加智能化，降低人为因素造成的失误，在原有的基础上提高运营管理的准确性、安全性。<p>据李金平介绍，8圈机器人能够轻松解决困扰网吧业主的收银员不负责，收银员成本高，招聘难，员工不稳定，财务统计困难，身份证冒用现象频发等系列问题。</p><p>不仅如此，8圈机器人优势明显：</p><p>设置简单、操作方便，无需专人指导一点就会；全天候24小时工作，节省人工成本开支提高竞争力；在财务管理上，自助收银，机器人收入按班次自动汇总，当班收入掌上8圈随时可查，更安全；AI人脸识别，杜绝人证不一致。</p><p>9.5版去侧边栏下载地址:</p><p><a href="https://item.taobao.com/item.htm?ft=t&id=655108849725">点击开始下载</a></p>]]></content>
    
    
    <summary type="html">&lt;img src=&quot;/images/8qu-img2.png&quot; alt&gt;
如果说8圈智能场所管理平台等，提高了网吧运营管理的效率，让整个管理流程更加便捷；那么8圈机器人，就是让整个运营管理更加智能化，降低人为因素造成的失误，在原有的基础上提高运营管理的准确性、安全性。

&lt;p&gt;据李金平介绍，8圈机器人能够轻松解决困扰网吧业主的收银员不负责，收银员成本高，招聘难，员工不稳定，财务统计困难，身份证冒用现象频发等系列问题。&lt;/p&gt;
&lt;p&gt;不仅如此，8圈机器人优势明显：&lt;/p&gt;
&lt;p&gt;设置简单、操作方便，无需专人指导一点就会；全天候24小时工作，节省人工成本开支提高竞争力；在财务管理上，自助收银，机器人收入按班次自动汇总，当班收入掌上8圈随时可查，更安全；AI人脸识别，杜绝人证不一致。&lt;/p&gt;
&lt;p&gt;9.5版去侧边栏下载地址:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://item.taobao.com/item.htm?ft=t&amp;id=655108849725&quot;&gt;点击开始下载&lt;/a&gt;&lt;/p&gt;
</summary>
    
    
    
    <category term="软件" scheme="https://www.bnwin.com/categories/soft/"/>
    
    
    <category term="八圈" scheme="https://www.bnwin.com/tags/%E5%85%AB%E5%9C%88/"/>
    
    <category term="原创软件" scheme="https://www.bnwin.com/tags/%E5%8E%9F%E5%88%9B%E8%BD%AF%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>显示器亮度，对比度，色温缩放调节，笔记本亮度调节AUTOIT源码</title>
    <link href="https://www.bnwin.com/page/365528154/"/>
    <id>https://www.bnwin.com/page/365528154/</id>
    <published>2019-10-11T04:37:00.000Z</published>
    <updated>2021-09-16T23:33:59.040Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/c9ae1552366758.png" alt="显示器调节"><br>通过调用dxva2.dll文件，修改显示器的设置，和按显示器上的物理按钮效果一样，有效的解决显示器上按钮不好设置，按钮功能不明的问题，有些显示器不支持，如果你使用的无效果，说明你显示器不支持此调节功能!下载地址：<a href="https://www.jianyiit.com/content/uploadfile/201903/adf51552366758.zip">源码</a></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WinAPI.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WinAPIFiles.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WinAPIGdi.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GUIConstantsEx.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;GuiSlider.au3&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Array.au3&gt;</span></span></span><br><span class="line">Opt(<span class="string">&quot;GUIOnEventMode&quot;</span>, <span class="number">1</span>)</span><br><span class="line">$g_szVersion = <span class="string">&quot;RU1Y2-D59U9&quot;</span></span><br><span class="line"><span class="keyword">If</span> <span class="built_in">WinExists</span>($g_szVersion) <span class="keyword">Then</span> <span class="keyword">Exit</span></span><br><span class="line"><span class="built_in">AutoItWinSetTitle</span>($g_szVersion)</span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $Dxva2 = <span class="built_in">DllOpen</span>(<span class="string">&quot;Dxva2.dll&quot;</span>)</span><br><span class="line"><span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $tagSTRUCT = <span class="string">&quot;HANDLE hPhysicalMonitor;WCHAR szPhysicalMonitorDescription[128];&quot;</span></span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $tag_MC_TIMING_REPORT = <span class="string">&quot;BYTE bTimingStatusByte; DWORD dwHorizontalFrequencyInHZ; DWORD dwVerticalFrequencyInHZ&quot;</span></span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $tag_DISPLAY_BRIGHTNESS = <span class="string">&quot;byte ucDisplayPolicy; byte ucACBrightness; byte ucDCBrightness&quot;</span></span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $IOCTL_VIDEO_QUERY_SUPPORTED_BRIGHTNESS = _WinAPI_IOCTL($FILE_DEVICE_VIDEO, <span class="number">0x125</span>, $METHOD_BUFFERED, $FILE_ANY_ACCESS)</span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $IOCTL_VIDEO_QUERY_DISPLAY_BRIGHTNESS = _WinAPI_IOCTL($FILE_DEVICE_VIDEO, <span class="number">0x126</span>, $METHOD_BUFFERED, $FILE_ANY_ACCESS)</span><br><span class="line"><span class="keyword">Global</span> <span class="keyword">Const</span> $IOCTL_VIDEO_SET_DISPLAY_BRIGHTNESS = _WinAPI_IOCTL($FILE_DEVICE_VIDEO, <span class="number">0x127</span>, $METHOD_BUFFERED, $FILE_ANY_ACCESS)</span><br><span class="line"><span class="keyword">Global</span> $idSlider1, $idSlider2, $idButton1, $idButton2, $idLabel1, $idLabel2</span><br><span class="line"><span class="keyword">Global</span> $hMonitor, $brightness, $contrast, $switch1, $switch2, $VCPReply</span><br><span class="line"><span class="keyword">Global</span> $idLabel3, $idSlider3, $hDevice, $BRIGHTNESS_LCD_Array</span><br><span class="line">$hDevice = LCD()</span><br><span class="line"><span class="keyword">If</span> <span class="literal">Not</span> <span class="symbol">@error</span> <span class="keyword">Then</span></span><br><span class="line">        LCD_Set($hDevice)</span><br><span class="line">        <span class="keyword">If</span> $hDevice <span class="keyword">Then</span> _WinAPI_CloseHandle($hDevice)</span><br><span class="line">        <span class="built_in">DllClose</span>($Dxva2)</span><br><span class="line">        <span class="keyword">Exit</span></span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line">$hMonitor = _WinAPI_MonitorFromWindow(_WinAPI_GetDesktopWindow(), $MONITOR_DEFAULTTOPRIMARY) <span class="comment">;返回主显示器句柄</span></span><br><span class="line">$hMonitor = _GetPhysicalMonitorsFromHMONITOR($hMonitor) <span class="comment">;获取物理显示器句柄</span></span><br><span class="line">$StringLength = CapabilitiesRequestAndCapabilitiesReply($hMonitor)</span><br><span class="line">$Gui = <span class="built_in">GUICreate</span>(<span class="string">&quot;显示器设置&quot;</span>, <span class="number">262</span>, <span class="number">220</span>, <span class="number">-1</span>, <span class="number">-1</span>)</span><br><span class="line"><span class="built_in">GUISetOnEvent</span>($GUI_EVENT_CLOSE, <span class="string">&quot;_exit&quot;</span>)</span><br><span class="line">$idSlider1 = <span class="built_in">GUICtrlCreateSlider</span>(<span class="number">10</span>, <span class="number">30</span>, <span class="number">240</span>, <span class="number">20</span>, <span class="built_in">BitOR</span>($TBS_TOOLTIPS, $TBS_AUTOTICKS))</span><br><span class="line"><span class="built_in">GUICtrlSetOnEvent</span>($idSlider1, <span class="string">&quot;Brightness&quot;</span>)</span><br><span class="line"><span class="built_in">GUICtrlSetLimit</span>($idSlider1, <span class="number">100</span>)</span><br><span class="line">$idSlider2 = <span class="built_in">GUICtrlCreateSlider</span>(<span class="number">10</span>, <span class="number">82</span>, <span class="number">240</span>, <span class="number">20</span>, <span class="built_in">BitOR</span>($TBS_TOOLTIPS, $TBS_AUTOTICKS))</span><br><span class="line"><span class="built_in">GUICtrlSetOnEvent</span>($idSlider2, <span class="string">&quot;Contrast&quot;</span>)</span><br><span class="line"><span class="built_in">GUICtrlSetLimit</span>($idSlider2, <span class="number">100</span>)</span><br><span class="line">$idButton1 = <span class="built_in">GUICtrlCreateButton</span>(<span class="string">&quot;宽屏切换&quot;</span>, <span class="number">16</span>, <span class="number">160</span>, <span class="number">85</span>, <span class="number">25</span>)</span><br><span class="line"><span class="built_in">GUICtrlSetOnEvent</span>($idButton1, <span class="string">&quot;Button1&quot;</span>)</span><br><span class="line">$idButton2 = <span class="built_in">GUICtrlCreateButton</span>(<span class="string">&quot;恢复默认&quot;</span>, <span class="number">158</span>, <span class="number">160</span>, <span class="number">85</span>, <span class="number">25</span>)</span><br><span class="line"><span class="built_in">GUICtrlSetOnEvent</span>($idButton2, <span class="string">&quot;Button2&quot;</span>)</span><br><span class="line">$idLabel1 = <span class="built_in">GUICtrlCreateLabel</span>(<span class="string">&quot;  亮度调节:不可用&quot;</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">140</span>, <span class="number">20</span>)</span><br><span class="line">$idLabel2 = <span class="built_in">GUICtrlCreateLabel</span>(<span class="string">&quot;对比度调节:不可用&quot;</span>, <span class="number">10</span>, <span class="number">60</span>, <span class="number">140</span>, <span class="number">20</span>)</span><br><span class="line">$Combo1 = <span class="built_in">GUICtrlCreateCombo</span>(<span class="string">&quot;&quot;</span>, <span class="number">102</span>, <span class="number">120</span>, <span class="number">100</span>, <span class="number">25</span>, <span class="number">0x0003</span>)</span><br><span class="line"><span class="built_in">GUICtrlSetOnEvent</span>($Combo1, <span class="string">&quot;Color&quot;</span>)</span><br><span class="line"><span class="built_in">GUICtrlCreateLabel</span>(<span class="string">&quot;色温调节&quot;</span>, <span class="number">32</span>, <span class="number">124</span>, <span class="number">48</span>, <span class="number">20</span>)</span><br><span class="line">_GUICtrlSlider_SetTipSide($idSlider1, $TBTS_TOP)</span><br><span class="line">_GUICtrlSlider_SetTipSide($idSlider2, $TBTS_TOP)</span><br><span class="line"><span class="keyword">If</span> $StringLength &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">        $VCP_Array = Manage_vcp($StringLength)</span><br><span class="line">        $VCPReply = _GetVCPFeatureAndVCPFeatureReply($hMonitor, <span class="number">0x86</span>)</span><br><span class="line">        <span class="keyword">If</span> $VCPReply[0] = <span class="number">0</span> <span class="keyword">Then</span> <span class="built_in">GUICtrlSetState</span>($idButton1, $GUI_DISABLE)</span><br><span class="line">        $brightness = _GetMonitorBrightness($hMonitor) <span class="comment">;获取监视器亮度</span></span><br><span class="line">        <span class="built_in">ConsoleWrite</span>($brightness[1] &amp; <span class="symbol">@CRLF</span>)</span><br><span class="line">        $contrast = _GetMonitorContrast($hMonitor) <span class="comment">;获取监视器对比度</span></span><br><span class="line">        <span class="keyword">If</span> $brightness[2] &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span> $switch1 = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">If</span> $contrast[2] &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span> $switch2 = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">If</span> $switch1 <span class="keyword">Then</span></span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($idSlider1, $brightness[1])</span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($idLabel1, <span class="string">&quot;设置亮度:&quot;</span> &amp; $brightness[1])</span><br><span class="line">        <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">If</span> $switch2 <span class="keyword">Then</span></span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($idSlider2, $contrast[1])</span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($idLabel2, <span class="string">&quot;设置对比度:&quot;</span> &amp; $contrast[1])</span><br><span class="line">        <span class="keyword">EndIf</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">For</span> $i = <span class="number">0</span> <span class="keyword">To</span> <span class="built_in">UBound</span>($VCP_Array) - <span class="number">1</span></span><br><span class="line">                <span class="keyword">If</span> $VCP_Array[$i][0] = <span class="string">&quot;14&quot;</span> <span class="keyword">Then</span></span><br><span class="line">                        <span class="keyword">If</span> $VCP_Array[$i][1] &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">                                $Color_Array = <span class="built_in">StringSplit</span>($VCP_Array[$i][1], <span class="string">&quot; &quot;</span>, <span class="number">2</span>)</span><br><span class="line">                                $Color_String = <span class="string">&quot;&quot;</span></span><br><span class="line">                                <span class="keyword">For</span> $S = <span class="number">0</span> <span class="keyword">To</span> <span class="built_in">UBound</span>($Color_Array) - <span class="number">1</span></span><br><span class="line">                                        $temp = Select_Color($Color_Array[$S])</span><br><span class="line">                                        <span class="keyword">If</span> $temp &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> $Color_String &amp;= $temp &amp; <span class="string">&quot;|&quot;</span></span><br><span class="line">                                <span class="keyword">Next</span></span><br><span class="line">                        <span class="keyword">EndIf</span></span><br><span class="line">                        <span class="keyword">ExitLoop</span></span><br><span class="line">                <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">If</span> $Color_String &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">                $VCPCode = _GetVCPFeatureAndVCPFeatureReply($hMonitor, <span class="number">0x14</span>)</span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($Combo1, $Color_String, Select_Color($VCPCode[1] - <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">                <span class="built_in">GUICtrlSetData</span>($Combo1, <span class="string">&quot;不支持&quot;</span>, <span class="string">&quot;不支持&quot;</span>)</span><br><span class="line">                <span class="built_in">GUICtrlSetState</span>($Combo1, $GUI_DISABLE)</span><br><span class="line">        <span class="keyword">EndIf</span></span><br><span class="line">        <span class="built_in">GUISetState</span>(<span class="symbol">@SW_SHOW</span>, $Gui)</span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">        <span class="built_in">WinSetTitle</span>($Gui, <span class="string">&quot;&quot;</span>, <span class="string">&quot;未发现DDC/CI&quot;</span>)</span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($Combo1, <span class="string">&quot;不支持&quot;</span>, <span class="string">&quot;不支持&quot;</span>)</span><br><span class="line">        <span class="built_in">GUICtrlSetState</span>($idSlider1, $GUI_DISABLE)</span><br><span class="line">        <span class="built_in">GUICtrlSetState</span>($idSlider2, $GUI_DISABLE)</span><br><span class="line">        <span class="built_in">GUICtrlSetState</span>($idButton1, $GUI_DISABLE)</span><br><span class="line">        <span class="built_in">GUICtrlSetState</span>($Combo1, $GUI_DISABLE)</span><br><span class="line">        <span class="built_in">GUISetState</span>(<span class="symbol">@SW_SHOW</span>, $Gui)</span><br><span class="line"><span class="keyword">EndIf</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">While</span> <span class="number">1</span></span><br><span class="line">        <span class="built_in">Sleep</span>(<span class="number">50</span>)</span><br><span class="line"><span class="keyword">WEnd</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">LCD</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">Local</span> $iDevice</span><br><span class="line">        $iDevice = _WinAPI_CreateFileEx(<span class="string">&quot;\\.\LCD&quot;</span>, $OPEN_EXISTING, $GENERIC_READ + $GENERIC_WRITE, $FILE_ANY_ACCESS, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span>) ? (<span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)) : ($iDevice)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;LCD</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">LCD_Set</span><span class="params">($iDevice)</span></span></span><br><span class="line">        <span class="keyword">Local</span> $brightness = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;BYTE[256]&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> $DISPLAY_BRIGHTNESS = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;BYTE[3]&quot;</span>)</span><br><span class="line">        $success = _WinAPI_DeviceIoControl($iDevice, $IOCTL_VIDEO_QUERY_SUPPORTED_BRIGHTNESS, <span class="literal">Null</span>, <span class="number">0</span>, <span class="built_in">DllStructGetPtr</span>($brightness), <span class="number">0xff</span>)</span><br><span class="line">        <span class="keyword">If</span> $success = <span class="literal">False</span> <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        $BRIGHTNESS_LCD_Array = Brightness_lcd(<span class="built_in">DllStructGetData</span>($brightness, <span class="number">1</span>))</span><br><span class="line">        $success = _WinAPI_DeviceIoControl($iDevice, $IOCTL_VIDEO_QUERY_DISPLAY_BRIGHTNESS, <span class="literal">Null</span>, <span class="number">0</span>, <span class="built_in">DllStructGetPtr</span>($DISPLAY_BRIGHTNESS), <span class="number">0x03</span>)</span><br><span class="line">        <span class="keyword">If</span> $success = <span class="literal">False</span> <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        $DISPLAY_BRIGHTNESS_READ = <span class="built_in">Int</span>(<span class="built_in">BinaryMid</span>(<span class="built_in">DllStructGetData</span>($DISPLAY_BRIGHTNESS, <span class="number">1</span>), <span class="number">3</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">        $Gui = <span class="built_in">GUICreate</span>(<span class="string">&quot;内置LCD显示器&quot;</span>, <span class="number">262</span>, <span class="number">80</span>, <span class="number">-1</span>, <span class="number">-1</span>)</span><br><span class="line">        <span class="built_in">GUISetOnEvent</span>($GUI_EVENT_CLOSE, <span class="string">&quot;_exit&quot;</span>)</span><br><span class="line">        $idSlider3 = <span class="built_in">GUICtrlCreateSlider</span>(<span class="number">10</span>, <span class="number">30</span>, <span class="number">240</span>, <span class="number">20</span>, <span class="built_in">BitOR</span>($TBS_TOOLTIPS, $TBS_AUTOTICKS))</span><br><span class="line">        <span class="built_in">GUICtrlSetLimit</span>($idSlider3, <span class="number">100</span>)</span><br><span class="line">        $idLabel3 = <span class="built_in">GUICtrlCreateLabel</span>(<span class="string">&quot;  亮度调节:&quot;</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">140</span>, <span class="number">20</span>)</span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idSlider3, $DISPLAY_BRIGHTNESS_READ)</span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idLabel3, <span class="string">&quot;设置亮度:&quot;</span> &amp; $DISPLAY_BRIGHTNESS_READ)</span><br><span class="line">        <span class="built_in">GUICtrlSetOnEvent</span>($idSlider3, <span class="string">&quot;Brightness_set_lcd&quot;</span>)</span><br><span class="line">        <span class="built_in">GUISetState</span>(<span class="symbol">@SW_SHOW</span>, $Gui)</span><br><span class="line">        <span class="built_in">WinSetTitle</span>($Gui, <span class="string">&quot;&quot;</span>, <span class="string">&quot;内置LCD显示器&quot;</span>)</span><br><span class="line">        <span class="keyword">While</span> <span class="number">1</span></span><br><span class="line">                <span class="built_in">Sleep</span>(<span class="number">50</span>)</span><br><span class="line">        <span class="keyword">WEnd</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;LCD_Set</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Brightness_set_lcd</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">Local</span> $lcd_BRIGHTNESS, $DISPLAY_BRIGHTNESS, $success</span><br><span class="line">        $lcd_BRIGHTNESS = <span class="built_in">GUICtrlRead</span>($idSlider3)</span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idLabel3, <span class="string">&quot;设置亮度:&quot;</span> &amp; $lcd_BRIGHTNESS)</span><br><span class="line">        <span class="keyword">For</span> $i = <span class="number">0</span> <span class="keyword">To</span> <span class="built_in">UBound</span>($BRIGHTNESS_LCD_Array)</span><br><span class="line">                <span class="keyword">If</span> $lcd_BRIGHTNESS &lt;= $BRIGHTNESS_LCD_Array[$i] <span class="keyword">Then</span></span><br><span class="line">                        $DISPLAY_BRIGHTNESS = <span class="built_in">DllStructCreate</span>($tag_DISPLAY_BRIGHTNESS)</span><br><span class="line">                        <span class="built_in">DllStructSetData</span>($DISPLAY_BRIGHTNESS, <span class="string">&quot;ucDisplayPolicy&quot;</span>, <span class="number">3</span>)</span><br><span class="line">                        <span class="built_in">DllStructSetData</span>($DISPLAY_BRIGHTNESS, <span class="string">&quot;ucACBrightness&quot;</span>, $BRIGHTNESS_LCD_Array[$i])</span><br><span class="line">                        <span class="built_in">DllStructSetData</span>($DISPLAY_BRIGHTNESS, <span class="string">&quot;ucDCBrightness&quot;</span>, $BRIGHTNESS_LCD_Array[$i])</span><br><span class="line">                        $success = _WinAPI_DeviceIoControl($hDevice, $IOCTL_VIDEO_SET_DISPLAY_BRIGHTNESS, <span class="built_in">DllStructGetPtr</span>($DISPLAY_BRIGHTNESS), <span class="built_in">DllStructGetSize</span>($DISPLAY_BRIGHTNESS), <span class="literal">Null</span>, <span class="number">0</span>)</span><br><span class="line">                        <span class="keyword">If</span> $success = <span class="literal">False</span> <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">                        <span class="keyword">ExitLoop</span></span><br><span class="line">                <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Brightness_set_lcd</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Select_Color</span><span class="params">($iValue)</span></span></span><br><span class="line">        <span class="keyword">Local</span> $String</span><br><span class="line">        <span class="keyword">If</span> <span class="built_in">StringIsXDigit</span>($iValue) <span class="keyword">Then</span> $iValue = <span class="built_in">Dec</span>($iValue)</span><br><span class="line">        <span class="keyword">Switch</span> $iValue</span><br><span class="line">                <span class="keyword">Case</span> <span class="number">1</span></span><br><span class="line">                        $String = <span class="string">&quot;sRGB&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">2</span></span><br><span class="line">                        $String = <span class="string">&quot;原生显示&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">3</span></span><br><span class="line">                        $String = <span class="string">&quot;4000K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">4</span></span><br><span class="line">                        $String = <span class="string">&quot;5000K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">5</span></span><br><span class="line">                        $String = <span class="string">&quot;6500K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">6</span></span><br><span class="line">                        $String = <span class="string">&quot;7500K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">7</span></span><br><span class="line">                        $String = <span class="string">&quot;8200K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">8</span></span><br><span class="line">                        $String = <span class="string">&quot;9300K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">9</span></span><br><span class="line">                        $String = <span class="string">&quot;10000K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">10</span></span><br><span class="line">                        $String = <span class="string">&quot;11500K&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">11</span></span><br><span class="line">                        $String = <span class="string">&quot;User1&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">12</span></span><br><span class="line">                        $String = <span class="string">&quot;User2&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="number">13</span></span><br><span class="line">                        $String = <span class="string">&quot;User3&quot;</span></span><br><span class="line">                <span class="keyword">Case</span> <span class="keyword">Else</span></span><br><span class="line">        <span class="keyword">EndSwitch</span></span><br><span class="line">        <span class="keyword">Return</span> $String</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Select_Color</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Color</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">Local</span> $iValue = <span class="built_in">GUICtrlRead</span>($Combo1)</span><br><span class="line">        <span class="keyword">Select</span></span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;sRGB&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x01</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;原生显示&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x02</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;4000K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x03</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;5000K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x04</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;6500K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x05</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;7500K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x06</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;8200K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x07</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;9300K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x08</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;10000K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x09</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;11500K&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x0a</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;User1&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x0b</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;User2&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x0c</span>)</span><br><span class="line">                <span class="keyword">Case</span> $iValue = <span class="string">&quot;User3&quot;</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x14</span>, <span class="number">0x0d</span>)</span><br><span class="line">                <span class="keyword">Case</span> <span class="keyword">Else</span></span><br><span class="line">        <span class="keyword">EndSelect</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Color</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Button1</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">Local</span> $VCPCode</span><br><span class="line">        <span class="keyword">If</span> $switch1 <span class="literal">And</span> $switch2 <span class="keyword">Then</span></span><br><span class="line">                $VCPCode = _GetVCPFeatureAndVCPFeatureReply($hMonitor, <span class="number">0x86</span>)</span><br><span class="line">                <span class="built_in">ConsoleWrite</span>($VCPCode[1] &amp; <span class="symbol">@CRLF</span>)</span><br><span class="line">                <span class="keyword">If</span> $VCPCode[1] = <span class="number">8</span> <span class="keyword">Then</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x86</span>, <span class="number">0x02</span>)</span><br><span class="line">                        <span class="built_in">GUICtrlSetData</span>($idButton1, <span class="string">&quot;窄屏&quot;</span>)</span><br><span class="line">                <span class="keyword">Else</span></span><br><span class="line">                        _SetVCPFeature($hMonitor, <span class="number">0x86</span>, <span class="number">0x08</span>)</span><br><span class="line">                        <span class="built_in">GUICtrlSetData</span>($idButton1, <span class="string">&quot;宽屏&quot;</span>)</span><br><span class="line">                <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">EndIf</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Button1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Button2</span><span class="params">()</span></span></span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idButton2, <span class="string">&quot;Reset..&quot;</span>)</span><br><span class="line">        <span class="built_in">Sleep</span>(<span class="number">250</span>)</span><br><span class="line">        <span class="built_in">GUISetState</span>(<span class="symbol">@SW_HIDE</span>)</span><br><span class="line">        <span class="keyword">If</span> $switch1 <span class="literal">Or</span> $switch2 <span class="keyword">Then</span></span><br><span class="line">                _RestoreMonitorFactoryDefaults($hMonitor)</span><br><span class="line">                <span class="built_in">Sleep</span>(<span class="number">1000</span>)</span><br><span class="line">        <span class="keyword">EndIf</span></span><br><span class="line">        _DestroyPhysicalMonitor($hMonitor) <span class="comment">;关闭监视器句柄</span></span><br><span class="line">        <span class="built_in">DllClose</span>($Dxva2)</span><br><span class="line">        <span class="keyword">Exit</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Button2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Brightness</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">If</span> <span class="literal">Not</span> $switch1 <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idLabel1, <span class="string">&quot;设置亮度:&quot;</span> &amp; <span class="built_in">GUICtrlRead</span>($idSlider1))</span><br><span class="line">        _SetMonitorBrightness($hMonitor, <span class="built_in">GUICtrlRead</span>($idSlider1))</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Brightness</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Contrast</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">If</span> <span class="literal">Not</span> $switch2 <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        <span class="built_in">GUICtrlSetData</span>($idLabel2, <span class="string">&quot;设置对比度:&quot;</span> &amp; <span class="built_in">GUICtrlRead</span>($idSlider2))</span><br><span class="line">        _SetMonitorContrast($hMonitor, <span class="built_in">GUICtrlRead</span>($idSlider2))</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Contrast</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_GetMonitorBrightness</span><span class="params">(Const $h_monitor)</span></span></span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $MinimumBrightness = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $CurrentBrightness = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $MaximumBrightness = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetMonitorBrightness&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $h_monitor, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MinimumBrightness), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($CurrentBrightness), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MaximumBrightness))</span><br><span class="line">        <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $brightness[3] = [<span class="built_in">DllStructGetData</span>($MinimumBrightness, <span class="number">1</span>), _</span><br><span class="line">                        <span class="built_in">DllStructGetData</span>($CurrentBrightness, <span class="number">1</span>), _</span><br><span class="line">                        <span class="built_in">DllStructGetData</span>($MaximumBrightness, <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">Return</span> $brightness</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_GetMonitorBrightness</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_GetMonitorContrast</span><span class="params">(Const $h_monitor)</span></span></span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $MinimumContrast = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $CurrentContrast = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $MaximumContrast = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetMonitorContrast&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $h_monitor, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MinimumContrast), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($CurrentContrast), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MaximumContrast))</span><br><span class="line">        <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $contrast[3] = [<span class="built_in">DllStructGetData</span>($MinimumContrast, <span class="number">1</span>), _</span><br><span class="line">                        <span class="built_in">DllStructGetData</span>($CurrentContrast, <span class="number">1</span>), _</span><br><span class="line">                        <span class="built_in">DllStructGetData</span>($MaximumContrast, <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">Return</span> $contrast</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_GetMonitorContrast</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_SetMonitorBrightness</span><span class="params">(Const $h_monitor, Const $NewBrightness)</span></span></span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;SetMonitorBrightness&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $h_monitor, <span class="string">&quot;dword&quot;</span>, $NewBrightness)</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span> ? <span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>) : <span class="literal">True</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_SetMonitorBrightness</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_SetMonitorContrast</span><span class="params">(Const $h_monitor, Const $contrast)</span></span></span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;SetMonitorContrast&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $h_monitor, <span class="string">&quot;dword&quot;</span>, $contrast)</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span> ? <span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>) : <span class="literal">True</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_SetMonitorContrast</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_GetPhysicalMonitorsFromHMONITOR</span><span class="params">(Const $pMonitor)</span></span></span><br><span class="line">        <span class="keyword">Local</span> $Number = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;DWORD&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> $i, $tagPhysical, $M = <span class="number">1</span></span><br><span class="line">        $Ret = <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetNumberOfPhysicalMonitorsFromHMONITOR&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $pMonitor, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($Number))</span><br><span class="line">        $NumberOfMonitors = <span class="built_in">DllStructGetData</span>($Number, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">For</span> $i = <span class="number">1</span> <span class="keyword">To</span> $NumberOfMonitors</span><br><span class="line">                $tagPhysical &amp;= $tagSTRUCT</span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">        $MonitorArray = <span class="built_in">DllStructCreate</span>($tagSTRUCT)</span><br><span class="line">        $Ret = <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetPhysicalMonitorsFromHMONITOR&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $pMonitor, _</span><br><span class="line">                        <span class="string">&quot;DWORD&quot;</span>, $NumberOfMonitors, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MonitorArray))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">Return</span> <span class="built_in">DllStructGetData</span>($MonitorArray, <span class="number">1</span>) <span class="comment">;返回第一个显示器句柄</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_GetPhysicalMonitorsFromHMONITOR</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">CapabilitiesRequestAndCapabilitiesReply</span><span class="params">(Const $h_monitor)</span></span></span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $tagStringLength = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetCapabilitiesStringLength&quot;</span>, <span class="string">&quot;handle&quot;</span>, $h_monitor, <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($tagStringLength))</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $CapabilitiesStringLength = <span class="built_in">DllStructGetData</span>($tagStringLength, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $CapabilitiesString = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;char[&quot;</span> &amp; $CapabilitiesStringLength &amp; <span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;CapabilitiesRequestAndCapabilitiesReply&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $h_monitor, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($CapabilitiesString), _</span><br><span class="line">                        <span class="string">&quot;dword&quot;</span>, <span class="built_in">DllStructGetSize</span>($CapabilitiesString))</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span>) ? (<span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)) : (<span class="built_in">DllStructGetData</span>($CapabilitiesString, <span class="number">1</span>))</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;CapabilitiesRequestAndCapabilitiesReply</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_RestoreMonitorFactoryDefaults</span><span class="params">(Const $h_monitor)</span></span></span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;RestoreMonitorFactoryDefaults&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $h_monitor)</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span>) ? (<span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)) : (<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_RestoreMonitorFactoryDefaults</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_SetVCPFeature</span><span class="params">(Const $h_monitor, Const $VCPCode, Const $NewValue)</span></span></span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;SetVCPFeature&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $h_monitor, _</span><br><span class="line">                        <span class="string">&quot;byte&quot;</span>, $VCPCode, _</span><br><span class="line">                        <span class="string">&quot;dword&quot;</span>, $NewValue)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span>) ? (<span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)) : (<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_SetVCPFeature</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_GetVCPFeatureAndVCPFeatureReply</span><span class="params">(Const $h_monitor, Const $VCPCode)</span></span></span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $CurrentValue = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $MaximumValue = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $VCPCodeType = <span class="built_in">DllStructCreate</span>(<span class="string">&quot;dword_ptr&quot;</span>)</span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;GetVCPFeatureAndVCPFeatureReply&quot;</span>, _</span><br><span class="line">                        <span class="string">&quot;handle&quot;</span>, $h_monitor, _</span><br><span class="line">                        <span class="string">&quot;byte&quot;</span>, $VCPCode, _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($VCPCodeType), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($CurrentValue), _</span><br><span class="line">                        <span class="string">&quot;ptr&quot;</span>, <span class="built_in">DllStructGetPtr</span>($MaximumValue))</span><br><span class="line">        <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Return</span> <span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">Local</span> <span class="keyword">Const</span> $VCPFeatureReply[3] = [<span class="built_in">DllStructGetData</span>($VCPCodeType, <span class="number">1</span>), <span class="built_in">DllStructGetData</span>($CurrentValue, <span class="number">1</span>), <span class="built_in">DllStructGetData</span>($MaximumValue, <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">Return</span> $VCPFeatureReply</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_GetVCPFeatureAndVCPFeatureReply</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Manage_vcp</span><span class="params">(Const $String)</span></span></span><br><span class="line">        <span class="keyword">Local</span> $Exp, $i, $tmp, $OUT_String</span><br><span class="line">        $Exp = <span class="built_in">StringRegExp</span>($String, <span class="string">&quot;(?&lt;=vcp\()([A-Za-z0-9]&#123;2&#125;[\)\(]?\s?)*(?=\))&quot;</span>, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        $Exp = <span class="built_in">StringRegExp</span>($Exp[0], <span class="string">&quot;([0-9A-Fa-f]&#123;2&#125;)(\(.+?\))?&quot;</span>, <span class="number">4</span>)</span><br><span class="line">        <span class="keyword">If</span> <span class="symbol">@error</span> <span class="keyword">Then</span> <span class="keyword">Return</span></span><br><span class="line">        <span class="keyword">Local</span> $Array[UBound($Exp)][<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">For</span> $i = <span class="number">0</span> <span class="keyword">To</span> <span class="built_in">UBound</span>($Exp) - <span class="number">1</span></span><br><span class="line">                $tmp = $Exp[$i]</span><br><span class="line">                $Array[$i][0] = <span class="built_in">StringStripWS</span>(<span class="built_in">StringLeft</span>($tmp[0], <span class="number">2</span>), <span class="number">8</span>)</span><br><span class="line">                $OUT_String = <span class="built_in">StringStripWS</span>(<span class="built_in">StringTrimLeft</span>($tmp[0], <span class="number">2</span>), <span class="number">3</span>)</span><br><span class="line">                <span class="keyword">If</span> $OUT_String &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">                        $OUT_String = <span class="built_in">StringTrimLeft</span>(<span class="built_in">StringTrimRight</span>($OUT_String, <span class="number">1</span>), <span class="number">1</span>)</span><br><span class="line">                        $Array[$i][1] = $OUT_String</span><br><span class="line">                <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">        <span class="keyword">Return</span> $Array</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Manage_vcp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_DestroyPhysicalMonitor</span><span class="params">(Const $h_monitor)</span></span></span><br><span class="line">        <span class="built_in">DllCall</span>($Dxva2, <span class="string">&quot;bool&quot;</span>, <span class="string">&quot;DestroyPhysicalMonitor&quot;</span>, <span class="string">&quot;ptr&quot;</span>, $h_monitor)</span><br><span class="line">        <span class="keyword">Return</span> (<span class="symbol">@error</span>) ? (<span class="built_in">SetError</span>(<span class="number">1</span>, _WinAPI_GetLastErrorMessage(), <span class="literal">False</span>)) : (<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_DestroyPhysicalMonitor</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">Brightness_lcd</span><span class="params">(Const $BRIGHTNESS_Lcd)</span></span></span><br><span class="line">        <span class="keyword">Local</span> $BRIGHTNESS_String, $tmp, $i</span><br><span class="line">        <span class="keyword">For</span> $i = <span class="number">1</span> <span class="keyword">To</span> <span class="built_in">BinaryLen</span>($BRIGHTNESS_Lcd)</span><br><span class="line">                $tmp = <span class="built_in">Int</span>(<span class="built_in">BinaryMid</span>($BRIGHTNESS_Lcd, $i, <span class="number">1</span>))</span><br><span class="line">                <span class="keyword">If</span> $i = <span class="number">1</span> <span class="keyword">Then</span></span><br><span class="line">                        $BRIGHTNESS_String &amp;= $tmp &amp; <span class="string">&quot;;&quot;</span></span><br><span class="line">                <span class="keyword">Else</span></span><br><span class="line">                        <span class="keyword">If</span> $tmp = <span class="number">0</span> <span class="keyword">Then</span> <span class="keyword">ExitLoop</span></span><br><span class="line">                        $BRIGHTNESS_String &amp;= $tmp &amp; <span class="string">&quot;;&quot;</span></span><br><span class="line">                <span class="keyword">EndIf</span></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line">        <span class="keyword">Return</span> <span class="built_in">StringSplit</span>(<span class="built_in">StringTrimRight</span>($BRIGHTNESS_String, <span class="number">1</span>), <span class="string">&quot;;&quot;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;Brightness_lcd</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Func</span> <span class="title">_exit</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">If</span> $hDevice <span class="keyword">Then</span> _WinAPI_CloseHandle($hDevice)</span><br><span class="line">        _DestroyPhysicalMonitor($hMonitor) <span class="comment">;关闭监视器句柄</span></span><br><span class="line">        <span class="built_in">DllClose</span>($Dxva2)</span><br><span class="line">        <span class="keyword">Exit</span></span><br><span class="line"><span class="keyword">EndFunc</span>   <span class="comment">;==&gt;_exit</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/c9ae1552366758.png&quot; alt=&quot;显示器调节&quot;&gt;&lt;br&gt;通过调用dxva2.dll文件，修改显示器的设置，和按显示器上的物理按钮效果一样，有效的解决显示器上按钮不好设置，按钮功能不明的问题，有些显示器不支持，如果你使用的无效果，说明你显示器不支持此调节功能!下载地址：&lt;a href=&quot;https://www.jianyiit.com/content/uploadfile/201903/adf51552366758.zip&quot;&gt;源码&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight autoit&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;190&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;191&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;193&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;194&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;195&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;196&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;197&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;198&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;199&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;200&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;201&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;202&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;203&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;204&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;205&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;206&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;207&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;208&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;210&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;211&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;212&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;213&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;214&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;215&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;216&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;217&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;218&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;219&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;220&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;221&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;222&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;223&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;224&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;225&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;226&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;227&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;228&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;229&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;230&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;231&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;232&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;233&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;234&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;235&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;236&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;237&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;238&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;239&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;240&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;241&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;242&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;243&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;244&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;245&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;246&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;247&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;248&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;249&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;250&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;251&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;252&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;253&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;254&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;255&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;256&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;257&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;258&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;259&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;260&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;261&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;262&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;263&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;264&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;265&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;266&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;267&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;268&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;269&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;270&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;271&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;272&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;273&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;274&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;275&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;276&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;277&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;278&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;279&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;280&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;281&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;282&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;283&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;284&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;285&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;286&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;287&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;289&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;290&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;291&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;292&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;293&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;294&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;295&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;296&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;297&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;298&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;299&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;300&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;301&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;302&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;303&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;304&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;305&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;306&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;307&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;308&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;309&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;310&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;311&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;312&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;313&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;314&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;315&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;316&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;317&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;318&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;319&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;320&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;321&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;322&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;323&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;324&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;325&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;326&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;327&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;328&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;329&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;330&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;331&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;332&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;333&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;334&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;335&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;336&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;337&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;338&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;339&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;340&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;341&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;342&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;343&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;344&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;345&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;346&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;347&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;348&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;349&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;350&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;351&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;352&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;353&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;354&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;355&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;356&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;357&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;358&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;359&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;360&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;361&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;362&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;363&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;364&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;365&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;366&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;367&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;368&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;369&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;370&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;371&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;372&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;373&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;374&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;375&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;376&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;377&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;378&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;379&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;380&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;381&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;382&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;383&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;385&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;386&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;387&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;388&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;389&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;390&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;391&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;392&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;393&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;394&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;395&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;396&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;397&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;398&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;399&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;400&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;401&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;402&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;403&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;404&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;405&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;406&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;407&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;WinAPI.au3&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;WinAPIFiles.au3&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;WinAPIGdi.au3&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;GUIConstantsEx.au3&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;GuiSlider.au3&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;Array.au3&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Opt(&lt;span class=&quot;string&quot;&gt;&amp;quot;GUIOnEventMode&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$g_szVersion = &lt;span class=&quot;string&quot;&gt;&amp;quot;RU1Y2-D59U9&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;WinExists&lt;/span&gt;($g_szVersion) &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Exit&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;AutoItWinSetTitle&lt;/span&gt;($g_szVersion)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Global&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $Dxva2 = &lt;span class=&quot;built_in&quot;&gt;DllOpen&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;Dxva2.dll&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Exit&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Global&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $tagSTRUCT = &lt;span class=&quot;string&quot;&gt;&amp;quot;HANDLE hPhysicalMonitor;WCHAR szPhysicalMonitorDescription[128];&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Global&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $tag_MC_TIMING_REPORT = &lt;span class=&quot;string&quot;&gt;&amp;quot;BYTE bTimingStatusByte; DWORD dwHorizontalFrequencyInHZ; DWORD dwVerticalFrequencyInHZ&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Global&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $tag_DISPLAY_BRIGHTNESS = &lt;span class=&quot;string&quot;&gt;&amp;quot;byte ucDisplayPolicy; byte ucACBrightness; byte ucDCBrightness&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Global&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $IOCTL_VIDEO_QUERY_SUPPORTED_BRIGHTNESS = _WinAPI_IOCTL($FILE_DEVICE_VIDEO, &lt;span class=&quot;number&quot;&gt;0x125&lt;/span&gt;, $METHOD_BUFFERED, $FILE_ANY_ACCESS)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Global&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $IOCTL_VIDEO_QUERY_DISPLAY_BRIGHTNESS = _WinAPI_IOCTL($FILE_DEVICE_VIDEO, &lt;span class=&quot;number&quot;&gt;0x126&lt;/span&gt;, $METHOD_BUFFERED, $FILE_ANY_ACCESS)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Global&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $IOCTL_VIDEO_SET_DISPLAY_BRIGHTNESS = _WinAPI_IOCTL($FILE_DEVICE_VIDEO, &lt;span class=&quot;number&quot;&gt;0x127&lt;/span&gt;, $METHOD_BUFFERED, $FILE_ANY_ACCESS)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Global&lt;/span&gt; $idSlider1, $idSlider2, $idButton1, $idButton2, $idLabel1, $idLabel2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Global&lt;/span&gt; $hMonitor, $brightness, $contrast, $switch1, $switch2, $VCPReply&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Global&lt;/span&gt; $idLabel3, $idSlider3, $hDevice, $BRIGHTNESS_LCD_Array&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$hDevice = LCD()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;Not&lt;/span&gt; &lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        LCD_Set($hDevice)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $hDevice &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; _WinAPI_CloseHandle($hDevice)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllClose&lt;/span&gt;($Dxva2)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Exit&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$hMonitor = _WinAPI_MonitorFromWindow(_WinAPI_GetDesktopWindow(), $MONITOR_DEFAULTTOPRIMARY) &lt;span class=&quot;comment&quot;&gt;;返回主显示器句柄&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$hMonitor = _GetPhysicalMonitorsFromHMONITOR($hMonitor) &lt;span class=&quot;comment&quot;&gt;;获取物理显示器句柄&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$StringLength = CapabilitiesRequestAndCapabilitiesReply($hMonitor)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$Gui = &lt;span class=&quot;built_in&quot;&gt;GUICreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;显示器设置&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;262&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;220&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;GUISetOnEvent&lt;/span&gt;($GUI_EVENT_CLOSE, &lt;span class=&quot;string&quot;&gt;&amp;quot;_exit&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$idSlider1 = &lt;span class=&quot;built_in&quot;&gt;GUICtrlCreateSlider&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;240&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;BitOR&lt;/span&gt;($TBS_TOOLTIPS, $TBS_AUTOTICKS))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;GUICtrlSetOnEvent&lt;/span&gt;($idSlider1, &lt;span class=&quot;string&quot;&gt;&amp;quot;Brightness&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;GUICtrlSetLimit&lt;/span&gt;($idSlider1, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$idSlider2 = &lt;span class=&quot;built_in&quot;&gt;GUICtrlCreateSlider&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;240&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;BitOR&lt;/span&gt;($TBS_TOOLTIPS, $TBS_AUTOTICKS))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;GUICtrlSetOnEvent&lt;/span&gt;($idSlider2, &lt;span class=&quot;string&quot;&gt;&amp;quot;Contrast&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;GUICtrlSetLimit&lt;/span&gt;($idSlider2, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$idButton1 = &lt;span class=&quot;built_in&quot;&gt;GUICtrlCreateButton&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;宽屏切换&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;GUICtrlSetOnEvent&lt;/span&gt;($idButton1, &lt;span class=&quot;string&quot;&gt;&amp;quot;Button1&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$idButton2 = &lt;span class=&quot;built_in&quot;&gt;GUICtrlCreateButton&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;恢复默认&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;GUICtrlSetOnEvent&lt;/span&gt;($idButton2, &lt;span class=&quot;string&quot;&gt;&amp;quot;Button2&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$idLabel1 = &lt;span class=&quot;built_in&quot;&gt;GUICtrlCreateLabel&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;  亮度调节:不可用&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;140&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$idLabel2 = &lt;span class=&quot;built_in&quot;&gt;GUICtrlCreateLabel&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;对比度调节:不可用&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;140&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$Combo1 = &lt;span class=&quot;built_in&quot;&gt;GUICtrlCreateCombo&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x0003&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;GUICtrlSetOnEvent&lt;/span&gt;($Combo1, &lt;span class=&quot;string&quot;&gt;&amp;quot;Color&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;GUICtrlCreateLabel&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;色温调节&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;124&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;_GUICtrlSlider_SetTipSide($idSlider1, $TBTS_TOP)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;_GUICtrlSlider_SetTipSide($idSlider2, $TBTS_TOP)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $StringLength &amp;lt;&amp;gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $VCP_Array = Manage_vcp($StringLength)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $VCPReply = _GetVCPFeatureAndVCPFeatureReply($hMonitor, &lt;span class=&quot;number&quot;&gt;0x86&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $VCPReply[0] = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetState&lt;/span&gt;($idButton1, $GUI_DISABLE)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $brightness = _GetMonitorBrightness($hMonitor) &lt;span class=&quot;comment&quot;&gt;;获取监视器亮度&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;ConsoleWrite&lt;/span&gt;($brightness[1] &amp;amp; &lt;span class=&quot;symbol&quot;&gt;@CRLF&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $contrast = _GetMonitorContrast($hMonitor) &lt;span class=&quot;comment&quot;&gt;;获取监视器对比度&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $brightness[2] &amp;lt;&amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; $switch1 = &lt;span class=&quot;literal&quot;&gt;True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $contrast[2] &amp;lt;&amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; $switch2 = &lt;span class=&quot;literal&quot;&gt;True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $switch1 &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idSlider1, $brightness[1])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idLabel1, &lt;span class=&quot;string&quot;&gt;&amp;quot;设置亮度:&amp;quot;&lt;/span&gt; &amp;amp; $brightness[1])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $switch2 &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idSlider2, $contrast[1])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idLabel2, &lt;span class=&quot;string&quot;&gt;&amp;quot;设置对比度:&amp;quot;&lt;/span&gt; &amp;amp; $contrast[1])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;For&lt;/span&gt; $i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;To&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;UBound&lt;/span&gt;($VCP_Array) - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $VCP_Array[$i][0] = &lt;span class=&quot;string&quot;&gt;&amp;quot;14&amp;quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $VCP_Array[$i][1] &amp;lt;&amp;gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                $Color_Array = &lt;span class=&quot;built_in&quot;&gt;StringSplit&lt;/span&gt;($VCP_Array[$i][1], &lt;span class=&quot;string&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                $Color_String = &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                &lt;span class=&quot;keyword&quot;&gt;For&lt;/span&gt; $S = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;To&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;UBound&lt;/span&gt;($Color_Array) - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                        $temp = Select_Color($Color_Array[$S])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $temp &amp;lt;&amp;gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; $Color_String &amp;amp;= $temp &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;quot;|&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                &lt;span class=&quot;keyword&quot;&gt;Next&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;ExitLoop&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Next&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $Color_String &amp;lt;&amp;gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                $VCPCode = _GetVCPFeatureAndVCPFeatureReply($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($Combo1, $Color_String, Select_Color($VCPCode[1] - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($Combo1, &lt;span class=&quot;string&quot;&gt;&amp;quot;不支持&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;不支持&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetState&lt;/span&gt;($Combo1, $GUI_DISABLE)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUISetState&lt;/span&gt;(&lt;span class=&quot;symbol&quot;&gt;@SW_SHOW&lt;/span&gt;, $Gui)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;WinSetTitle&lt;/span&gt;($Gui, &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;未发现DDC/CI&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($Combo1, &lt;span class=&quot;string&quot;&gt;&amp;quot;不支持&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;不支持&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetState&lt;/span&gt;($idSlider1, $GUI_DISABLE)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetState&lt;/span&gt;($idSlider2, $GUI_DISABLE)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetState&lt;/span&gt;($idButton1, $GUI_DISABLE)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetState&lt;/span&gt;($Combo1, $GUI_DISABLE)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUISetState&lt;/span&gt;(&lt;span class=&quot;symbol&quot;&gt;@SW_SHOW&lt;/span&gt;, $Gui)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;While&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;Sleep&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WEnd&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;LCD&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $iDevice&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $iDevice = _WinAPI_CreateFileEx(&lt;span class=&quot;string&quot;&gt;&amp;quot;\\.\LCD&amp;quot;&lt;/span&gt;, $OPEN_EXISTING, $GENERIC_READ + $GENERIC_WRITE, $FILE_ANY_ACCESS, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; (&lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt;) ? (&lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, _WinAPI_GetLastErrorMessage(), &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;)) : ($iDevice)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;LCD&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;LCD_Set&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;($iDevice)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $brightness = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;BYTE[256]&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $DISPLAY_BRIGHTNESS = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;BYTE[3]&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $success = _WinAPI_DeviceIoControl($iDevice, $IOCTL_VIDEO_QUERY_SUPPORTED_BRIGHTNESS, &lt;span class=&quot;literal&quot;&gt;Null&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($brightness), &lt;span class=&quot;number&quot;&gt;0xff&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $success = &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $BRIGHTNESS_LCD_Array = Brightness_lcd(&lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($brightness, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $success = _WinAPI_DeviceIoControl($iDevice, $IOCTL_VIDEO_QUERY_DISPLAY_BRIGHTNESS, &lt;span class=&quot;literal&quot;&gt;Null&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($DISPLAY_BRIGHTNESS), &lt;span class=&quot;number&quot;&gt;0x03&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $success = &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $DISPLAY_BRIGHTNESS_READ = &lt;span class=&quot;built_in&quot;&gt;Int&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;BinaryMid&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($DISPLAY_BRIGHTNESS, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $Gui = &lt;span class=&quot;built_in&quot;&gt;GUICreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;内置LCD显示器&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;262&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUISetOnEvent&lt;/span&gt;($GUI_EVENT_CLOSE, &lt;span class=&quot;string&quot;&gt;&amp;quot;_exit&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $idSlider3 = &lt;span class=&quot;built_in&quot;&gt;GUICtrlCreateSlider&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;240&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;BitOR&lt;/span&gt;($TBS_TOOLTIPS, $TBS_AUTOTICKS))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetLimit&lt;/span&gt;($idSlider3, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $idLabel3 = &lt;span class=&quot;built_in&quot;&gt;GUICtrlCreateLabel&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;  亮度调节:&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;140&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idSlider3, $DISPLAY_BRIGHTNESS_READ)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idLabel3, &lt;span class=&quot;string&quot;&gt;&amp;quot;设置亮度:&amp;quot;&lt;/span&gt; &amp;amp; $DISPLAY_BRIGHTNESS_READ)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetOnEvent&lt;/span&gt;($idSlider3, &lt;span class=&quot;string&quot;&gt;&amp;quot;Brightness_set_lcd&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUISetState&lt;/span&gt;(&lt;span class=&quot;symbol&quot;&gt;@SW_SHOW&lt;/span&gt;, $Gui)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;WinSetTitle&lt;/span&gt;($Gui, &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;内置LCD显示器&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;While&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;Sleep&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;WEnd&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;LCD_Set&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Brightness_set_lcd&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $lcd_BRIGHTNESS, $DISPLAY_BRIGHTNESS, $success&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $lcd_BRIGHTNESS = &lt;span class=&quot;built_in&quot;&gt;GUICtrlRead&lt;/span&gt;($idSlider3)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idLabel3, &lt;span class=&quot;string&quot;&gt;&amp;quot;设置亮度:&amp;quot;&lt;/span&gt; &amp;amp; $lcd_BRIGHTNESS)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;For&lt;/span&gt; $i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;To&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;UBound&lt;/span&gt;($BRIGHTNESS_LCD_Array)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $lcd_BRIGHTNESS &amp;lt;= $BRIGHTNESS_LCD_Array[$i] &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $DISPLAY_BRIGHTNESS = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;($tag_DISPLAY_BRIGHTNESS)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;built_in&quot;&gt;DllStructSetData&lt;/span&gt;($DISPLAY_BRIGHTNESS, &lt;span class=&quot;string&quot;&gt;&amp;quot;ucDisplayPolicy&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;built_in&quot;&gt;DllStructSetData&lt;/span&gt;($DISPLAY_BRIGHTNESS, &lt;span class=&quot;string&quot;&gt;&amp;quot;ucACBrightness&amp;quot;&lt;/span&gt;, $BRIGHTNESS_LCD_Array[$i])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;built_in&quot;&gt;DllStructSetData&lt;/span&gt;($DISPLAY_BRIGHTNESS, &lt;span class=&quot;string&quot;&gt;&amp;quot;ucDCBrightness&amp;quot;&lt;/span&gt;, $BRIGHTNESS_LCD_Array[$i])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $success = _WinAPI_DeviceIoControl($hDevice, $IOCTL_VIDEO_SET_DISPLAY_BRIGHTNESS, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($DISPLAY_BRIGHTNESS), &lt;span class=&quot;built_in&quot;&gt;DllStructGetSize&lt;/span&gt;($DISPLAY_BRIGHTNESS), &lt;span class=&quot;literal&quot;&gt;Null&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $success = &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;ExitLoop&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Next&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;Brightness_set_lcd&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Select_Color&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;($iValue)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $String&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;StringIsXDigit&lt;/span&gt;($iValue) &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; $iValue = &lt;span class=&quot;built_in&quot;&gt;Dec&lt;/span&gt;($iValue)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Switch&lt;/span&gt; $iValue&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;sRGB&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;原生显示&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;4000K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;5000K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;6500K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;7500K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;8200K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;9300K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;10000K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;11500K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;User1&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;User2&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $String = &lt;span class=&quot;string&quot;&gt;&amp;quot;User3&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;EndSwitch&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; $String&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;Select_Color&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $iValue = &lt;span class=&quot;built_in&quot;&gt;GUICtrlRead&lt;/span&gt;($Combo1)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Select&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;sRGB&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x01&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;原生显示&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x02&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;4000K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x03&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;5000K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x04&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;6500K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x05&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;7500K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x06&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;8200K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x07&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;9300K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x08&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;10000K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x09&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;11500K&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x0a&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;User1&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x0b&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;User2&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x0c&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; $iValue = &lt;span class=&quot;string&quot;&gt;&amp;quot;User3&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x0d&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Case&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;EndSelect&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;Color&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Button1&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $VCPCode&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $switch1 &lt;span class=&quot;literal&quot;&gt;And&lt;/span&gt; $switch2 &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                $VCPCode = _GetVCPFeatureAndVCPFeatureReply($hMonitor, &lt;span class=&quot;number&quot;&gt;0x86&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;ConsoleWrite&lt;/span&gt;($VCPCode[1] &amp;amp; &lt;span class=&quot;symbol&quot;&gt;@CRLF&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $VCPCode[1] = &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x86&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x02&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idButton1, &lt;span class=&quot;string&quot;&gt;&amp;quot;窄屏&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        _SetVCPFeature($hMonitor, &lt;span class=&quot;number&quot;&gt;0x86&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x08&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idButton1, &lt;span class=&quot;string&quot;&gt;&amp;quot;宽屏&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;Button1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Button2&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idButton2, &lt;span class=&quot;string&quot;&gt;&amp;quot;Reset..&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;Sleep&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;250&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUISetState&lt;/span&gt;(&lt;span class=&quot;symbol&quot;&gt;@SW_HIDE&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $switch1 &lt;span class=&quot;literal&quot;&gt;Or&lt;/span&gt; $switch2 &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                _RestoreMonitorFactoryDefaults($hMonitor)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;Sleep&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        _DestroyPhysicalMonitor($hMonitor) &lt;span class=&quot;comment&quot;&gt;;关闭监视器句柄&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllClose&lt;/span&gt;($Dxva2)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Exit&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;Button2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Brightness&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;Not&lt;/span&gt; $switch1 &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idLabel1, &lt;span class=&quot;string&quot;&gt;&amp;quot;设置亮度:&amp;quot;&lt;/span&gt; &amp;amp; &lt;span class=&quot;built_in&quot;&gt;GUICtrlRead&lt;/span&gt;($idSlider1))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        _SetMonitorBrightness($hMonitor, &lt;span class=&quot;built_in&quot;&gt;GUICtrlRead&lt;/span&gt;($idSlider1))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;Brightness&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Contrast&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;Not&lt;/span&gt; $switch2 &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;GUICtrlSetData&lt;/span&gt;($idLabel2, &lt;span class=&quot;string&quot;&gt;&amp;quot;设置对比度:&amp;quot;&lt;/span&gt; &amp;amp; &lt;span class=&quot;built_in&quot;&gt;GUICtrlRead&lt;/span&gt;($idSlider2))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        _SetMonitorContrast($hMonitor, &lt;span class=&quot;built_in&quot;&gt;GUICtrlRead&lt;/span&gt;($idSlider2))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;Contrast&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_GetMonitorBrightness&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $h_monitor)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $MinimumBrightness = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;dword_ptr&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $CurrentBrightness = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;dword_ptr&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $MaximumBrightness = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;dword_ptr&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;GetMonitorBrightness&amp;quot;&lt;/span&gt;, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;handle&amp;quot;&lt;/span&gt;, $h_monitor, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($MinimumBrightness), _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($CurrentBrightness), _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($MaximumBrightness))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, _WinAPI_GetLastErrorMessage(), &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $brightness[3] = [&lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($MinimumBrightness, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($CurrentBrightness, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($MaximumBrightness, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; $brightness&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_GetMonitorBrightness&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_GetMonitorContrast&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $h_monitor)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $MinimumContrast = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;dword_ptr&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $CurrentContrast = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;dword_ptr&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $MaximumContrast = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;dword_ptr&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;GetMonitorContrast&amp;quot;&lt;/span&gt;, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;handle&amp;quot;&lt;/span&gt;, $h_monitor, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($MinimumContrast), _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($CurrentContrast), _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($MaximumContrast))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, _WinAPI_GetLastErrorMessage(), &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $contrast[3] = [&lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($MinimumContrast, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($CurrentContrast, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($MaximumContrast, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; $contrast&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_GetMonitorContrast&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_SetMonitorBrightness&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $h_monitor, Const $NewBrightness)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;SetMonitorBrightness&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, $h_monitor, &lt;span class=&quot;string&quot;&gt;&amp;quot;dword&amp;quot;&lt;/span&gt;, $NewBrightness)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; (&lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt; ? &lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, _WinAPI_GetLastErrorMessage(), &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;) : &lt;span class=&quot;literal&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_SetMonitorBrightness&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_SetMonitorContrast&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $h_monitor, Const $contrast)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;SetMonitorContrast&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, $h_monitor, &lt;span class=&quot;string&quot;&gt;&amp;quot;dword&amp;quot;&lt;/span&gt;, $contrast)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; (&lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt; ? &lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, _WinAPI_GetLastErrorMessage(), &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;) : &lt;span class=&quot;literal&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_SetMonitorContrast&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_GetPhysicalMonitorsFromHMONITOR&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $pMonitor)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $Number = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;DWORD&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $i, $tagPhysical, $M = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $Ret = &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;GetNumberOfPhysicalMonitorsFromHMONITOR&amp;quot;&lt;/span&gt;, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;handle&amp;quot;&lt;/span&gt;, $pMonitor, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($Number))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $NumberOfMonitors = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($Number, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;For&lt;/span&gt; $i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;To&lt;/span&gt; $NumberOfMonitors&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                $tagPhysical &amp;amp;= $tagSTRUCT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Next&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $MonitorArray = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;($tagSTRUCT)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $Ret = &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;GetPhysicalMonitorsFromHMONITOR&amp;quot;&lt;/span&gt;, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;handle&amp;quot;&lt;/span&gt;, $pMonitor, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;DWORD&amp;quot;&lt;/span&gt;, $NumberOfMonitors, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($MonitorArray))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($MonitorArray, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;;返回第一个显示器句柄&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_GetPhysicalMonitorsFromHMONITOR&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CapabilitiesRequestAndCapabilitiesReply&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $h_monitor)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $tagStringLength = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;dword_ptr&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;GetCapabilitiesStringLength&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;handle&amp;quot;&lt;/span&gt;, $h_monitor, &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($tagStringLength))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $CapabilitiesStringLength = &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($tagStringLength, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $CapabilitiesString = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;char[&amp;quot;&lt;/span&gt; &amp;amp; $CapabilitiesStringLength &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;#x27;]&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;CapabilitiesRequestAndCapabilitiesReply&amp;quot;&lt;/span&gt;, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;handle&amp;quot;&lt;/span&gt;, $h_monitor, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($CapabilitiesString), _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;dword&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetSize&lt;/span&gt;($CapabilitiesString))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; (&lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt;) ? (&lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, _WinAPI_GetLastErrorMessage(), &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;)) : (&lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($CapabilitiesString, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;CapabilitiesRequestAndCapabilitiesReply&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_RestoreMonitorFactoryDefaults&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $h_monitor)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;RestoreMonitorFactoryDefaults&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, $h_monitor)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; (&lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt;) ? (&lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, _WinAPI_GetLastErrorMessage(), &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;)) : (&lt;span class=&quot;literal&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_RestoreMonitorFactoryDefaults&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_SetVCPFeature&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $h_monitor, Const $VCPCode, Const $NewValue)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;SetVCPFeature&amp;quot;&lt;/span&gt;, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;handle&amp;quot;&lt;/span&gt;, $h_monitor, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;byte&amp;quot;&lt;/span&gt;, $VCPCode, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;dword&amp;quot;&lt;/span&gt;, $NewValue)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; (&lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt;) ? (&lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, _WinAPI_GetLastErrorMessage(), &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;)) : (&lt;span class=&quot;literal&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_SetVCPFeature&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_GetVCPFeatureAndVCPFeatureReply&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $h_monitor, Const $VCPCode)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $CurrentValue = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;dword_ptr&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $MaximumValue = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;dword_ptr&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $VCPCodeType = &lt;span class=&quot;built_in&quot;&gt;DllStructCreate&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;dword_ptr&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;GetVCPFeatureAndVCPFeatureReply&amp;quot;&lt;/span&gt;, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;handle&amp;quot;&lt;/span&gt;, $h_monitor, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;byte&amp;quot;&lt;/span&gt;, $VCPCode, _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($VCPCodeType), _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($CurrentValue), _&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;DllStructGetPtr&lt;/span&gt;($MaximumValue))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, _WinAPI_GetLastErrorMessage(), &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Const&lt;/span&gt; $VCPFeatureReply[3] = [&lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($VCPCodeType, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($CurrentValue, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), &lt;span class=&quot;built_in&quot;&gt;DllStructGetData&lt;/span&gt;($MaximumValue, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; $VCPFeatureReply&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_GetVCPFeatureAndVCPFeatureReply&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Manage_vcp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $String)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $Exp, $i, $tmp, $OUT_String&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $Exp = &lt;span class=&quot;built_in&quot;&gt;StringRegExp&lt;/span&gt;($String, &lt;span class=&quot;string&quot;&gt;&amp;quot;(?&amp;lt;=vcp\()([A-Za-z0-9]&amp;#123;2&amp;#125;[\)\(]?\s?)*(?=\))&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $Exp = &lt;span class=&quot;built_in&quot;&gt;StringRegExp&lt;/span&gt;($Exp[0], &lt;span class=&quot;string&quot;&gt;&amp;quot;([0-9A-Fa-f]&amp;#123;2&amp;#125;)(\(.+?\))?&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $Array[UBound($Exp)][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;For&lt;/span&gt; $i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;To&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;UBound&lt;/span&gt;($Exp) - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                $tmp = $Exp[$i]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                $Array[$i][0] = &lt;span class=&quot;built_in&quot;&gt;StringStripWS&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;StringLeft&lt;/span&gt;($tmp[0], &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;), &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                $OUT_String = &lt;span class=&quot;built_in&quot;&gt;StringStripWS&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;StringTrimLeft&lt;/span&gt;($tmp[0], &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;), &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $OUT_String &amp;lt;&amp;gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $OUT_String = &lt;span class=&quot;built_in&quot;&gt;StringTrimLeft&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;StringTrimRight&lt;/span&gt;($OUT_String, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $Array[$i][1] = $OUT_String&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Next&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; $Array&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;Manage_vcp&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_DestroyPhysicalMonitor&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $h_monitor)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllCall&lt;/span&gt;($Dxva2, &lt;span class=&quot;string&quot;&gt;&amp;quot;bool&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;DestroyPhysicalMonitor&amp;quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;quot;ptr&amp;quot;&lt;/span&gt;, $h_monitor)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; (&lt;span class=&quot;symbol&quot;&gt;@error&lt;/span&gt;) ? (&lt;span class=&quot;built_in&quot;&gt;SetError&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, _WinAPI_GetLastErrorMessage(), &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;)) : (&lt;span class=&quot;literal&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_DestroyPhysicalMonitor&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Brightness_lcd&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Const $BRIGHTNESS_Lcd)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Local&lt;/span&gt; $BRIGHTNESS_String, $tmp, $i&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;For&lt;/span&gt; $i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;To&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;BinaryLen&lt;/span&gt;($BRIGHTNESS_Lcd)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                $tmp = &lt;span class=&quot;built_in&quot;&gt;Int&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;BinaryMid&lt;/span&gt;($BRIGHTNESS_Lcd, $i, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $BRIGHTNESS_String &amp;amp;= $tmp &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;Else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $tmp = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;ExitLoop&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        $BRIGHTNESS_String &amp;amp;= $tmp &amp;amp; &lt;span class=&quot;string&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;EndIf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Next&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;StringSplit&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;StringTrimRight&lt;/span&gt;($BRIGHTNESS_String, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;), &lt;span class=&quot;string&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;Brightness_lcd&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;Func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_exit&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;If&lt;/span&gt; $hDevice &lt;span class=&quot;keyword&quot;&gt;Then&lt;/span&gt; _WinAPI_CloseHandle($hDevice)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        _DestroyPhysicalMonitor($hMonitor) &lt;span class=&quot;comment&quot;&gt;;关闭监视器句柄&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;DllClose&lt;/span&gt;($Dxva2)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;Exit&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;EndFunc&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;;==&amp;gt;_exit&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="源码" scheme="https://www.bnwin.com/categories/code/"/>
    
    
    <category term="autoit源码" scheme="https://www.bnwin.com/tags/autoit%E6%BA%90%E7%A0%81/"/>
    
    <category term="dxva2" scheme="https://www.bnwin.com/tags/dxva2/"/>
    
    <category term="显示器设置" scheme="https://www.bnwin.com/tags/%E6%98%BE%E7%A4%BA%E5%99%A8%E8%AE%BE%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>网吧耳麦助手－设置主音量_麦克风音量_麦克风加强级别</title>
    <link href="https://www.bnwin.com/page/2203111529/"/>
    <id>https://www.bnwin.com/page/2203111529/</id>
    <published>2019-03-21T13:56:27.000Z</published>
    <updated>2021-09-11T16:44:49.058Z</updated>
    
    <content type="html"><![CDATA[<p>网吧耳麦助手是一款自动设置系统主音量，自动设置麦克风音量，自动设置麦克风加强级别，波形显示麦克风音量的软件！</p><p>可使用命令行运行，命令行无界面，运行后自动退出<br>参数一 为 允许/禁止所有声音效果 0为允许 1为禁止<br>参数二 为 设置主音量 取值范围为0-100<br>参数三 为 设置麦克风音量 取值范围为0-100<br>参数四 为 设置麦克风加强 取值范围为 0 10 20 30 40<br>例如 autosound.exe 1 100 100 30表示禁止所有声音效果，<br>主音量设置为100 麦克风音量为100 麦克风加强为30</p><p>运行本软件，看下面的麦克风检测的动态条，就可知麦克风是否正常!</p><p>本软件支持win7 win10 不支持winxp<br><img src="/images/wblmzs.gif" alt="网吧耳麦助手演示动画"></p><p>下载地址</p><p>链接: <a href="https://pan.baidu.com/s/1b5KCsTAPffjVh40SyUUuVw">https://pan.baidu.com/s/1b5KCsTAPffjVh40SyUUuVw</a> 提取码: sek6 复制这段内容后打开百度网盘手机App，操作更方便哦 解压密码 bnwin.com</p><p>加强版自动检测上报麦克风是否损坏，方便及时更换麦克风损坏的耳机，不用一台一台的试耳麦是否完好!</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;网吧耳麦助手是一款自动设置系统主音量，自动设置麦克风音量，自动设置麦克风加强级别，波形显示麦克风音量的软件！&lt;/p&gt;
&lt;p&gt;可使用命令行运行，命令行无界面，运行后自动退出&lt;br&gt;参数一 为 允许/禁止所有声音效果 0为允许 1为禁止&lt;br&gt;参数二 为 设置主音量 取值范围为0-100&lt;br&gt;参数三 为 设置麦克风音量 取值范围为0-100&lt;br&gt;参数四 为 设置麦克风加强 取值范围为 0 10 20 30 40&lt;br&gt;例如 autosound.exe 1 100 100 30表示禁止所有声音效果，&lt;br&gt;主音量设置为100 麦克风音量为100 麦克风加强为30&lt;/p&gt;
&lt;p&gt;运行本软件，看下面的麦克风检测的动态条，就可知麦克风是否正常!&lt;/p&gt;
&lt;p&gt;本软件支持win7 win10 不支持winxp&lt;br&gt;&lt;img src=&quot;/images/wblmzs.gif&quot; alt=&quot;网吧耳麦助手演示动画&quot;&gt;&lt;/p&gt;
&lt;p&gt;下载地址&lt;/p&gt;
&lt;p&gt;链接: &lt;a href=&quot;https://pan.baidu.com/s/1b5KCsTAPffjVh40SyUUuVw&quot;&gt;https://pan.baidu.com/s/1b5KCsTAPffjVh40SyUUuVw&lt;/a&gt; 提取码: sek6 复制这段内容后打开百度网盘手机App，操作更方便哦 解压密码 bnwin.com&lt;/p&gt;
&lt;p&gt;加强版自动检测上报麦克风是否损坏，方便及时更换麦克风损坏的耳机，不用一台一台的试耳麦是否完好!&lt;/p&gt;
</summary>
    
    
    
    <category term="软件" scheme="https://www.bnwin.com/categories/soft/"/>
    
    
    <category term="原创软件" scheme="https://www.bnwin.com/tags/%E5%8E%9F%E5%88%9B%E8%BD%AF%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>8圈计费系统9.5独立挂机_充值_换机_下机等功能工具-八圈挂机锁</title>
    <link href="https://www.bnwin.com/page/1816476569/"/>
    <id>https://www.bnwin.com/page/1816476569/</id>
    <published>2019-03-21T13:53:41.000Z</published>
    <updated>2021-09-18T04:38:14.980Z</updated>
    
    <content type="html"><![CDATA[<p>8圈计费系统独立挂机\充值\换机\下机等功能工具<br>适用于8圈 9.5版</p><p>2019-03-24 新增参数二支持</p><p>参数二为1，按8圈计费原生方式显示，为空或其他值，则直接显示功能界面!</p><p>如 8圈挂机.exe 1 1 表示按8圈计费原生方式显示下机!而 8圈挂机.exe 1 则直接显示下机界面，不会有8圈的主界面! 如 8圈挂机.exe 0 1 则按8圈计费原生方式显示挂机</p><p>参数 1 下机<br>参数 2 换机<br>参数 3 呼叫<br>参数 4 充值<br>参数 5 去上网<br>参数 6 商城<br>参数 7 聊天<br>参数 8 修改密码<br>参数 9 包时<br>不加参数或其他值 挂机<br><img src="/images/lock9.5.gif" alt=""></p><h2 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址:"></a>下载地址:</h2><p><a href="https://item.taobao.com/item.htm?ft=t&id=655874499629">点我开始下载</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;8圈计费系统独立挂机\充值\换机\下机等功能工具&lt;br&gt;适用于8圈 9.5版&lt;/p&gt;
&lt;p&gt;2019-03-24 新增参数二支持&lt;/p&gt;
&lt;p&gt;参数二为1，按8圈计费原生方式显示，为空或其他值，则直接显示功能界面!&lt;/p&gt;
&lt;p&gt;如 8圈挂机.exe 1 1 表示按8圈计费原生方式显示下机!而 8圈挂机.exe 1 则直接显示下机界面，不会有8圈的主界面! 如 8圈挂机.exe 0 1 则按8圈计费原生方式显示挂机&lt;/p&gt;
&lt;p&gt;参数 1 下机&lt;br&gt;参数 2 换机&lt;br&gt;参数 3 呼叫&lt;br&gt;参数 4 充值&lt;br&gt;参数 5 去上网&lt;br&gt;参数 6 商城&lt;br&gt;参数 7 聊天&lt;br&gt;参数 8 修改密码&lt;br&gt;参数 9 包时&lt;br&gt;不加参数或其他值 挂机&lt;br&gt;&lt;img src=&quot;/images/lock9.5.gif&quot; alt&gt;&lt;/p&gt;
&lt;h2 id=&quot;下载地址&quot;&gt;&lt;a href=&quot;#下载地址&quot; class=&quot;headerlink&quot; title=&quot;下载地址:&quot;&gt;&lt;/a&gt;下载地址:&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://item.taobao.com/item.htm?ft=t&amp;id=655874499629&quot;&gt;点我开始下载&lt;/a&gt;&lt;/p&gt;
</summary>
    
    
    
    <category term="软件" scheme="https://www.bnwin.com/categories/soft/"/>
    
    
    <category term="八圈" scheme="https://www.bnwin.com/tags/%E5%85%AB%E5%9C%88/"/>
    
    <category term="原创软件" scheme="https://www.bnwin.com/tags/%E5%8E%9F%E5%88%9B%E8%BD%AF%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>单机游戏死亡阴影aardio内存修改器源码</title>
    <link href="https://www.bnwin.com/page/2891878490/"/>
    <id>https://www.bnwin.com/page/2891878490/</id>
    <published>2018-10-26T14:11:47.000Z</published>
    <updated>2021-09-17T00:26:01.058Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/2012-2_2012216161145996090.jpg" alt="">aardio是专用于桌面软件快速开发的新一代混合型编程语言 – 具有动态语言轻便、灵活的特性，而且又可以同时支持静态类型开发，象静态语言那样使用。aardio可以直接支持原生DLL，即使是外部EXE进程中的函数，也可以使用一句代码声明为普通的aardio函数对象( 原生call支持 )，aardio支持非常多的标准调用约定，例如 stdcall，cdecl，thiscall，fastcall，regparm(n) 等调用约定都可以支持。aardio虽然小，但支持的接口很丰富、可以支持com静态动态双接口，象VBS一样原生支持com对象。<p>以下是使用aardio写的修改单机游戏死亡阴影3的游戏数据源码，仅供学习aardio使用!新建一个aardio代码文件，把下面代码复制到代码文件中，就可直接运行!</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> win.ui;</span><br><span class="line"><span class="keyword">import</span> process;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//声明变量hero3,jz</span></span><br><span class="line">var hero3,jz;</span><br><span class="line">hero3=process.find(<span class="string">&quot;Heroes3.exe&quot;</span>)</span><br><span class="line"><span class="keyword">if</span>(hero3)&#123;</span><br><span class="line">    <span class="comment">//把基址赋值给jz变量</span></span><br><span class="line">    jz=hero3.readNumber(<span class="number">0</span>x82B0BC)        </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    win.msgbox(<span class="string">&quot;请您先运行游戏&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*DSG&#123;&#123;*/</span></span><br><span class="line">var winform = win.form(text=<span class="string">&quot;死亡阴影修改器&quot;</span>;left=<span class="number">300</span>;right=<span class="number">440</span>;bottom=<span class="number">247</span>;max=<span class="literal">false</span>;parent=...)</span><br><span class="line">winform.add(</span><br><span class="line">button=&#123;cls=<span class="string">&quot;button&quot;</span>;text=<span class="string">&quot;修改&quot;</span>;left=<span class="number">33</span>;top=<span class="number">202</span>;right=<span class="number">105</span>;bottom=<span class="number">237</span>;z=<span class="number">1</span>&#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">/*&#125;&#125;*/</span></span><br><span class="line"> </span><br><span class="line">bqm = &#123; <span class="string">&quot;水晶：&quot;</span>;<span class="string">&quot;水银：&quot;</span>;<span class="string">&quot;石头：&quot;</span>;<span class="string">&quot;金钱：&quot;</span>;<span class="string">&quot;木材：&quot;</span>;<span class="string">&quot;宝石：&quot;</span>;<span class="string">&quot;硫磺：&quot;</span> &#125;</span><br><span class="line">py  = &#123; sj=Oxac;sy=Oxa0;st=Oxa4;jq=<span class="number">0</span>xb4;mc=Ox9c;bs=<span class="number">0</span>xb0;lh=Oxa8 &#125;</span><br><span class="line">bjk = &#123; <span class="string">&quot;sj&quot;</span>;<span class="string">&quot;sy&quot;</span>;<span class="string">&quot;st&quot;</span>;<span class="string">&quot;jq&quot;</span>;<span class="string">&quot;mc&quot;</span>;<span class="string">&quot;bs&quot;</span>;<span class="string">&quot;lh&quot;</span> &#125;</span><br><span class="line">tab = &#123; &#125;</span><br><span class="line"> </span><br><span class="line">winform.button.oncommand = <span class="built_in">function</span>(id,event)&#123; </span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;#bjk;<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(winform[<span class="string">&quot;edit_&quot;</span>+bjk[ i ]].text != <span class="number">0</span>&amp;&amp;winform[<span class="string">&quot;edit_&quot;</span>+bjk[ i ]].text !=<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">            table.push(tab,bjk[ i ])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;#tab;<span class="number">1</span>)&#123; </span><br><span class="line">        <span class="comment">//win.msgbox(winform[&quot;edit_&quot;+tab[ i ]].text,&quot;死亡阴影修改器&quot;)</span></span><br><span class="line">        hero3.writeNumber(jz+py[tab[ i ]],winform[<span class="string">&quot;edit_&quot;</span>+tab[ i ]].text)</span><br><span class="line">    &#125;</span><br><span class="line">    tab=&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">var topp = <span class="number">5</span></span><br><span class="line">var bott = <span class="number">25</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;#bqm;<span class="number">1</span>)&#123;</span><br><span class="line">    winform.add( [<span class="string">&quot;edit_&quot;</span>+bjk[ i ]]=&#123;num=<span class="number">1</span>;bottom=bott;text=<span class="string">&quot;999&quot;</span>;left=<span class="number">50</span>;top=topp;z=<span class="number">3</span>;right=<span class="number">114</span>;edge=<span class="number">1</span>;cls=<span class="string">&quot;edit&quot;</span> &#125;)</span><br><span class="line">    winform.add( [<span class="string">&quot;static&quot;</span>+i]=&#123; bottom=bott;right=<span class="number">52</span>;left=<span class="number">16</span>;text=bqm[ i ];top=topp;z=<span class="number">1</span>;transparent=<span class="number">1</span>;cls=<span class="string">&quot;static&quot;</span>&#125;)</span><br><span class="line">    topp+=<span class="number">24</span></span><br><span class="line">    bott+=<span class="number">24</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">winform.show() </span><br><span class="line">win.loopMessage();</span><br></pre></td></tr></table></figure><p>其中的基址0x82B0BC，及偏移量为什么是这个数据，就需要你使用ce自己分析了! 对aardio不熟悉可以查看在线手机 aardio使用手册</p>]]></content>
    
    
    <summary type="html">&lt;img src=&quot;/images/2012-2_2012216161145996090.jpg&quot; alt&gt;
aardio是专用于桌面软件快速开发的新一代混合型编程语言 – 具有动态语言轻便、灵活的特性，而且又可以同时支持静态类型开发，象静态语言那样使用。aardio可以直接支持原生DLL，即使是外部EXE进程中的函数，也可以使用一句代码声明为普通的aardio函数对象( 原生call支持 )，aardio支持非常多的标准调用约定，例如 stdcall，cdecl，thiscall，fastcall，regparm(n) 等调用约定都可以支持。aardio虽然小，但支持的接口很丰富、可以支持com静态动态双接口，象VBS一样原生支持com对象。

&lt;p&gt;以下是使用aardio写的修改单机游戏死亡阴影3的游戏数据源码，仅供学习aardio使用!新建一个aardio代码文件，把下面代码复制到代码文件中，就可直接运行!&lt;/p&gt;
&lt;figure class=&quot;highlight d&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; win.ui;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; process;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//声明变量hero3,jz&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var hero3,jz;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hero3=process.find(&lt;span class=&quot;string&quot;&gt;&amp;quot;Heroes3.exe&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(hero3)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//把基址赋值给jz变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    jz=hero3.readNumber(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x82B0BC)        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    win.msgbox(&lt;span class=&quot;string&quot;&gt;&amp;quot;请您先运行游戏&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*DSG&amp;#123;&amp;#123;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var winform = win.form(text=&lt;span class=&quot;string&quot;&gt;&amp;quot;死亡阴影修改器&amp;quot;&lt;/span&gt;;left=&lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;;right=&lt;span class=&quot;number&quot;&gt;440&lt;/span&gt;;bottom=&lt;span class=&quot;number&quot;&gt;247&lt;/span&gt;;max=&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;parent=...)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.add(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;button=&amp;#123;cls=&lt;span class=&quot;string&quot;&gt;&amp;quot;button&amp;quot;&lt;/span&gt;;text=&lt;span class=&quot;string&quot;&gt;&amp;quot;修改&amp;quot;&lt;/span&gt;;left=&lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;;top=&lt;span class=&quot;number&quot;&gt;202&lt;/span&gt;;right=&lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;;bottom=&lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;;z=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&amp;#125;&amp;#125;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bqm = &amp;#123; &lt;span class=&quot;string&quot;&gt;&amp;quot;水晶：&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;水银：&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;石头：&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;金钱：&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;木材：&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;宝石：&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;硫磺：&amp;quot;&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;py  = &amp;#123; sj=Oxac;sy=Oxa0;st=Oxa4;jq=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;xb4;mc=Ox9c;bs=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;xb0;lh=Oxa8 &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bjk = &amp;#123; &lt;span class=&quot;string&quot;&gt;&amp;quot;sj&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;sy&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;st&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;jq&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;mc&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;bs&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;lh&amp;quot;&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tab = &amp;#123; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.button.oncommand = &lt;span class=&quot;built_in&quot;&gt;function&lt;/span&gt;(id,event)&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(i=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;#bjk;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(winform[&lt;span class=&quot;string&quot;&gt;&amp;quot;edit_&amp;quot;&lt;/span&gt;+bjk[ i ]].text != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&amp;amp;&amp;amp;winform[&lt;span class=&quot;string&quot;&gt;&amp;quot;edit_&amp;quot;&lt;/span&gt;+bjk[ i ]].text !=&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            table.push(tab,bjk[ i ])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(i=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;#tab;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//win.msgbox(winform[&amp;quot;edit_&amp;quot;+tab[ i ]].text,&amp;quot;死亡阴影修改器&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        hero3.writeNumber(jz+py[tab[ i ]],winform[&lt;span class=&quot;string&quot;&gt;&amp;quot;edit_&amp;quot;&lt;/span&gt;+tab[ i ]].text)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    tab=&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var topp = &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var bott = &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(i=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;#bqm;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    winform.add( [&lt;span class=&quot;string&quot;&gt;&amp;quot;edit_&amp;quot;&lt;/span&gt;+bjk[ i ]]=&amp;#123;num=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;bottom=bott;text=&lt;span class=&quot;string&quot;&gt;&amp;quot;999&amp;quot;&lt;/span&gt;;left=&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;;top=topp;z=&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;right=&lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;;edge=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;cls=&lt;span class=&quot;string&quot;&gt;&amp;quot;edit&amp;quot;&lt;/span&gt; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    winform.add( [&lt;span class=&quot;string&quot;&gt;&amp;quot;static&amp;quot;&lt;/span&gt;+i]=&amp;#123; bottom=bott;right=&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;;left=&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;;text=bqm[ i ];top=topp;z=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;transparent=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;cls=&lt;span class=&quot;string&quot;&gt;&amp;quot;static&amp;quot;&lt;/span&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    topp+=&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    bott+=&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.show() &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;win.loopMessage();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;其中的基址0x82B0BC，及偏移量为什么是这个数据，就需要你使用ce自己分析了! 对aardio不熟悉可以查看在线手机 aardio使用手册&lt;/p&gt;
</summary>
    
    
    
    <category term="源码" scheme="https://www.bnwin.com/categories/code/"/>
    
    
    <category term="基址查找方法" scheme="https://www.bnwin.com/tags/%E5%9F%BA%E5%9D%80%E6%9F%A5%E6%89%BE%E6%96%B9%E6%B3%95/"/>
    
    <category term="aardio源码" scheme="https://www.bnwin.com/tags/aardio%E6%BA%90%E7%A0%81/"/>
    
    <category term="内存修改方法" scheme="https://www.bnwin.com/tags/%E5%86%85%E5%AD%98%E4%BF%AE%E6%94%B9%E6%96%B9%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>aardio的listview自绘源代码</title>
    <link href="https://www.bnwin.com/page/1712950360/"/>
    <id>https://www.bnwin.com/page/1712950360/</id>
    <published>2018-10-26T13:52:47.000Z</published>
    <updated>2021-09-16T23:54:09.750Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/aardio.jpg" alt="">aardio的listview自绘源代码，在aardio新建一代码文件，复制下面的代码到代码文件中，直接运行就可以看到效果!<figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> win.ui;</span><br><span class="line"><span class="comment">/*DSG&#123;&#123;*/</span></span><br><span class="line">var winform = win.form(text=<span class="string">&quot;listview中添加进度条演示&quot;</span>;right=<span class="number">945</span>;bottom=<span class="number">474</span>)</span><br><span class="line">winform.add(</span><br><span class="line">button=&#123;cls=<span class="string">&quot;button&quot;</span>;text=<span class="string">&quot;(点击这里随机更新一次第二行的进度值)&quot;</span>;left=<span class="number">0</span>;top=<span class="number">392</span>;right=<span class="number">944</span>;bottom=<span class="number">472</span>;font=LOGFONT(h=-<span class="number">21</span>);z=<span class="number">2</span>&#125;;</span><br><span class="line">流程编辑框=&#123;cls=<span class="string">&quot;listview&quot;</span>;left=<span class="number">0</span>;top=<span class="number">0</span>;right=<span class="number">946</span>;bottom=<span class="number">384</span>;edge=<span class="number">1</span>;font=LOGFONT(h=-<span class="number">19</span>;name=<span class="string">&#x27;FontAwesome&#x27;</span>);fullRow=<span class="number">1</span>;vscroll=<span class="number">1</span>;z=<span class="number">1</span>&#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">/*&#125;&#125;*/</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> win.fontAwesome;</span><br><span class="line"><span class="keyword">import</span> win.graphics;</span><br><span class="line"><span class="keyword">import</span> win.imageList;</span><br><span class="line">var imagelist = win.imageList(<span class="number">5</span>,<span class="number">34</span>);</span><br><span class="line">winform.流程编辑框.setImageList( imagelist,<span class="number">1</span><span class="comment">/*_LVSIL_SMALL*/</span> );</span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;&quot;</span>,<span class="number">30</span>,,<span class="number">0</span>x2<span class="comment">/*_LVCFMT_CENTER*/</span>) </span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;中断&quot;</span>,<span class="number">80</span>,,<span class="number">0</span>x2<span class="comment">/*_LVCFMT_CENTER*/</span>) </span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;备注&quot;</span>,<span class="number">300</span>,,<span class="number">0</span>x0<span class="comment">/*_LVCFMT_LEFT*/</span>) </span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;功能&quot;</span>,<span class="number">100</span>,,<span class="number">0</span>x0<span class="comment">/*_LVCFMT_LEFT*/</span>)</span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;参数&quot;</span>,<span class="number">300</span>,,<span class="number">0</span>x0<span class="comment">/*_LVCFMT_LEFT*/</span>)</span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;&quot;</span>,<span class="number">30</span>,,<span class="number">0</span>x2<span class="comment">/*_LVCFMT_CENTER*/</span>)</span><br><span class="line">winform.流程编辑框.insertColumn(<span class="string">&quot;&quot;</span>,<span class="number">1</span>,,<span class="number">0</span>x2<span class="comment">/*_LVCFMT_CENTER*/</span>)</span><br><span class="line"><span class="comment">//自适应列宽度 </span></span><br><span class="line">winform.流程编辑框.adjust = <span class="built_in">function</span>(cx,cy)&#123;</span><br><span class="line">    winform.流程编辑框.fillParent(<span class="number">5</span><span class="comment">/*列序号*/</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">30</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=1000;[&quot;模式&quot;]=&quot;相对运动&quot;;[&quot;距离&quot;]=&quot;2380&quot;;[&quot;是否等待&quot;]=&quot;否&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00d&#x27;</span>;<span class="string">&#x27;\uF05e&#x27;</span>;<span class="number">100</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=300;[&quot;模式&quot;]=&quot;连续运动&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">200</span>;<span class="string">&quot;调用子程序&quot;</span>;<span class="string">&#x27;&#123;[&quot;调用子程序&quot;]=&quot;连续读传感器&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">50</span>;<span class="string">&quot;调用子程序&quot;</span>;<span class="string">&#x27;&#123;[&quot;调用子程序&quot;]=&quot;回字形对准算法&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">150</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=1000;[&quot;模式&quot;]=&quot;相对运动&quot;;[&quot;距离&quot;]=&quot;2380&quot;;[&quot;是否等待&quot;]=&quot;否&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">120</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=1000;[&quot;模式&quot;]=&quot;相对运动&quot;;[&quot;距离&quot;]=&quot;2380&quot;;[&quot;是否等待&quot;]=&quot;否&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00d&#x27;</span>;<span class="string">&#x27;\uF05e&#x27;</span>;<span class="number">10</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=300;[&quot;模式&quot;]=&quot;连续运动&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">70</span>;<span class="string">&quot;调用子程序&quot;</span>;<span class="string">&#x27;&#123;[&quot;调用子程序&quot;]=&quot;连续读传感器&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">260</span>;<span class="string">&quot;调用子程序&quot;</span>;<span class="string">&#x27;&#123;[&quot;调用子程序&quot;]=&quot;回字形对准算法&quot;;[&quot;是否等待&quot;]=&quot;是&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line">winform.流程编辑框.addItem( &#123; </span><br><span class="line">        text=&#123;<span class="string">&#x27;\uF00c&#x27;</span>;<span class="string">&#x27;\uF1db&#x27;</span>;<span class="number">130</span>;<span class="string">&quot;直线运动&quot;</span>;<span class="string">&#x27;&#123;[&quot;速度&quot;]=1000;[&quot;模式&quot;]=&quot;相对运动&quot;;[&quot;距离&quot;]=&quot;2380&quot;;[&quot;是否等待&quot;]=&quot;否&quot;;&#125;&#x27;</span>;<span class="string">&#x27;\uF01a&#x27;</span>&#125; </span><br><span class="line">&#125; )</span><br><span class="line"> </span><br><span class="line"><span class="comment">//自绘</span></span><br><span class="line">winform.流程编辑框.onnotify = <span class="built_in">function</span>(id,code,ptr)&#123; </span><br><span class="line">        <span class="keyword">if</span>( code == <span class="number">0</span>xFFFFFFF4<span class="comment">/*_NM_CUSTOMDRAW*/</span> )&#123;</span><br><span class="line">                var lvcd = winform.流程编辑框.getNotifyCustomDraw(code,ptr);</span><br><span class="line">                <span class="keyword">if</span>( lvcd.nmcd.dwDrawStage == <span class="number">0</span>x10001<span class="comment">/*_CDDS_ITEMPREPAINT*/</span>)</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>x20<span class="comment">/*_CDRF_NOTIFYSUBITEMDRAW*/</span></span><br><span class="line">                elseif( lvcd.nmcd.dwDrawStage == <span class="number">1</span><span class="comment">/*_CDDS_PREPAINT*/</span> )&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>x20<span class="comment">/*_CDRF_NOTIFYITEMDRAW*/</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                elseif( lvcd.nmcd.dwDrawStage == ( <span class="number">0</span>x10001<span class="comment">/*_CDDS_ITEMPREPAINT*/</span> | <span class="number">0</span>x20000<span class="comment">/*_CDDS_SUBITEM*/</span>) )&#123; </span><br><span class="line">                        <span class="comment">//注意这里 iSubItem 的索引自0开始( 其他函数通常自1开始 )</span></span><br><span class="line">                        </span><br><span class="line">                        var cvs = win.graphics.canvas(); <span class="comment">// 创建一个画布</span></span><br><span class="line">                    cvs.fromHDC(lvcd.nmcd.hdc); <span class="comment">// 传入 hDC</span></span><br><span class="line">                    var nItem = lvcd.nmcd.dwItemSpec+<span class="number">1</span>;</span><br><span class="line">                    var nSubItem = lvcd.iSubItem;</span><br><span class="line">                    var rc = owner.getItemRect(nItem,nSubItem);</span><br><span class="line">                    <span class="keyword">if</span>(nSubItem == <span class="number">3</span>)&#123;</span><br><span class="line">                            </span><br><span class="line">                            var RetRc = ::RECT(rc.left+<span class="number">1</span>,rc.top+<span class="number">6</span>,rc.right-tonumber(owner.getItemText(nItem,<span class="number">3</span>)),rc.bottom-<span class="number">6</span>);</span><br><span class="line">                            cvs.brush.color = <span class="number">0</span>x00ff00;</span><br><span class="line">                            cvs.fillRect(RetRc)</span><br><span class="line">                                    </span><br><span class="line">                    &#125;</span><br><span class="line">                    cvs.pen.color = <span class="number">0</span>xebebeb; <span class="comment">// 定义画笔的颜色</span></span><br><span class="line">                    cvs.drawEdge(rc);</span><br><span class="line">                        </span><br><span class="line">                    lvcd.update()</span><br><span class="line">                    cvs.destroy();</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span><span class="comment">/*_CDRF_DODEFAULT*/</span></span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//演示更新进度</span></span><br><span class="line">winform.button.oncommand = <span class="built_in">function</span>(id,event)&#123;</span><br><span class="line">        winform.流程编辑框.setItemText(tostring(math.random(<span class="number">10</span>,<span class="number">280</span>)),<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">winform.show() </span><br><span class="line">win.loopMessage();</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;img src=&quot;/images/aardio.jpg&quot; alt&gt;
aardio的listview自绘源代码，在aardio新建一代码文件，复制下面的代码到代码文件中，直接运行就可以看到效果!
&lt;figure class=&quot;highlight d&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; win.ui;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*DSG&amp;#123;&amp;#123;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var winform = win.form(text=&lt;span class=&quot;string&quot;&gt;&amp;quot;listview中添加进度条演示&amp;quot;&lt;/span&gt;;right=&lt;span class=&quot;number&quot;&gt;945&lt;/span&gt;;bottom=&lt;span class=&quot;number&quot;&gt;474&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.add(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;button=&amp;#123;cls=&lt;span class=&quot;string&quot;&gt;&amp;quot;button&amp;quot;&lt;/span&gt;;text=&lt;span class=&quot;string&quot;&gt;&amp;quot;(点击这里随机更新一次第二行的进度值)&amp;quot;&lt;/span&gt;;left=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;top=&lt;span class=&quot;number&quot;&gt;392&lt;/span&gt;;right=&lt;span class=&quot;number&quot;&gt;944&lt;/span&gt;;bottom=&lt;span class=&quot;number&quot;&gt;472&lt;/span&gt;;font=LOGFONT(h=-&lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;);z=&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;流程编辑框=&amp;#123;cls=&lt;span class=&quot;string&quot;&gt;&amp;quot;listview&amp;quot;&lt;/span&gt;;left=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;top=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;right=&lt;span class=&quot;number&quot;&gt;946&lt;/span&gt;;bottom=&lt;span class=&quot;number&quot;&gt;384&lt;/span&gt;;edge=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;font=LOGFONT(h=-&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;;name=&lt;span class=&quot;string&quot;&gt;&amp;#x27;FontAwesome&amp;#x27;&lt;/span&gt;);fullRow=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;vscroll=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;z=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&amp;#125;&amp;#125;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; win.fontAwesome;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; win.graphics;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; win.imageList;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var imagelist = win.imageList(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.setImageList( imagelist,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;/*_LVSIL_SMALL*/&lt;/span&gt; );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.insertColumn(&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;,,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x2&lt;span class=&quot;comment&quot;&gt;/*_LVCFMT_CENTER*/&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.insertColumn(&lt;span class=&quot;string&quot;&gt;&amp;quot;中断&amp;quot;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;,,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x2&lt;span class=&quot;comment&quot;&gt;/*_LVCFMT_CENTER*/&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.insertColumn(&lt;span class=&quot;string&quot;&gt;&amp;quot;备注&amp;quot;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;,,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;span class=&quot;comment&quot;&gt;/*_LVCFMT_LEFT*/&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.insertColumn(&lt;span class=&quot;string&quot;&gt;&amp;quot;功能&amp;quot;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;,,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;span class=&quot;comment&quot;&gt;/*_LVCFMT_LEFT*/&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.insertColumn(&lt;span class=&quot;string&quot;&gt;&amp;quot;参数&amp;quot;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;,,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;span class=&quot;comment&quot;&gt;/*_LVCFMT_LEFT*/&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.insertColumn(&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;,,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x2&lt;span class=&quot;comment&quot;&gt;/*_LVCFMT_CENTER*/&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.insertColumn(&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x2&lt;span class=&quot;comment&quot;&gt;/*_LVCFMT_CENTER*/&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//自适应列宽度 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.adjust = &lt;span class=&quot;built_in&quot;&gt;function&lt;/span&gt;(cx,cy)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    winform.流程编辑框.fillParent(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;/*列序号*/&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.addItem( &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        text=&amp;#123;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF00c&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF1db&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;直线运动&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123;[&amp;quot;速度&amp;quot;]=1000;[&amp;quot;模式&amp;quot;]=&amp;quot;相对运动&amp;quot;;[&amp;quot;距离&amp;quot;]=&amp;quot;2380&amp;quot;;[&amp;quot;是否等待&amp;quot;]=&amp;quot;否&amp;quot;;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF01a&amp;#x27;&lt;/span&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.addItem( &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        text=&amp;#123;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF00d&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF05e&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;直线运动&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123;[&amp;quot;速度&amp;quot;]=300;[&amp;quot;模式&amp;quot;]=&amp;quot;连续运动&amp;quot;;[&amp;quot;是否等待&amp;quot;]=&amp;quot;是&amp;quot;;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF01a&amp;#x27;&lt;/span&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.addItem( &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        text=&amp;#123;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF00c&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF1db&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;调用子程序&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123;[&amp;quot;调用子程序&amp;quot;]=&amp;quot;连续读传感器&amp;quot;;[&amp;quot;是否等待&amp;quot;]=&amp;quot;是&amp;quot;;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF01a&amp;#x27;&lt;/span&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.addItem( &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        text=&amp;#123;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF00c&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF1db&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;调用子程序&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123;[&amp;quot;调用子程序&amp;quot;]=&amp;quot;回字形对准算法&amp;quot;;[&amp;quot;是否等待&amp;quot;]=&amp;quot;是&amp;quot;;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF01a&amp;#x27;&lt;/span&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.addItem( &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        text=&amp;#123;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF00c&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF1db&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;直线运动&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123;[&amp;quot;速度&amp;quot;]=1000;[&amp;quot;模式&amp;quot;]=&amp;quot;相对运动&amp;quot;;[&amp;quot;距离&amp;quot;]=&amp;quot;2380&amp;quot;;[&amp;quot;是否等待&amp;quot;]=&amp;quot;否&amp;quot;;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF01a&amp;#x27;&lt;/span&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.addItem( &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        text=&amp;#123;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF00c&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF1db&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;直线运动&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123;[&amp;quot;速度&amp;quot;]=1000;[&amp;quot;模式&amp;quot;]=&amp;quot;相对运动&amp;quot;;[&amp;quot;距离&amp;quot;]=&amp;quot;2380&amp;quot;;[&amp;quot;是否等待&amp;quot;]=&amp;quot;否&amp;quot;;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF01a&amp;#x27;&lt;/span&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.addItem( &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        text=&amp;#123;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF00d&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF05e&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;直线运动&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123;[&amp;quot;速度&amp;quot;]=300;[&amp;quot;模式&amp;quot;]=&amp;quot;连续运动&amp;quot;;[&amp;quot;是否等待&amp;quot;]=&amp;quot;是&amp;quot;;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF01a&amp;#x27;&lt;/span&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.addItem( &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        text=&amp;#123;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF00c&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF1db&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;调用子程序&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123;[&amp;quot;调用子程序&amp;quot;]=&amp;quot;连续读传感器&amp;quot;;[&amp;quot;是否等待&amp;quot;]=&amp;quot;是&amp;quot;;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF01a&amp;#x27;&lt;/span&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.addItem( &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        text=&amp;#123;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF00c&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF1db&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;number&quot;&gt;260&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;调用子程序&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123;[&amp;quot;调用子程序&amp;quot;]=&amp;quot;回字形对准算法&amp;quot;;[&amp;quot;是否等待&amp;quot;]=&amp;quot;是&amp;quot;;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF01a&amp;#x27;&lt;/span&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.addItem( &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        text=&amp;#123;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF00c&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF1db&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;quot;直线运动&amp;quot;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123;[&amp;quot;速度&amp;quot;]=1000;[&amp;quot;模式&amp;quot;]=&amp;quot;相对运动&amp;quot;;[&amp;quot;距离&amp;quot;]=&amp;quot;2380&amp;quot;;[&amp;quot;是否等待&amp;quot;]=&amp;quot;否&amp;quot;;&amp;#125;&amp;#x27;&lt;/span&gt;;&lt;span class=&quot;string&quot;&gt;&amp;#x27;\uF01a&amp;#x27;&lt;/span&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//自绘&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.流程编辑框.onnotify = &lt;span class=&quot;built_in&quot;&gt;function&lt;/span&gt;(id,code,ptr)&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;( code == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;xFFFFFFF4&lt;span class=&quot;comment&quot;&gt;/*_NM_CUSTOMDRAW*/&lt;/span&gt; )&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                var lvcd = winform.流程编辑框.getNotifyCustomDraw(code,ptr);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;( lvcd.nmcd.dwDrawStage == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x10001&lt;span class=&quot;comment&quot;&gt;/*_CDDS_ITEMPREPAINT*/&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x20&lt;span class=&quot;comment&quot;&gt;/*_CDRF_NOTIFYSUBITEMDRAW*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                elseif( lvcd.nmcd.dwDrawStage == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;/*_CDDS_PREPAINT*/&lt;/span&gt; )&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x20&lt;span class=&quot;comment&quot;&gt;/*_CDRF_NOTIFYITEMDRAW*/&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                elseif( lvcd.nmcd.dwDrawStage == ( &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x10001&lt;span class=&quot;comment&quot;&gt;/*_CDDS_ITEMPREPAINT*/&lt;/span&gt; | &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x20000&lt;span class=&quot;comment&quot;&gt;/*_CDDS_SUBITEM*/&lt;/span&gt;) )&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;comment&quot;&gt;//注意这里 iSubItem 的索引自0开始( 其他函数通常自1开始 )&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        var cvs = win.graphics.canvas(); &lt;span class=&quot;comment&quot;&gt;// 创建一个画布&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    cvs.fromHDC(lvcd.nmcd.hdc); &lt;span class=&quot;comment&quot;&gt;// 传入 hDC&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    var nItem = lvcd.nmcd.dwItemSpec+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    var nSubItem = lvcd.iSubItem;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    var rc = owner.getItemRect(nItem,nSubItem);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(nSubItem == &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            var RetRc = ::RECT(rc.left+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,rc.top+&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;,rc.right-tonumber(owner.getItemText(nItem,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)),rc.bottom-&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            cvs.brush.color = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00ff00;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            cvs.fillRect(RetRc)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    cvs.pen.color = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;xebebeb; &lt;span class=&quot;comment&quot;&gt;// 定义画笔的颜色&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    cvs.drawEdge(rc);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    lvcd.update()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    cvs.destroy();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;/*_CDRF_DODEFAULT*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//演示更新进度&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.button.oncommand = &lt;span class=&quot;built_in&quot;&gt;function&lt;/span&gt;(id,event)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        winform.流程编辑框.setItemText(tostring(math.random(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;280&lt;/span&gt;)),&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;winform.show() &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;win.loopMessage();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="源码" scheme="https://www.bnwin.com/categories/code/"/>
    
    
    <category term="aardio源码" scheme="https://www.bnwin.com/tags/aardio%E6%BA%90%E7%A0%81/"/>
    
    <category term="listview使用方法" scheme="https://www.bnwin.com/tags/listview%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    
  </entry>
  
</feed>
